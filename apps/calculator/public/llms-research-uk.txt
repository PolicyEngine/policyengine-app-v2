# PolicyEngine UK Research

> UK tax and benefit policy analysis.

---
# How a £2,000 salary sacrifice cap would affect workers
Slug: uk-salary-sacrifice-cap
Date: 2025-11-27
Authors: Max Ghenis, Vahid Ahmadi
Tags: uk, policy
Description: Capping salary sacrifice pension contributions at £2,000 would raise £3.3-7.6 billion in 2029-30 depending on behavioural responses, with impacts concentrated on higher earners.

---

Salary sacrifice arrangements allow employees to exchange part of their salary for non-cash benefits before tax and National Insurance are calculated. The Financial Times [reported](https://www.ft.com/content/11602ac1-44fc-4b58-8b17-af5e851f5c95) that the government is considering capping the amount that can be put into pension salary sacrifice schemes at £2,000 annually without paying National Insurance. Above this threshold, standard NI rates would apply. UK government guidance [defines](https://www.gov.uk/guidance/salary-sacrifice-and-the-effects-on-paye) salary sacrifice as an arrangement where an employee gives up the right to part of their cash pay, usually in return for a non-cash benefit.

HMRC's research [shows](https://www.gov.uk/government/publications/understanding-the-attitudes-and-behaviours-of-employers-towards-salary-sacrifice-for-pensions/understanding-the-attitudes-and-behaviours-of-employers-towards-salary-sacrifice-for-pensions) that salary sacrifice is widely used when it is available: in 2019, 30% of private-sector employees and 9% of public-sector employees in organisations offering salary sacrifice contributed to pensions through these arrangements.

The government announced this policy in the Autumn Budget 2025. The OBR estimates the cap would raise £4.9 billion (static) or £4.7 billion (post-behavioural) in 2029-30, when the policy takes effect. This analysis examines the cap's impact on households, government revenue, and income distribution.

### Data

This analysis uses salary sacrifice pension contribution data from the Family Resources Survey (FRS), enhanced through calibration to match administrative totals. PolicyEngine's microsimulation identifies 4.9 million workers with salary sacrifice pension contributions (15% of employees). Among these contributors, average annual contributions are £4,631. Total salary sacrifice contributions amount to £22.7 billion, consistent with external estimates based on NI relief costs. For more information on PolicyEngine's data methodology, see the [PolicyEngine UK data documentation](https://policyengine.github.io/policyengine-uk-data/).

### Assumptions

This analysis models the cap's effects under the following assumptions:

1. **Continued pension saving**: Employees currently using salary sacrifice maintain their desire to contribute the same total amount to pensions.

2. **Contribution redirection**: Contributions exceeding the £2,000 cap shift from salary sacrifice to regular employee pension contributions (which receive income tax relief but not National Insurance relief).

3. **Broad-based employer response**: Employers spread the increased National Insurance costs across all employees, maintaining cost neutrality. This is more defensible than assuming employers can target only affected workers, since if employers could identify and reduce compensation for specific individuals, those workers could simply restructure their benefits to avoid the targeting. With £13.8 billion in excess contributions generating £2.1 billion in additional employer NI (at 15%), this translates to a 0.16% reduction in employment income across all workers.

4. **No changes to other benefits**: Employer pension matching rates and other employment benefits remain unchanged.

## Household impact

Under current law, when an employee makes pension contributions through salary sacrifice, both the employee and employer save on National Insurance contributions on the sacrificed amount. As an example, consider an employee earning £50,000 who contributes £5,000 to their pension through salary sacrifice. The table below shows the tax calculation:

**Table 1: Current system - £50,000 earner with £5,000 pension contribution via salary sacrifice**

| Component                           | Amount      | Calculation               |
| :---------------------------------- | :---------- | :------------------------ |
| Gross salary                        | £50,000     |                           |
| Salary sacrifice                    | £5,000      |                           |
| Taxable salary                      | £45,000     | £50,000 - £5,000          |
| Employee NI (8% on £12,570-£45,000) | £2,594      | 8% × (£45,000 - £12,570)  |
| Employer NI (15% on above £9,100)   | £5,385      | 15% × (£45,000 - £9,100)  |
| Income tax (20% on £12,570-£45,000) | £6,486      | 20% × (£45,000 - £12,570) |
| **Take-home pay**                   | **£35,920** | £45,000 - £2,594 - £6,486 |

### Impact of the proposed cap

With the cap in place, an employee previously contributing £5,000 via salary sacrifice faces the following changes under the broad-based employer response: the £3,000 excess becomes taxable income, and the employee redirects it to regular employee pension contributions. The employer spreads its increased NI costs (0.058% of payroll) across all workers, resulting in a £29 reduction for this worker. The employee now pays NI on the £3,000 excess (£240 at 8%), reducing take-home pay from £35,920 to £35,651.

**Table 2: With £2,000 cap - £50,000 earner with broad-based employer response**

| Component                           | Amount      | Calculation                        |
| :---------------------------------- | :---------- | :--------------------------------- |
| Original gross salary               | £50,000     |                                    |
| Broad-based haircut (0.058%)        | £29         | 0.058% × £50,000                   |
| Adjusted gross salary               | £49,971     | £50,000 - £29                      |
| Salary sacrifice                    | £2,000      | Capped at £2,000                   |
| Taxable salary                      | £47,971     | £49,971 - £2,000                   |
| Employee pension contribution       | £3,000      | Full excess redirected             |
| Taxable income (for IT)             | £44,971     | £47,971 - £3,000                   |
| Employee NI (8% on £12,570-£47,971) | £2,832      | 8% × (£47,971 - £12,570)           |
| Income tax (20% on £12,570-£44,971) | £6,480      | 20% × (£44,971 - £12,570)          |
| **Take-home pay**                   | **£35,659** | £47,971 - £3,000 - £2,832 - £6,480 |
| **Total pension contribution**      | **£5,000**  | £2,000 + £3,000                    |

Under the broad-based model, the affected worker maintains their full £5,000 pension contribution, but pays £240 more in employee NI on the excess. Unaffected workers see a £17-£58 annual reduction depending on their salary.

## Government revenue impact

PolicyEngine's microsimulation estimates that 4.9 million people make pension contributions through salary sacrifice arrangements. Of these, 3.3 million (68%) would exceed the £2,000 cap.

Under baseline policy, total salary sacrifice contributions amount to £22.7 billion. With the cap in place, £13.8 billion in excess contributions would shift to regular employee pension contributions.

The policy is scheduled to take effect from April 2029. PolicyEngine estimates the cap would raise **£3.3 billion** in 2029-30 under our baseline assumptions (employers spread costs, employees maintain pension contributions), compared to the OBR's estimate of £4.9 billion (static) or £4.7 billion (post-behavioural). Revenue estimates vary significantly based on behavioural assumptions:

[Interactive: revenue by year]

PolicyEngine's baseline estimate of £3.3 billion is 32% below the OBR's static estimate of £4.9 billion. This reflects differences in behavioural assumptions: PolicyEngine's baseline assumes employees maintain their pension contributions (shifting excess to regular schemes) and employers spread costs across all workers, while the OBR's post-behavioural estimate of £4.7 billion may assume greater take-up of taxable cash.

## Distributional analysis

The cap is progressive: lower-income households are largely unaffected while higher earners bear the burden. This reflects both the concentration of salary sacrifice usage among higher earners and the tendency for high earners to contribute amounts exceeding the £2,000 cap.

[Interactive: distributional impact]

Under the baseline scenario (employers spread costs, employees maintain pension contributions), the top income decile experiences an average 0.65% reduction in disposable income (£200/year), while lower deciles see minimal impact. Toggle between scenarios to see how different behavioural assumptions affect the distributional pattern.

## Conclusion

The cap would raise approximately £3.3 billion annually when it takes effect in April 2029, affecting 3.3 million workers who currently contribute above £2,000. This compares to the OBR's estimates of £4.9 billion (static) or £4.7 billion (post-behavioural).

The impact is progressive: higher earners experience larger reductions while lower-income households are largely unaffected.

## Appendix: Data construction methodology

The Family Resources Survey (FRS) asks a subset of respondents whether their pension contributions are made through salary sacrifice (the SALSAC question). In FRS 2023-24, approximately 4,000 respondents were asked this question, while around 13,000 were not asked. To construct a complete picture of salary sacrifice usage, we use the following methodology:

### Imputation approach

1. **Training data**: We use the ~4,000 FRS respondents who were asked about salary sacrifice as training data. This includes both participants (with reported contribution amounts) and non-participants (with zero contributions).

2. **Predict salary sacrifice amounts**: Using this training set, we fit a quantile random forest model to predict salary sacrifice pension contribution amounts based on age and employment income.

3. **Impute for non-respondents**: We apply this model to impute salary sacrifice amounts for respondents who were not asked the question, generating a complete picture of salary sacrifice usage across the population.

### Calibration

After imputation, we calibrate the dataset using PolicyEngine's standard [reweighting methodology](https://policyengine.github.io/policyengine-uk-data/) to match administrative totals. This salary sacrifice-enhanced dataset is available alongside PolicyEngine's standard UK datasets for researchers who wish to analyse salary sacrifice reforms.

### Limitations

The imputation approach assumes that salary sacrifice usage patterns among non-respondents are similar to those among respondents with similar characteristics. If employers systematically offer salary sacrifice to workers with unobservable characteristics that differ from our predictors, our estimates may be biased. The difference between PolicyEngine's estimates and OBR figures likely reflects differences in behavioural assumptions about employer and employee responses to the cap.



---

---
# OBR November 2025 economic projections: what changed
Slug: obr-november-2025-projections
Date: 2025-11-26 18:00:00
Authors: Max Ghenis
Tags: uk, policy, technical
Description: The OBR revised up inflation and earnings forecasts in the November 2025 Autumn Budget. We compare the new projections to March 2025.

---

The Office for Budget Responsibility (OBR) released its [November 2025 Economic and Fiscal Outlook](https://obr.uk/efo/economic-and-fiscal-outlook-november-2025/) alongside the Autumn Budget. This forecast updates the March 2025 projections with revisions to inflation and earnings growth.

PolicyEngine uses these OBR projections to uprate monetary values across our UK tax-benefit model, affecting calculations for benefits, tax thresholds, and policy impacts.

## Key changes

The November 2025 forecast shows higher inflation and earnings growth in the near term compared to March:

- **Higher CPI inflation in 2025-26**: CPI revised up from 3.2% to 3.5% in 2025, and from 2.1% to 2.5% in 2026. The OBR attributes this to higher energy prices and the inflationary impact of the employer National Insurance increases announced in the Budget.
- **Higher earnings growth through 2026**: Average earnings growth revised up from 4.3% to 5.2% in 2025—a 0.9 percentage point increase. This reflects stronger-than-expected wage growth and the impact of the National Living Wage increase.
- **Higher RPI through 2027**: RPI projections revised upward, reflecting the CPI revisions plus continued housing cost pressures. RPI matters particularly for student loan repayments and some pension uprating.
- **Lower private rent growth, mixed mortgage outlook**: Private rent growth revised down from 6.5% to 5.5% in 2025 and from 3.9% to 3.3% in 2026. Mortgage interest costs show a mixed picture: lower in 2025 (11.0% vs 14.2%) but higher in 2026 (14.4% vs 13.3%), reflecting expectations about Bank of England rate decisions. Social rent, which follows CPI+1% with a one-year lag, rises to 4.5% in 2026 (up from 4.2% projected in March).
- **Convergence to long-run assumptions by 2030**: Despite near-term revisions, both forecasts converge toward the same long-run equilibrium: 2% CPI (the Bank of England's target) and around 2.3% RPI.[^1]

[^1]: The OBR also revised historical outturn data back to 2022 as final ONS estimates became available (e.g., 2023 CPI from 5.7% to 7.3%). The March 2025 forecast only projected housing, income, and council tax variables through 2029, while November 2025 extends these to 2030. We updated all values in [policyengine-uk PR #1377](https://github.com/PolicyEngine/policyengine-uk/pull/1377).

## Interactive comparison

Explore how the OBR's projections changed between March and November 2025:

<center>[Interactive: obr comparison]</center>

## What we updated in PolicyEngine

We've updated the following OBR-derived parameters in [policyengine-uk](https://github.com/PolicyEngine/policyengine-uk):

**Inflation indices** (from Economy Table 1.7):
- **CPI growth**: Used for benefit uprating, poverty thresholds, and real-terms analysis
- **RPI growth**: Used for student loan interest rates and some pension calculations
- **CPIH growth**: Consumer prices including owner occupiers' housing costs

**Labour market** (from Economy Table 1.6):
- **Average earnings growth**: Used for projecting employment income and State Pension triple lock calculations

**Housing** (from Economy Tables 1.7 and 1.16):
- **House price growth**: Used for property-related calculations including stamp duty projections
- **Rent growth**: Used for housing benefit and Universal Credit housing element calculations
- **Mortgage interest growth**: Used for housing cost projections
- **Social rent growth**: Derived from CPI+1% with one-year lag

**Income components** (from Economy Table 1.12):
- **Non-labour income growth**: Used for projecting investment and property income
- **Per capita GDP growth**: Used for scaling aggregate statistics
- **Per capita mixed income growth**: Used for self-employment income projections
- **Per capita non-labour income growth**: Used for household income projections

**Local taxes** (from Expenditure Table 4.1):
- **Council tax receipt growth**: Separate forecasts for England, Scotland, and Wales

All projections now extend to 2030, with clear annotations distinguishing outturn data (2009-2024) from OBR forecasts (2025-2030) and long-run equilibrium assumptions (2031+).

These parameters affect both household-level calculations and economy-wide budget impact estimates.

## Implications for PolicyEngine users

These updated projections affect several PolicyEngine calculations:

1. **Benefit uprating**: Most working-age benefits are uprated by September CPI each April. The higher 2025-26 CPI forecasts mean larger benefit increases in April 2026 and 2027, improving support for low-income households.

2. **Tax threshold freezes**: The higher inflation forecasts increase the real cost of frozen income tax thresholds. With the personal allowance frozen at £12,570 and higher rate threshold frozen, more income gets pushed into higher tax bands—a phenomenon known as "fiscal drag."

3. **State Pension**: The triple lock guarantees pensions rise by the highest of CPI inflation, average earnings growth, or 2.5%. The higher earnings growth forecast (5.2% vs 4.3% in 2025) suggests larger State Pension increases.

4. **Earnings projections**: Our household simulations use earnings growth to project future incomes, affecting multi-year policy impact estimates. Higher near-term earnings growth means higher projected incomes.

5. **Real terms analysis**: When presenting results in real terms, we deflate using these CPI projections. Higher inflation means slower real income growth even if nominal incomes rise.

6. **Housing costs**: Updated rent and house price forecasts affect calculations for housing-related benefits and property taxes.

## Data sources

- [OBR Economic and Fiscal Outlook - November 2025](https://obr.uk/efo/economic-and-fiscal-outlook-november-2025/)
- [OBR Economic and Fiscal Outlook - March 2025](https://obr.uk/efo/economic-and-fiscal-outlook-march-2025/)
- [OBR Detailed forecast tables](https://obr.uk/download/november-2025-economic-and-fiscal-outlook-detailed-forecast-tables-zip-file/)
- [OBR long-run RPI-CPI wedge methodology](https://obr.uk/box/the-long-run-difference-between-rpi-and-cpi-inflation/)



---

---
# Impact of the Autumn Budget fuel duty freeze
Slug: fuel-duty-freeze-2025
Date: 2025-11-26 10:00:00
Authors: Vahid Ahmadi
Tags: uk, autumn-budget, featured
Description: PolicyEngine estimates that the fuel duty freeze costs £2.8 billion in 2026-27 and raises net income for 46.7% of people.

---

In the Autumn Budget 2025, the Government [announced](https://obr.uk/efo/economic-and-fiscal-outlook-november-2025/) a five-month freeze to fuel duty rates until September 2026, at which point the five pence cut first introduced in 2022 will be reversed through a staggered approach. From April 2027, the Government has stated that fuel duty rates will then be uprated annually by RPI. Previously announced increases to fuel duty rates have now been postponed for 16 consecutive years. The total cost of fuel duty freezes from 2010-11 to 2026-27 has risen to £120 billion.

To understand the impact of this policy, we follow OBR methodology to compare it against a baseline that assumes the five pence cut would have ended in March 2026 as previously planned. Table 1 shows how fuel duty rates differ between these two scenarios across different time periods.

**Table 1: Fuel duty rates under baseline and announced policy (pence per litre)**

| Period                     | Baseline | Announced policy |
| -------------------------- | -------- | ---------------- |
| Jan 1 - Mar 22, 2026       | 52.95    | 52.95            |
| Mar 23 - Mar 31, 2026      | 57.95    | 52.95            |
| Apr 1 - Aug 31, 2026       | 60.33    | 52.95            |
| Sep 1 - Nov 30, 2026       | 60.33    | 53.95            |
| Dec 1, 2026 - Feb 28, 2027 | 60.33    | 55.95            |
| Mar 1 - Mar 31, 2027       | 60.33    | 57.95            |
| Apr 1, 2027 - Mar 31, 2028 | 62.26    | 59.80            |
| Apr 1, 2028 - Mar 31, 2029 | 64.06    | 61.54            |
| Apr 1, 2029 onwards        | 65.92    | 63.34            |

The baseline assumes the 5p cut ends on March 22, 2026, returning the rate to 57.95p, followed by RPI uprating from April 2026 onwards (4.1% in 2026-27, 3.2% in 2027-28, 2.9% in 2028-29, and 2.9% in 2029-30). The announced policy maintains the freeze at 52.95p until September 2026, then implements a staggered reversal with increases of 1p, 2p, and 2p over three-month periods, reaching 57.95p by March 2027. Both policies then apply the same annual RPI uprating from April 2027 onwards.

In the following sections, we [estimate](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) the revenue impact and distributional effects of the fuel duty freeze across income deciles, examine how the policy affects income inequality, and analyse impacts across UK constituencies.

## Economic impacts

### Revenue impact

We [estimate](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) the revenue impact of the fuel duty freeze policy across fiscal years and compare our estimates with official OBR projections. Table 2 shows the cost of maintaining frozen rates rather than implementing the planned policy trajectory.

**Table 2: Revenue impact of fuel duty freeze (£ billion)**

| Source                                                                                                                                                                      | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- | ------- | ------- | ------- | ------- |
| [PolicyEngine](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) | 0.0     | -2.8    | -0.7    | -0.7    | -0.7    |
| [OBR](https://obr.uk/efo/economic-and-fiscal-outlook-november-2025/)                                                                                                        | 0.0     | -2.4    | -0.9    | -0.9    | -0.9    |

PolicyEngine estimates the freeze reduces revenue by £2.8 billion in 2026-27, followed by £0.7 billion annually from 2027-28 onwards. The OBR projects revenue reductions of £2.4 billion in 2026-27 and £0.9 billion annually thereafter.

### Distributional impact

Figure 1 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) the relative change in household income by income decile from the fuel duty freeze in 2026-27.

**Relative change in household income by income decile, 2026-27**

[Chart: Relative change in household income by income decile, 2026-27]

In 2026-27, the lowest income decile gains 0.30% and the highest decile gains 0.11%. The gains decline progressively across higher income deciles, reflecting that fuel duty represents a larger share of expenditure for lower-income households. Deciles 3-7 experience gains between 0.17% and 0.21%.

### Winners and losers

Figure 2 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) the distribution of impacts across the population in 2026-27, categorising households by the magnitude of income changes they experience. The chart displays the share of the population in each income decile that gains more than 5%, gains less than 5%, experiences no change, loses less than 5%, or loses more than 5% of their household income.

**Population share by income change from fuel duty freeze, 2026-27**

[Chart: Population share by income change from fuel duty freeze, 2026-27]

In 2026-27, 46.7% of the population gains from the freeze, with around half of households experiencing no change. The majority of beneficiaries experience income increases of less than 5%.

### Inequality impact

The fuel duty freeze [reduces](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) income inequality in 2026-27, as measured by changes in the Gini index. In 2026-27, the Gini index declines by 0.18%, indicating a reduction in income inequality.

### Constituency impact

Figure 3 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=95140&region=uk&timePeriod=2026&baseline=95147&uk_local_areas_beta=true) the average net income change across UK parliamentary constituencies from the fuel duty freeze in 2026-27.

**Figure 3: The fuel duty freeze raises net income on average in a majority of the 650 parliamentary constituencies in 2026-27**

![](/assets/posts/uk-fuel-duty-freeze-2025/uk-fuel-duty-freeze-2025.png)

Average net income changes vary across constituencies, with all experiencing positive impacts. The distribution ranges from increases of 0.09% to 0.24%. The five constituencies with the largest gains are Cardiff East (0.24%), Swansea West (0.24%), Cardiff South and Penarth (0.23%), Torfaen (0.23%), and Vale of Glamorgan (0.23%).

## Conclusion

PolicyEngine estimates the fuel duty freeze costs £2.8 billion in 2026-27. The policy benefits 46.7% of the population, with the lowest income decile gaining 0.30% and the highest income decile gaining 0.11%. The freeze reduces income inequality by 0.18% as measured by the Gini index.



---

---
# Impact of the Autumn Budget rail fares freeze
Slug: rail-fares-freeze-2025
Date: 2025-11-27 10:00:00
Authors: Vahid Ahmadi
Tags: uk, autumn-budget, policy
Description: PolicyEngine estimates that the rail fares freeze reduces revenue by £145 million in 2026-27.

---

In the Autumn Budget 2025, the Government announced a freeze on all regulated rail fares in England for one year starting from March 2026. This is the first freeze on regulated rail fares in 30 years. The freeze applies to season tickets, peak return fares for commuters, and off-peak returns between major cities, holding these fares at their current levels until March 2027.

## Revenue impact

Table 1 shows the cost of freezing fares rather than implementing the planned 5.8% increase. PolicyEngine estimates align closely with official HM Treasury projections.

**Table 1: Revenue impact of rail fares freeze (£ million)**

| Source       | 2026-27 | 2027-28 | 2028-29 | 2029-30 |
| ------------ | ------- | ------- | ------- | ------- |
| PolicyEngine | -145    | -155    | -160    | -165    |
| [HM Treasury](https://www.gov.uk/government/publications/rail-fares-freeze-passenger-savings-estimate)  | -145    | -150    | -155    | -160    |

PolicyEngine estimates the freeze reduces revenue by £145 million in 2026-27, rising to £165 million by 2029-30 as baseline fare increases compound. This closely matches HM Treasury projections of £145 million in 2026-27, rising to £160 million by 2029-30.

## Distributional impact

Figure 1 shows the average change in household net income by income decile from the rail fares freeze in 2026-27. The distributional pattern reflects how rail usage varies across the income distribution.

**Average change in household income by income decile, 2026-27**

[Chart: Average change in household income by income decile, 2026-27]

In 2026-27, the average household benefit ranges from £1.76 per year for the highest decile to £17.58 for the eighth decile. The eighth decile sees the largest benefit, likely reflecting middle-to-upper-middle income commuters who rely heavily on rail travel. Lower and middle deciles see more modest benefits of £2-5 per household, while the top decile benefits least in absolute terms despite higher incomes.

## Appendix: Methodology

### Baseline scenario

Without the freeze, regulated rail fares would have increased by [5.8%](https://www.gov.uk/government/publications/rail-fares-freeze-passenger-savings-estimate) in March 2026 under the existing [fare formula](https://www.gov.uk/government/publications/railways-bill/railways-bill-fares), which sets annual fare increases at July RPI plus 1 percentage point. HM Treasury's passenger savings methodology document uses July 2025 RPI of 4.8%, yielding the 5.8% baseline increase. Subsequent years would follow the same formula, with fare increases compounding annually.

### Fiscal cost estimation

We calibrate our aggregate fiscal cost to [HM Treasury estimates](https://www.gov.uk/government/publications/rail-fares-freeze-passenger-savings-estimate). The freeze requires additional government subsidy to compensate train operating companies for foregone fare revenue, estimated at £145 million in 2026-27 rising to £775 million cumulative by 2030-31. Costs rise in subsequent years as the gap between frozen fares and the counterfactual baseline widens with each year of foregone increases.

### Household-level distribution

To estimate distributional impacts, we use household rail expenditure data from the [Family Resources Survey](https://www.gov.uk/government/collections/family-resources-survey--2) (FRS). The FRS records annual spending on rail travel for each sampled household, which we use as a proxy for rail usage intensity.

We distribute the aggregate Treasury cost estimate to households in proportion to their share of total weighted rail expenditure. Each household's benefit equals the total cost multiplied by their share of weighted rail spending across all households.

This approach assumes the benefit of frozen fares accrues proportionally to existing rail usage patterns. Households that spend more on rail travel receive a larger absolute benefit from the freeze.

### Limitations

Our distributional estimates have several limitations:

1. **Static behaviour**: We assume rail usage patterns remain unchanged. In practice, the freeze may induce additional rail travel, particularly among price-sensitive households.

2. **Regulated fares only**: The freeze applies only to regulated fares (season tickets, some returns). Unregulated fares set by train operators may still increase.

3. **Survey coverage**: The FRS may undercount very high rail spending (e.g., long-distance commuters with expensive season tickets) due to survey design and response patterns.

4. **Geographic variation**: Benefits concentrate among households with access to rail services, primarily in urban areas and along commuter corridors.



---

---
# High value council tax surcharge: constituency-level impact
Slug: high-value-council-tax-surcharge
Date: 2025-11-26 12:00:00
Authors: Max Ghenis
Tags: uk, policy, tax, autumn-budget, featured
Description: The top 10 constituencies account for 35% of the £400 million annual revenue from the new surcharge on properties over £2 million.

---

In the [November 2025 Autumn Budget](https://www.gov.uk/government/collections/budget-2025), the UK government announced a new high value council tax surcharge on properties valued over £2 million. The Office for Budget Responsibility (OBR) [estimates](https://obr.uk/efo/economic-and-fiscal-outlook-november-2025/) this measure will raise £400 million in 2029-30.

Using 2024 Land Registry sales data, we estimate how this revenue will be distributed across Westminster constituencies.

Key findings:
- We estimate 553 of 650 constituencies have properties that would be subject to the surcharge
- The top 10 constituencies account for 35% of the estimated revenue
- Cities of London and Westminster alone accounts for 10% (£42 million)
- London constituencies account for 47% of total revenue

[Explore the interactive map](#geographic-distribution) | [Download the data](https://github.com/PolicyEngine/uk-mansion-tax)

## The policy

From April 2028, owners of properties in England and Wales valued over £2 million (in 2026 prices) will pay an annual surcharge in addition to their existing council tax. The policy applies to properties valued by the Valuation Office Agency; it does not apply to Scotland or Northern Ireland, which have separate property tax systems. According to the [OBR](https://obr.uk/efo/economic-and-fiscal-outlook-november-2025/):

> There will be four price bands with the surcharge rising from £2,500 for a property valued in the lowest £2 million to £2.5 million band, to £7,500 for a property valued in the highest band of £5 million or more, all uprated by CPI inflation each year.

The OBR does not specify the thresholds or surcharge amounts for the two middle bands. [Bloomberg reports](https://www.bloomberg.com/news/articles/2025-11-26/reeves-hits-uk-property-with-mansion-tax-on-2-million-homes) the middle threshold as either £3 million or £3.5 million (the article contains a typo with overlapping bands), with surcharges of £3,500 and £5,000, though does not cite a source.

For this analysis, we assume the following band structure:

| Property value | Annual surcharge | Source |
|----------------|------------------|--------|
| £2m - £2.5m | £2,500 | OBR |
| £2.5m - £3m | £3,500 | Assumed |
| £3m - £5m | £5,000 | Assumed |
| £5m+ | £7,500 | OBR |

The revenue flows to central government rather than local authorities.

## Constituency-level estimates

We estimate each constituency's share of the £400 million total by modelling the distribution of high-value properties using 2024 Land Registry sales data. We uprate sale prices to April 2028 levels using OBR house price forecasts (10.7% cumulative growth from 2024), apply the surcharge band structure (with thresholds uprated by CPI from 2026 to 2028), and allocate the OBR's total estimate proportionally based on each constituency's share of modelled revenue.

### Top 20 constituencies by estimated revenue

| Rank | Constituency | Estimated annual revenue | Share of total |
|------|--------------|--------------------------|----------------|
| 1 | Cities of London and Westminster | £41.9m | 10.5% |
| 2 | Kensington and Bayswater | £29.4m | 7.4% |
| 3 | Chelsea and Fulham | £17.9m | 4.5% |
| 4 | Hampstead and Highgate | £12.0m | 3.0% |
| 5 | Richmond Park | £7.0m | 1.8% |
| 6 | Battersea | £6.4m | 1.6% |
| 7 | Islington South and Finsbury | £6.1m | 1.5% |
| 8 | Holborn and St Pancras | £7.4m | 1.8% |
| 9 | Hammersmith and Chiswick | £5.5m | 1.4% |
| 10 | Finchley and Golders Green | £5.6m | 1.4% |
| 11 | Runnymede and Weybridge | £5.0m | 1.3% |
| 12 | Wimbledon | £4.3m | 1.1% |
| 13 | Ealing Central and Acton | £3.6m | 0.9% |
| 14 | Queen's Park and Maida Vale | £3.7m | 0.9% |
| 15 | Windsor | £4.0m | 1.0% |
| 16 | Esher and Walton | £3.1m | 0.8% |
| 17 | Dulwich and West Norwood | £2.3m | 0.6% |
| 18 | Harpenden and Berkhamsted | £2.0m | 0.5% |
| 19 | Hornsey and Friern Barnet | £1.8m | 0.5% |
| 20 | Chesham and Amersham | £2.1m | 0.5% |

The top 20 constituencies account for 43% of the estimated revenue while comprising 3% of all constituencies.

## Geographic distribution

The map below shows the estimated revenue allocation by constituency. Darker shading indicates higher estimated revenue from the surcharge.

<center>[Interactive: surcharge_map_by_revenue]</center>

The concentration in London and the Home Counties reflects the geography of UK property wealth. Of the 553 constituencies we estimate have properties subject to the surcharge:
- 56 are in Greater London (accounting for 47% of estimated revenue)
- The remaining 497 constituencies share 53% of estimated revenue

London constituencies account for 47% of the estimated revenue while comprising 9% of all constituencies.

### Distribution by surcharge band

Revenue is concentrated in the highest-value properties:

| Band (2028 prices) | Share of affected properties | Revenue contribution |
|--------------------|------------------------------|---------------------|
| £2.09m - £2.61m | 31% | 17% |
| £2.61m - £3.14m | 18% | 13% |
| £3.14m - £5.23m | 27% | 29% |
| £5.23m+ | 25% | 41% |

Properties valued over £5.23 million (in 2028 prices) represent an estimated 25% of affected properties but contribute 41% of the estimated revenue due to the £7,500 annual surcharge rate.

## Methodology and limitations

### Data sources

- **Property sales**: UK Land Registry Price Paid Data for 2024 (881,757 transactions)
- **Revenue estimate**: OBR Economic and Fiscal Outlook, November 2025 (£400 million in 2029-30)
- **House price growth**: OBR November 2025 forecasts (2.9% in 2025, 2.5% in 2026-27, 2.4% in 2028)
- **Constituency boundaries**: MySoc 2025 Westminster constituencies

### Surcharge band assumptions

As noted above, the OBR confirms only the lowest and highest band rates. Our assumed middle band structure (£3,500 for £2.5m-£3m; £5,000 for £3m-£5m) is broadly consistent with Bloomberg's reporting. Since we allocate the OBR's total revenue estimate proportionally by constituency, these assumptions affect the distribution of revenue across bands but not the total or constituency-level allocations.

### Uprating methodology

The policy takes effect in April 2028. We uprate 2024 sale prices to 2028 using OBR house price forecasts (10.7% cumulative growth). We also uprate the thresholds from their 2026 base values using OBR CPI forecasts (4.5% cumulative from 2026 to 2028). This means the £2m threshold becomes approximately £2.09m in 2028 prices, and the band boundaries are similarly adjusted.

This approach captures the properties that would actually be subject to the surcharge when it comes into effect, accounting for both house price appreciation and the inflation-linked adjustment to the thresholds.

### Key assumption: sales as proxy for stock

This analysis uses property sales data to model the distribution of high-value properties across constituencies. We assume that the geographic distribution of high-value sales is representative of the geographic distribution of the high-value housing stock.

The OBR's £400 million estimate is based on Valuation Office data covering all properties, not just those sold in a given year. We allocate this total proportionally based on each constituency's share of modelled revenue from the sales data.

This approach is valid if high-value properties turn over at similar rates across constituencies. Annual property turnover rates of 5-10% of housing stock are typical, and there is no strong evidence that turnover rates vary systematically by constituency for high-value properties.

### Behavioural effects

The OBR's £400 million estimate incorporates behavioural responses including:
- Full pass-through of the surcharge into property prices
- Price bunching just below band boundaries
- Non-compliance and appeals

The OBR notes that these behavioural effects reduce revenue from other property taxes (stamp duty land tax, capital gains tax), which partly offsets the gross surcharge revenue in the early years of implementation.

## Conclusion

The high value council tax surcharge concentrates revenue collection in a small number of constituencies. The top 10 constituencies—all in London—account for over a third of the estimated £400 million annual revenue. This geographic concentration reflects the distribution of properties valued over £2 million, which are heavily concentrated in London and the South East.

---

*Analysis by PolicyEngine. Data and code available on [GitHub](https://github.com/PolicyEngine/uk-mansion-tax).*



---

---
# Estimating the constituency distribution of a mansion tax
Slug: uk-mansion-tax-autumn-budget
Date: 2025-11-25 12:00:00
Authors: Daphne Hansell
Tags: uk, policy, tax, autumn-budget, featured
Description: Three central London constituencies account for a fifth of property sales above £2 million.

---

The Times [reports](https://www.thetimes.com/article/b43b7639-6a3b-4180-baa2-b1c249d8a30a?shareToken=2b69490f2c227849a9d6446b1f6c477e) that Chancellor Rachel Reeves plans to raise up to £450 million from a levy on homes worth over £2 million, affecting over 100,000 properties. Earlier speculation suggested a £1.5 million threshold, which would have affected 300,000 homes.

To illustrate where a mansion tax would have the greatest impact, we mapped 2024 Land Registry sales above these thresholds by parliamentary constituency. Sales data serves as a proxy for the stock of high-value homes; turnover rates vary by area, so these figures show the relative geographic concentration rather than the total number of homes that would be affected.

## Key findings

Raising the threshold from £1.5 million to £2 million nearly halves the number of affected properties:

| Threshold | Sales | Share of all sales |
|:----------|:-----:|:------------------:|
| £1.5 million | 14,820 | 1.7% |
| £2 million | 8,213 | 0.9% |

Three central London constituencies—Cities of London and Westminster, Kensington and Bayswater, and Chelsea and Fulham—account for 16% of affected properties at the £1.5m threshold and 21% at the £2m threshold. The median constituency saw 10 sales above £1.5m or 6 above £2m.

London constituencies account for 45-46% of all affected properties. Outside London, the constituencies with the most high-value sales are Runnymede and Weybridge (183), Queen's Park and Maida Vale (166), Esher and Walton (163), Windsor (134), and Chesham and Amersham (127).

## Interactive map

Use the toggle to switch between £1.5m and £2m thresholds.

<center>[Interactive: mansion_tax_d3]</center>

The top 10 constituencies account for 30% of sales above £1.5m and 36% above £2m. All are in London or the commuter belt.

**Top 10 constituencies by share of nationwide high-value sales**

| Constituency | £1.5m | £2m |
|:-------------|:-----:|:---:|
| Cities of London and Westminster | 6.7% | 9.5% |
| Kensington and Bayswater | 5.5% | 7.0% |
| Chelsea and Fulham | 4.2% | 4.6% |
| Hampstead and Highgate | 2.7% | 3.0% |
| Battersea | 2.2% | 1.7% |
| Richmond Park | 2.0% | 1.9% |
| Islington South and Finsbury | 1.7% | 1.7% |
| Hammersmith and Chiswick | 1.7% | 1.6% |
| Holborn and St Pancras | 1.5% | 1.7% |
| Finchley and Golders Green | 1.3% | 1.4% |

## Methodology

We identified 2024 property sales exceeding £1.5 million and £2 million from [Land Registry Price Paid Data](https://www.gov.uk/government/statistical-data-sets/price-paid-data-downloads), which includes postcodes for each transaction. We mapped postcodes to parliamentary constituencies using [MySociety's 2025 constituency lookup](https://github.com/mysociety/2025-constituencies), then uprated prices to 2026-27 values using the OBR house price index forecast (+3.56%) from the [October 2024 Economic and Fiscal Outlook](https://obr.uk/efo/economic-and-fiscal-outlook-october-2024/).

**Limitations**: We use sales as a proxy for housing stock, apply the national house price index uniformly (regional growth may vary), and properties near thresholds may be revalued.

[Download the constituency dataset (CSV)](/assets/posts/uk-mansion-tax/mansion_tax_constituency_data.csv) | [View code on GitHub](https://github.com/PolicyEngine/uk-mansion-tax)



---

---
# Analysing alternative income tax and National Insurance reform options for the UK
Slug: uk-income-tax-ni-reforms-2025
Date: 2025-11-20 11:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, featured
Description: PolicyEngine analysis of alternative tax reform options: raising basic and higher income tax rates, cutting NI, and extending the threshold freeze.

---

The Times [reported](https://www.thetimes.com/uk/politics/article/rachel-reeves-budget-watchdog-raise-income-tax-plan-sr2wd8mp7) that Chancellor Rachel Reeves informed the Office for Budget Responsibility on November 6 that she planned to increase the basic and higher income tax rates by 2 percentage points (from 20% to 22% and from 40% to 42%), reduce National Insurance contributions from 8% to 6%, and extend the income tax threshold freeze to 2029-30; current law already [freezes](https://www.gov.uk/government/publications/the-personal-allowance-and-basic-rate-limit-for-income-tax-and-certain-national-insurance-contributions-nics-thresholds-from-6-april-2026-to-5-apr/income-tax-personal-allowance-and-the-basic-rate-limit-and-certain-national-insurance-contributions-thresholds-from-6-april-2026-to-5-april-2028) thresholds until 2027-28. The Financial Times subsequently [reported](https://www.ft.com/content/6cbb46b1-c075-453b-a9f9-7eb1e9120d9b) that Reeves did not include the income tax and National Insurance changes in her November 13 submission to the OBR, ahead of the November 26 Autumn Budget. Together, the first two reforms would raise net revenue of £6.9 billion in 2026-27: workers would face partially offsetting changes (lower National Insurance, higher income tax), while pensioners and landlords would pay only the income tax increase. The threshold freeze would raise revenue through fiscal drag as inflation pushes more income into higher tax brackets.

This analysis examines each reform option using PolicyEngine's microsimulation model to assess their potential impacts on government revenue, household finances, and poverty rates. Revenue impacts are modelled sequentially to capture interaction effects between reforms, while distributional impacts show each reform independently to understand their distinct effects on different income groups.

## Household impact

To understand how these reforms affect households, we first look at a step-by-step calculation for a specific example, and then examine how the impact varies with income.

### Example calculation

Consider a single earner with a gross income of £60,000 who contributes £10,000 (approx. 16.7%) to a workplace pension. We calculate their tax liabilities for the 2026-27 tax year under both the baseline (current law) and the proposed reform package. Note that in 2026-27, the proposed threshold freeze extension has not yet taken effect, so we focus on the rate changes: National Insurance (NI) reducing from 8% to 6%, and Income Tax (IT) increasing by 2 percentage points (20% to 22% basic, 40% to 42% higher).

**Table 1: Example tax calculation for a single earner (£60k gross, £10k pension)**

| Tax                                                  | Baseline (current law)                                   | Reform package                                           | Change                       |
| :--------------------------------------------------- | :------------------------------------------------------- | :------------------------------------------------------- | :--------------------------- |
| **National Insurance**<br>_(Gross earnings £60,000)_ | **£3,210.60**<br>8% on £12,570–£50,270<br>2% on >£50,270 | **£2,456.60**<br>6% on £12,570–£50,270<br>2% on >£50,270 | **-£754.00**<br>_(Tax cut)_  |
| **Income Tax**<br>_(Taxable income £50,000)_         | **£7,486.00**<br>20% on £12,570–£50,270                  | **£8,234.60**<br>22% on £12,570–£50,270                  | **+£748.60**<br>_(Tax rise)_ |
| **Total net impact**                                 |                                                          |                                                          | **+£5.40**<br>_(Better off)_ |

_Note: Pension contributions of £10,000 reduce taxable income for Income Tax but not for National Insurance._

### Varying earnings

The combined reform creates different outcomes for households depending on their income level. [Figure 1 shows how the net income change varies with gross household income](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=94911&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=false&household=56492), assuming a single earner making a £10,000 pension contribution.

**Change in household net income by gross income (with £10k pension contribution), 2026-27**

[Chart: Change in household net income by gross income (with £10k pension contribution), 2026-27]

At low to moderate income levels (where the NI cut applies to most taxable earnings), households gain. However, as income rises, the Income Tax increase (which applies to all taxable income above the allowance) begins to outweigh the NI reduction (which is capped at the Upper Earnings Limit of £50,270).

Pension contributions affect how the reforms impact households. While they reduce taxable income for Income Tax, they do _not_ reduce earnings for National Insurance (except in salary sacrifice arrangements, which are not assumed here). A pension contribution lowers the amount of income exposed to the 2 percentage point Income Tax increase, while the household receives the National Insurance cut on their gross earnings. As a result, households with pension contributions face a smaller net tax increase than those without.

## Budgetary impact

Figure 2 shows the change in government revenue from each reform across fiscal years 2026-27 through 2029-30, using a stacking methodology where each reform is applied on top of the previous ones to capture interaction effects. The first reform, extending the threshold freeze to 2029-30, would raise [£3.5 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=83092&region=uk&timePeriod=2028&baseline=1) in 2028-29, when thresholds would otherwise be unfrozen. The second reform, reducing the National Insurance rate from 8% to 6% applied on top of the freeze, would cost an additional [£11.7 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94938&region=uk&timePeriod=2026&baseline=83092) in 2026-27. The third reform, increasing the basic and higher income tax rates by 2 percentage points applied on top of both the freeze and NI reduction, would raise an additional [£18.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94911&region=uk&timePeriod=2026&baseline=94938) in 2026-27.

**Change in government revenue by reform, 2026-27 to 2029-30**

[Chart: Change in government revenue by reform, 2026-27 to 2029-30]

The Times [reported](https://www.thetimes.com/uk/politics/article/rachel-reeves-budget-watchdog-raise-income-tax-plan-sr2wd8mp7) that an expected Office for Budget Responsibility productivity forecast downgrade would create an estimated £30 billion shortfall in fiscal headroom—the amount needed to meet fiscal rules while maintaining adequate buffers against future economic shocks—that Reeves sought to address with these options. Following standard budget analysis practice, we apply a stacking methodology: each reform is modeled sequentially with the prior reforms already in effect, ensuring the individual components add to the combined total and capturing how reforms interact. The stacked bars show each reform's contribution, with the line showing the net combined effect. The combined package would raise [£6.9 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.budgetaryImpact&reform=94911&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=false&simYears=5) in 2026-27, rising to £15.4 billion by 2029-30, with the threshold freeze extension contributing additional revenue in later years as fiscal drag increases.

## Distributional impact

The following distributional analyses show each reform independently against the baseline.

### National Insurance rate reduction (8% to 6%)

Figure 3 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94906&region=uk&timePeriod=2026&baseline=1) the relative change in household income by income decile from reducing the National Insurance rate from 8% to 6% in 2026-27. Higher-income deciles experience larger percentage increases, with deciles 8 and 9 each gaining 1.1% in household income, while the lowest income decile gains 0.1%.

**Change in household income by income decile from National Insurance rate reduction, 2026-27**

[Chart: Change in household income by income decile from National Insurance rate reduction, 2026-27]

### Income tax rate increase (basic and higher rates +2pp)

Figure 4 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94910&region=uk&timePeriod=2026&baseline=1) the relative change in household income by income decile from increasing the basic and higher income tax rates by 2 percentage points in 2026-27. All income deciles experience decreases in household income, with deciles 8 and 9 seeing the largest reductions of 1.5% to 1.6%, while the lowest income decile decreases by 0.2%.

**Change in household income by income decile from basic and higher rate income tax increase, 2026-27**

[Chart: Change in household income by income decile from basic and higher rate income tax increase, 2026-27]

### Threshold freeze extension

Figure 5 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=83092&region=uk&timePeriod=2028&baseline=1) the relative change in household income by income decile from extending the threshold freeze to 2029-30. All income deciles experience decreases in household income, with decile 9 seeing the largest reduction of 0.32%, while the lowest income decile decreases by 0.08%.

**Change in household income by income decile from threshold freeze extension, 2028-29**

[Chart: Change in household income by income decile from threshold freeze extension, 2028-29]

### Combined reform impact

Figure 6 shows the relative change in household income by income decile from each reform component across fiscal years 2026-27 through 2029-30. The stacked bars show individual reform contributions: the threshold freeze extension (green), the National Insurance reduction (gray), and the income tax increase (blue). The line [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.distributionalImpact.incomeDecile.relative&reform=94911&region=uk&timePeriod=2029&baseline=1&uk_local_areas_beta=false) the net combined effect across deciles. Use the play button to animate between years or drag the slider to view a specific year.

**Change in household income by reform component, 2026-27 to 2029-30**

[Chart: Change in household income by reform component, 2026-27 to 2029-30]

## Winners and losers

Winner and loser status varies within income deciles based on individual circumstances, particularly pension contributions. National Insurance applies to gross earnings before pension contributions, while income tax applies to earnings after pension contributions. Individuals with higher pension contribution rates gain more from National Insurance reductions and lose less from income tax increases compared to those with lower contribution rates at the same gross income level.

### National Insurance rate reduction (8% to 6%)

Figure 7 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94906&region=uk&timePeriod=2026&baseline=1) the distribution of income changes from reducing the National Insurance rate across fiscal years 2026-27 through 2029-30. In 2026-27, 3% gain more than 5% in income, 60% gain less than 5%, and 37% experience no change.

**Population share by income change from National Insurance rate reduction, 2026-27 to 2029-30**

[Chart: Population share by income change from National Insurance rate reduction, 2026-27 to 2029-30]

### Income tax rate increase (basic and higher rates +2pp)

Figure 8 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94910&region=uk&timePeriod=2026&baseline=1) the distribution of income changes from increasing the basic and higher income tax rates across fiscal years 2026-27 through 2029-30. In 2026-27, 26% experience no change, 64% lose less than 5%, and 10% lose more than 5%.

**Population share by income change from basic and higher rate income tax increase, 2026-27 to 2029-30**

[Chart: Population share by income change from basic and higher rate income tax increase, 2026-27 to 2029-30]

### Threshold freeze extension

Figure 9 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=83092&region=uk&timePeriod=2028&baseline=1) the distribution of income changes from extending the threshold freeze across fiscal years 2026-27 through 2029-30. The threshold freeze extension only applies from 2028-29 onward (current law already freezes thresholds through 2027-28). In 2028-29, 20% experience no change, 77% lose less than 5%, and 3% lose more than 5%.

**Population share by income change from threshold freeze extension, 2026-27 to 2029-30**

[Chart: Population share by income change from threshold freeze extension, 2026-27 to 2029-30]

### Combined reform impact

Figure 10 [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.winnersAndLosers.incomeDecile&reform=94911&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=false) the distribution of income changes from the combined reform package (income tax increase, National Insurance reduction, and threshold freeze extension) across fiscal years 2026-27 through 2029-30. In 2026-27, 1% gain more than 5%, 20% gain less than 5%, 36% experience no change, 39% lose less than 5%, and 4% lose more than 5%.

**Population share by income change from combined reform, 2026-27 to 2029-30**

[Chart: Population share by income change from combined reform, 2026-27 to 2029-30]

## Poverty impact

Table 1 shows the change in absolute before-housing-costs poverty rate for each reform. Reducing the National Insurance rate from 8% to 6% would have [no impact](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=94906&region=uk&timePeriod=2026&baseline=1) on the overall poverty rate in 2026-27. Increasing the basic and higher income tax rates by 2 percentage points would raise the overall poverty rate by [0.2 percentage points](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94910&region=uk&timePeriod=2026&baseline=1) in 2026-27. Extending the threshold freeze to 2029-30 would have [no impact](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=83092&region=uk&timePeriod=2028&baseline=1) on the overall poverty rate in 2028-29 (current law already freezes thresholds until 2027-28).

**Table 1: Poverty impact by reform**

| Reform                                            | Fiscal year | Change in poverty rate (pp)                                                                                                              |
| ------------------------------------------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| NI rate reduction (8% to 6%)                      | 2026-27     | [0pp](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=94906&region=uk&timePeriod=2026&baseline=1)      |
| Income tax increase (basic and higher rates +2pp) | 2026-27     | [+0.2pp](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94910&region=uk&timePeriod=2026&baseline=1) |
| Threshold freeze extension                        | 2028-29     | [0pp](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=83092&region=uk&timePeriod=2028&baseline=1)      |

Table 2 shows the net poverty impact from the combined reform package across fiscal years 2026-27 through 2029-30. The [combined package](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=94911&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=false) would have no impact on absolute before-housing-costs poverty in 2026-27, with the poverty impact increasing to 0.2 percentage points by 2029-30 as the threshold freeze extension effect accumulates alongside the income tax and National Insurance reforms.

**Table 2: Net poverty impact from combined reform package**

| Fiscal year | Change in poverty rate (pp) |
| ----------- | --------------------------- |
| 2026-27     | 0pp                         |
| 2027-28     | 0pp                         |
| 2028-29     | +0.1pp                      |
| 2029-30     | +0.2pp                      |

## Inequality impact

The three reforms show minimal change in the Gini index, with the National Insurance rate reduction producing a [0.1%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=94906&region=uk&timePeriod=2026&baseline=1) increase in 2026-27, the income tax increase producing a [0.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=94910&region=uk&timePeriod=2026&baseline=1) decrease in 2026-27, and the threshold freeze extension having [no impact](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=83092&region=uk&timePeriod=2028&baseline=1) on income inequality in 2028-29 (current law already freezes thresholds until 2027-28).

## Conclusion

Increasing the basic and higher income tax rates by 2 percentage points would raise £18.6 billion in 2026-27 but increase absolute before-housing-costs poverty by 0.2 percentage points and reduce the Gini index by 0.3%, while reducing National Insurance from 8% to 6% would cost £11.7 billion with no change in poverty. Extending the threshold freeze to 2029-30 would raise £3.5 billion in 2028-29 with no change in poverty.



---

---
# PolicyEngine London event 2025
Slug: policyengine-2-event-report
Date: 2025-11-10
Authors: Vahid Ahmadi
Tags: uk, event, featured
Description: PolicyEngine hosted an event in London that presented new updates and capabilities, real-world policy research applications, local area modelling, and how to use AI in policy research.

---

On November 3, 2025, PolicyEngine hosted an event at Central Hall Westminster in London to showcase PolicyEngine 2.0 and explore the future of public policy analysis. The afternoon brought together policymakers, researchers, and practitioners to examine how technology and AI are reshaping evidence-based policymaking. [View the presentation slides](https://policyengine.github.io/policyengine-uk-event-2025/).

## Event overview

The event featured presentations from PolicyEngine's team and external speakers, covering technical capabilities, real-world applications, and future directions for the platform. Supported by the Nuffield Foundation, the gathering demonstrated PolicyEngine's expanding role in UK policy analysis.

## PolicyEngine's journey and vision

Max Ghenis, Founder and CEO of PolicyEngine, opened the event by tracing PolicyEngine's evolution from its origins at the UBI Centre in 2020 to its establishment as an independent nonprofit in 2021. Key milestones included early UK policy scoring demonstrations, US expansion in March 2022, development of economic simulation with representative datasets, and the launch of multiple access surfaces including the Python package and AI summarisation in 2023.

Adoption has grown across organisations including the Green Party, Centre for Policy Studies, NIESR, IEA, Social Market Foundation, Liberal Democrats, and UK in a Changing Europe. In March 2025, HM Treasury began piloting PolicyEngine UK. The Nuffield Foundation's grant supports expansion with childcare integration, public services modelling, local datasets, validation dashboards, and AI-enhanced design.

## Technology and AI infrastructure

Nikhil Woodruff, Co-founder, CTO and UK Country Director, demonstrated how PolicyEngine applies artificial intelligence and modern software architecture for UK policy analysis. Built on OpenFisca-Core, the platform processes policy simulations in real-time. The AI-powered explanation system, launched in 2024, translates tax and benefit calculations into clear language. Machine learning addresses data limitations, particularly the Family Resources Survey's undersampling of higher-income households, while maintaining efficiency across millions of policy configurations.

## Model scope and capabilities

Vahid Ahmadi, UK Research Associate, presented PolicyEngine UK's modelling scope, covering tax and benefit rules from income tax and National Insurance to Universal Credit, Council Tax support, and childcare programmes. The platform maintains current policy while enabling simulation of hypothetical reforms through its OpenFisca-based architecture.

Data enhancement capabilities address under-sampling and measurement errors through machine learning. Using random forest imputation and gradient descent reweighting, PolicyEngine fuses the Family Resources Survey with the Wealth and Assets Survey and Living Costs and Food Survey. Behavioural response modelling captures labour supply and capital gains tax effects. For Capital Gains Tax analysis, behavioural modelling projected lower five-year revenue than static analysis.

## Local area analysis

Nikhil Woodruff and Ben Ogorek, Senior Data Scientist, presented PolicyEngine's local area modelling framework, estimating tax and benefit policy impacts at the parliamentary constituency and local authority level. The system reweights Family Resources Survey data to match administrative statistics from HMRC, ONS, ASHE, and the House of Commons Library, using gradient-based optimisation across 11,000 targets covering income, age, and employment patterns.

The [interactive dashboard](https://uk-local-areas-dashboard-578039519715.us-central1.run.app/) enables MPs to understand constituency-specific effects and helps local authorities assess benefit changes. PolicyEngine US builds upon this infrastructure by cloning households for each local area rather than reweighting, revealing programme participation patterns at the congressional district level. The underlying software will be made available for usage beyond PolicyEngine. PolicyEngine plans to incorporate this approach into UK data in 2026.

## User experience design

Biniam Gebre, Co-Founder of Citizen Codex, and MaSara Myers, Creative Director of Citizen Codex, presented the user experience research behind PolicyEngine 2.0. Through interviews with policymakers, researchers, journalists, and citizens, they gathered insights about needs and pain points. These insights shaped design decisions, from information architecture to visual design, ensuring microsimulation results are both accurate and comprehensible. The speakers showcased design patterns for distributional analysis, budget impacts, and household-level effects.

## Platform demonstration

Anthony Volk, Software Engineer, demonstrated the redesigned PolicyEngine 2.0 platform. The new interface clarifies the separation of PolicyEngine's fundamental concepts: policies, households, and dynamics, and integrates these into simulations and reports. Users can easily save and view past versions of each element to combine into novel insights.

## Applications in practice

### NIESR's living standards review

Max Mosley, Senior Economist at the New Economics Foundation and formerly at NIESR, [presented](https://docs.google.com/presentation/d/1qSPVxdCdz9kIP5O4YWVw7kfQR5jzCu9y/edit?usp=sharing&ouid=106351675150319968795&rtpof=true&sd=true) how PolicyEngine supported NIESR's [UK Living Standards Review 2025](https://niesr.ac.uk/publications/uk-living-standards-review-2025?type=report). PolicyEngine enabled NIESR to analyse policy interventions, particularly poverty reduction measures. Analysis compared cost per person lifted from poverty of policies such as removing the two-child limit. PolicyEngine's accessibility improved the efficiency of NIESR's analysis and communication of findings.

### Carbon dividend analysis

Malcolm Torry, formerly at the Basic Income Earth Network and London School of Economics, [presented](https://docs.google.com/presentation/d/19yRatNQKqzKwT5v1HlCtpHjksXRBGddb/edit?usp=sharing&ouid=106351675150319968795&rtpof=true&sd=true) PolicyEngine's application to [carbon tax and dividend proposals](/uk/research/uk-carbon-tax-dividend), where carbon tax revenue funds unconditional payments. Two scenarios were analysed: a £100 per tonne tax funding £18.60 per week dividends, and a £200 per tonne tax funding £37.40 per week. While both scenarios redistribute from higher-income to lower-income households, some households on lower incomes would experience losses. Microsimulation shows precisely which households gain and lose under different approaches.

### VAT analysis with firm microdata

Vahid Ahmadi [presented](https://uk-vatlab-app1j7s6o-policy-engine.vercel.app/) PolicyEngine's firm-level microsimulation for VAT policy, analysing threshold changes between £70,000 and £120,000 for 2026-27. Using synthetic firm microdata calibrated to ONS and HMRC statistics, the model captures firms by industry, turnover, employees, and VAT liability.

PolicyEngine's estimates deviate an average of 12.3% from HMRC projections. Raising the threshold to £100,000 would remove 48,000 firms from VAT registration and reduce revenue by £371 million, while a £70,000 threshold would add 109,000 firms and generate £642 million.

### US policy analysis tools

David Trimmer, Policy Research Fellow, and Daphne Hansell, Research Associate, demonstrated PolicyEngine US's household-level analysis tools through two recent applications.

Trimmer presented the [household-by-household interactive](https://policyengine.github.io/obbba-household-by-household/) for the One Big Beautiful Bill Act (OBBBA), which allows users to explore the legislation's effects on over 40,000 representative households using PolicyEngine's Enhanced Current Population Survey data. The interactive's "Get Random Household" function reveals how the same policy affects different families across America's diverse population, with each household weighted by population representation.

Hansell demonstrated a tool for simulating the extension of enhanced premium tax credits, which expire after 2025. The tool shows how different extension scenarios affect health insurance subsidy impacts at the individual household level. These tools make policy impacts tangible by showing real effects on specific family types rather than aggregate statistics alone.

## Panel discussion on evidence-based policymaking

Max Ghenis moderated a panel discussion with Arun Advani, Director of CenTax and Professor of Economics at the University of Warwick, and Anvar Sarygulov, Research Grants and Programmes Manager at the Nuffield Foundation, exploring the evolving landscape of evidence-based policymaking. The conversation examined how open models, administrative data, and artificial intelligence are reshaping policy analysis, bringing together perspectives from academic research, philanthropy, and open-source tool development.

## AI roadmap

Max Ghenis and Nikhil Woodruff presented PolicyEngine's AI roadmap across three pillars: building software, improving models, and augmenting software.

For building software, they announced the beta launch of the [policyengine-claude plugin](https://github.com/policyengine/policyengine-claude), providing custom commands, specialised agents, and domain knowledge for PolicyEngine development. They demonstrated a scientific approach to rules-as-code automation: creating golden pull requests with manually verified code, using AI to generate implementations from policy descriptions, then iteratively adjusting prompts to maximise alignment between AI-produced and golden code.

The team demonstrated multi-agent workflows for policy research, building on Vahid Ahmadi's [Testing multi-agent AI workflows for policy research](/uk/research/multi-agent-workflows-policy-research). The demonstration showed specialised agents handling data fetching, Python script writing, and report generation. For standard distributional analyses calculating poverty rates and decile-level impacts, the agents produced output matching manual approaches while maintaining PolicyEngine's writing standards. Complex benefit programme interactions requiring understanding of coordination logic between multiple programmes remain challenging for agents. The team positions these workflows as handling routine policy updates where analysis structure stays constant, allowing human researchers to focus on questions requiring policy expertise.

For improving models, two priorities were presented: continuing US local area modelling work with enhanced calibration methods while transferring these to UK constituencies and local authorities, and exploring synthetic panel generation to enable lifetime programme simulation (such as US Social Security solvency) where current cross-sectional survey data provides only snapshots.

For augmenting software, they previewed PolicyEngine App v2's natural language capabilities: LLM extraction to pull relevant insights from the database based on natural language queries, and flexible visualisations to present insights through adaptive charts on an extensible report canvas. The presentation concluded with reflections on AI's potential to enable policy analysis that is more comprehensive, accurate, and accessible, balanced against challenges as AI transforms society through changing income patterns and creating new demands for policy research aligned with societal values.

## Looking ahead

The event demonstrated PolicyEngine's technical capabilities and growing adoption across policy research, think tanks, and government. With integration of AI technologies, PolicyEngine aims to expand access to policy analysis while maintaining accuracy and transparency in its modelling approach.



---

---
# Comparing PolicyEngine and official UK poverty rates
Slug: uk-poverty-analysis
Date: 2025-10-10 11:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, featured
Description: We compare PolicyEngine poverty estimates with official DWP statistics and explain the methodological factors behind the differences.

---

This analysis compares PolicyEngine's poverty estimates against official figures for 2023/24 using the Family Resources Survey (FRS). To understand the differences, we first describe how official statistics are produced.

### Official methodology

The Department for Work and Pensions (DWP) [produces](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2024) official poverty statistics through the Households Below Average Income (HBAI) series. The methodology uses the FRS with enhancements including replacing high earners' incomes with HMRC tax data, applying [CALMAR](https://www.gov.uk/government/publications/initial-review-of-the-family-resources-survey-weighting-scheme/initial-review-of-the-family-resources-survey-weighting-scheme) calibration weighting to match Census totals, and adjusting benefit amounts using administrative records. Poverty is measured as relative (60% of median income) and absolute (2010/11 threshold uprated by inflation), both before and after housing costs.

### PolicyEngine methodology

PolicyEngine [uses](https://www.gov.uk/government/collections/family-resources-survey--2) two versions of the Family Resources Survey (FRS) microdata. The standard FRS [uses](https://policyengine.github.io/policyengine-uk-data/) data as collected by the Office for National Statistics, applying the original FRS household weights without additional calibration, with income components extracted directly from survey responses and benefits used as reported without administrative data adjustments. We also construct the [Enhanced FRS](https://policyengine.github.io/policyengine-uk-data/methodology/), which [incorporates](https://github.com/PolicyEngine/policyengine-uk-data/blob/24c1bd6fabe91b05da652cdb4776e25c01927e50/policyengine_uk_data/datasets/create_datasets.py) additional data sources and adjustments, reweights survey responses to match external benchmarks from HMRC tax records and DWP benefit statistics, and replaces or supplements survey-reported income with administrative data where available, particularly for benefits, tax credits, and pension income.

Both approaches calculate relative and absolute poverty thresholds using the same definitions as official statistics, measuring household income both before and after housing costs. The following sections compare poverty rates for the total population and by age group, and describe methodological factors explaining the differences.[^1]

## Overall poverty rates

The table below compares PolicyEngine's [estimates](https://gist.github.com/vahid-ahmadi/c8bb92c92a3b3a5f42eff36e26b7b7a9) with official [DWP figures](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2024) for 2023/24:

| Measure                | DWP   | PE Standard FRS   | PE Enhanced FRS   |
| ---------------------- | ----- | ----------------- | ----------------- |
| Relative poverty (BHC) | 17.2% | 18.0%<br>(+0.8pp) | 16.6%<br>(-0.6pp) |
| Relative poverty (AHC) | 21.1% | 22.9%<br>(+1.8pp) | 20.7%<br>(-0.4pp) |
| Absolute poverty (BHC) | 15.0% | 17.2%<br>(+2.2pp) | 12.8%<br>(-2.2pp) |
| Absolute poverty (AHC) | 18.3% | 20.5%<br>(+2.2pp) | 17.9%<br>(-0.4pp) |

_BHC = Before Housing Costs, AHC = After Housing Costs_

The total population is 67.5 million in the DWP figures, 67.5 million in the standard FRS, and 67.3 million in the Enhanced FRS. The standard FRS estimates run +0.8pp to +2.2pp higher than official figures, with AHC poverty showing larger deviations than BHC. The Enhanced FRS matches official relative poverty closely but diverges on absolute poverty.

## Poverty rates by age group

The tables below break down poverty rates by age group.

### Children

The table below shows poverty rates for children:

| Measure                | DWP   | PE Standard FRS   | PE Enhanced FRS   |
| ---------------------- | ----- | ----------------- | ----------------- |
| Relative poverty (BHC) | 23.2% | 24.6%<br>(+1.4pp) | 22.7%<br>(-0.5pp) |
| Relative poverty (AHC) | 30.5% | 33.5%<br>(+3.0pp) | 29.5%<br>(-1.0pp) |
| Absolute poverty (BHC) | 20.0% | 23.6%<br>(+3.6pp) | 17.9%<br>(-2.1pp) |
| Absolute poverty (AHC) | 26.4% | 30.2%<br>(+3.8pp) | 25.4%<br>(-1.0pp) |

The children population is 14.6 million in the DWP figures, 14.4 million in the standard FRS, and 14.2 million in the Enhanced FRS. Children show the highest poverty rates and largest deviations, with the standard FRS estimates +1.4pp to +3.8pp higher than official figures. The Enhanced FRS reduces these deviations to -0.5pp to -2.1pp.

### Working-age adults (16-64)

The table below shows poverty rates for working-age adults:

| Measure                | DWP   | PE Standard FRS   | PE Enhanced FRS   |
| ---------------------- | ----- | ----------------- | ----------------- |
| Relative poverty (BHC) | 14.7% | 15.7%<br>(+1.0pp) | 16.1%<br>(+1.4pp) |
| Relative poverty (AHC) | 19.4% | 21.2%<br>(+1.9pp) | 21.0%<br>(+1.6pp) |
| Absolute poverty (BHC) | 12.9% | 15.1%<br>(+2.1pp) | 12.2%<br>(-0.8pp) |
| Absolute poverty (AHC) | 16.9% | 19.2%<br>(+2.4pp) | 18.6%<br>(+1.7pp) |

The working-age adult population is 40.9 million in the DWP figures, 41.8 million in the standard FRS, and 43.2 million in the Enhanced FRS. The standard FRS deviations range from +1.0pp to +2.4pp, with larger AHC gaps reflecting Housing Benefit under-reporting among renters. The Enhanced FRS deviations range from -0.8pp to +1.7pp.

### Pensioners (State Pension age and over)

The table below shows poverty rates for pensioners:

| Measure                | DWP   | PE Standard FRS   | PE Enhanced FRS   |
| ---------------------- | ----- | ----------------- | ----------------- |
| Relative poverty (BHC) | 18.6% | 19.1%<br>(+0.5pp) | 12.1%<br>(-6.6pp) |
| Relative poverty (AHC) | 15.7% | 17.8%<br>(+2.2pp) | 10.5%<br>(-5.2pp) |
| Absolute poverty (BHC) | 16.0% | 18.0%<br>(+2.0pp) | 9.4%<br>(-6.6pp)  |
| Absolute poverty (AHC) | 13.2% | 14.6%<br>(+1.5pp) | 7.4%<br>(-5.8pp)  |

The pensioner population is 12.1 million in the DWP figures, 12.0 million in the standard FRS, and 10.8 million in the Enhanced FRS. The standard FRS deviations range from +0.5pp to +2.2pp. The Enhanced FRS deviations range from -6.6pp to -5.2pp, with all measures showing lower poverty rates than official statistics.

## Methodological differences

The DWP and PolicyEngine use the same FRS data, but process it differently. The following sections explain the key methodological factors that produce the observed differences.

### 1. Survey of Personal Incomes adjustment for high earners

The DWP [replaces](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2023/households-below-average-income-series-quality-and-methodology-information-report-fye-2023) high earners' incomes with HMRC tax data through the Survey of Personal Incomes (SPI) adjustment (above £361,200 for working-age adults or £107,800 for pensioners). PolicyEngine [incorporates](https://github.com/PolicyEngine/policyengine-us-data/tree/main/paper) SPI data differently: rather than directly replacing individual incomes, it augments the FRS with synthetic individuals trained on SPI data and reweights the combined dataset to match HMRC income distribution targets across multiple income bands and sources.

### 2. Survey weighting and grossing methodology

The DWP uses [CALMAR](https://www.gov.uk/government/publications/initial-review-of-the-family-resources-survey-weighting-scheme/initial-review-of-the-family-resources-survey-weighting-scheme) calibration weighting to match Census population totals across demographic dimensions including age-sex-region combinations, benefit unit composition, council tax bands, and tenure. PolicyEngine's standard FRS uses original FRS weights without calibration, producing a population estimate of 67.5 million matching official figures. The Enhanced FRS reweights to match hundreds of targets from multiple administrative data sources—including OBR tax and benefit aggregates, ONS demographic statistics, HMRC income distributions, DWP benefit caseloads, and VOA council tax records—at both national and constituency levels. Different weights alter which household types are weighted up or down.

### 3. Benefit measurement

The DWP adjusts benefit amounts using administrative records, though the methodology is not publicly documented. PolicyEngine's standard FRS uses benefit amounts as reported in the survey. The Enhanced FRS incorporates HMRC and DWP administrative data. These different approaches produce different household income estimates, affecting measured poverty rates for households receiving means-tested benefits like Universal Credit and Housing Benefit.

### 4. Housing costs and Housing Benefit measurement

Both methods define housing costs identically but face Housing Benefit under-reporting in the FRS. The DWP [adjusts](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2023/households-below-average-income-series-quality-and-methodology-information-report-fye-2023) Housing Benefit using administrative records. PolicyEngine's standard FRS uses reported Housing Benefit without adjustment, while the Enhanced FRS reweights to match official Housing Benefit expenditure and claimant count targets. Under-reporting in the standard FRS means net housing costs appear higher, lowering income after housing costs and raising AHC poverty.

### 5. Children-specific income components

The DWP [assigns](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2023/households-below-average-income-series-quality-and-methodology-information-report-fye-2023) cash-equivalent values to in-kind benefits like free school meals and childcare, and may adjust Child Benefit using administrative data. PolicyEngine's standard FRS calculates benefits from survey data using legislative rules without administrative adjustments.

### 6. Enhanced FRS pensioner poverty adjustments

Administrative data adjustments may better capture pension income from multiple sources where survey self-reporting is less accurate. The Enhanced FRS pensioner population is 10.8 million versus 12.0 million in the standard FRS and 12.1 million official. The Enhanced FRS targets older age bands (60-70, 70-80, 80-90) by region along with pension income and benefit aggregates, but the reweighting optimization produces this lower pensioner count as a trade-off to better match other targets.

## Conclusion

This analysis compared PolicyEngine's poverty estimates against the DWP statistics for 2023/24 using both standard and Enhanced FRS data. The standard FRS deviations range from +0.5pp to +3.8pp across all measures and demographic groups, with AHC poverty showing larger deviations than BHC. The largest differences are for child poverty AHC measures.

[^1]: Official statistics from DWP Households Below Average Income (HBAI) Tables 1.3a, 1.3b, 1.4a, 1.4b, 1.5a, 1.5b, 1.6a, and 1.6b.



---

---
# How removing the two-child benefit limit would affect the UK
Slug: uk-two-child-limit
Date: 2025-10-06 11:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, featured
Description: Removing the two-child limit would cost £2.8 billion in 2026-27 and reduce child poverty by 15.7%.

---

Chancellor Rachel Reeves is [expected](https://www.theguardian.com/society/2025/sep/30/rachel-reeves-lift-two-child-benefit-cap-november-budget) to lift the two-child benefit cap in the November 2025 Budget. The cap, introduced in 2017, prevents parents from claiming Universal Credit or Child Tax Credit for more than two children born after April 2017. The policy affected [1.5 million](https://www.gov.uk/government/statistics/universal-credit-and-child-tax-credit-claimants-statistics-related-to-the-policy-to-provide-support-for-a-maximum-of-2-children-april-2023) children in the UK in April 2023. Treasury officials are exploring alternatives to a complete removal of the cap.

In this analysis, we examine the impact of removing the two-child limit on household incomes, government spending, income distribution, poverty rates, income inequality, and geographic variation across parliamentary constituencies.

## Household impact

The reform would increase Universal Credit or Child Tax Credit payments for affected families by removing the restriction on child elements. For a sample household of two parents with three children aged 3, 5, and 7 in 2026-27, Figure 1 [shows](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=93219&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=true&household=56008) how household net income changes across different employment income levels.

**Household net income by employment income**

[Chart: Household net income by employment income]

At lower income ranges, the reform delivers larger increases in household net income due to higher Universal Credit entitlements when the two-child limit is removed. As employment income rises, Universal Credit tapers off under both scenarios, reducing the relative benefit of the reform.

## Budgetary impact

PolicyEngine estimates that removing the two-child limit would cost £2.7 billion in 2025-26, rising to £3.1 billion by 2029-30. The cost increases over time as more children are born after April 2017, when the cap was introduced, making fewer families eligible for transitional protection. See the Appendix for a comparison of cost estimates from different organisations across years.

## Distributional impact

By income decile, removing the two-child limit would provide the largest relative benefits to lower-income households, as shown in Figure 2. The lowest income decile would see household income rise by 1.4%, while the second decile would see a 1.3% increase.

**Change in household income by income decile, 2026-27**

[Chart: Change in household income by income decile, 2026-27]

### Winners and losers

Figure 3 shows that 4.6% of the population would see income gains from removing the two-child limit, with the largest share of winners concentrated in the lowest income deciles. The lowest income decile sees 11% of households gain income, with 10.5% gaining more than 5% and 0.6% gaining less than 5%. The second decile sees 14.8% gain, with 14.2% gaining more than 5%.

**Population share by income change, 2026-27**

[Chart: Population share by income change, 2026-27]

## Poverty impact

By age group, removing the two-child limit would reduce poverty rates most for children across all years. Using the absolute poverty measure before housing costs, the child poverty rate would fall by 13.6% in 2025-26 and by 15.5% in 2029-30, while the overall poverty rate would decline by 6.5% in 2025-26 and by 7.3% in 2029-30.

| Year | Children                                                                                                                               | All                                                                                                                                   |
| ---- | -------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |
| 2025 | [-13.6%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2025&baseline=1) | [-6.5%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2025&baseline=1) |
| 2026 | [-15.7%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2026&baseline=1) | [-7.4%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2026&baseline=1) |
| 2027 | [-15.8%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2027&baseline=1) | [-7.4%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2027&baseline=1) |
| 2028 | [-16.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2028&baseline=1) | [-7.8%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2028&baseline=1) |
| 2029 | [-15.5%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2029&baseline=1) | [-7.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=93219&region=uk&timePeriod=2029&baseline=1) |

## Inequality impact

Removing the two-child limit in 2026-27 would reduce income inequality. The Gini index would fall by 0.6%, while the top 10% income share would decrease by 0.1% and the top 1% income share would decline by 0.1%.

| Metric        | Change                                                                                                                                   |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| Gini index    | [-0.6%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=93219&region=uk&timePeriod=2026&baseline=1) |
| Top 10% share | [-0.1%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=93219&region=uk&timePeriod=2026&baseline=1) |
| Top 1% share  | [-0.1%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=93219&region=uk&timePeriod=2026&baseline=1) |

## Geographic impact

The impact of removing the two-child limit [varies](https://legacy.policyengine.org/uk/policy?focus=policyOutput.constituencies.relative&reform=93219&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=true&household=56008) across parliamentary constituencies, as shown in Figure 4.

**Figure 4: Geographic distribution of relative income change by parliamentary constituency**

![](/images/posts/two-child-limit/map-impact.png)

The constituencies experiencing the largest relative income gains include Bradford East, Birmingham Hodge Hill and Solihull North, Bradford South, Luton North, and Birmingham Hall Green and Moseley. The constituencies with the smallest gains include South Down, Lagan Valley, Upper Bann, Glasgow East, and Cities of London and Westminster.

## Conclusion

Removing the two-child benefit limit would cost £2.7 billion in 2025-26, rising to £3.1 billion by 2029-30. The reform would reduce absolute child poverty (before housing costs) by 13.6% and overall absolute poverty by 6.5% in 2025-26.

We invite you to explore the [PolicyEngine webapp](https://legacy.policyengine.org/) to model your own customised reforms.

## Appendix: Cost estimates by organisation and year

The following table compares cost estimates for abolishing the two-child limit from different organisations.

| Year              | PolicyEngine                                                                                                                             | IFS        | JRF        | Resolution Foundation |
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------- | ---------- | ---------- | --------------------- |
| 2024-25           | —                                                                                                                                        | —          | —          | £2.5bn                |
| 2025-26           | [£2.7bn](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=93219&region=uk&timePeriod=2025&baseline=1) | —          | £2.7bn[^1] | —                     |
| 2026-27           | [£2.8bn](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=93219&region=uk&timePeriod=2026&baseline=1) | —          | —          | —                     |
| 2027-28           | [£2.9bn](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=93219&region=uk&timePeriod=2027&baseline=1) | —          | —          | —                     |
| 2028-29           | [£3.0bn](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=93219&region=uk&timePeriod=2028&baseline=1) | —          | —          | —                     |
| 2029-30           | [£3.1bn](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=93219&region=uk&timePeriod=2029&baseline=1) | —          | £2.8bn[^2] | —                     |
| Long run          | —                                                                                                                                        | £2.5bn[^3] | —          | —                     |
| Full coverage[^4] | —                                                                                                                                        | —          | —          | £3.6bn                |

[^1]: JRF estimate includes both two-child limit and benefit cap removal. Source: JRF analysis using IPPR tax-benefit model (Parkes et al 2025). JRF's earlier estimate from May 2025 showed £2.0bn for two-child limit only in 2025/26

[^2]: JRF estimate for two-child limit only. JRF's earlier estimate from May 2025 also showed £2.8bn for 2029/30

[^3]: IFS estimate from October 2024 report "Child poverty: trends and policy options". Would cost £3.3bn if household benefit cap also removed

[^4]: Full coverage expected around 2035 when all children potentially affected

Sources:

- PolicyEngine: This analysis
- IFS: [The two-child limit: poverty, incentives and cost](https://ifs.org.uk/articles/two-child-limit-poverty-incentives-and-cost)
- JRF: [Getting the child poverty strategy we need](https://www.ippr.org/articles/getting-the-child-poverty-strategy-we-need) (IPPR/JRF collaboration), [Two policies to boost family living standards and reduce child poverty](https://www.jrf.org.uk/child-poverty/two-policies-to-boost-family-living-standards-and-reduce-child-poverty), and [Three policies to reduce child poverty this parliament](https://www.jrf.org.uk/child-poverty/three-policies-to-reduce-child-poverty-this-parliament)
- Resolution Foundation: [Catastrophic caps](https://www.resolutionfoundation.org/publications/catastophic-caps/)



---

---
# How carbon tax and dividend policies affect UK households
Slug: uk-carbon-tax-dividend
Date: 2025-09-30 11:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, featured
Description: PolicyEngine analysis of £100/200 per tonne carbon taxes with full dividend redistribution shows approximately 71% of UK residents would gain.

---

This report examines how carbon tax and dividend policies would affect UK households under two scenarios: £100 and £200 per tonne of CO2. We analyse how carbon prices impact household incomes when all tax revenue is returned as equal dividends to every resident.

In this policy experiment, the government applies carbon taxes at £100 and £200 per tonne of CO2 equivalent, generating revenue based on emissions and consumption patterns. We calculate average household net income under baseline conditions (no carbon tax) and reform conditions (with carbon tax). The government redistributes all tax revenue as equal per-person dividends to UK residents. We categorise household income changes by gain and loss thresholds and analyse distributional effects across income deciles.

## Carbon tax revenue

The following table presents the total revenue generated from carbon taxation under each scenario in 2026-27:

| Carbon tax rate | Total revenue                                                                                                                                    | Dividend amount (per person per week) |
| :-------------- | :----------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------ |
| £100/tonne      | [£67.3 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=75542&region=uk&timePeriod=2026&baseline=1)  | £19                                   |
| £200/tonne      | [£134.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92939&region=uk&timePeriod=2026&baseline=1) | £37                                   |

The Department for Environment, Food & Rural Affairs [reports](https://www.gov.uk/government/statistics/uks-carbon-footprint/carbon-footprint-for-the-uk-and-england-to-2022) greenhouse gas emissions associated with consumption in 2022 at 740 MtCO2e. At the rate of £100/tonne, the revenue estimation in 2022 would be £74 billion.

For the following analysis, we assume that revenue generated from the carbon tax is redistributed amongst people at a flat rate per person as a carbon dividend.

## Distributional analysis

This section examines how carbon dividend policies affect households across the income distribution, showing relative changes in household income by income decile. Figures 1 and 2 show the percentage change in household income by income decile for each scenario in 2026-27:

### £100/tonne carbon dividend:

**Figure 1**: Change in household income by income decile

[Chart: type: bar]

### £200/tonne carbon dividend:

**Figure 2**: Change in household income by income decile

[Chart: type: bar]

As shown in Figures 1 and 2, income deciles 1-6 consistently gain from the carbon dividend policy across both scenarios. The magnitude of gains decreases with income level, with decile 1 households seeing the largest improvements. Income deciles 8-10 experience net losses. The £200/tonne rate approximately doubles both the gains for lower deciles and losses for higher deciles compared to the £100/tonne rate.

## Winner-loser analysis

This section analyses the population distribution across different income change categories, showing what proportion of households gain or lose under each scenario. At both levels, 71% of UK residents would benefit financially on a net basis, while 28% would pay more in the carbon tax than they receive in the dividend. Figures 3 and 4 display the distribution of households by income change category for each scenario in 2026-27:

### £100/tonne carbon dividend:

**Figure 3**: Distribution of households by income change

[Chart: type: bar]

### £200/tonne carbon dividend:

**Figure 4**: Distribution of households by income change

[Chart: type: bar]

As illustrated in Figures 3 and 4, the distribution indicates that lower income deciles have a higher proportion of households gaining more than 5%, while higher income deciles are more likely to experience losses.

## Poverty impact analysis

This section examines how carbon dividend policies affect poverty rates across different demographic groups. Poverty is measured as absolute before housing costs. The following table shows the relative change in poverty rates by demographic group for each scenario in 2026-27:

| Demographic group  | £100/tonne                                                                                                                               | £200/tonne                                                                                                                               |
| :----------------- | :--------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| Children           | [\-0.5%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\-0.7%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |
| Working-age adults | [\-0.2%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\-0.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |
| Seniors            | [\-0.6%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\-0.6%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |
| All populations    | [\-0.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\-0.5%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |

The carbon dividend policy shows poverty-reducing effects across all demographic groups, with the largest improvements for children at £200/tonne (-0.7%). The £200/tonne rate produces more poverty reduction.

## Inequality impact analysis

This section analyses how carbon dividend policies affect income inequality using standard inequality measures. The following table presents the relative change in inequality measures for each scenario in 2026-27:

| Inequality measure | £100/tonne                                                                                                                               | £200/tonne                                                                                                                               |
| :----------------- | :--------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| Gini index         | [\-0.2%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\+0.4%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |
| Top 10% share      | [\-1.2%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\-1.2%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |
| Top 1% share       | [\-0.7%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92873&region=uk&timePeriod=2026&baseline=1) | [\-1.1%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=92996&region=uk&timePeriod=2026&baseline=1) |

The analysis shows that the Gini coefficient decreases by 0.2% at £100/tonne but increases by 0.4% at £200/tonne. The income share of the top 10% and top 1% declines under both scenarios.

## Constituency-level analysis

This section presents a geographical analysis of how carbon dividend policies affect different UK constituencies. Figures 5-8 illustrate the distribution of income changes across UK constituencies for each scenario in 2026-27.

### £100/tonne carbon dividend:

The £100/tonne carbon dividend [shows](https://legacy.policyengine.org/uk/policy?focus=policyOutput.constituencies.relative&reform=92873&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=true) geographically concentrated benefits, with urban constituencies experiencing the largest gains.

**Figure 5**: £100/tonne carbon dividend constituency map

![](/images/posts/uk-carbon-tax/carbon-tax-100.png)

The regional breakdown shows that England benefits most from the £100/tonne carbon dividend, while Wales faces losses across all constituencies.

**Figure 6**: Constituency distribution by region

[Chart: type: bar]

### £200/tonne carbon dividend:

The higher carbon tax rate [amplifies](https://legacy.policyengine.org/uk/policy?focus=policyOutput.constituencies.relative&reform=92996&region=uk&timePeriod=2026&baseline=1&uk_local_areas_beta=true) the geographical patterns, with more constituencies experiencing gains.

**Figure 7**: £200/tonne carbon dividend constituency map

![](/images/posts/uk-carbon-tax/carbon-tax-200.png)

At the £200/tonne rate, 294 constituencies gain compared to 265 at the £100/tonne rate, with 60 constituencies showing no change.

**Figure 8**: Constituency distribution by region

[Chart: type: bar]

The constituency analysis shown in Figures 5-8 reveals geographical variation in policy impacts. Wales consistently shows negative impacts, with all 32 constituencies experiencing losses in both scenarios. England shows the greatest number of benefiting constituencies, with 245 gaining at £100/tonne and 269 gaining at £200/tonne. Scotland shows mixed results with 13-18 constituencies gaining, while Northern Ireland has 7 constituencies gaining under both scenarios.

### Areas with largest gains and losses

The constituencies experiencing the largest gains (as a share of net income) include urban areas such as Birmingham Ladywood, Bradford West, Bradford East, Nottingham East, and Leeds South. Conversely, constituencies in Wales and affluent areas face the largest losses (as a share of net income), including Monmouthshire, Cardiff North, and Vale of Glamorgan. This geographical variation reflects differences in local income distributions and carbon consumption patterns across UK constituencies.

## Conclusion

Our analysis shows that carbon dividend policies would benefit approximately 71% of UK residents across both £100/tonne and £200/tonne scenarios in 2026-27. The £100/tonne rate would reduce poverty by 0.3% overall, while the £200/tonne rate would reduce poverty by 0.5% overall.

Lower-income households in deciles 1-6 would see net income gains under both scenarios, while higher-income households in deciles 8-10 would experience net losses. The geographic distribution reveals 265 constituencies gaining at £100/tonne and 294 at £200/tonne in 2026-27.

We invite you to explore the [PolicyEngine webapp](https://legacy.policyengine.org/) to model your own customised carbon tax and dividend reforms.



---

---
# Event: PolicyEngine 2.0 and the Future of Public Policy Analysis
Slug: sep-2025-london-event
Date: 2025-09-12
Authors: Max Ghenis
Tags: uk, org, featured, event
Description: Join us on the afternoon of November 3rd in London for an exclusive showcase of PolicyEngine's latest innovations in evidence-based policy analysis, featuring live demos and networking.

---

Join us at Central Hall Westminster in London on Monday, 3 November 2025, from 12:00-18:00 for an exclusive showcase of PolicyEngine 2.0 and our latest innovations in evidence-based policy analysis. Register now on [Eventbrite](https://www.eventbrite.co.uk/e/policyengine-20-and-the-future-of-public-policy-analysis-tickets-1673065246189).

## Event overview

PolicyEngine is hosting a special event to demonstrate our cutting-edge research, tools, and features that are transforming how policymakers and researchers analyse tax and benefit reforms. This gathering brings together professionals at the forefront of computational policy modelling and evidence-based policymaking technology.

## What to expect

### Revolutionary platform updates

Experience the unveiling of PolicyEngine v2, our next-generation policy analysis platform, with a live demonstration by our engineering team. See firsthand how our enhanced interface and capabilities make complex policy analysis more accessible and powerful than ever.

### Hyperlocal policy analysis

Discover our breakthrough capability to estimate policy impacts at the parliamentary constituency and local authority level. Our UK Country Director Nikhil Woodruff will demonstrate how our revolutionary microdata construction enables unprecedented granularity in understanding policy effects across the UK, expanding on the methodologies described in our [Enhanced CPS launch](/us/blog/enhanced-cps-launch).

### Cutting-edge research presentations

Learn about our latest research innovations, including:

- **VAT analysis with synthetic firm microdata**: Our UK Research Associate Vahid Ahmadi presents groundbreaking work on modelling VAT reforms using fully synthetic firm-level data, building on our recent [analysis of VAT threshold changes](/uk/blog/uk-vat-thresholds)
- **US policy modelling expansion**: Insights from our federal and state-level policy analysis work across the Atlantic, powered by our [Enhanced Current Population Survey](/us/blog/enhanced-cps-launch) microdata
- **AI-powered policy analysis**: How we're deploying large language models and agentic systems to transform policy research workflows

### Networking opportunities

Connect with policy researchers, government officials, think tank professionals, academic researchers, and data scientists working in public policy. The event includes dedicated networking time during registration, tea break, and an evening reception.

## Full agenda

- **12:00-13:00** | Registration, Lunch & Networking
- **13:00-13:15** | Welcome & Vision - Max Ghenis, Co-founder & CEO
- **13:15-13:30** | Technology for UK Policymaking - Nikhil Woodruff, Co-founder, CTO & UK Country Director
- **13:30-14:00** | Live Demo: PolicyEngine v2 Platform - Anthony Volk, Software Engineer
- **14:00-14:30** | Localising Policy Impact - Nikhil Woodruff
- **14:30-15:00** | VAT Analysis with Synthetic Firm Microdata - Vahid Ahmadi, UK Research Associate
- **15:00-15:30** | Tea Break & Networking
- **15:30-16:00** | PolicyEngine US: Federal & State Policy Modelling - Max Ghenis
- **16:00-16:30** | Panel Discussion: The Future of Evidence-Based Policymaking
- **16:30-17:00** | Looking Ahead: AI-Powered Policy Analysis - Max Ghenis & Nikhil Woodruff
- **17:00-18:00** | Reception & Networking

## Acknowledgments

This event is made possible by the generous support of the Nuffield Foundation, whose commitment to evidence-based social policy aligns perfectly with PolicyEngine's mission to democratise policy analysis. Our work building sustainable open-source ecosystems is also supported by the [National Science Foundation's POSE program](/us/blog/nsf-pose-phase-1-grant).

## Event Details

**Date:** Monday, 3 November 2025  
**Time:** 12:00-18:00 GMT  
**Venue:** Central Hall Westminster  
**Address:** Storey's Gate, London SW1H 9NH

## Registration

Space is limited for this exclusive event. [Register now on Eventbrite](https://www.eventbrite.co.uk/e/policyengine-20-and-the-future-of-public-policy-analysis-tickets-1673065246189) to secure your place at this pioneering gathering in computational policy analysis.

## About PolicyEngine

PolicyEngine is a non-profit organisation building free, open-source software to compute the impact of public policy. Our platform enables anyone to design tax and benefit reforms and see their effects on society and individual households. Learn more at [policyengine.org](https://legacy.policyengine.org).



---

---
# National Science Foundation awards PolicyEngine $300,000 grant
Slug: nsf-pose-phase-1-grant
Date: 2025-08-18
Authors: Max Ghenis
Tags: us, uk, org, featured
Description: NSF's Pathways to Enable Open-Source Ecosystems program will support PolicyEngine's work to expand access to policy analysis tools.

---

PolicyEngine has been awarded a $300,000 Phase I grant from the National Science Foundation's [Pathways to Enable Open-Source Ecosystems (POSE) program](https://new.nsf.gov/funding/opportunities/pathways-enable-open-source-ecosystems-pose) ([Award No. 2518372](https://www.nsf.gov/awardsearch/showAward?AWD_ID=2518372)). This grant will support our work to strengthen and expand the open-source ecosystem around economic policy analysis tools.

## Award abstract

This Pathways to Enable Open-Source Ecosystems (POSE) project increases access to sophisticated economic policy analysis tools, enabling evidence-based decision-making across all levels of American society. The project transforms tax-benefit microsimulations into open-source infrastructure accessible to local governments, nonprofits, and citizens. This innovation enhances scientific understanding by making policy models transparent and reproducible, allowing researchers to validate assumptions and build upon existing work. The OSE provides durable competitive advantage by establishing the United States as the global leader in open-source policy modeling. The model leverages distributed open-source development, where commercial users fund expansions that benefit the entire ecosystem. Primary beneficiaries include households accessing benefits, local governments analyzing policy impacts, and researchers advancing economic science.

This POSE project addresses the critical gap between sophisticated policy analysis capabilities and organizational infrastructure needed for sustainable open-source development. While the team has built comprehensive tax-benefit microsimulation tools with a strong user base, transitioning to a self-sustaining ecosystem requires systematic organizational development. The project's objectives include: 1) conducting ecosystem discovery to map stakeholder needs; 2) establishing a new governance structure; and 3) building contributor infrastructure including documentation, mentorship programs, and community engagement frameworks. The effort involves surveying stakeholders, conducting focus groups, developing governance bylaws, creating contributor onboarding systems, and launching a dashboard tracking ecosystem health. Technical goals include a comprehensive ecosystem landscape report, formalized intellectual property frameworks (e.g., AGPL-3.0 code, trademark protection, contributor agreements), documented partnership models, and quantitative metrics showing increasing contribution rates and growth in monthly users. This organizational infrastructure ensures PolicyEngine's technical capabilities, including state and congressional district-level analysis powered by machine learning calibration, can sustainably serve community interests and drive development.

## About the POSE program

The NSF POSE program helps open-source projects develop robust ecosystems with strong governance, community engagement, and technical infrastructure. Phase I focuses on ecosystem discovery and planning, while Phase II provides implementation funding for projects ready to scale their impact.

## Project activities

Our grant activities focus on three key areas:

### Ecosystem discovery and research

- Conduct 100+ stakeholder interviews to understand the needs of policy researchers, government agencies, nonprofits, and academic institutions
- Map the landscape of policy analysis tools and identify gaps in current capabilities
- Study successful open-source economic modeling projects to learn best practices

### Community building and engagement

- Attend and present at key conferences to engage with the policy analysis community
- Develop partnerships with organizations that can contribute to and benefit from our tools
- Create documentation and resources to lower barriers for new contributors

### Governance development

- Design governance structures that support transparent decision-making and community involvement
- Develop sustainable funding models that align with our open-source mission
- Create processes for managing contributions and maintaining code quality

## Learning from TAXSIM's success

Dr. Dan Feenberg, creator of TAXSIM (cited in over 1,100 academic publications), will serve as our external mentor through the I-Corps for POSE training. TAXSIM has successfully built a large user community at the National Bureau of Economic Research, and we'll learn from their decades of experience creating an ecosystem around tax microsimulation tools. Many current TAXSIM users are potential PolicyEngine users, and Dr. Feenberg is helping us understand how to best serve this community's needs.

## Conference participation

As part of our ecosystem discovery efforts, we'll be attending and presenting at major conferences in economics, public policy, and open-source software development. These events will help us engage with potential users and contributors, learn from other projects, and share our work with the broader community.

## Application materials

You can view our complete NSF POSE Phase I application materials, including our project proposal and supporting documents, in our [public Google Drive folder](https://drive.google.com/drive/folders/1QzAXCGQJ-Z0Mn1OSx6qKMDJvEup7RKpH?usp=drive_link).

## Get involved

We invite researchers, developers, and policy analysts to join our open-source community. Visit our [GitHub repositories](https://github.com/PolicyEngine) to contribute, or explore our platform at [policyengine.org](https://legacy.policyengine.org) to see how we're democratizing policy analysis.

The NSF POSE Phase I grant will help PolicyEngine strengthen its open-source ecosystem and expand access to sophisticated policy analysis tools for researchers, policymakers, and citizens alike.

---

_This material is based upon work supported by the National Science Foundation under Award No. 2518372. Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation._



---

---
# Childcare programmes in PolicyEngine UK
Slug: uk-childcare-report
Date: 2025-06-06
Authors: Vahid Ahmadi
Tags: uk, benefit, featured
Description: This report explains how PolicyEngine models childcare programmes in the UK.

---

This report provides an analysis of childcare programmes in the UK, examining how they are modelled in PolicyEngine UK and their distributional impacts across different household types and income groups. We link each programme component to its implementation in the codebase to make this report a technical reference for understanding how childcare calculations are performed within the PolicyEngine UK microsimulation model. The report covers five major childcare programmes:

- **[Tax-Free Childcare](https://www.gov.uk/tax-free-childcare?step-by-step-nav=d78aeaf6-1747-4d72-9619-f16efb4dd89d)**: The UK government adds £2 for every £8 parents pay into a childcare account, up to £2,000 per child per year (£4,000 if the child is disabled).
- **[Extended childcare entitlement](https://www.gov.uk/check-eligible-free-childcare-if-youre-working?step-by-step-nav=f517cd57-3c18-4bb9-aa8b-1b907e279bf9)**: The UK government funds 15 to 30 hours of free childcare per week for working parents in England, depending on the child’s age.
- **[Universal childcare entitlement](https://www.gov.uk/help-with-childcare-costs/free-childcare-and-education-for-3-to-4-year-olds?step-by-step-nav=f237ec8e-e82c-4ffa-8fba-2a88a739783b)**: The UK government provides 15 free hours of childcare per week for all 3- and 4-year-olds in England.
- **[Targeted childcare entitlement](https://www.gov.uk/help-with-childcare-costs/free-childcare-2-year-olds-claim-benefits?step-by-step-nav=f237ec8e-e82c-4ffa-8fba-2a88a739783b)**: The UK government offers 15 free hours per week for 2-year-olds in households receiving certain benefits.
- **[Care to Learn](https://www.gov.uk/care-to-learn)**: The UK government covers weekly childcare costs for parents under 20 in England who are in education or training.

For each programme, we provide details on eligibility criteria, implementation, and calculation methods. For a complete assessment of eligibility criteria, please refer to the official government sources linked for each programme throughout this report. Finally, we explain our calibration methodology to ensure the model accurately reflects real-world participation and expenditure patterns.

Table 1 compares PolicyEngine’s estimates of the budgetary impact of the main childcare programmes with government-reported figures which are reported by fiscal year.

**Table 1. Budgetary estimates for childcare programmes (PolicyEngine vs government)**

| Programme           | PolicyEngine estimate 2025 (£bn)                                                                                                                               | PolicyEngine estimate 2024 (£bn)                                                                                                                               | Government report 2024 (£bn)                                                                                  | Relative error in estimate 2024 (%) |
| ------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| Tax-Free Childcare  | [0.7](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=82972)                          | [0.6](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2024&baseline=83892)                          | [0.6](https://www.gov.uk/government/statistics/tax-free-childcare-statistics-september-2024)                  | -0.7                                |
| Extended childcare  | [4.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80613&uk_local_areas_beta=true) | [2.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2024&baseline=83897&uk_local_areas_beta=true) | [2.5](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | 3.8                                 |
| Universal childcare | [1.8](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=82975)                          | [1.6](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2024&baseline=83887)                          | [1.7](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | -5.9                                |
| Targeted childcare  | [0.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=82974)                          | [0.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2024&baseline=83888)                          | [0.6](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | -10.0                               |

Table 2 compares PolicyEngine’s estimates of programme caseloads for the main childcare programmes with those reported by the government.

**Table 2. Caseload estimates for childcare programmes**

| Programme           | PolicyEngine estimate 2025 (thousands)                                       | PolicyEngine estimate 2024 (thousands)                                       | Government report 2024 (thousands)                                                                            | Relative error in estimate 2024 (%) |
| ------------------- | ---------------------------------------------------------------------------- | ---------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| Tax-Free Childcare  | [740](https://gist.github.com/vahid-ahmadi/02e479aaf8cd151036915597097a81b7) | [715](https://gist.github.com/vahid-ahmadi/02e479aaf8cd151036915597097a81b7) | [660](https://www.gov.uk/government/statistics/tax-free-childcare-statistics-september-2024)                  | 8.3                                 |
| Extended childcare  | [970](https://gist.github.com/vahid-ahmadi/bf773434c3539f9ab0bf178ddbbe503d) | [710](https://gist.github.com/vahid-ahmadi/bf773434c3539f9ab0bf178ddbbe503d) | [740](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | -4.1                                |
| Universal childcare | [520](https://gist.github.com/vahid-ahmadi/ce71205cbd3a84db282cc452aa746e4d) | [460](https://gist.github.com/vahid-ahmadi/ce71205cbd3a84db282cc452aa746e4d) | [490](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | -6.1                                |
| Targeted childcare  | [100](https://gist.github.com/vahid-ahmadi/184b2cda84c0f87d68498317696a434f) | [115](https://gist.github.com/vahid-ahmadi/184b2cda84c0f87d68498317696a434f) | [130](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | -11.5                               |

## Tax-Free Childcare (TFC)

The UK government, through HM Revenue and Customs (HMRC), runs the [Tax-Free Childcare](https://www.gov.uk/tax-free-childcare?step-by-step-nav=d78aeaf6-1747-4d72-9619-f16efb4dd89d) scheme that provides funding for working families with childcare expenses. For every £8 paid into a childcare account, the government adds £2. HMRC contributes up to £2,000 per year for each eligible child. For disabled children, this allocation increases to £4,000 per year.

### Eligibility requirements

#### Age criteria

The government provides standard childcare funding until 1 September after the child's [11th birthday](https://www.legislation.gov.uk/ukpga/2014/28/notes/division/6/4/1). For disabled children who receive disability benefits or are certified as blind/severely sight-impaired, funding continues until 1 September following their [16th birthday](https://www.legislation.gov.uk/ukpga/2014/28/notes/division/6/4/1). We [determine](https://github.com/PolicyEngine/policyengine-uk/blob/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/hmrc/tax_free_childcare/conditions/tax_free_childcare_child_age_eligible.py) eligibility by checking each child’s age and disability status.

#### Income requirements

The UK limits the programme to households where each partner earns—between employment and self-employment income—at least these amounts over a 3-month period, depending on their age, as shown in Table 3.

**Table 3. Minimum earnings thresholds by age group for TFC programme**

| Age group            | Minimum earnings |
| :------------------- | :--------------- |
| 21+                  | £2,379           |
| 18-20                | £1,788           |
| Under 18/Apprentices | £1,331           |

In addition to the earnings requirement, the maximum adjusted net income allowed is [£100,000](https://www.legislation.gov.uk/uksi/2015/448/regulation/15#commentary-key-e27c923eee152accd495af8425536e29) per year for each partner. We [evaluate](https://github.com/PolicyEngine/policyengine-uk/blob/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/hmrc/tax_free_childcare/conditions/tax_free_childcare_meets_income_requirements.py) if the parents meet the income criteria, examining both minimum and maximum thresholds.

#### Work status

Eligible individuals [must be](https://github.com/PolicyEngine/policyengine-uk/blob/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/hmrc/tax_free_childcare/conditions/tax_free_childcare_work_condition.py) either employed, self-employed, or on qualifying leave (sick, annual, or shared parental leave). Non-working partners may still qualify if they receive any of these benefits: incapacity benefit, severe disablement allowance, carer's allowance, or contribution-based employment and support allowance.

#### Programme interactions

Households can use Tax-Free Childcare alongside the extended and universal childcare entitlements, but they cannot [combine](https://www.legislation.gov.uk/ukdsi/2015/9780111127063) it with Working Tax Credit, Child Tax Credit, Universal Credit, or childcare vouchers. We [check](https://github.com/PolicyEngine/policyengine-uk/blob/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/hmrc/tax_free_childcare/conditions/tax_free_childcare_program_eligible.py) whether the household receives any of these benefits to determine eligibility for Tax-Free Childcare.

Finally, for eligible households, we [calculate](https://github.com/PolicyEngine/policyengine-uk/tree/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/hmrc/tax_free_childcare) the government contribution.

### Economic analysis

#### Gross salary vs take-home pay at the household level

To show the impact of TFC on household finances, we start with an example of a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=73038&region=uk&timePeriod=2025&baseline=76821&household=51616) with one child aged 3. These households become eligible for TFC when the earner is aged 21 or over and earning at least [£9,516](https://www.gov.uk/tax-free-childcare) annually. The benefit continues until £100,000, where eligibility ends, creating a decline in take-home pay. This creates a divergence between those receiving and not receiving TFC at higher income levels, as shown in Figure 1.

**. Household net income with and without Tax-Free Childcare**

[Chart: . Household net income with and without Tax-Free Childcare]

This decline at £100,000 creates an earnings dead zone, which is the width of the area in the chart where the sudden loss of TFC benefits affects household finances. At this threshold, families experience a cliff effect as they transition from receiving childcare support to losing it entirely.

#### Budgetary and distributional impacts

PolicyEngine [projects](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=82972) that the UK government will spend £0.7 billion on Tax-Free Childcare in 2025. Figure 2 shows the distributional impact of this programme:

[Chart: type: bar]

Figure 3 shows our estimation of [the number of children](https://gist.github.com/vahid-ahmadi/02e479aaf8cd151036915597097a81b7) in each household income decile receiving Tax-Free Childcare in 2025.

[Chart: type: bar]

## Extended childcare entitlement

The UK government, through the Department for Education (DfE), runs the [extended childcare](https://www.gov.uk/check-eligible-free-childcare-if-youre-working?step-by-step-nav=f517cd57-3c18-4bb9-aa8b-1b907e279bf9) programme, offering different weekly hours based on the child’s age. Children aged 9 months to 2 years receive 15 hours of free childcare per week, while those aged 3 to 4 receive 30 hours per week.

### Eligibility requirements

#### Work status

The UK government [requires](https://www.legislation.gov.uk/uksi/2022/1134/regulation/11A) single parents to be working to qualify for extended childcare. For couples, both partners must be in employment, unless one partner receives a qualifying disability benefit—such as incapacity benefit, severe disablement allowance, carer’s allowance, limited capability for work benefit, or contribution-based employment and support allowance.

#### Income requirements

The UK restricts eligibility to households where each partner earns, through employment or self-employment, at least a minimum amount over a 3-month period, depending on their age, as shown in Table 4.

**Table 4. Minimum earnings thresholds by age group for extended childcare entitlement**

| Age group            | Minimum earnings |
| :------------------- | :--------------- |
| 21+                  | £2,379           |
| 18-20                | £1,788           |
| Under 18/Apprentices | £1,331           |

These thresholds are based on working 16 hours per week at the applicable national minimum wage. Adjusted net income must also not exceed [£100,000](https://www.legislation.gov.uk/uksi/2015/448/regulation/15#commentary-key-e27c923eee152accd495af8425536e29) per year.

#### Entitlement calculation

We [determine](https://github.com/PolicyEngine/policyengine-uk/tree/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/dfe/extended_childcare_entitlement) the weekly hours based on the child's age and apply the funding rates to calculate the total annual entitlement value. Table 5 shows examples of entitlement calculation based on age and funding rates.

**Table 5. Examples of annual childcare entitlement by child age**

| Child age | Weekly hours | Funding rate (2025)                                                       | Annual entitlement (2025) |
| :-------- | :----------- | :------------------------------------------------------------------------ | :------------------------ |
| 2         | 15           | [£8.3](https://commonslibrary.parliament.uk/research-briefings/cbp-8052/) | £4,719.6                  |
| 3         | 30           | [£5.9](https://commonslibrary.parliament.uk/research-briefings/cbp-8052/) | £6,703.2                  |

### Economic analysis

#### Gross salary vs take-home pay at the household level

To show the impact of extended childcare entitlement on household finances, we start with an example of a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.pythonReproducibility&reform=1&region=uk&timePeriod=2025&baseline=84515&household=53312) with one child aged 3. These households become eligible for extended childcare when earning at least [£9,516 annually](https://www.gov.uk/free-childcare-if-working/check-youre-eligible) for those aged 21 or over. The benefit continues until £100,000, where eligibility ends, creating a decline in take-home pay. This creates a divergence between those receiving and not receiving extended childcare at higher income levels, as shown in Figure 5.

**. Household net income with and without extended childcare**

[Chart: . Household net income with and without extended childcare]

#### Budgetary and distributional impacts

PolicyEngine [projects](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80613) that the UK government will spend £4.4 billion on extended childcare entitlement in 2025. Figure 6 shows the distributional impact of this programme:

[Chart: type: bar]

Figure 7 shows our estimation of [the number of children](https://gist.github.com/vahid-ahmadi/bf773434c3539f9ab0bf178ddbbe503d) in each household income decile receiving extended childcare entitlement in 2025.

[Chart: type: bar]

## Universal childcare entitlement

The UK government, through the Department for Education (DfE), provides free childcare for all 3- to 4-year-olds in England under the [universal childcare programme](https://www.gov.uk/help-with-childcare-costs/free-childcare-and-education-for-3-to-4-year-olds?step-by-step-nav=f237ec8e-e82c-4ffa-8fba-2a88a739783b). Each eligible child receives up to 570 hours per year, delivered as 15 hours per week over 38 weeks through an approved childcare provider. This programme applies to England only.

### Eligibility requirements

The UK government [grants](https://github.com/PolicyEngine/policyengine-uk/tree/20ed1a9d77a3307b3e2bc4a0986ec606ab7fead9/policyengine_uk/variables/gov/dfe/universal_childcare_entitlement) universal childcare entitlement to children who meet residence and age conditions. The child must live in England, be at least [3 years](https://www.legislation.gov.uk/uksi/2016/1257/part/4/made) old, and not yet reach compulsory [school age](https://www.legislation.gov.uk/ukpga/2006/21/section/19).

We determine the weekly hours based on the child's age and apply the funding rates to calculate the total annual entitlement value.

### Economic analysis

#### Gross salary vs take-home pay at the household level

To show how the universal childcare entitlement affects household finances, we examine a [single-earner household](https://legacy.policyengine.org/uk/household?reform=1&focus=householdOutput.earnings&region=uk&timePeriod=2025&baseline=82975&household=53312) with one child aged 3. The household cannot [claim](https://www.childcarechoices.gov.uk/combining-schemes) both universal childcare and Tax-Free Childcare at the same time. Figure 9 shows how net income changes with the head of household’s earnings under each option.

**. Household net income with and without universal childcare**

[Chart: . Household net income with and without universal childcare]

#### Budgetary and distributional impacts

PolicyEngine [projects](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=82975) that the UK government will spend £1.8 billion on universal childcare entitlement in 2025. Figure 10 shows the distributional impact of this programme:

[Chart: type: bar]

Figure 11 shows our estimation of [the number of children](https://gist.github.com/vahid-ahmadi/ce71205cbd3a84db282cc452aa746e4d) in each household income decile receiving universal childcare entitlement in 2025.

[Chart: type: bar]

## Targeted childcare entitlement

The UK government, through the Department for Education (DfE), provides the [targeted childcare entitlement](https://www.gov.uk/help-with-childcare-costs/free-childcare-2-year-olds-claim-benefits?step-by-step-nav=f237ec8e-e82c-4ffa-8fba-2a88a739783b), offering 15 hours of free childcare per week for eligible [2-year-old](https://www.legislation.gov.uk/uksi/2014/2147/regulation/3/made) children in England. This entitlement totals up to [570](https://www.legislation.gov.uk/uksi/2014/2147/regulation/4/made) hours per year, delivered across 38 weeks.

### Eligibility requirements

The UK government [grants](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/targeted_childcare_entitlement/targeted_childcare_entitlement_eligible.py) targeted childcare entitlement to households that receive one or more qualifying benefits. These include Income Support, income-based Jobseeker’s Allowance (JSA), income-related Employment and Support Allowance (ESA), and the guaranteed element of Pension Credit. Households may also [qualify](https://www.gov.uk/help-with-childcare-costs/free-childcare-2-year-olds) if they receive Universal Credit and have earned income below £15,400 a year after tax (excluding benefit payments), or if they receive Child Tax Credit (but not Working Tax Credit) with gross annual income below £16,190.

### Entitlement calculation

The UK government [provides](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/targeted_childcare_entitlement/targeted_childcare_entitlement.py) up to 570 hours of free childcare per year for eligible children, delivered as 15 hours per week over 38 weeks. Table 6 shows how the annual entitlement varies based on eligibility, age, and funding rates.

**Table 6. Examples of annual childcare entitlement by age and eligibility**

| Child age | Eligible | Hours entitlement | Hourly rate (2025) | Annual entitlement (2025) |
| :-------- | :------- | :---------------- | :----------------- | :------------------------ |
| 1         | No       | 0                 | £11.2              | £0                        |
| 2         | Yes      | 570               | £8.3               | £4,719.6                  |
| 3         | No       | 0                 | £5.9               | £0                        |

### Economic analysis

#### Gross salary vs take-home pay at the household level

To show the impact of targeted childcare entitlement on household finances, we start with an example of a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=1&region=uk&timePeriod=2025&baseline=82974&household=53310) with one child aged 2. Figure 13 shows household net income based on head employment income.

**. Household net income with and without targeted childcare**

[Chart: . Household net income with and without targeted childcare]

#### Budgetary and distributional impacts

PolicyEngine [projects](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=82974) that the UK government will spend £0.5 billion on targeted childcare entitlement in 2025. Figure 14 shows the distributional impact of this programme:

[Chart: type: bar]

Figure 15 shows our estimation of [the number of children](https://gist.github.com/vahid-ahmadi/184b2cda84c0f87d68498317696a434f) in each household income decile receiving targeted childcare entitlement in 2025.

[Chart: type: bar]

## Care to learn

The UK government, through the Department for Education (DfE), runs the [Care to Learn](https://www.gov.uk/care-to-learn) scheme in England to support young parents under the age of 20 who continue their education while caring for children. The programme covers childcare costs during education or training, offering up to [£180](https://researchbriefings.files.parliament.uk/documents/CBP-8054/CBP-8054.pdf#page=43) per week outside London and up to [£195](https://researchbriefings.files.parliament.uk/documents/CBP-8054/CBP-8054.pdf#page=43) per week in London.

### Eligibility requirements

The UK government [provides](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/care_to_learn/care_to_learn.py) Care to Learn support to young parents who meet specific eligibility criteria. To qualify, applicants must be under [20 years](https://publications.parliament.uk/pa/cm200809/cmbills/055/en/09055x-c.htm#:~:text=160,childcare%20when%20securing%20these%20grants) old, not enrolled in higher education or an apprenticeship, and living in England.

### Entitlement calculation

We [determine](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/care_to_learn/care_to_learn.py) whether the applicant lives in London and applies the weekly rate based on their location. Table 7 shows the annual entitlement in 2025 by location.

**Table 7. Annual childcare entitlement (Care to Learn) by location**

| Location       | Weekly rate | Annual entitlement (52 weeks) |
| -------------- | ----------- | ----------------------------- |
| London         | £195        | £10,140                       |
| Outside London | £180        | £9,360                        |

Due to the absence of relevant cases in the Family Resources Survey, we are unable to estimate the economic impact of this programme. Nevertheless, the programme is implemented and can be used to calculate benefits in the household section of PolicyEngine.

## Data calibration

To align our model with real-world participation and expenditure patterns, we calibrate our enhanced [FRS (Family Resources Survey)](https://www.gov.uk/government/collections/family-resources-survey--2) dataset by adding take-up rates to match official spending and caseload statistics for childcare programmes.

### Target data

We target both aggregate spending and caseload figures for each programme in 2024, as shown in Table 8.

**Table 8. Calibration targets for spending and caseloads (2024)**

| Programme           | Spending target (£ billions)                                                                                  | Caseload target (thousands)                                                                                   |
| :------------------ | :------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------ |
| Tax-Free Childcare  | [0.6](https://www.gov.uk/government/statistics/tax-free-childcare-statistics-september-2024)                  | [660](https://www.gov.uk/government/statistics/tax-free-childcare-statistics-september-2024)                  |
| Extended childcare  | [2.5](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | [740](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) |
| Targeted childcare  | [0.6](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | [130](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) |
| Universal childcare | [1.7](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | [490](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) |

### Optimisation process

We [calibrate](https://github.com/PolicyEngine/policyengine-uk-data/blob/1334f28bca35c78efc342423ca64b53774e92dc1/policyengine_uk_data/datasets/frs/childcare/takeup_rate.py) the model using an optimisation process to identify take-up rates that align with our targets. We define an objective function that quantifies the difference between simulated and target values for both spending and caseload. We then minimise this function to find the optimal take-up rates, ensuring the model reflects official statistics.

### Integration into the UK model

We [integrate](https://github.com/PolicyEngine/policyengine-uk-data/blob/1334f28bca35c78efc342423ca64b53774e92dc1/policyengine_uk_data/datasets/frs/enhanced_frs.py) the optimised take-up rates into the Enhanced FRS dataset class. The model currently applies the take-up rates shown in Table 9.

**Table 9. Childcare programme take-up rates in PolicyEngine**

| Programme           | Take-up Rate |
| :------------------ | :----------- |
| Tax-Free Childcare  | 0.58         |
| Extended childcare  | 0.81         |
| Targeted childcare  | 0.60         |
| Universal childcare | 0.56         |

We use these rates to randomly assign benefit units to each childcare programme, generating representative aggregate statistics. Based on the 2023 Childcare and Early Years [Survey](https://explore-education-statistics.service.gov.uk/find-statistics/childcare-and-early-years-survey-of-parents/2023) of Parents, the government reports that around 63% of children aged 0 to 4 used formal childcare.

To reach the target metrics for extended childcare, we [impute](https://github.com/PolicyEngine/policyengine-uk-data/blob/1334f28bca35c78efc342423ca64b53774e92dc1/policyengine_uk_data/datasets/frs/enhanced_frs.py) hours claimed among households simulated to take up the program. We model the distribution of claimed hours using a normal distribution with a mean of 15.0 and a standard deviation of 5.0, bounded from 0 (exclusive) to 40 (inclusive).

## Conclusion

This report explains how UK childcare programmes are modelled in PolicyEngine and linked to the codebase. Each programme’s rules are implemented through defined eligibility and entitlement conditions. We also present the impacts on household finances and income distribution. We invite you to explore the economic impacts of these childcare programmes using the PolicyEngine interface.



---

---
# Tax changes in effect in April 2025
Slug: impact-of-tax-changes-2025-2026
Date: 2025-04-25
Authors: Nikhil Woodruff
Tags: uk, tax, policy, featured
Description: Using PolicyEngine UK, we analyse four tax changes taking effect in April 2025 that will increase taxes by an average of £1,133 per household.

---

Four tax reforms took effect in April 2025. Using the PolicyEngine UK tax-benefit microsimulation model, we analysed these reforms, which will increase taxes by an average of £1,133 per household.[^1]

[^1]: A previous version of this analysis assumed a 5% increase in average Council Tax rates by using the central Government's figure for the change in the average Band D rate. This version uses the 6.1% rise in the average Council Tax rate for all households from the same source.

This analysis, requested and [published](https://insider.iea.org.uk/p/new-analysis-the-cost-of-tax-hikes) by the Institute for Economic Affairs, featured in the Daily Mail's [front-page article](https://www.dailymail.co.uk/news/article-14548907/Labours-tax-raids-cost-families-week.html) on the 28th March 2025, in two [Express](https://www.express.co.uk/news/politics/2034186/rachel-reeves-tax-increase-cost) [articles](https://www.express.co.uk/finance/personalfinance/2034211/rachel-reevesl-tax-hikes-cost-british-families), and two [other](https://www.dorsetecho.co.uk/news/25047728.tax-hikes-will-cost-british-families-1-000-per-year-average/) [outlets](https://londonlovesbusiness.com/labours-tax-hikes-will-cost-british-families-over-1000-per-year-on-average/).

## Policy changes

From a combination of temporary reforms expiring and new tax reforms taking effect:

- The Government has [allowed](https://www.legislation.gov.uk/ukpga/2023/2/section/1) **Stamp Duty Land Tax** nil-rate thresholds to expire to £300,000 (from £425,000) for first-time buyers and £125,000 (from £250,000) for subsequent purchases. These thresholds determine the property value at which SDLT begins to apply. First-time buyers maintain a higher threshold than subsequent purchasers under this reform. This reform is the result of an expiry of a Stamp Duty Land Tax cut announced by then-Chancellor Jeremy Hunt in the Autumn Budget 2023 (expiring 31 March 2025).
- The Government [set](https://bills.parliament.uk/bills/3888) the **Employer's National Insurance** rate to 15% with the secondary threshold set to £96.14 (from £175) per week. We assume that the employer NI changes is passed on to employees at 40% in 2025, 50% in 2026, 60% in 2027, and 70% in 2028-2029, with the remainder split between business owners and prices. This reform was announced in the Autumn Budget 2024 and takes effect in April 2025.
- The Government had [set](https://www.legislation.gov.uk/ukpga/2025/8/section/7/enacted) **Capital Gains Tax** rates to [change](https://policyengine.org/uk/research/cgt-autumn-budget) to 18% (from 10%) for basic rate taxpayers and 24% (from 20%) for both higher and additional rate taxpayers. CGT applies to profits from the sale of assets that have increased in value, with various exemptions including primary residences. This reform was in effect from the time of the Autumn Budget, but 2025/26 is the first full tax year of its implementation.
- Local authorities have [increased](https://www.gov.uk/government/statistics/council-tax-levels-set-by-local-authorities-in-england-2025-to-2026/council-tax-levels-set-by-local-authorities-in-england-2025-to-2026#average-council-tax-per-dwelling) **Council Tax** by 6.1% on average from 2024\. This is set by local authorities. These reforms have been announced by councils over the last year.

## Economic impacts

We estimate the following revenue impacts for these reforms in 2025/26 (Table 1). For each tax, we include its _static_ revenue impact. This assumes that individuals do not adjust their behaviour in response, representing simply the impact of the change in policy on existing households.

| Reform                                                                         | 2025 static revenue (£ million)                                                                                                                                   | Average per household (£) |
| :----------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------ |
| Stamp duty: lower first home nil-rate threshold from 425,000 to 300,000        | [150](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&baseline=80444&timePeriod=2025&region=uk)                             | 5                         |
| Stamp duty: lower primary residence nil-rate threshold from 250,000 to 125,000 | [1,200](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&baseline=80446&timePeriod=2025&region=uk)                           | 43                        |
| Capital Gains Tax: raise rates to 18% and 24%                                  | [4,200](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69732&region=uk&timePeriod=2025&baseline=1)                           | 150                       |
| Council tax: raise by 5%                                                       | 3,300                                                                                                                                                             | 117                       |
| National Insurance: raise employer rate from 13.8% to 15% and lower threshold  | [22,900](https://legacy.policyengine.org/uk/policy?reform=69728&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=1&uk_local_areas_beta=true) | 818                       |
| Total                                                                          | 31,750                                                                                                                                                            | 1,133                     |

Table 1

Figure 1 shows the impact of these reforms on average in each household income decile. The highest decile’s household net income falls by £2,754, and the lowest decile £808.

[Chart: type: bar]

Figure 2 shows the median tax rise by region.

[Chart: type: bar]



---

---
# Analyzing Energy Policy with PolicyEngine
Slug: earth-day-2025
Date: 2025-04-22
Authors: Max Ghenis
Tags: us, uk, featured
Description: We provide an Earth Day recap of our capabilities in the US and UK.

---

At PolicyEngine, our work centers on providing open and transparent tools for public policy analysis. While many analyses focus on tax and benefit programs, energy policies also have significant individual and societal effects that warrant examination.

I discussed PolicyEngine's capabilities in this area at the most recent [Open Sustainability Policy Summit](https://opensource.engineering.jhu.edu/), hosted by Johns Hopkins and LF Energy. You can watch the talk below:

<center>[Interactive: af8Y5J_jLO0]</center>

As I described (slides available [here](https://docs.google.com/presentation/d/1pAXVClSU1Ws7tcrpHFinGTdeHLsrZWJo_tQWmEzjXXk/preview)), our open-source platform allows users to explore the quantitative impacts of various policies, including those related to energy. Here's an overview of PolicyEngine's relevant features:

### Modeling the Individual Impacts of Energy Policies

Energy policies can affect household budgets in numerous ways. PolicyEngine uses microsimulation modeling to estimate these effects. The platform can analyze:

- **Carbon Pricing:** In the UK, we can model hypothetical policies like a [carbon tax](https://policyengine.org/uk/research/how-policyengine-estimates-the-effects-of-uk-carbon-taxes) paired with a dividend. Our UK model demonstrated the distributional effects of pairing a £100/tonne carbon tax with an £18/week universal dividend, showing potential outcomes across income and wealth levels.
- **Energy Assistance Programs:** In some US states, we model programs like the Low Income Home Energy Assistance Program (LIHEAP). For example, we can simulate Michigan's Home Heating Credit to show how benefits change based on income and heating costs, revealing implicit subsidy rates.
- **Energy Price Regulations:** We have modeled policies like the [UK's Energy Price Guarantee](https://policyengine.org/uk/research/projected-impact-of-the-uks-extended-energy-price-guarantee), which capped household energy costs.
- **Clean Energy Incentives:** We analyze individual tax credits, such as the Clean Vehicle Credit from the Inflation Reduction Act (IRA), including eligibility rules and income interactions. You can read my [2022 UBI Center report](https://www.ubicenter.org/ira-ev-credit-cliff) for a demonstration.
- **Implicit Subsidies:** We can identify energy-related components in other programs, like the SNAP utility expense deduction.
- **State & Local Programs:** We incorporate state-specific policies, such as California's low-income electricity discounts (CARE and FERA).

### An Open, Integrated Platform

Our capabilities are built on a foundation of openness and specific data techniques:

- **Open Source:** Our entire platform – from the front-end interface to the underlying rules engine and APIs – is free and open source, available on [GitHub](https://github.com/PolicyEngine). We leverage and contribute to the broader open-source community.
- **Data Integration:** We use techniques, including machine learning, to integrate diverse datasets (like income surveys and consumption data) to provide a detailed view of policy impacts.
- **Tools:**
  - **Individuals:** Calculate estimated taxes and benefits under current law.
  - **Analysts:** Design custom policy reforms, adjusting parameters or introducing new policies.
  - **Impact Analysis:** Compute the personalized impact of reforms on specific households and estimate the broader societal effects on metrics like poverty and inequality using microsimulation.
  - **API Access:** Third parties can build custom applications using our API.

### Future Directions in Energy & Climate Modeling

We are continuously expanding our capabilities. As discussed in the presentation, future directions include:

- **Broadening Scope:** Modeling more LIHEAP programs across the US and incorporating state-specific rules for IRA rebates.
- **Deeper Data:** Integrating more detailed utility expense data into our US models.
- **Dynamic Modeling:** Working towards integration with dynamic macroeconomic models (like OG-USA).
- **Energy & Emissions:** Exploring the integration of dedicated energy models to estimate the potential impact of policies on emissions.
- **Enhanced UX:** Improving the user experience and expanding our API for developers.
- **AI Integration:** Developing AI-powered tools, like chatbots, for policy analysis.

### Learn More

Understanding the economic and distributional effects of energy policy involves dissecting complex interactions. PolicyEngine provides transparent, accessible tools for this analysis. Explore our platform and contribute to our open-source project. Visit [PolicyEngine US](https://legacy.policyengine.org/us) and [PolicyEngine UK](https://legacy.policyengine.org/uk) to learn more.



---

---
# Analysis of the Spring 2025 OBR forecast
Slug: obr-forecast-2025
Date: 2025-03-26
Authors: Nikhil Woodruff
Tags: uk, impact, featured
Description: PolicyEngine integrates the new OBR forecasts to provide updated predictions on household income, poverty, and inequality.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Credit: Best for Britain*\n",
    "\n",
    "## Executive summary\n",
    "\n",
    "Today, the Office for Budget Responsibility releases its Spring 2025 Economic and Fiscal Outlook. The OBR is an independent body that produces economic and fiscal forecasts for the UK government.\n",
    "\n",
    "* The OBR forecasts that income sources will rise across all categories (employment: +£24-29B, self-employment: +£12-25B, non-labor: +£19-43B annually, CPI: +0.3-0.9 annually).\n",
    "* We project absolute poverty rates will fall (0.2-0.7 percentage points), while income inequality will widen.\n",
    "* We project that households in the lowest decile will see net incomes 1.9% higher in 2030 under the new forecast than the Autumn 2024 forecast, and households in the highest decile will see net incomes 3.1% higher.\n",
    "* We project that the average household will have a net income £1,160 (2.5%) higher in 2030 under the new forecast than the Autumn 2024 forecast.\n",
    "* We project net benefit recipient households will reduce by 0.3-0.5 points (253,000-462,000 fewer households annually).\n",
    "\n",
    "In this report, we'll integrate the OBR's new Spring forecast into PolicyEngine's tax-benefit microsimulation model, and examine the impact this new forecast (against the Autumn 2024 EFO) on the UK household sector. All impacts below are the impact of this forecast change *alone*, excluding any policy measures not already in the baseline policy."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/nikhilwoodruff/policyengine/obr-forecast/.venv/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n",
      "  from .autonotebook import tqdm as notebook_tqdm\n"
     ]
    },
    {
     "data": {
      "text/markdown": [
       "[See the forecast change in PolicyEngine](https://legacy.policyengine.org/uk/policy?reform=80230&baseline=80227&region=uk&timePeriod=2029)"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from policyengine import Simulation\n",
    "\n",
    "\n",
    "# Autumn 2024 OBR Forecast\n",
    "AUTUMN_24_OBR_FORECAST = {\n",
    "    \"gov.obr.employment_income\": {\n",
    "        \"year:2025:1\": 1215.6,\n",
    "        \"year:2026:1\": 1246.5,\n",
    "        \"year:2027:1\": 1277.7,\n",
    "        \"year:2028:1\": 1312.9,\n",
    "        \"year:2029:1\": 1352.9,\n",
    "    },\n",
    "    \"gov.obr.mixed_income\": {\n",
    "        \"year:2025:1\": 177.6,\n",
    "        \"year:2026:1\": 196.7,\n",
    "        \"year:2027:1\": 205.3,\n",
    "        \"year:2028:1\": 214.6,\n",
    "        \"year:2029:1\": 225.0,\n",
    "    },\n",
    "    \"gov.obr.non_labour_income\": {\n",
    "        \"year:2025:1\": 460.8,\n",
    "        \"year:2026:1\": 512.7,\n",
    "        \"year:2027:1\": 535.0,\n",
    "        \"year:2028:1\": 554.0,\n",
    "        \"year:2029:1\": 571.8,\n",
    "    },\n",
    "    \"gov.obr.consumer_price_index\": {\n",
    "        \"year:2025:1\": 138.1,\n",
    "        \"year:2026:1\": 141.1,\n",
    "        \"year:2027:1\": 144.1,\n",
    "        \"year:2028:1\": 147.1,\n",
    "        \"year:2029:1\": 150.1,\n",
    "    },\n",
    "}\n",
    "\n",
    "# Spring 2025 OBR Forecast - Default to Autumn 2024 values, update these when the new forecast is released\n",
    "SPRING_25_OBR_FORECAST = {\n",
    "    \"gov.obr.employment_income\": {\n",
    "        \"year:2025:1\": 1239.8,\n",
    "        \"year:2026:1\": 1272.5,\n",
    "        \"year:2027:1\": 1305.3,\n",
    "        \"year:2028:1\": 1340.7,\n",
    "        \"year:2029:1\": 1382.0,\n",
    "    },\n",
    "    \"gov.obr.mixed_income\": {\n",
    "        \"year:2025:1\": 202.8,\n",
    "        \"year:2026:1\": 210.6,\n",
    "        \"year:2027:1\": 218.7,\n",
    "        \"year:2028:1\": 227.4,\n",
    "        \"year:2029:1\": 237.2,\n",
    "    },\n",
    "    \"gov.obr.non_labour_income\": {\n",
    "        \"year:2025:1\": 503.3,\n",
    "        \"year:2026:1\": 531.6,\n",
    "        \"year:2027:1\": 555.6,\n",
    "        \"year:2028:1\": 574.6,\n",
    "        \"year:2029:1\": 594.5,\n",
    "    },\n",
    "    \"gov.obr.consumer_price_index\": {\n",
    "        \"year:2025:1\": 139.0,\n",
    "        \"year:2026:1\": 141.7,\n",
    "        \"year:2027:1\": 144.5,\n",
    "        \"year:2028:1\": 147.4,\n",
    "        \"year:2029:1\": 150.4,\n",
    "    },\n",
    "}\n",
    "sim = Simulation(\n",
    "    country=\"uk\",\n",
    "    scope=\"macro\",\n",
    "    baseline=AUTUMN_24_OBR_FORECAST,\n",
    "    reform=SPRING_25_OBR_FORECAST,\n",
    ")\n",
    "\n",
    "from policyengine_core.reforms import Reform\n",
    "from IPython.display import Markdown\n",
    "import pandas as pd\n",
    "\n",
    "baseline = Reform.from_dict(AUTUMN_24_OBR_FORECAST, country_id=\"uk\")\n",
    "reform = Reform.from_dict(SPRING_25_OBR_FORECAST, country_id=\"uk\")\n",
    "\n",
    "link = f\"https://legacy.policyengine.org/uk/policy?reform={reform.api_id}&baseline={baseline.api_id}&region=uk&timePeriod=2029\"\n",
    "\n",
    "Markdown(f\"[See the forecast change in PolicyEngine]({link})\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## The forecast change\n",
    "\n",
    "In this report we'll focus on the changes to core economic variables: employment income, mixed income, non-labour income, and inflation. The tables below show the prior and new values for these variables (totals, £ billion).\n",
    "\n",
    "* The **employment income** forecast by the OBR is used to update wages and salaries in PolicyEngine for future year modelling.\n",
    "* The **mixed income** forecast by the OBR is used to update self-employment incomes.[^1]\n",
    "* The **non-labour income** forecast by the OBR is used to update income from savings, investments, and pensions.\n",
    "* The **inflation** forecast by the OBR is used to update the price level in PolicyEngine, including policy parameters that are indexed to inflation.\n",
    "\n",
    "[^1]: Per the [OBR's definition](https://obr.uk/forecasts-in-depth/the-economy-forecast/income/#disposable), *\"mixed income is largely composed of self-employment income, which is derived from our forecasts of self-employment and whole economy average earnings\"*."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "### Employment income\n",
       "\n",
       "|   Year | Autumn 2024   | Spring 2025   |   Change (%) |\n",
       "|-------:|:--------------|:--------------|-------------:|\n",
       "|   2025 | 1,215.6       | 1,239.8       |         24.2 |\n",
       "|   2026 | 1,246.5       | 1,272.5       |         26   |\n",
       "|   2027 | 1,277.7       | 1,305.3       |         27.6 |\n",
       "|   2028 | 1,312.9       | 1,340.7       |         27.8 |\n",
       "|   2029 | 1,352.9       | 1,382.0       |         29.1 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create a table for the baseline and reform, column 1 is the baseline, column 2 is the reform, column 3 is the change. Years are rows\n",
    "\n",
    "\n",
    "def add_thousands_separator(x):\n",
    "    return \"{:,}\".format(x)\n",
    "\n",
    "\n",
    "def create_table(baseline, reform):\n",
    "    years = []\n",
    "    autumn_values = []\n",
    "    spring_values = []\n",
    "    change_values = []\n",
    "    variables = []\n",
    "    key_to_label = {\n",
    "        \"gov.obr.employment_income\": \"Employment income\",\n",
    "        \"gov.obr.mixed_income\": \"Mixed income\",\n",
    "        \"gov.obr.non_labour_income\": \"Non-labour income\",\n",
    "        \"gov.obr.consumer_price_index\": \"Consumer Price Index\",\n",
    "    }\n",
    "\n",
    "    for year in range(2025, 2030):\n",
    "        for key in baseline.keys():\n",
    "            years.append(year)\n",
    "            variables.append(key_to_label[key])\n",
    "            autumn_values.append(baseline[key][f\"year:{year}:1\"])\n",
    "            spring_values.append(reform[key][f\"year:{year}:1\"])\n",
    "            if key != \"gov.obr.consumer_price_index\":\n",
    "                change_values.append(\n",
    "                    reform[key][f\"year:{year}:1\"]\n",
    "                    - baseline[key][f\"year:{year}:1\"]\n",
    "                )\n",
    "            else:\n",
    "                change_values.append(\n",
    "                    (\n",
    "                        reform[key][f\"year:{year}:1\"]\n",
    "                        / baseline[key][f\"year:{year}:1\"]\n",
    "                        - 1\n",
    "                    )\n",
    "                    * 100\n",
    "                )\n",
    "\n",
    "    change_label = (\n",
    "        \"Change (%)\" if key == \"gov.obr.consumer_price_index\" else \"Change\"\n",
    "    )\n",
    "    df = pd.DataFrame(\n",
    "        {\n",
    "            \"Year\": years,\n",
    "            \"Variable\": variables,\n",
    "            \"Autumn 2024\": autumn_values,\n",
    "            \"Spring 2025\": spring_values,\n",
    "            change_label: change_values,\n",
    "        }\n",
    "    )\n",
    "    df[\"Year\"] = df[\"Year\"].astype(str)\n",
    "    df[\"Autumn 2024\"] = df[\"Autumn 2024\"].round(1)\n",
    "    df[\"Spring 2025\"] = df[\"Spring 2025\"].round(1)\n",
    "    df[change_label] = df[change_label].round(1)\n",
    "\n",
    "    df[\"Autumn 2024\"] = df[\"Autumn 2024\"].apply(add_thousands_separator)\n",
    "    df[\"Spring 2025\"] = df[\"Spring 2025\"].apply(add_thousands_separator)\n",
    "    df[change_label] = df[change_label].apply(add_thousands_separator)\n",
    "\n",
    "    return df\n",
    "\n",
    "\n",
    "reform_table = create_table(AUTUMN_24_OBR_FORECAST, SPRING_25_OBR_FORECAST)\n",
    "\n",
    "\n",
    "def get_table(key):\n",
    "    return Markdown(\n",
    "        f\"### {key}\\n\\n\"\n",
    "        + reform_table[reform_table.Variable == key]\n",
    "        .drop(\"Variable\", axis=1)\n",
    "        .set_index(\"Year\")\n",
    "        .to_markdown()\n",
    "    )\n",
    "\n",
    "\n",
    "get_table(\"Employment income\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "### Mixed income\n",
       "\n",
       "|   Year |   Autumn 2024 |   Spring 2025 |   Change |\n",
       "|-------:|--------------:|--------------:|---------:|\n",
       "|   2025 |         177.6 |         202.8 |     25.2 |\n",
       "|   2026 |         196.7 |         210.6 |     13.9 |\n",
       "|   2027 |         205.3 |         218.7 |     13.4 |\n",
       "|   2028 |         214.6 |         227.4 |     12.8 |\n",
       "|   2029 |         225   |         237.2 |     12.2 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_table(\"Mixed income\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "### Non-labour income\n",
       "\n",
       "|   Year |   Autumn 2024 |   Spring 2025 |   Change |\n",
       "|-------:|--------------:|--------------:|---------:|\n",
       "|   2025 |         460.8 |         503.3 |     42.5 |\n",
       "|   2026 |         512.7 |         531.6 |     18.9 |\n",
       "|   2027 |         535   |         555.6 |     20.6 |\n",
       "|   2028 |         554   |         574.6 |     20.6 |\n",
       "|   2029 |         571.8 |         594.5 |     22.7 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_table(\"Non-labour income\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "### Consumer Price Index\n",
       "\n",
       "|   Year |   Autumn 2024 |   Spring 2025 |   Change (%) |\n",
       "|-------:|--------------:|--------------:|-------------:|\n",
       "|   2025 |         138.1 |         139   |          0.7 |\n",
       "|   2026 |         141.1 |         141.7 |          0.4 |\n",
       "|   2027 |         144.1 |         144.5 |          0.3 |\n",
       "|   2028 |         147.1 |         147.4 |          0.2 |\n",
       "|   2029 |         150.1 |         150.4 |          0.2 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_table(\"Consumer Price Index\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Public sector net worth\n",
    "\n",
    "The table below shows the change in public sector net worth as a result of the forecast change (change to government tax revenue forecast minus spending). Public sector net worth (PSNW), defined by the [OBR](https://obr.uk/box/broader-measures-of-the-public-sector-balance-sheet/), is the broadest National Accounts measure of the public sector balance sheet in the UK.\n",
    "\n",
    "In the table below, we report *only the change to PSNW implied by the PolicyEngine model*, which is the simulated change in tax revenues less government spending on cash benefits implied by the change in the OBR forecast on the four economic metrics above (excluding debt interest spending). We do not account for behavioural responses in this score.\n",
    "\n",
    "Table 1: Change in public sector net worth (£ billion)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|                          |   2025 |   2026 |   2027 |   2028 |   2029 |   2025-2029 |\n",
       "|:-------------------------|-------:|-------:|-------:|-------:|-------:|------------:|\n",
       "| PSNW change (£ billions) |   28.4 |   19.3 |   20.8 |   20.9 |   21.5 |       110.9 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# First, PSND from forecast changes\n",
    "psnd_change = []\n",
    "years = []\n",
    "for year in range(2025, 2030):\n",
    "    psnd_baseline = (\n",
    "        sim.baseline_simulation.calculate(\"gov_balance\", year).sum() / 1e9\n",
    "    )\n",
    "    psnd_reform = (\n",
    "        sim.reform_simulation.calculate(\"gov_balance\", year).sum() / 1e9\n",
    "    )\n",
    "    change = psnd_reform - psnd_baseline\n",
    "    psnd_change.append(round(change, 1))\n",
    "    years.append(year)\n",
    "\n",
    "years.append(\"2025-2029\")\n",
    "psnd_change.append(round(sum(psnd_change), 1))\n",
    "\n",
    "Markdown(\n",
    "    pd.DataFrame({\"Year\": years, \"PSNW change (£ billions)\": psnd_change})\n",
    "    .set_index(\"Year\")\n",
    "    .T.to_markdown()\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "As shown, the OBR forecast update raises the government budget by £110.9 billion over the period 2025-2029. Per year, this is on average £22.2 billion."
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Markdown(\n",
    "    f\"As shown, the OBR forecast update raises the government budget by £{psnd_change[-1]} billion over the period 2025-2029. Per year, this is on average £{round(psnd_change[-1]/5, 1)} billion.\"\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Poverty rates\n",
    "\n",
    "The government reports annually on four poverty metrics:\n",
    "\n",
    "* **Absolute poverty before housing costs**: households with income below 60% of the 2010/11 median income, adjusted for inflation.\n",
    "* **Absolute poverty after housing costs**: households with income below 60% of the 2010/11 median income after housing costs, adjusted for inflation.\n",
    "* **Relative poverty before housing costs**: households with income below 60% of the median income in the current year.\n",
    "* **Relative poverty after housing costs**: households with income below 60% of the median incomeafter housing costs in the current year .\n",
    "\n",
    "For each of these metrics, we simulate the change in the poverty rate and headcount as a result of the forecast change."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_poverty(simulation, year, absolute, bhc, rate):\n",
    "    population = simulation.calculate(\"person_id\", year).count()\n",
    "    if absolute:\n",
    "        if bhc:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_poverty\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "        else:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_poverty_ahc\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "    else:\n",
    "        if bhc:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_relative_poverty_bhc\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "        else:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_relative_poverty_ahc\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "\n",
    "    if rate:\n",
    "        return round(in_poverty / population * 100, 1)\n",
    "\n",
    "    else:\n",
    "        return round(in_poverty / 1e3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 2: Absolute poverty before housing costs\n",
       "\n",
       "|   Year |   Autumn EFO rate (%) | Autumn EFO headcount (thousands)   |   Spring EFO rate (%) | Spring EFO headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|----------------------:|:-----------------------------------|----------------------:|:-----------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                  12.5 | 9,125                              |                  12.3 | 8,961                              |                  -0.2 |                              -164 |\n",
       "|   2026 |                  12.3 | 9,025                              |                  12.1 | 8,854                              |                  -0.2 |                              -171 |\n",
       "|   2027 |                  12.3 | 9,113                              |                  12.1 | 8,947                              |                  -0.2 |                              -166 |\n",
       "|   2028 |                  12.3 | 9,101                              |                  12.1 | 8,968                              |                  -0.2 |                              -133 |\n",
       "|   2029 |                  12.4 | 9,206                              |                  12.1 | 9,048                              |                  -0.3 |                              -158 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def get_rate_table(absolute, bhc, i):\n",
    "    years = []\n",
    "    poverty_rates_autumn = []\n",
    "    headcounts_autumn = []\n",
    "    poverty_rates_spring = []\n",
    "    headcounts_spring = []\n",
    "    change_rates = []\n",
    "    change_headcounts = []\n",
    "    for year in range(2025, 2030):\n",
    "        years.append(year)\n",
    "        poverty_rates_autumn.append(\n",
    "            get_poverty(\n",
    "                sim.baseline_simulation, year, absolute, bhc, rate=True\n",
    "            )\n",
    "        )\n",
    "        poverty_rates_spring.append(\n",
    "            get_poverty(sim.reform_simulation, year, absolute, bhc, rate=True)\n",
    "        )\n",
    "        headcounts_autumn.append(\n",
    "            get_poverty(\n",
    "                sim.baseline_simulation, year, absolute, bhc, rate=False\n",
    "            )\n",
    "        )\n",
    "        headcounts_spring.append(\n",
    "            get_poverty(sim.reform_simulation, year, absolute, bhc, rate=False)\n",
    "        )\n",
    "        change_rates.append(\n",
    "            round(poverty_rates_spring[-1] - poverty_rates_autumn[-1], 1)\n",
    "        )\n",
    "        change_headcounts.append(\n",
    "            round(headcounts_spring[-1] - headcounts_autumn[-1], 0)\n",
    "        )\n",
    "\n",
    "    df = pd.DataFrame(\n",
    "        {\n",
    "            \"Year\": years,\n",
    "            \"Autumn EFO rate (%)\": poverty_rates_autumn,\n",
    "            \"Autumn EFO headcount (thousands)\": headcounts_autumn,\n",
    "            \"Spring EFO rate (%)\": poverty_rates_spring,\n",
    "            \"Spring EFO headcount (thousands)\": headcounts_spring,\n",
    "            \"Change in rate (pp)\": change_rates,\n",
    "            \"Change in headcount (thousands)\": change_headcounts,\n",
    "        }\n",
    "    )\n",
    "\n",
    "    for col in df.columns:\n",
    "        if \"thousands\" in col:\n",
    "            df[col] = df[col].apply(add_thousands_separator)\n",
    "\n",
    "    title = \"Absolute poverty\" if absolute else \"Relative poverty\"\n",
    "    title += \" before housing costs\" if bhc else \" after housing costs\"\n",
    "\n",
    "    return Markdown(\n",
    "        f\"Table {i}: {title}\\n\\n\" + df.set_index(\"Year\").to_markdown()\n",
    "    )\n",
    "\n",
    "\n",
    "get_rate_table(absolute=True, bhc=True, i=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 3: Absolute poverty after housing costs\n",
       "\n",
       "|   Year |   Autumn EFO rate (%) | Autumn EFO headcount (thousands)   |   Spring EFO rate (%) | Spring EFO headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|----------------------:|:-----------------------------------|----------------------:|:-----------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                  16.1 | 11,713                             |                  15.6 | 11,372                             |                  -0.5 |                              -341 |\n",
       "|   2026 |                  16.1 | 11,777                             |                  15.4 | 11,329                             |                  -0.7 |                              -448 |\n",
       "|   2027 |                  16.2 | 11,980                             |                  15.6 | 11,529                             |                  -0.6 |                              -451 |\n",
       "|   2028 |                  16.3 | 12,082                             |                  15.6 | 11,607                             |                  -0.7 |                              -475 |\n",
       "|   2029 |                  16.4 | 12,196                             |                  15.7 | 11,682                             |                  -0.7 |                              -514 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rate_table(absolute=True, bhc=False, i=3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 4: Relative poverty after housing costs\n",
       "\n",
       "|   Year |   Autumn EFO rate (%) | Autumn EFO headcount (thousands)   |   Spring EFO rate (%) | Spring EFO headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|----------------------:|:-----------------------------------|----------------------:|:-----------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                  21.4 | 15,569                             |                  21   | 15,312                             |                  -0.4 |                              -257 |\n",
       "|   2026 |                  21.2 | 15,562                             |                  21.3 | 15,633                             |                   0.1 |                                71 |\n",
       "|   2027 |                  21.3 | 15,757                             |                  21.5 | 15,869                             |                   0.2 |                               112 |\n",
       "|   2028 |                  21.3 | 15,821                             |                  21.1 | 15,668                             |                  -0.2 |                              -153 |\n",
       "|   2029 |                  20.9 | 15,548                             |                  21   | 15,661                             |                   0.1 |                               113 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rate_table(absolute=False, bhc=False, i=4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 5: Relative poverty after housing costs\n",
       "\n",
       "|   Year |   Autumn EFO rate (%) | Autumn EFO headcount (thousands)   |   Spring EFO rate (%) | Spring EFO headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|----------------------:|:-----------------------------------|----------------------:|:-----------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                  21.4 | 15,569                             |                  21   | 15,312                             |                  -0.4 |                              -257 |\n",
       "|   2026 |                  21.2 | 15,562                             |                  21.3 | 15,633                             |                   0.1 |                                71 |\n",
       "|   2027 |                  21.3 | 15,757                             |                  21.5 | 15,869                             |                   0.2 |                               112 |\n",
       "|   2028 |                  21.3 | 15,821                             |                  21.1 | 15,668                             |                  -0.2 |                              -153 |\n",
       "|   2029 |                  20.9 | 15,548                             |                  21   | 15,661                             |                   0.1 |                               113 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rate_table(absolute=False, bhc=False, i=5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Inequality\n",
    "\n",
    "We also project income inequality metrics in PolicyEngine's open source model, including the Gini coefficient, the share of income held by the top 10 percent, and the share of income held by the top 1 percent."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 6: Gini coefficient\n",
       "\n",
       "|   Year |   Autumn EFO |   Spring EFO |   Change (pp) |   Change (%) |\n",
       "|-------:|-------------:|-------------:|--------------:|-------------:|\n",
       "|   2025 |         35.3 |         35.7 |           0.4 |          1   |\n",
       "|   2026 |         35.5 |         35.7 |           0.2 |          0.5 |\n",
       "|   2027 |         35.6 |         35.8 |           0.2 |          0.6 |\n",
       "|   2028 |         35.6 |         35.8 |           0.2 |          0.5 |\n",
       "|   2029 |         35.7 |         35.9 |           0.2 |          0.5 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def get_inequality_table(metric, i):\n",
    "    years = []\n",
    "    autumn_values = []\n",
    "    spring_values = []\n",
    "    change_values = []\n",
    "    change_values_pct = []\n",
    "\n",
    "    for year in range(2025, 2030):\n",
    "        if metric == \"Gini coefficient\":\n",
    "            autumn_values.append(\n",
    "                sim.baseline_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).gini()\n",
    "                * 100\n",
    "            )\n",
    "            spring_values.append(\n",
    "                sim.reform_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).gini()\n",
    "                * 100\n",
    "            )\n",
    "        elif metric == \"Top 10% share\":\n",
    "            autumn_values.append(\n",
    "                sim.baseline_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_10_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "            spring_values.append(\n",
    "                sim.reform_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_10_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "        elif metric == \"Top 1% share\":\n",
    "            autumn_values.append(\n",
    "                sim.baseline_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_1_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "            spring_values.append(\n",
    "                sim.reform_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_1_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "        years.append(year)\n",
    "        change_values.append(round(spring_values[-1] - autumn_values[-1], 1))\n",
    "        change_values_pct.append(\n",
    "            round(\n",
    "                (spring_values[-1] - autumn_values[-1])\n",
    "                / autumn_values[-1]\n",
    "                * 100,\n",
    "                1,\n",
    "            )\n",
    "        )\n",
    "\n",
    "    df = pd.DataFrame(\n",
    "        {\n",
    "            \"Year\": years,\n",
    "            \"Autumn EFO\": autumn_values,\n",
    "            \"Spring EFO\": spring_values,\n",
    "            \"Change (pp)\": change_values,\n",
    "            \"Change (%)\": change_values_pct,\n",
    "        }\n",
    "    )\n",
    "\n",
    "    df[\"Autumn EFO\"] = df[\"Autumn EFO\"].round(1)\n",
    "    df[\"Spring EFO\"] = df[\"Spring EFO\"].round(1)\n",
    "\n",
    "    return Markdown(\n",
    "        f\"Table {i}: {metric}\\n\\n\" + df.set_index(\"Year\").to_markdown()\n",
    "    )\n",
    "\n",
    "\n",
    "get_inequality_table(\"Gini coefficient\", i=6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 7: Top 10% share\n",
       "\n",
       "|   Year |   Autumn EFO |   Spring EFO |   Change (pp) |   Change (%) |\n",
       "|-------:|-------------:|-------------:|--------------:|-------------:|\n",
       "|   2025 |         27.2 |         27.3 |           0.2 |          0.6 |\n",
       "|   2026 |         27.5 |         27.7 |           0.2 |          0.8 |\n",
       "|   2027 |         27.5 |         27.7 |           0.2 |          0.6 |\n",
       "|   2028 |         27.6 |         27.8 |           0.1 |          0.5 |\n",
       "|   2029 |         27.8 |         27.8 |          -0.1 |         -0.2 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_inequality_table(\"Top 10% share\", i=7)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 8: Top 1% share\n",
       "\n",
       "|   Year |   Autumn EFO |   Spring EFO |   Change (pp) |   Change (%) |\n",
       "|-------:|-------------:|-------------:|--------------:|-------------:|\n",
       "|   2025 |          7.9 |          8.2 |           0.3 |          3.9 |\n",
       "|   2026 |          8.2 |          8.3 |           0.1 |          1.3 |\n",
       "|   2027 |          8.2 |          8.4 |           0.1 |          1.5 |\n",
       "|   2028 |          8.3 |          8.4 |           0.1 |          1.5 |\n",
       "|   2029 |          8.3 |          8.5 |           0.1 |          1.4 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_inequality_table(\"Top 1% share\", i=8)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Household impacts\n",
    "\n",
    "The OBR forecast change lowers net income for some households and raises it for others, due to households having different compositions of income sources and spending. The chart below shows an extract of a thousand randomly-sampled households from our enhanced Family Resources Survey-based microdata, with the x-axis showing the household's income percentile in 2025 and the y-axis showing the change in net income in 2030 as a result of the forecast change.\n",
    "\n",
    "Figure 1: Change in net income by income percentile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n",
       "    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n",
       "    <link href=\"https://fonts.googleapis.com/css2?family=Roboto+Serif:ital,opsz,wght@0,8..144,100..900;1,8..144,100..900&display=swap\" rel=\"stylesheet\">\n",
       "    "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from policyengine.utils.charts import *\n",
    "\n",
    "add_fonts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.0250177071127051"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sim.reform_simulation.calculate(\n",
    "    \"real_household_net_income\", 2030\n",
    ").mean() / sim.baseline_simulation.calculate(\n",
    "    \"real_household_net_income\", 2030\n",
    ").mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "```plotly\n",
       "{\"data\":[{\"hovertemplate\":\"Percentile=%{x}\\u003cbr\\u003eGain=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#2C6496\",\"opacity\":0.5,\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"x\":[40.0,80.0,35.0,22.0,16.0,42.0,13.0,92.0,14.0,77.0,80.0,25.0,17.0,42.0,44.0,10.0,61.0,75.0,40.0,10.0,100.0,89.0,40.0,16.0,45.0,69.0,27.0,12.0,18.0,55.0,88.0,89.0,93.0,65.0,93.0,21.0,75.0,99.0,88.0,84.0,57.0,34.0,10.0,29.0,76.0,81.0,68.0,20.0,67.0,83.0,35.0,88.0,36.0,47.0,95.0,39.0,48.0,34.0,8.0,60.0,26.0,57.0,84.0,21.0,41.0,6.0,81.0,50.0,47.0,41.0,65.0,80.0,81.0,85.0,84.0,69.0,51.0,32.0,73.0,12.0,91.0,9.0,91.0,49.0,43.0,28.0,55.0,34.0,58.0,25.0,97.0,10.0,53.0,46.0,92.0,44.0,93.0,60.0,14.0,54.0,81.0,8.0,35.0,89.0,29.0,42.0,14.0,61.0,9.0,45.0,47.0,69.0,79.0,84.0,23.0,73.0,99.0,60.0,82.0,50.0,17.0,74.0,96.0,40.0,6.0,47.0,26.0,19.0,95.0,46.0,51.0,92.0,7.0,95.0,32.0,12.0,90.0,36.0,14.0,81.0,21.0,91.0,23.0,73.0,40.0,15.0,71.0,55.0,39.0,7.0,42.0,90.0,60.0,36.0,3.0,38.0,34.0,10.0,37.0,48.0,58.0,43.0,83.0,30.0,92.0,45.0,29.0,8.0,47.0,52.0,21.0,26.0,87.0,52.0,53.0,58.0,91.0,10.0,89.0,4.0,100.0,68.0,73.0,98.0,50.0,67.0,90.0,22.0,24.0,70.0,56.0,64.0,83.0,57.0,84.0,98.0,87.0,45.0,45.0,89.0,11.0,3.0,46.0,38.0,65.0,18.0,42.0,34.0,64.0,38.0,23.0,89.0,55.0,44.0,2.0,31.0,77.0,44.0,89.0,81.0,6.0,1.0,62.0,59.0,31.0,35.0,46.0,73.0,12.0,67.0,35.0,25.0,100.0,6.0,5.0,53.0,79.0,45.0,22.0,5.0,89.0,27.0,35.0,12.0,9.0,4.0,23.0,8.0,91.0,39.0,38.0,3.0,12.0,48.0,85.0,95.0,99.0,83.0,94.0,94.0,70.0,76.0,30.0,54.0,13.0,16.0,26.0,3.0,41.0,12.0,5.0,76.0,99.0,87.0,31.0,85.0,83.0,47.0,6.0,47.0,38.0,22.0,68.0,1.0,61.0,35.0,99.0,48.0,77.0,89.0,17.0,55.0,24.0,38.0,100.0,82.0,63.0,54.0,26.0,100.0,69.0,61.0,17.0,66.0,21.0,24.0,34.0,74.0,100.0,23.0,94.0,42.0,67.0,67.0,74.0,51.0,49.0,53.0,51.0,63.0,49.0,36.0,83.0,41.0,8.0,58.0,45.0,43.0,55.0,51.0,1.0,64.0,35.0,45.0,35.0,63.0,80.0,25.0,46.0,29.0,95.0,50.0,78.0,84.0,3.0,16.0,67.0,85.0,90.0,66.0,91.0,86.0,96.0,83.0,87.0,65.0,81.0,73.0,23.0,54.0,42.0,78.0,68.0,25.0,59.0,91.0,46.0,17.0,19.0,39.0,10.0,38.0,72.0,47.0,69.0,3.0,20.0,51.0,61.0,36.0,10.0,85.0,3.0,73.0,83.0,80.0,39.0,53.0,8.0,50.0,18.0,47.0,63.0,44.0,8.0,59.0,54.0,82.0,96.0,89.0,32.0,70.0,30.0,84.0,85.0,32.0,96.0,79.0,64.0,58.0,51.0,100.0,58.0,37.0,66.0,78.0,17.0,80.0,70.0,41.0,93.0,43.0,64.0,46.0,53.0,87.0,95.0,72.0,88.0,78.0,58.0,4.0,90.0,49.0,54.0,5.0,15.0,85.0,11.0,97.0,42.0,86.0,85.0,47.0,34.0,1.0,85.0,29.0,51.0,76.0,37.0,11.0,31.0,50.0,78.0,12.0,37.0,21.0,49.0,4.0,60.0,32.0,43.0,68.0,94.0,74.0,79.0,100.0,4.0,65.0,35.0,76.0,69.0,23.0,64.0,39.0,72.0,46.0,6.0,87.0,90.0,4.0,51.0,12.0,50.0,45.0,7.0,67.0,100.0,47.0,38.0,12.0,25.0,96.0,85.0,86.0,45.0,92.0,84.0,54.0,35.0,32.0,93.0,85.0,98.0,88.0,15.0,92.0,54.0,12.0,47.0,33.0,66.0,91.0,18.0,3.0,77.0,87.0,63.0,75.0,8.0,85.0,52.0,63.0,70.0,84.0,25.0,97.0,92.0,82.0,56.0,66.0,36.0,87.0,54.0,40.0,20.0,7.0,77.0,60.0,36.0,24.0,46.0,94.0,55.0,48.0,14.0,6.0,42.0,78.0,17.0,49.0,1.0,11.0,86.0,53.0,99.0,12.0,95.0,89.0,98.0,67.0,71.0,51.0,60.0,87.0,70.0,72.0,45.0,53.0,75.0,13.0,59.0,99.0,59.0,18.0,92.0,83.0,53.0,27.0,80.0,86.0,82.0,25.0,6.0,63.0,100.0,29.0,71.0,86.0,60.0,69.0,97.0,95.0,26.0,72.0,49.0,94.0,46.0,29.0,71.0,2.0,47.0,62.0,58.0,98.0,5.0,51.0,44.0,89.0,94.0,35.0,30.0,35.0,85.0,41.0,82.0,14.0,29.0,49.0,65.0,31.0,79.0,52.0,98.0,38.0,49.0,62.0,93.0,52.0,73.0,34.0,56.0,64.0,61.0,81.0,69.0,74.0,73.0,100.0,35.0,38.0,32.0,6.0,30.0,77.0,43.0,85.0,38.0,52.0,89.0,42.0,44.0,82.0,5.0,61.0,72.0,92.0,63.0,87.0,78.0,65.0,81.0,39.0,66.0,47.0,27.0,91.0,74.0,98.0,44.0,68.0,58.0,51.0,38.0,66.0,73.0,72.0,96.0,77.0,89.0,6.0,50.0,52.0,36.0,71.0,93.0,12.0,86.0,30.0,50.0,72.0,81.0,36.0,70.0,76.0,24.0,82.0,71.0,17.0,97.0,36.0,95.0,1.0,95.0,64.0,34.0,80.0,1.0,6.0,56.0,50.0,61.0,29.0,95.0,80.0,60.0,63.0,64.0,88.0,97.0,98.0,96.0,50.0,37.0,68.0,11.0,68.0,34.0,78.0,74.0,82.0,49.0,81.0,52.0,4.0,40.0,50.0,54.0,90.0,12.0,42.0,92.0,53.0,50.0,44.0,100.0,78.0,60.0,41.0,50.0,29.0,98.0,24.0,66.0,47.0,43.0,60.0,66.0,37.0,100.0,1.0,35.0,100.0,71.0,54.0,4.0,51.0,91.0,17.0,67.0,50.0,53.0,73.0,71.0,45.0,43.0,8.0,10.0,33.0,45.0,46.0,25.0,76.0,45.0,56.0,84.0,24.0,79.0,46.0,85.0,14.0,53.0,24.0,71.0,94.0,34.0,93.0,55.0,35.0,79.0,70.0,47.0,2.0,47.0,83.0,59.0,73.0,11.0,44.0,97.0,60.0,13.0,24.0,40.0,91.0,14.0,3.0,95.0,38.0,78.0,75.0,10.0,46.0,1.0,49.0,79.0,79.0,74.0,48.0,25.0,82.0,64.0,90.0,52.0,47.0,92.0,98.0,83.0,77.0,3.0,79.0,36.0,34.0,13.0,45.0,88.0,89.0,99.0,61.0,97.0,34.0,35.0,14.0,54.0,69.0,38.0,83.0,61.0,64.0,60.0,5.0,3.0,51.0,17.0,3.0,34.0,6.0,46.0,41.0,36.0,90.0,55.0,50.0,43.0,13.0,44.0,61.0,6.0,40.0,58.0,50.0,65.0,49.0,45.0,54.0,88.0,95.0,49.0,40.0,23.0,20.0,4.0,83.0,89.0,25.0,38.0,96.0,97.0,9.0,36.0,78.0,74.0,12.0,83.0,86.0,26.0,2.0,58.0,70.0,70.0,100.0,5.0,23.0,1.0,34.0,54.0,4.0,1.0,10.0,3.0,58.0,89.0,69.0,97.0,90.0,91.0,12.0,87.0,12.0,72.0,17.0,80.0,51.0,83.0,40.0,72.0,83.0,74.0,98.0,64.0,94.0,95.0,74.0,42.0,2.0,52.0,25.0,18.0,87.0,99.0,5.0,58.0,20.0,15.0,33.0,62.0,51.0,90.0,87.0,49.0,41.0,59.0,32.0,68.0,94.0,73.0,87.0,88.0,3.0,11.0,85.0,40.0,41.0,5.0,53.0,99.0,86.0,42.0,16.0,96.0,8.0,61.0,62.0,41.0,8.0,4.0,86.0,46.0,12.0,18.0,9.0,72.0,75.0,99.0,32.0,38.0,41.0,75.0,76.0],\"xaxis\":\"x\",\"y\":[1069.958984375,1519.14453125,336.826171875,419.408203125,348.787109375,770.21484375,233.7626953125,2061.0703125,621.4736328125,1303.796875,1346.4375,470.984375,421.134765625,796.12890625,776.958984375,725.6123046875,212.51171875,881.84765625,250.16015625,-43.9033203125,12807.0625,1682.5078125,364.548828125,86.537109375,261.92578125,1612.05859375,660.388671875,194.84375,429.208984375,897.3828125,1791.0078125,2376.4765625,2922.7109375,1453.78515625,2088.515625,487.60546875,1430.5625,7533.65625,1453.8828125,2163.21875,1150.8828125,667.88671875,218.6005859375,63.064453125,1813.15234375,2340.9609375,1557.3359375,656.021484375,1390.69921875,1550.0,141.236328125,1880.3671875,883.5,935.55859375,2474.875,257.458984375,891.7890625,604.9296875,25.822265625,1052.69921875,207.646484375,1205.8984375,1651.59375,429.302734375,451.271484375,298.9619140625,1685.27734375,681.62890625,814.5859375,1537.37109375,1471.94140625,1371.1640625,1354.59765625,1628.0625,1636.9296875,174.47265625,79.72265625,720.326171875,1983.19921875,133.4248046875,1790.734375,307.0947265625,2128.4609375,684.6875,104.486328125,693.541015625,99.00390625,344.16796875,831.16015625,546.216796875,3061.125,305.17578125,878.2109375,1246.63671875,2001.8125,967.931640625,2691.0234375,1282.06640625,511.0498046875,1105.3203125,1455.23046875,597.1298828125,746.92578125,2871.25,114.443359375,754.8046875,669.458984375,1027.23828125,376.5439453125,593.48828125,862.484375,391.09375,1524.1953125,1662.9609375,40.845703125,1728.2265625,4598.84375,900.7421875,1708.20703125,370.796875,88.30859375,1134.95703125,2910.7265625,200.697265625,184.0634765625,712.4140625,456.13671875,403.638671875,2458.78125,668.3671875,355.609375,1585.8046875,343.8935546875,2436.828125,608.1171875,278.96484375,1999.53125,802.45703125,348.95703125,2070.97265625,660.3828125,2406.5,99.505859375,1584.28515625,1923.23828125,210.1875,1202.8125,76.38671875,346.3515625,195.67578125,724.8671875,1427.8046875,235.86328125,962.357421875,-126.1552734375,850.529296875,609.2890625,261.2490234375,149.00390625,989.20703125,338.72265625,803.73046875,1585.140625,162.4296875,2062.546875,821.865234375,590.90625,358.5654296875,956.28515625,627.640625,696.0078125,651.984375,1824.6015625,441.7890625,1215.05859375,831.328125,1713.0625,494.962890625,1692.5546875,20.79296875,8098.59375,1161.25390625,1370.7421875,3121.171875,1456.58984375,1834.046875,2700.640625,99.46875,103.36328125,1843.609375,953.1640625,1386.75,1548.078125,958.625,1001.8984375,3722.3125,1820.1484375,628.12890625,1015.958984375,1542.7578125,454.90234375,-21.08837890625,122.115234375,555.533203125,1466.67578125,328.107421875,738.24609375,19.16015625,454.40625,258.89453125,600.115234375,1956.984375,286.3515625,1342.23828125,656.197021484375,794.5078125,2881.74609375,707.392578125,1915.3515625,1567.82421875,15.98828125,-7.460693359375,907.59765625,991.2265625,697.337890625,76.189453125,651.671875,2304.51953125,228.5634765625,1156.49609375,1161.873046875,409.275390625,7784.4375,212.994140625,198.4765625,1034.5,1710.41796875,111.4921875,727.2734375,-16.0029296875,2658.4296875,210.177734375,103.486328125,292.3623046875,412.529296875,34.326171875,62.349609375,885.666015625,2243.5,376.244140625,833.830078125,-104.48583984375,241.6337890625,675.265625,1911.7578125,2454.34375,4511.234375,1563.53125,2370.8671875,1915.1640625,1418.3203125,1569.1953125,544.6328125,899.1953125,360.75390625,238.505859375,527.0390625,35.30810546875,489.5703125,151.8583984375,198.7529296875,1633.62109375,4998.09375,1562.3515625,97.765625,2428.6640625,1681.4609375,1271.16796875,174.4736328125,729.578125,1148.939453125,72.767578125,1676.2578125,-38.53271484375,1095.99609375,622.94921875,3601.3125,266.484375,1543.9296875,1360.3046875,107.775390625,1167.3515625,224.408203125,497.263671875,47962.5,1706.28125,1076.5078125,554.203125,64.689453125,8212.78125,923.23828125,1100.953125,89.875,1232.73046875,195.982421875,65.302734375,645.458984375,1448.5390625,14919.1875,101.5,2278.984375,1080.302734375,971.22265625,866.6171875,1930.484375,962.609375,1316.17578125,414.546875,1201.00390625,1092.46484375,871.73828125,104.3515625,1481.6640625,737.330078125,285.064453125,209.66796875,826.865234375,1051.33984375,1307.578125,1068.1015625,4.09832763671875,257.51953125,132.15625,823.771484375,30.142578125,1182.3046875,1907.41015625,186.517578125,780.01171875,64.744140625,2275.3359375,1750.4609375,1537.69921875,1464.2890625,194.2333984375,124.890625,1401.5078125,2188.078125,1451.8515625,1124.15625,2025.7265625,2533.9375,1743.234375,2013.9921875,2213.4140625,1093.60546875,1424.8203125,1381.80078125,112.0234375,339.66796875,1106.6328125,2241.80078125,820.1328125,598.78125,581.69140625,1841.671875,766.763671875,216.23046875,651.619140625,703.689453125,278.529296875,106.51171875,1284.26953125,888.78515625,1401.74609375,8.201171875,505.4140625,1146.1796875,1399.51953125,69.953125,584.91015625,1599.3828125,194.46240234375,1283.90625,1229.46875,1494.5546875,402.4609375,1253.21875,287.2099609375,943.0078125,440.947265625,87.578125,1491.00390625,764.580078125,287.4326171875,1246.09375,715.32421875,1499.8359375,2941.1171875,2693.1171875,109.201171875,1888.5390625,66.8359375,1630.625,1631.078125,43.783203125,3977.78125,1518.1484375,1644.4453125,1178.7109375,92.1875,6187.21875,100.8359375,657.419921875,836.47265625,1828.3984375,419.455078125,1458.17578125,1247.015625,236.7578125,2376.4140625,1094.35546875,1258.51953125,856.240234375,906.15625,2023.9921875,2035.3046875,1393.6171875,1911.5859375,1403.84375,469.35546875,-6.65625,2041.0859375,1051.26171875,316.97265625,36.0068359375,72.880859375,1805.3203125,413.166015625,3071.6171875,549.107421875,2121.4765625,1700.609375,737.97265625,611.71484375,211.12890625,1646.046875,549.640625,845.49609375,1518.5234375,824.244140625,10.5810546875,213.69921875,870.20703125,1370.24609375,342.8720703125,183.744140625,52.16015625,1072.82421875,41.68994140625,1822.43359375,628.115234375,1353.869140625,2306.6171875,2493.25,1316.2265625,1621.16796875,7649.28125,25.7509765625,509.2265625,626.640625,1476.8515625,727.67578125,187.05859375,845.15625,855.966796875,604.6328125,889.556640625,374.8369140625,2412.5703125,1708.7734375,37.26806640625,1155.6640625,544.0830078125,925.421875,953.552734375,36.6845703125,482.6171875,24347.25,1060.8046875,756.54296875,81.01171875,491.396484375,2879.0859375,1717.359375,1925.4609375,805.865234375,1837.609375,2407.1796875,906.37109375,872.890625,750.412109375,2110.3984375,1425.125,3249.25,1974.7421875,433.732421875,2412.359375,1109.88671875,80.287109375,865.765625,518.763671875,1046.83984375,1956.2578125,727.919921875,-6.35498046875,1237.86328125,1921.9765625,889.66015625,1028.4375,218.8486328125,1425.578125,908.0,940.6015625,1254.62890625,1874.1484375,621.419921875,3713.7578125,1684.5546875,1648.8984375,69.22265625,980.0859375,256.44921875,1775.90625,874.00390625,847.40625,823.0390625,217.232421875,1512.62109375,851.7578125,297.169921875,105.525390625,30.02734375,1938.4921875,38.21484375,896.53515625,332.6220703125,208.1689453125,28.962890625,1539.21875,279.45703125,1159.16796875,203.00390625,546.8623046875,1848.1171875,1090.25,5850.375,50.822265625,1790.328125,1571.5546875,2808.578125,1298.0859375,1554.046875,900.00390625,916.4140625,1603.3671875,1319.015625,1637.06640625,828.568359375,748.1875,1706.7109375,253.634765625,542.62109375,2885.5625,1105.03515625,217.2890625,2197.5078125,1295.3046875,1290.7265625,39.91796875,2110.29296875,2115.3515625,1554.65625,553.212890625,116.4501953125,941.63671875,11420.21875,419.259765625,1226.46875,1942.40625,419.0,1287.16796875,3232.9375,2904.96875,69.96484375,1077.27734375,418.37109375,2183.84375,818.12109375,536.396484375,924.2734375,531.8564453125,1081.99609375,1556.22265625,939.15234375,4471.15625,173.814453125,266.20703125,246.638671875,2002.625,2316.8125,595.638671875,99.404296875,12.716796875,1885.71875,717.13671875,1504.671875,7.7744140625,724.611328125,83.09375,1261.1875,77.4140625,1716.07421875,712.28515625,3724.390625,31.623046875,1012.65625,860.84765625,2708.578125,1051.62890625,1770.8515625,15.73046875,1586.21875,1111.05078125,1132.8671875,1450.5,1387.2109375,1450.671875,1405.89453125,7419.859375,1110.73828125,451.109375,70.52734375,236.4111328125,97.208984375,1297.40625,1045.404296875,1382.0625,80.884765625,1305.07421875,1696.2734375,768.931640625,798.5546875,1883.4453125,200.921875,558.203125,129.84765625,1982.625,1714.984375,1626.515625,1523.28125,870.88671875,1855.72265625,1164.87890625,1205.515625,297.18359375,457.642578125,1723.0859375,1432.3515625,4331.09375,804.84375,1243.80859375,1046.52734375,376.84375,778.126953125,1153.92578125,1072.1796875,1611.1953125,4170.5390625,1313.25390625,2095.3828125,215.2978515625,696.875,1068.31640625,656.88671875,1711.5234375,1831.734375,573.4873046875,1969.0234375,65.125,393.98046875,1087.91796875,1801.56640625,1064.755859375,1551.13671875,597.25,56.830078125,1350.484375,1385.77734375,63.625,2731.8984375,616.21875,2864.6328125,-6.89599609375,2036.96875,1524.9921875,430.708984375,2013.41015625,-14.941650390625,503.3515625,969.67578125,865.14453125,1078.17578125,38.9921875,2105.9296875,1622.765625,1449.8203125,1371.24609375,1087.55859375,1827.921875,2290.15625,3644.0,2485.15625,892.9921875,240.998046875,1202.62109375,207.970703125,2237.7109375,625.126953125,1579.01953125,1381.84765625,1565.390625,701.91015625,1991.8671875,815.93359375,16.6728515625,886.544921875,868.7109375,1444.7734375,1979.7421875,228.4794921875,1285.9765625,2171.546875,1076.53125,914.51171875,295.48046875,8061.625,1999.69921875,1077.4765625,751.3359375,956.51953125,370.123046875,3402.953125,290.04296875,1273.3046875,330.10546875,320.7421875,8631.86328125,966.625,566.818359375,25967.875,107.24462890625,740.5234375,15094.25,1368.1796875,1149.5546875,50.671875,818.91015625,1720.984375,39.65625,1060.3125,984.12890625,1080.46875,1456.9609375,1295.0234375,481.732421875,721.40625,399.1396484375,240.8193359375,599.701171875,819.048828125,628.25390625,502.25390625,1450.71484375,357.380859375,1359.26171875,1649.515625,54.109375,1607.11328125,174.78125,1685.515625,408.96484375,708.8515625,450.126953125,1354.71875,2030.0546875,804.259765625,2152.0859375,1111.91796875,572.58984375,2007.3046875,1317.453125,839.16796875,9.5875244140625,863.078125,1617.6796875,1522.0078125,1058.96875,-11.6240234375,826.416015625,3312.0,980.65234375,298.4951171875,476.861328125,762.78125,1741.15625,50.470703125,-17.48828125,2700.6875,1002.966796875,1853.15234375,460.375,306.064453125,459.453125,-8.868408203125,913.4921875,1634.21484375,1354.4375,1322.19140625,926.046875,525.56640625,1647.984375,1488.828125,1924.75,1478.9921875,1286.01171875,2067.46875,3273.234375,1709.546875,1615.6484375,344.28662109375,1941.43359375,849.9375,626.48046875,150.083984375,919.47265625,1804.015625,1861.2421875,3970.1875,1039.3671875,3817.953125,620.5234375,97.880859375,387.34765625,2071.3828125,1548.20703125,801.16796875,1933.7734375,803.37890625,1222.87890625,1086.1953125,25.7333984375,15.8857421875,1292.0546875,90.958984375,-11.09130859375,149.919921875,315.96875,931.7109375,548.193359375,208.685546875,1813.65625,1292.98828125,932.6171875,732.8359375,471.9033203125,1037.583984375,855.6484375,171.341796875,88.302734375,1213.671875,377.48828125,1182.86328125,658.44921875,816.15625,750.63671875,2433.84375,2139.828125,48.5078125,746.484375,476.630859375,235.458984375,281.33984375,1571.390625,1901.578125,52.978515625,660.16015625,2348.7734375,2813.21875,355.0859375,737.556640625,1597.390625,957.3828125,533.0732421875,1697.4140625,2106.03125,541.97265625,132.682861328125,1051.8359375,1692.55078125,1399.26171875,22337.1875,234.3544921875,445.279296875,-137.501953125,743.169921875,936.09375,-19.16162109375,1011.0869140625,413.5537109375,181.03515625,1717.01171875,1769.15625,1363.7890625,2787.0703125,1800.7421875,2516.8671875,326.205078125,1962.1875,349.9384765625,1880.08984375,461.3984375,1109.31640625,139.328125,2123.4609375,156.798828125,2045.16796875,1300.3046875,1356.53515625,5171.5078125,1161.23828125,2140.890625,1875.3984375,2460.90234375,1117.2421875,-12.7728271484375,1051.85546875,69.5546875,438.220703125,2011.6171875,6243.78125,50.0341796875,1329.80859375,93.876953125,947.939453125,632.990234375,1120.37109375,851.609375,1834.640625,1501.6328125,327.45703125,181.03125,974.95703125,623.453125,1276.75,3261.2578125,1143.21875,1903.59375,1857.0546875,83.65673828125,353.361328125,1645.0859375,786.220703125,736.212890625,300.7578125,1361.46484375,3983.609375,1597.1015625,852.08203125,32.025390625,2150.4765625,394.1337890625,1091.390625,929.76953125,685.060546875,25.228515625,27.576171875,3199.7578125,563.984375,359.33203125,731.50390625,255.88671875,1594.26171875,1245.453125,4006.640625,99.095703125,375.181640625,747.865234375,104.75,498.28125],\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Percentile\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Change in net income (\\u00a3)\"},\"range\":[-5000,5000],\"tickformat\":\",.0f\"},\"legend\":{\"tracegroupgap\":0},\"margin\":{\"t\":100,\"l\":50,\"r\":50,\"b\":100,\"pad\":4},\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"title\":{\"text\":\"OBR forecast change impact on households by percentile\"},\"showlegend\":false,\"annotations\":[{\"font\":{\"color\":\"#616161\",\"family\":\"Roboto Serif\",\"size\":10},\"showarrow\":false,\"text\":\"Source: PolicyEngine UK\",\"x\":1,\"xref\":\"paper\",\"y\":-0.25,\"yref\":\"paper\"}],\"images\":[{\"sizex\":0.1,\"sizey\":0.1,\"source\":\"\/assets/logos/policyengine/teal-square.png\",\"x\":1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"shapes\":[{\"line\":{\"color\":\"#616161\",\"dash\":\"solid\",\"width\":2},\"type\":\"line\",\"x0\":0,\"x1\":100,\"y0\":0,\"y1\":0}]}}\n",
       "```"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.DataFrame()\n",
    "df[\"weight\"] = sim.baseline_simulation.calculate(\n",
    "    \"household_weight\", 2030\n",
    ").values\n",
    "df[\"Gain\"] = (\n",
    "    sim.reform_simulation.calculate(\"real_household_net_income\", 2030).values\n",
    "    - sim.baseline_simulation.calculate(\n",
    "        \"real_household_net_income\", 2030\n",
    "    ).values\n",
    ")\n",
    "df[\"Percentile\"] = (\n",
    "    sim.baseline_simulation.calculate(\"real_household_net_income\", 2030)\n",
    "    .percentile_rank()\n",
    "    .values\n",
    ")\n",
    "\n",
    "import plotly.express as px\n",
    "\n",
    "fig = px.scatter(\n",
    "    df.sample(weights=\"weight\", n=1_000, random_state=1),\n",
    "    x=\"Percentile\",\n",
    "    y=\"Gain\",\n",
    "    color_discrete_sequence=[BLUE],\n",
    "    opacity=0.5,\n",
    ").update_layout(\n",
    "    title=\"OBR forecast change impact on households by percentile\",\n",
    "    xaxis_title=\"Percentile\",\n",
    "    yaxis_title=\"Change in net income (£)\",\n",
    "    showlegend=False,\n",
    "    font=dict(family=\"Roboto Serif\"),\n",
    "    font_color=\"black\",\n",
    "    yaxis_range=[-5_000, 5_000],\n",
    "    yaxis_tickformat=\",.0f\",\n",
    "    margin={\"l\": 50, \"r\": 50, \"b\": 100, \"t\": 100, \"pad\": 4},\n",
    "    annotations=[\n",
    "        {\n",
    "            \"x\": 1,\n",
    "            \"y\": -0.25,\n",
    "            \"xref\": \"paper\",\n",
    "            \"yref\": \"paper\",\n",
    "            \"text\": \"Source: PolicyEngine UK\",\n",
    "            \"showarrow\": False,\n",
    "            \"font\": {\"family\": \"Roboto Serif\", \"size\": 10, \"color\": \"#616161\"},\n",
    "        }\n",
    "    ],\n",
    "    images=[\n",
    "        {\n",
    "            \"source\": \"/assets/logos/policyengine/teal-square.png\",\n",
    "            \"x\": 1,\n",
    "            \"y\": -0.20,\n",
    "            \"xref\": \"paper\",\n",
    "            \"yref\": \"paper\",\n",
    "            \"sizex\": 0.1,\n",
    "            \"sizey\": 0.1,\n",
    "            \"xanchor\": \"right\",\n",
    "            \"yanchor\": \"bottom\",\n",
    "        }\n",
    "    ],\n",
    ")\n",
    "\n",
    "# Add zero line\n",
    "\n",
    "fig.add_shape(\n",
    "    type=\"line\",\n",
    "    x0=0,\n",
    "    y0=0,\n",
    "    x1=100,\n",
    "    y1=0,\n",
    "    line=dict(\n",
    "        color=DARK_GRAY,\n",
    "        width=2,\n",
    "        dash=\"solid\",\n",
    "    ),\n",
    ")\n",
    "\n",
    "Markdown(f\"```plotly\\n{fig.to_json()}\\n```\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Impact by income decile\n",
    "\n",
    "The chart below shows the relative change in income held by each 2030 household income decile, as a result of the change in the OBR forecast.\n",
    "\n",
    "Figure 2: Change in income by income decile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "```plotly\n",
       "{\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"Income decile=%{x}\\u003cbr\\u003eRelative change=%{y}\\u003cbr\\u003eText=%{text}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#2C6496\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"text\":[\"1.9%\",\"2.0%\",\"2.0%\",\"2.3%\",\"2.0%\",\"2.5%\",\"2.5%\",\"2.6%\",\"2.4%\",\"3.1%\"],\"textposition\":\"auto\",\"x\":[1,2,3,4,5,6,7,8,9,10],\"xaxis\":\"x\",\"y\":[0.019247149326981478,0.02023357590682839,0.020460483075160386,0.02286974072878526,0.019911543407832855,0.024777099660026773,0.02477875671690137,0.025885340736588137,0.024425674721593793,0.03068977979172698],\"yaxis\":\"y\",\"type\":\"bar\"}],\"layout\":{\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Income decile\"},\"tickvals\":[1,2,3,4,5,6,7,8,9,10]},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Relative change\"},\"tickformat\":\".0%\"},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"OBR forecast change impact on 2030 net income by income decile\"},\"barmode\":\"relative\",\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"margin\":{\"l\":50,\"r\":50,\"b\":100,\"t\":100,\"pad\":4},\"showlegend\":false,\"annotations\":[{\"font\":{\"color\":\"#616161\",\"family\":\"Roboto Serif\",\"size\":10},\"showarrow\":false,\"text\":\"Source: PolicyEngine UK\",\"x\":1,\"xref\":\"paper\",\"y\":-0.25,\"yref\":\"paper\"}],\"images\":[{\"sizex\":0.1,\"sizey\":0.1,\"source\":\"\/assets/logos/policyengine/teal-square.png\",\"x\":1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}]}}\n",
       "```"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "decile = sim.baseline_simulation.calculate(\"household_income_decile\", 2030)\n",
    "income = sim.baseline_simulation.calculate(\"real_household_net_income\", 2030)\n",
    "gain = sim.reform_simulation.calculate(\n",
    "    \"real_household_net_income\", 2030\n",
    ") - sim.baseline_simulation.calculate(\"real_household_net_income\", 2030)\n",
    "aggregate_change_by_decile = gain.groupby(decile).sum()\n",
    "relative_change_by_decile = (\n",
    "    gain.groupby(decile).sum() / income.groupby(decile).sum()\n",
    ")\n",
    "\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Aggregate change\": aggregate_change_by_decile.values,\n",
    "        \"Relative change\": relative_change_by_decile.values,\n",
    "        \"Income decile\": aggregate_change_by_decile.index,\n",
    "    }\n",
    ")\n",
    "df = df[df[\"Income decile\"] > 0]\n",
    "df[\"Text\"] = df[\"Relative change\"].apply(lambda x: f\"{x:.1%}\")\n",
    "\n",
    "fig = px.bar(\n",
    "    df,\n",
    "    x=\"Income decile\",\n",
    "    y=\"Relative change\",\n",
    "    text=\"Text\",\n",
    "    color_discrete_sequence=[BLUE],\n",
    "    labels={\n",
    "        \"Aggregate change\": \"Change in net income (£)\",\n",
    "        \"Income decile\": \"Income decile\",\n",
    "    },\n",
    "    title=\"OBR forecast change impact on 2030 net income by income decile\",\n",
    ").update_layout(\n",
    "    font=dict(family=\"Roboto Serif\"),\n",
    "    yaxis_tickformat=\".0%\",\n",
    "    xaxis_title=\"Income decile\",\n",
    "    xaxis_tickvals=list(range(1, 11)),\n",
    "    showlegend=False,\n",
    "    font_color=\"black\",\n",
    "    margin={\"l\": 50, \"r\": 50, \"b\": 100, \"t\": 100, \"pad\": 4},\n",
    "    annotations=[\n",
    "        {\n",
    "            \"x\": 1,\n",
    "            \"y\": -0.25,\n",
    "            \"xref\": \"paper\",\n",
    "            \"yref\": \"paper\",\n",
    "            \"text\": \"Source: PolicyEngine UK\",\n",
    "            \"showarrow\": False,\n",
    "            \"font\": {\"family\": \"Roboto Serif\", \"size\": 10, \"color\": \"#616161\"},\n",
    "        }\n",
    "    ],\n",
    "    images=[\n",
    "        {\n",
    "            \"source\": \"/assets/logos/policyengine/teal-square.png\",\n",
    "            \"x\": 1,\n",
    "            \"y\": -0.20,\n",
    "            \"xref\": \"paper\",\n",
    "            \"yref\": \"paper\",\n",
    "            \"sizex\": 0.1,\n",
    "            \"sizey\": 0.1,\n",
    "            \"xanchor\": \"right\",\n",
    "            \"yanchor\": \"bottom\",\n",
    "        }\n",
    "    ],\n",
    ")\n",
    "Markdown(f\"```plotly\\n{fig.to_json()}\\n```\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Households by beneficiary status\n",
    "\n",
    "The ONS [reports](https://www.ons.gov.uk/peoplepopulationandcommunity/personalandhouseholdfinances/incomeandwealth/bulletins/theeffectsoftaxesandbenefitsonhouseholdincome/financialyearending2023) on its self-defined net recipient rate. This is the percentage of households that receive more in (cash and in-kind) benefits than they pay in taxes.\n",
    "\n",
    "The table below shows the change in a similar measure, defined as the percentage of households that receive more in cash benefits than they pay in taxes, as a result of the forecast change."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 9: Net recipients by forecast \n",
       "\n",
       "|   Year |   Net recipients rate (%) (Autumn 2024) |   Net recipients rate (%) (Spring 2025) |   Change in rate (pp) |   Net recipients (Autumn 2024) (m) |   Net recipients (Spring 2025) (m) |   Change in net recipients (k) |\n",
       "|-------:|----------------------------------------:|----------------------------------------:|----------------------:|-----------------------------------:|-----------------------------------:|-------------------------------:|\n",
       "|   2025 |                                    45.4 |                                    44.9 |                  -0.5 |                               30.2 |                               29.8 |                           -462 |\n",
       "|   2026 |                                    45.3 |                                    44.9 |                  -0.3 |                               30.5 |                               30.2 |                           -316 |\n",
       "|   2027 |                                    45.1 |                                    44.7 |                  -0.4 |                               30.6 |                               30.2 |                           -379 |\n",
       "|   2028 |                                    44.9 |                                    44.6 |                  -0.3 |                               30.5 |                               30.3 |                           -253 |\n",
       "|   2029 |                                    44.8 |                                    44.5 |                  -0.3 |                               30.5 |                               30.2 |                           -254 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "years = []\n",
    "net_recipients_rate_a = []\n",
    "net_recipients_rate_s = []\n",
    "net_recipients_people_a = []\n",
    "net_recipients_people_s = []\n",
    "change_rate = []\n",
    "change_people = []\n",
    "\n",
    "for year in range(2025, 2030):\n",
    "    years.append(year)\n",
    "    net_recipients_rate_a.append(\n",
    "        (\n",
    "            sim.baseline_simulation.calculate(\"household_benefits\", year)\n",
    "            > sim.baseline_simulation.calculate(\"household_tax\", year)\n",
    "        ).mean()\n",
    "    )\n",
    "    net_recipients_rate_s.append(\n",
    "        (\n",
    "            sim.reform_simulation.calculate(\"household_benefits\", year)\n",
    "            > sim.reform_simulation.calculate(\"household_tax\", year)\n",
    "        ).mean()\n",
    "    )\n",
    "    change_rate.append(net_recipients_rate_s[-1] - net_recipients_rate_a[-1])\n",
    "    net_recipients_people_a.append(\n",
    "        (\n",
    "            sim.baseline_simulation.calculate(\n",
    "                \"household_benefits\", year, map_to=\"person\"\n",
    "            )\n",
    "            > sim.baseline_simulation.calculate(\n",
    "                \"household_tax\", year, map_to=\"person\"\n",
    "            )\n",
    "        ).sum()\n",
    "    )\n",
    "    net_recipients_people_s.append(\n",
    "        (\n",
    "            sim.reform_simulation.calculate(\n",
    "                \"household_benefits\", year, map_to=\"person\"\n",
    "            )\n",
    "            > sim.reform_simulation.calculate(\n",
    "                \"household_tax\", year, map_to=\"person\"\n",
    "            )\n",
    "        ).sum()\n",
    "    )\n",
    "    change_people.append(\n",
    "        net_recipients_people_s[-1] - net_recipients_people_a[-1]\n",
    "    )\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Year\": years,\n",
    "        \"Net recipients rate (%) (Autumn 2024)\": net_recipients_rate_a,\n",
    "        \"Net recipients rate (%) (Spring 2025)\": net_recipients_rate_s,\n",
    "        \"Change in rate (pp)\": change_rate,\n",
    "        \"Net recipients (Autumn 2024) (m)\": net_recipients_people_a,\n",
    "        \"Net recipients (Spring 2025) (m)\": net_recipients_people_s,\n",
    "        \"Change in net recipients (k)\": change_people,\n",
    "    }\n",
    ")\n",
    "\n",
    "df[\"Net recipients rate (%) (Autumn 2024)\"] = df[\n",
    "    \"Net recipients rate (%) (Autumn 2024)\"\n",
    "].apply(lambda x: f\"{x*100:.1f}\")\n",
    "df[\"Net recipients rate (%) (Spring 2025)\"] = df[\n",
    "    \"Net recipients rate (%) (Spring 2025)\"\n",
    "].apply(lambda x: f\"{x*100:.1f}\")\n",
    "df[\"Change in rate (pp)\"] = df[\"Change in rate (pp)\"].apply(\n",
    "    lambda x: f\"{x*100:.1f}\"\n",
    ")\n",
    "\n",
    "df[\"Net recipients (Autumn 2024) (m)\"] = df[\n",
    "    \"Net recipients (Autumn 2024) (m)\"\n",
    "].apply(lambda x: f\"{x/1e6:,.1f}\")\n",
    "df[\"Net recipients (Spring 2025) (m)\"] = df[\n",
    "    \"Net recipients (Spring 2025) (m)\"\n",
    "].apply(lambda x: f\"{x/1e6:,.1f}\")\n",
    "df[\"Change in net recipients (k)\"] = df[\"Change in net recipients (k)\"].apply(\n",
    "    lambda x: f\"{x/1e3:,.0f}\"\n",
    ")\n",
    "\n",
    "\n",
    "Markdown(\n",
    "    f\"Table 9: Net recipients by forecast \\n\\n\"\n",
    "    + df.set_index(\"Year\").to_markdown()\n",
    ")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# HM Treasury pilots PolicyEngine UK for tax-benefit microsimulation
Slug: hmt-policyengine-pilot
Date: 2025-03-24
Authors: Nikhil Woodruff
Tags: uk, impact, featured
Description: The UK government's finance ministry explores PolicyEngine as a potential supplement to existing models.

---

The UK's HM Treasury has explored using PolicyEngine UK as a potential supplement to their existing tax-benefit models, marking a significant milestone in the recognition of PolicyEngine's accuracy and utility at the highest levels of government.

According to a [recently published Algorithmic Transparency Record](https://www.gov.uk/algorithmic-transparency-records/hmt-modelling-policy-engine) from December 17, 2024, HM Treasury's Personal Tax, Welfare and Pensions team conducted a beta/pilot evaluation of PolicyEngine UK to assess its capabilities in microsimulating tax and benefit policy changes.

The Treasury record notes that PolicyEngine UK "uses machine learning and gradient descent methods to tackle two key sources of error in household survey data typically used for modelling tax and welfare policies: under-sampling of certain demographics of households or individuals, and measurement errors such as underreporting of income and benefits."

HM Treasury explored the scope for "making greater use of this model for advising policymakers on the impact of tax and welfare measures on households, supplementing the existing models used for this (such as the Intra-Governmental Tax and Benefit Microsimulation model – IGOTM)."
Media coverage of this pilot appeared in [The Times](https://www.thetimes.co.uk/uk/politics/article/how-civil-servants-really-use-ai-from-lesson-plans-to-recruitment-k8nzghbn8), which noted that "The Treasury is using the technology to more accurately measure how changes to national insurance, income tax and universal credit would affect different groups. It is believed that the tool, PolicyEngine, can more accurately predict the outcome of ministers' decisions and is expected to be used mostly in budget periods." The Guardian also [mentioned](https://www.theguardian.com/technology/2024/dec/17/amazon-hosted-ai-tool-for-uk-military-recruitment-carries-risk-of-data-breach) PolicyEngine in its coverage of the government's AI tools initiatives.

The Treasury's review of PolicyEngine highlighted several features, including:

- Combining multiple years of Family Resources Survey data for increased robustness
- Using Survey of Personal Incomes (SPI) imputation with random forest models to address income measurement errors
- Employing gradient descent reweighting to minimise loss between survey aggregates and target statistics
- Imputing additional variables using multiple data sources including the Wealth and Assets Survey and Living Costs and Food Survey
- Using microsimulation to uprate policies to target years

This comes not long after the [December 2024 announcement](/uk/research/posts/uk-nuffield-grant) that PolicyEngine received a £251,296 grant from the Nuffield Foundation to enhance our UK tax-benefit microsimulation model. The Nuffield-funded project will significantly expand PolicyEngine UK's capabilities, including:

- Creating representative micro-datasets for each local authority and constituency
- Integrating childcare subsidies and major public service spending
- Developing validation tools comparing PolicyEngine outputs to other microsimulation models
- Implementing user-centric design improvements with AI capabilities

The Treasury's assessment included risk considerations as part of their evaluation process. As noted in their transparency record, potential risks like "Erroneous Operation of the Code" would be mitigated through "thorough review and testing" involving both technical and policy teams - a common approach for any model implementation in government settings.

These developments represent significant recognition of PolicyEngine's open-source approach to tax-benefit microsimulation and our mission to democratise economic policy analysis tools.



---

---
# Extending the Income Tax threshold freeze to 2030
Slug: income-tax-freeze
Date: 2025-03-25
Authors: Nikhil Woodruff
Tags: uk, policy, featured
Description: PolicyEngine estimates extending the personal allowance and higher rate threshold freeze would raise £12.2 billion over two years.

---

_Credit: HM Treasury_

[See the full impacts on PolicyEngine here in 2028](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=68997&region=uk&timePeriod=2028&baseline=1) and [2029](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=68997&region=uk&timePeriod=2029&baseline=1).

The Resolution Foundation on Monday 17th March [proposed](https://www.resolutionfoundation.org/press-releases/chancellor-needs-take-action-to-balance-the-books/) extending the freeze on the income tax personal allowance and higher rate threshold for an additional two years. This policy would raise over £12 billion in tax revenue and would affect taxpayers across all income groups.

## The reforms

Currently, the personal allowance (£12,570) and higher rate threshold (£50,270) are frozen until 2028. The proposed extension would maintain these thresholds at their current levels until 2030, representing a seven-year freeze since they were last uprated in 2021.

### Taxpayer band changes

Our analysis shows the following changes in taxpayer bands due to the extended freeze:

- **Basic rate taxpayers**: By 2029, an estimated 640,000 additional people would become basic rate taxpayers who otherwise would have remained below the personal allowance threshold.
- **Higher rate taxpayers**: Approximately 906,000 additional people would move from basic rate to higher rate taxpayers by 2029.
- **Additional rate taxpayers**: The counts of additional rate taxpayers are not affected by the threshold freeze.

These shifts would occur primarily in England, Wales and Northern Ireland, as Scotland sets its own income tax thresholds.

## Methodology notes

We model the proposed extension of the freeze from April 2028 to April 2030 using the fiscal year 2029-30 for our analysis. Our projections account for expected inflation and wage growth, following OBR forecasts.

## UK impacts

Using PolicyEngine's open-source model, we estimate both the budgetary and distributional impacts of extending the freeze.

### Budgetary impact

We project that extending the income tax threshold freeze would raise approximately £12.2 billion over the two additional years:

| Fiscal year   | 2028-29 | 2029-30 | Total |
| ------------- | ------- | ------- | ----- |
| Revenue (£bn) | 4.0     | 8.2     | 12.2  |

### Distributional impacts

The extension of the freeze would affect taxpayers across the income distribution. Our analysis shows households in the ninth, seventh, and eighth income deciles would experience the largest proportional reductions in net income (-0.66%, -0.58%, and -0.57% respectively).

[Chart: type: bar]

[Chart: type: bar]

Higher-income households lose more in monetary terms, while the proportional impact varies across the income distribution. Our analysis shows impacts of -0.66% in the ninth income decile, -0.58% in the seventh decile, and -0.57% in the eighth decile, reflecting the dual effect of freezing both the personal allowance and higher rate threshold.

We estimate that 82% of UK households would be affected by the extension, with the impact concentrated among those in employment. Households primarily relying on benefits rather than earnings would see less impact from the freeze.

The reform would reduce the Gini coefficient by 0.07% and increase poverty rates by 0.17% (from 12.20% to 12.23%).

Working-age singles and couples without children would face larger proportional reductions in income, as these groups more commonly have taxable incomes above the personal allowance.



---

---
# How machine learning tools make PolicyEngine more accurate
Slug: how-machine-learning-tools-make-policyengine-more-accurate
Date: 2022-03-07
Authors: Nikhil Woodruff
Tags: uk, technical
Description: Today, we're launching new survey weights that cut deviations from administrative statistics by 97%.

---

When you click “Calculate UK impact” in PolicyEngine, our servers run through tens of thousands of UK households, and for each one, they crunch how your policy affects taxes and benefits. Each of those households in turn represents hundreds or thousands of real UK households, such that adding them up produces measures like budgets, poverty, and inequality. By the time the UK impact screen loads, we’ve calculated each of those measures under your policy, compared it to baseline policy, and summarised the results into charts and graphs.

![](https://cdn-images-1.medium.com/max/3200/0*0JQZPaICpWesixXJ)

This technique is called _microsimulation_, and its heart is a representative survey — that set of tens of thousands of households. Like five of the six other UK microsimulation models, we use the [Family Resources Survey](https://www.gov.uk/government/collections/family-resources-survey--2) produced by the Department of Work and Pensions. The DWP releases a new FRS each year (the latest is for 2019–20), and reports demographic variables like age, location or disability, as well as financial variables like earnings, benefit receipt or pension income.

## Standard accuracy improvements fell short

From the start, we’ve adjusted the FRS to make it more useful for microsimulation. Like other microsimulation models, we’ve:

- Replaced reported tax and benefit values with our calculations (for benefit participants)

- Uprated population and income from 2019–20 to 2022 using government projections

- Assumed that some households claim benefits when eligible, even when they don’t report claiming them, according to government estimates of take-up rates

- Moved households from legacy benefits to Universal Credit according to roll-out rates

However, even our adjusted FRS failed to match administrative totals on a variety of measures. For example, Income Tax revenue in 2019 was £165bn in the model, compared to £190bn by administrative statistics. Across benefit programs, we were often off by between 10% and 40%.

Two possible issues explained our remaining discrepancies:

1. Measurement error, in which FRS respondents misreport their financial situation

1. Sampling error, in which FRS households misrepresent UK households

As we dug further, we found that for many benefits, we could adjust take-up rates to either match official expenditure or official caseloads, but not both. This situation can only occur if the households claiming a benefit in the model are fundamentally different from the households claiming the benefit in reality. So, having exhausted our options to address measurement error, and with evidence on hand that the survey was unrepresentative of the population, we turned to sampling error.

Specifically, we questioned the household weights: the number of real-world households a given FRS respondent represents. DWP assigns weights by a [multi-stage process](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/321820/initial-review-family-resources-survey-weighting-scheme.pdf):

1. Randomly sampling postcode addresses (approximately one in 650). If surveyors find multiple households at an address, they select one and adjust the weight.

1. Calibrating weights to match administrative statistics for the following metrics (with slight variations).

These calibrations included targeting metrics like:

1. Age group-sex-region bins (for example, the number of men aged 30 to 39 in London)

1. Population counts by region, tenure type and council tax band

Could we do better?

## Enter: gradient descent

To find the “best” weights for the FRS, we first need to define what we mean by “best”. To do this, we define a _loss function_, which reduces an array of household weights into a single number (the _loss_): the lower, the better. We then apply an optimisation procedure to find the array of weights that minimises this loss function.

We compute our loss function as follows:

1. For each of 1,512 targets, compute the squared relative error. For example, the FRS estimates Housing Benefit to be £13.6bn, while the administrative total is £18.4bn; the initial squared error for this target would be ((13.6–18.4)/18.4)²=0.068.

1. Multiply each squared relative error by the baseline target, so as to weigh larger targets more.

1. Assign each target to one of four categories: populations, families, households, or budgetary impacts, according to their unit. For each category, compute the log of the change to percent error against the baseline.

1. Compute the final loss as the average log percent error across each category, with half of the total weight going to budgetary impacts and the other half on the other categories. That is, we value a 50% improvement in the loss for budgetary impact statistics the same as a 50% improvement in the combined loss for population, family and household statistics.

Having constructed our loss function, we can adjust the weights to minimise the loss via gradient descent:

1. For each survey household, calculate the _gradient_ of the loss function with respect to the household’s weight. This is the extent to which the total loss metric would increase if the household’s weight increased: if the gradient with respect to a household is positive, then increasing the weight would worsen accuracy, and vice versa. The larger the absolute gradient is, the more adjusting a household’s weight affects the loss function.

1. Multiply the gradient by a small number, called the _learning rate_, and subtract it from the initial vector of weights to create a new set of weights.

1. Recompute the loss with the new weights.

1. Repeat steps 1–3, which constitute an _epoch_, until some stopping criterion is met.

## Tuning the model

As with other machine learning models, this iterative approach risks _overfitting_–that is, we might over-optimise for the measures in the loss function, at the expense of other measures we haven’t yet included. Machine learning models often reserve a set of records to validate their predictions on, and tune hyperparameters (e.g., learning rate and number of epochs) to avoid overfitting on the training data at the expense of these out-of-sample predictions. Our analogy to that is reserving a set of validation targets.

Specifically, we trained our model five times, each time reserving 20% of the targets for validation, and training on the other 80%. Each 20% was exclusive of the others, such that all metrics were validated against in one of the five validation runs.

![](https://cdn-images-1.medium.com/max/2000/0*ta4Hz9miF7u83_mt)

Averaging over the five runs showed that gradient descent continues to reduce total loss (training plus validation metrics) for at least 200 epochs.

![](https://cdn-images-1.medium.com/max/2000/0*l6Eo4qs_jbBvQueu)

Based on these results, we chose to produce the final weights by training again with all the targets in the loss function, stopping at 200 epochs.

## Results

Our procedure reduced the total loss by 97%, with the regional populations and country-wide budgetary impact categories seeing the largest improvements.

![](https://cdn-images-1.medium.com/max/2000/0*eEAuyeu6kE5fJcP6)

![](https://cdn-images-1.medium.com/max/2000/0*lYp59pEkyRJED81P)

Of the six other UK microsimulation models, only UKMOD publishes their aggregates to compare against. We find that our improved weights produce up to 80% lower aggregate and caseload errors on individual programs.

![](https://cdn-images-1.medium.com/max/2000/0*BH4WBVIvOhfZVBaD)

Our relative errors are highest for the smallest benefit programs (those with less than £10 billion annual expenditure), in part because our loss function prioritises larger programs.

## Where we go from here

We’ve published [our weights on GitHub](https://github.com/PolicyEngine/openfisca-uk/tree/master/data/weights) for other analysts and microsimulation modellers to use, [documented our approach with interactive visualisations](https://policyengine.github.io/openfisca-uk//model/reweighting.html), and effective today, updated [PolicyEngine UK](https://legacy.policyengine.org/uk) to use the new weights. In the future, we’ll refine and extend our weights with more targets, mid-year adjustments, and multi-year extrapolations.

We will also continue to develop other ways of enhancing PolicyEngine with state-of-the-art data science. For example, we are continuing to invest in our [machine learning-based synthimpute technology](http://blog.pslmodels.org/demo-day-22-synthimpute) to fuse variables from other surveys, such as wealth from the Wealth and Assets Survey and consumption from the Living Costs and Food Survey, to model a broader range of policy reforms.

We’re excited to explore other ideas for improving public policy analysis with technology, and welcome any other modellers to [reach out](mailto:contact@policyengine.org) with feedback or ideas.



---

---
# Stamp duties in PolicyEngine UK
Slug: stamp-duties-in-policyengine-uk
Date: 2022-09-22
Authors: Nikhil Woodruff
Tags: uk, technical
Description: The Times reported yesterday that Prime Minister Liz Truss will announce plans to cut Stamp Duty this week. PolicyEngine now supports…

---

[The Times reported yesterday](https://www.thetimes.co.uk/article/liz-truss-to-cut-stamp-duty-in-push-for-prosperity-qrh5nxbcd) that Prime Minister Liz Truss will announce plans to cut Stamp Duty this week. PolicyEngine now supports custom reforms to Stamp Duty and its devolved equivalents, so you can compute the impact of potential cuts or your preferred Stamp Duty reform. We will post estimates of Truss’s cut when she announces it.

## What is Stamp Duty?

HMRC levies the Stamp Duty Land Tax, often just called Stamp Duty, as a tax on property transfers in England and Northern Ireland. Similarly, the Welsh Revenue Authority levies the Land Transaction Tax, and Revenue Scotland levies the Land and Buildings Transaction Tax, though the policies differ in their parameters and rules.

## How does PolicyEngine model Stamp Duty?

PolicyEngine’s core microsimulation runs off an enhanced version of the Family Resources Survey, a household survey that captures household structure, income, and benefits. Just as we impute energy consumption from the Living Costs and Food Survey to [estimate energy price cap reforms](https://blog.policyengine.org/prime-minister-liz-trusss-energy-bill-price-cap-cfcfbd7b4dec), we impute assets from the Wealth and Assets Survey to estimate Stamp Duty and other asset-based policies. Specifically, we impute the value of a household’s primary and other residences, and whether their primary residence was their first home. We also impute their corporate wealth to model their share of non-residential stamp duty burdens.

Our imputation process automatically calibrates the imputation to match the true value of properties. Our [synthimpute](https://github.com/PSLmodels/synthimpute) machine learning software ensures we impute realistic conditional values that also add up to the true aggregates.

To match the Stamp Duty aggregates, we then assign each household in the survey data a chance of transferring their property in a given year. This effectively gives homeowners a slice of their total Stamp Duty each year based on the expected duration between transfers.

After assigning this expected Stamp Duty (and devolved equivalents) in the baseline, we recompute it based on the policy reform, and assign any difference as a change to the household’s income in the year. That change drives distributional charts, including poverty impacts.

## What kinds of Stamp Duty reforms does PolicyEngine support?

Any! We’ve added switches to abolish each of the three Stamp Duty policies, as well as detailed parameters for each policy. For example, here’s one screen of controls for Stamp Duty on first homes:

![Stamp duty parameters on PolicyEngine.](https://cdn-images-1.medium.com/max/3200/0*irKUYKfN1VVZ4hwL)_Stamp duty parameters on PolicyEngine._

Here are some examples of Stamp Duty reforms you can compute in PolicyEngine:

- [Repeal all three policies
  ](https://legacy.policyengine.org/uk/population-impact?abolish_sdlt=1&abolish_ltt=1&abolish_lbtt=1)£16.2 billion cost in 2022

- [Double Stamp Duty’s first home value exemption from £500,000 to £1,000,000
  ](https://legacy.policyengine.org/uk/population-impact?sdlt_first_time_buyer_value_limit=1000000)£95 million cost in 2022

- [Set the rate to a flat 2% on-first primary homes
  ](https://legacy.policyengine.org/uk/population-impact?abolish_lbtt=1&sdlt_on_non_first_home_1_rate=2&sdlt_on_non_first_home_3_rate=2&sdlt_on_non_first_home_4_rate=2&sdlt_on_non_first_home_5_rate=2&ltt_on_secondary_residences_1_rate=2&ltt_on_secondary_residences_2_rate=2&ltt_on_secondary_residences_3_rate=2&ltt_on_secondary_residences_4_rate=2&ltt_on_secondary_residences_5_rate=2&ltt_on_secondary_residences_6_rate=2&lbtt_on_residential_property_1_rate=2&lbtt_on_residential_property_3_rate=2&lbtt_on_residential_property_4_rate=2&lbtt_on_residential_property_5_rate=2)£3.7 billion cost in 2022

## Exploring the results

To see how each reform affects the UK, click on ‘Compute population impact’ (or navigate to the ‘UK impact’ tab). From there, you can see all the standard outputs: budgetary impacts, changes to poverty rates, and distributional impacts.

### Changes to poverty rates

Our poverty definition follows the standard methodology defined by the Households Below Average Income statistical release (the official poverty measure), with income defined as net household income before housing costs and the poverty line uprated by inflation. PolicyEngine assigns any reduction in expected liabilities to an increased net income, which can bring households above the poverty line. However, it’s worth noting that HBAI technically doesn’t deduct stamp duties, so the HBAI publication wouldn’t be affected by policy reforms.

### Distributional impacts

PolicyEngine shows the average gains by income and wealth decile, and these will often differ. For example, a cut in stamp duties is often regressive by income deciles and progressive by wealth deciles: this is fundamentally because income doesn’t correlate perfectly with wealth (consider a pensioner with low income, who owns their own house, or a young graduate with student loans and a high-paying job). You can use the buttons underneath each distributional impact chart to see different angles here — relative or absolute income changes, by income or by wealth deciles.

How would you reform Stamp Duty? [Tweet it at us](http://twitter.com/thepolicyengine) with a PolicyEngine reform, or describe it and we’ll run it through the model for you!



---

---
# Prime Minister Liz Truss’s energy bill price cap
Slug: prime-minister-liz-trusss-energy-bill-price-cap
Date: 2022-09-16
Authors: Max Ghenis
Tags: uk, policy
Description: See the impact in PolicyEngine.

---

New UK Prime Minister Liz Truss last week announced that the [energy bill price cap will remain at £2,500](https://helpforhouseholds.campaign.gov.uk/help-with-your-bills/) for the typical household until 2024, rather than rising as planned. The government will compensate energy companies for the difference.

[PolicyEngine now models this reform](https://legacy.policyengine.org/uk/population-impact/treasury/energy-price-guarantee) as a household transfer, as well as any customisable price cap change by quarter. We estimate that Truss’s plan will cost £50 billion over the next year and cut poverty 20%. Higher income households benefit less on a percentage basis and more on an absolute pound basis, and the policy disproportionately reduces senior poverty.

This blog post explains our methodology and dives deeper into the results. For an analysis of the policy itself, see [our article published by UK in a Changing Europe](https://ukandeu.ac.uk/energy-subsidy/).

## How PolicyEngine models the energy price cap

PolicyEngine models price cap reforms as a transfer equal to the reduction in energy expenditures against the baseline, holding consumption constant.

As an example, consider what Ofgem calls the “typical household” — one with 12,000 kWh in annual consumption. Before today’s announcement, [Cornwall Insights forecasted](https://www.cornwall-insight.com/cornwall-insight-release-final-predictions-for-octobers-price-cap/) that they would have faced an energy price cap rising to an average of about £4,600 over the next year. The £2,500 cap therefore amounts to a £2,100 annual transfer.

Households vary in their energy consumption, and PolicyEngine models this heterogeneity by fusing the Living Costs and Food Survey to our enhanced Family Resources Survey, using our [synthimpute](https://github.com/policyengine/synthimpute) machine learning software. For each household in our dataset, we estimate the annual energy consumption, and accordingly, their expenditure under the pre- and post-Truss energy cap schedules. The program’s cost equals the total difference between these figures.

Like all PolicyEngine results, the price cap assumes no behavioural responses; that is, we assume households’ lower energy prices do not affect energy usage.

## Impacts of Liz Truss’s energy bill price cap

PolicyEngine now allows users to change the energy bill price caps in each of the coming four quarters. We’ve now set each of these to £2,500, per the policy reform. [Setting the baseline values back to their projections estimates Liz Truss’s cap](https://legacy.policyengine.org/uk/policy/treasury/energy-price-guarantee).

The distributional impact is progressive in relative terms: lower deciles see a higher percent increase to net income than higher deciles, from 14% to 2%. At the same time, the nominal increases are larger for higher-income households (from £1,400 to £2,400). This is largely due to the fact that energy consumption makes up a larger percentage of low-income budgets than it does for high-income households.

![*Change to net income by income decile under the price cap subsidy.*](https://cdn-images-1.medium.com/max/2156/0*zd856MutdKoSspHu)Change to net income by income decile under the price cap subsidy.

Poverty also falls by 20%, compared to the counterfactual scenario with no action taken. The impact is strongest among seniors, who see a 35% reduction in the poverty rate. Deep poverty, the share of people living at under half the poverty line, falls by 28%.

![*Change to poverty rates by age group under the EPG.*](https://cdn-images-1.medium.com/max/2194/0*WQK8LyHm6Ge52UiX)Change to poverty rates by age group under the EPG.

Multiple measures of inequality also fall. The Gini index of income inequality falls 3%, and the top-ten and top-one percent shares of income fall by 2% and 3%, respectively.

The reforms are based on energy usage, not income, so they avoid changing marginal tax rates.

To compare against other levels at which to fix the price cap, [see the reform on PolicyEngine](https://legacy.policyengine.org/uk/policy/treasury/energy-price-guarantee).



---

---
# Raising the marriage allowance from 10% to 100%
Slug: raising-the-marriage-allowance-from-10-to-100
Date: 2022-08-29
Authors: Nikhil Woodruff
Tags: uk, policy
Description: See the reform in PolicyEngine.

---

On 21 July, UK Prime Minister candidate Liz Truss promised to “review the taxation of families to ensure people aren’t penalised for taking time out to care for their children or elderly relatives.” Her campaign team [elaborated](https://www.reuters.com/world/uk/uk-pm-candidate-truss-eyes-tax-breaks-carers-2022-07-21/) that this involved transferring the full personal tax allowance within households, rather than the 10 percent allowed under current law, though they haven’t specified if the reform would also affect other parts of the policy, such as the limitation to Basic Rate taxpayers.

In this blog post, I’ll explain the marriage allowance and show how to use PolicyEngine to score two potential reforms to the policy:

1. [Raising the marriage allowance from 10% to 100%.](https://legacy.policyengine.org/uk/population-impact?marriage_allowance_cap=100) PolicyEngine estimates that this reform would cost £3.05 billion in 2022, lowering poverty by 0.5%, benefiting 15% of the population, and widening the marriage allowance’s earnings dead zone by roughly a factor of 10.

1. [Raising the marriage allowance from 10% to 100% and removing the limitation to Basic Rate taxpayers.](https://legacy.policyengine.org/uk/population-impact?marriage_allowance_cap=100&abolish_marriage_allowance_income_condition=1) PolicyEngine estimates that this reform would cost £5.91 billion in 2022, lowering poverty by 0.5%, benefiting 20% of the population, and removing the marriage allowance’s earnings dead zone.

## What is the marriage allowance?

The [marriage allowance](https://www.gov.uk/marriage-allowance) allows a person to transfer £1,260 of their personal allowance (10% of the maximum) to their spouse, if their income is below the personal allowance and their spouse pays income tax at the basic rate (income between £12,571 and £50,270).

To compute the impact of the current marriage allowance in PolicyEngine, [compare the current law to a baseline without the marriage allowance.](https://legacy.policyengine.org/uk/population-impact?marriage_allowance_cap=10&baseline_marriage_allowance_cap=0)

For example, consider a married couple with one child. One person earns £30,000, and the other earns £0. Without the marriage allowance, they would pay £5,954 in taxes; the marriage allowance lowers that by £252 to £5,702. However, since DWP bases benefits on after-tax income, they also lose £139 of benefits. In total, the marriage allowance increases their net income by £113, or about 0.4%.

![](https://cdn-images-1.medium.com/max/3200/0*IY_xXY22mfz2x73x)

This household benefits from the marriage allowance because their earnings are higher than the personal allowance, but lower than the basic rate threshold. The marriage allowance increases their net income by £113 if their income qualifies them for Universal Credit; once they become ineligible, it increases their net income by £252. The marriage allowance creates a welfare cliff with an associated earnings dead zone about £600 wide — the household is worse off earning between about £50,200 and £50,800.

![](https://cdn-images-1.medium.com/max/3116/0*xF8DsVz0qIXXevqg)

Overall, PolicyEngine estimates that the marriage allowance currently costs £844 million per year, cuts poverty 0.8%, and benefits 17% of the population. For comparison, [HMRC estimated the true budgetary impact](https://researchbriefings.files.parliament.uk/documents/SN00870/SN00870.pdf) at £560 million in 2020/21, 34% below our 2022 estimate. However, HMRC reports that actual costs have been 30% to 37% below HMRC forecasts from 2016/17 to 2018/19. PolicyEngine’s forecasts, like HMRC’s, do not consider the take-up rate of the program, though [we intend to model the marriage allowance’s take-up rate in the future](https://github.com/PolicyEngine/openfisca-uk/issues/623).

## How does increasing the marriage allowance from 10% to 100% affect a household?

Let’s return to our sample household: a married couple with one child, one of whom earns £30,000 and the other earns £0. If we [compare their situation](https://legacy.policyengine.org/uk/household?marriage_allowance_cap=100) under current law to that in which the marriage allowance rises from 10% to 100%, we see that the reform would increase their net income by £2,143, or 8.4%. This again comes from lower taxes, which are partly offset by lower benefits.

![](https://cdn-images-1.medium.com/max/3200/0*dS7FHuDa6qzqDSHD)

The household would benefit from the policy if their income between about £13,830 (the £12,570 personal allowance plus the £1,260 current marriage allowance) and £50,270. They would receive the maximum gain of £2,262 for earnings between £30,400 and £50,270.

![](https://cdn-images-1.medium.com/max/3144/0*4KZZFs4JwdkocX9a)

The reform lowers marginal tax rates by 9.0p for earnings between £13,830 and £25,200, and then by 36.7p for earnings between £27,000 and £30,200. It then amplifies the cliff by an order of magnitude, from its current £252 to £2,514 (£2,262 + £252). The policy widens the earnings dead zone by a similar factor to £5,600: the household is worse off earning above £50,270 until their earnings exceed £55,800.

![](https://cdn-images-1.medium.com/max/3200/0*IlxZTi9EJ5bsJng7)

[You can enter your household information here to see how it would affect you.](https://legacy.policyengine.org/uk/household?marriage_allowance_cap=100)

## How does increasing the marriage allowance from 10% to 100% affect the population?

Raising the marriage allowance to 100% lowers tax liabilities by £3.36 billion, partly offset by £309 million less in benefit outlays. The reform costs £3.05 billion on net.

![](https://cdn-images-1.medium.com/max/3200/0*YJqbE0m1-c2KiAC0)

Overall, the reform cuts poverty by 0.5%, including child poverty by 0.8%. It has no effect on senior poverty or deep poverty.

![](https://cdn-images-1.medium.com/max/3200/0*t0fNme32sgA86h6j)

As a percentage of income, expanding the marriage allowance most benefits households in the second through fourth deciles.

![](https://cdn-images-1.medium.com/max/3200/0*P2_1CJU4mH1gN90s)

Similarly, households in the second through fourth deciles are most likely to benefit, and most likely to gain at least 5% of their income.

![](https://cdn-images-1.medium.com/max/3200/0*Wa_NYSZdWUVIrAVi)

We can aggregate these impacts to find that the reform reduces inequality according to the three measures reported by PolicyEngine: the Gini index (a broad measure) falls by 0.5%, and the net income shares held by the top 10% and 1% each fall by 0.3%.

![](https://cdn-images-1.medium.com/max/3200/0*swg8UEVRUQgcjA64)

[Explore the full population impacts of the reform in PolicyEngine here](https://legacy.policyengine.org/uk/population-impact?marriage_allowance_cap=100), and [find how it would affect your own household here.](https://legacy.policyengine.org/uk/household?marriage_allowance_cap=100)

## How does removing the Basic Rate restriction affect households?

Since our sample household is in the Basic Rate band, removing that restriction doesn’t affect them at £30,000 income. However, if their income rises, the policy continues to benefit them, up to £5,656 per year if their income exceeds £162,600.

![](https://cdn-images-1.medium.com/max/3200/0*js3K_uoEtwe_2yX9)

This reform would also lower their marginal tax rates in several earnings regions.

![](https://cdn-images-1.medium.com/max/3156/0*ERQ1akHhXK9d5BKQ)

## How does removing the Basic Rate restriction affect the population?

Compared to only raising the percentage, removing the Basic Rate restriction roughly doubles the budgetary impact and has roughly no additional poverty impact. The main difference is that upper income deciles would benefit more, in particular the top two which would not benefit without this provision.

![](https://cdn-images-1.medium.com/max/3200/0*I28U_nsGjYjwsAm3)

[Explore the full population impacts of the reform in PolicyEngine here](https://legacy.policyengine.org/uk/population-impact?marriage_allowance_cap=100&abolish_marriage_allowance_income_condition=1), and [find how it would affect your own household here.](https://legacy.policyengine.org/uk/household?marriage_allowance_cap=100&abolish_marriage_allowance_income_condition=1)



---

---
# Rishi Sunak’s proposal to cut the basic rate to 16 percent
Slug: rishi-sunaks-proposal-to-cut-the-basic-rate-to-16-percent
Date: 2022-08-01
Authors: Max Ghenis
Tags: uk, policy
Description: See the interactive simulation on PolicyEngine

---

In a pitch today for Conservatives to elect him Prime Minister, [Rishi Sunak has proposed](https://www.theguardian.com/politics/2022/jul/31/rishi-sunak-pledges-20-tax-cut-by-end-of-decade-in-last-gasp-pitch-to-members) lowering the basic rate of income tax from 20 percent to 16 percent by the end of the next parliament. The proposal follows his [announcement in March](https://www.independent.co.uk/news/uk/politics/uk-income-tax-cut-2024-rishi-sunak-b2042197.html) (when he was still Chancellor) that the government would cut the basic rate to 19 percent by 2024.

PolicyEngine estimates that cutting the basic rate from 20p to 16p in 2022 would:

- Cost £18.8 billion

- Lower the poverty rate by 1.2 percent

- Benefit higher income households more than lower income households

- Produce a mixed impact on income inequality

[See the interactive simulation in PolicyEngine here.](https://legacy.policyengine.org/uk/population-impact?basic_rate=16)

## Budgetary impact

The reform would lower tax revenues by £19.0 billion, and also lower benefit outlays by £0.2bn, for a total budgetary impact of £18.8 billion. Lowering tax rates lowers benefit outlays because programs like Universal Credit phase out based on after-tax income.

![](https://cdn-images-1.medium.com/max/3200/0*EXIQtIvwQGyXNyM5)

PolicyEngine is a “static” model, meaning that it assumes no behavioural responses. In its dynamic model that assumes behavioural responses, [HMRC estimates that a 1p change to basic rate would cost £5.25 billion in 2023–24](https://www.gov.uk/government/statistics/direct-effects-of-illustrative-tax-changes/direct-effects-of-illustrative-tax-changes-bulletin-june-2022) (PolicyEngine estimates that [lowering basic rate to 19p would cost £4.7 billion](https://legacy.policyengine.org/uk/population-impact?basic_rate=19)). A linear extrapolation would therefore produce a £21 billion budgetary estimate from HMRC.

## Poverty

The reform would cut poverty 1.2% overall. The effect is larger for children (1.7%) and small for seniors (0.1%). It would not affect deep poverty, the share of people in households with income below half their poverty threshold.

![](https://cdn-images-1.medium.com/max/3200/0*t3cBR98Pk7xjSLB2)

## Distributional impact

The reform generally benefits higher income households more: as a percent of net income, the average benefit rises for each decile, except for the top decile which gains about as much as the seventh decile.

![](https://cdn-images-1.medium.com/max/3200/0*1cRlBNg4HgFc22VN)

Higher income households are also more likely to gain.

![](https://cdn-images-1.medium.com/max/3200/0*Zne_4Z0ooBO2rZQJ)

While the reform would increase the Gini index, a broad measure of income inequality, it would have a small effect on the share of net income held by the top 10% and reduce the share held by the top 1%.

![](https://cdn-images-1.medium.com/max/3200/0*ZCJ7B5-ErWM13zbZ)

## Sample household

A single parent of one would start to benefit from the basic rate cut once they earn about £13,000. Because Income Tax interacts with Universal Credit, the gain increases at different rates, until it plateaus at £1,508 once their earnings hit £50,300.

![](https://cdn-images-1.medium.com/max/2788/0*8sYS6Bha4dpC4v2F)

For the income range where this household is eligible for Universal Credit, the reform lowers their marginal tax rate by 1.8%; beyond that, it falls by the full 4% cut.

![](https://cdn-images-1.medium.com/max/2628/0*UDmm9O3KZzHHvERV)

To compute more impacts of Sunak’s proposed basic rate cut, [see how it would affect your own household](https://legacy.policyengine.org/uk/household?basic_rate=16&baseline_basic_rate=20), or create your own version of this reform, [view the simulation on the PolicyEngine.](https://legacy.policyengine.org/uk/population-impact?basic_rate=16&baseline_basic_rate=20)



---

---
# Impact of the Chancellor’s Cost of Living Support package
Slug: impact-of-the-chancellors-cost-of-living-support-package
Date: 2022-05-26
Authors: Max Ghenis
Tags: uk, policy
Description: See the analysis in PolicyEngine UK

---

Today, the Chancellor of the Exchequer [announced a new Cost of Living Support package](https://www.gov.uk/government/news/millions-of-most-vulnerable-households-will-receive-1200-of-help-with-cost-of-living) of cash transfers:

- £650 to households receiving means-tested benefits

- £150 to households receiving non-means-tested disability benefits

- £300 to households receiving the Winter Fuel Payment (i.e., those with pensioners)

- £200 to households receiving energy bills, doubling the [Energy Bills Support Scheme rebate announced in February](https://www.gov.uk/government/news/millions-to-receive-350-boost-to-help-with-rising-energy-costs) and removing the need to repay it over five years

Alongside a six-month extension of the Household Support Fund, HM Treasury estimated that the package would cost £15.3bn, and be partly offset by £5bn from a new temporary Energy Profits Levy. We’ve added these four payments (not the Household Support Fund or Energy Profits Levy) to PolicyEngine. This post shows how to define the reform in PolicyEngine, compares PolicyEngine’s results to HM Treasury’s, and shows novel impacts on poverty, inequality, and households.

## Defining the reform in PolicyEngine

_Skip this section to see the results._

To accommodate this package, we’ve added a new section to the Benefit menu in the [Policy page](https://legacy.policyengine.org/uk/policy), for the _Cost-of-living support payment_. This includes payments to each of the three new household categories: those receiving means tested benefits, those with pensioners (the qualification for receiving Winter Fuel Payment), and those receiving non-means-tested disability benefits. These are set to £0 until they become legislation.

![](https://cdn-images-1.medium.com/max/3200/0*fKtwMJpHA8ua9nti)

To model the Cost of Living Support package, set these parameters to £650, £300, and £150, respectively.

![](https://cdn-images-1.medium.com/max/3200/0*niEvXilrDsNIERMK)

Next, navigate to the _Energy bills support_ menu. This defaults to £0 because it doesn’t take effect until October. Set it to £400.

![](https://cdn-images-1.medium.com/max/3200/0*-QfroG-AojdZbEiv)

This, however, will compare the full £400 against £0. To focus on the additional £200, we need to first set the baseline value to £200 by toggling the Baseline in the upper right and setting the credit to £200. This effectively front-loads the £200 announced in February to the beginning of the year.

![](https://cdn-images-1.medium.com/max/3200/0*ZC3T6NytGLf7n9SM)

If you made it this far, congratulations, you’ve modelled the newly announced Cost of Living Support package! Your URL should look like this: [https://legacy.policyengine.org/uk/policy?col_benefit_payment_amount=650&col_disability_payment_amount=150&col_pensioner_payment_amount=300&ebr_energy_bills_credit=400&baseline_ebr_energy_bills_credit=200](https://legacy.policyengine.org/uk/policy?col_benefit_payment_amount=650&col_disability_payment_amount=150&col_pensioner_payment_amount=300&ebr_energy_bills_credit=400&baseline_ebr_energy_bills_credit=200).

## Budgetary impact

![](https://cdn-images-1.medium.com/max/4544/1*1QUONsnbioHZgnKl5cd3gw.png)

PolicyEngine estimates that these four programs would cost £16.2bn, 9% higher than HM Treasury’s estimate of £14.8bn. Most of this discrepancy, and the largest proportional discrepancy, comes from the payment to pensioner households receiving Winter Fuel Payment. It’s not clear how HM Treasury estimated that this program would cost £2.5bn; the [factsheet](https://www.gov.uk/government/publications/cost-of-living-support/cost-of-living-support-factsheet-26-may-2022) states that it is not exclusive with other payments, and [DWP forecasts 11.4m households receiving Winter Fuel Payment in 2022–23](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2021), which would cost £3.4bn when multiplied by £300.

## Comparison to HM Treasury distributional impact

HM Treasury released an [“Illustrative analysis of the impact of the Cost of Living Support packages on households”](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1078837/DA_May_2022_publication.pdf) along with the package announcement, including distributional impacts on English households. Here’s one chart from their report:

![](https://cdn-images-1.medium.com/max/3200/0*kNAJvbiWYIkVklP6)

To replicate these results, select England from the Geography menu in the Policy page. Doing so yields [this impact page](https://legacy.policyengine.org/uk/population-impact?col_benefit_payment_amount=650&col_disability_payment_amount=150&col_pensioner_payment_amount=300&ebr_energy_bills_credit=400&baseline_ebr_energy_bills_credit=200&baseline_country_specific=ENGLAND).

![](https://cdn-images-1.medium.com/max/3052/0*SIcutajl_eFEU4Mn)

This shows that the package would increase incomes among low-income England households by a larger percentage than high-income England households (the same holds across the UK). PolicyEngine estimates slightly larger impacts than HM Treasury, aligning with our larger budgetary impact; for example, increasing the bottom decile’s income by 8% instead of 7%.

![](https://cdn-images-1.medium.com/max/3200/0*sfXwma_6_dIT67cS)

HM Treasury also shows the impact by decile in pounds.

![](https://cdn-images-1.medium.com/max/3200/0*mhiMc1dHvacyjXnn)

PolicyEngine estimates a lower absolute impact on low-income households than HM Treasury. Combined with the relative impact graph, these results reveal that PolicyEngine estimates a significantly lower baseline income for households in the bottom income decile than HM Treasury: £500 / 8.1% = ~£6,200, compared to £830 / 7% = ~£12,000. This is probably due to our reweighting, which improves the accuracy of our microdata, but we’ll investigate it further in [this GitHub issue](https://github.com/PolicyEngine/policyengine/issues/740).

![](https://cdn-images-1.medium.com/max/3200/0*c0wwoflvFJ-eqqor)

## Poverty and inequality impact

In addition to the decile breakdowns, PolicyEngine estimates the poverty and inequality impacts. Overall, the package lowers the poverty rate by 7%, and by 17% among pensioners.

![](https://cdn-images-1.medium.com/max/3200/0*tMkZ4fTNtcOR4O6g)

The package has a larger effect on deep poverty–the population share whose household has net income below half its poverty threshold–lowering it by 10%, and more consistently across age groups than the poverty impact.

![](https://cdn-images-1.medium.com/max/3200/0*pwjC5NxVYM0sV9Rq)

The policy would also lower inequality, especially measured most broadly via the Gini index, which would fall 1.8%.

![](https://cdn-images-1.medium.com/max/3200/0*mQx7AjV1JbdzydRD)

## Impact on individual households

The package provides between £200 and £1,100 for each household. £650 of that depends on a household’s earnings, since it is limited to claimants of means-tested benefits. This creates a “welfare cliff” at the point where a household is no longer eligible for means-tested benefits.

For example, an unmarried person with no children will receive £850 if they earn between £0 and about £7,300 per year. Once they earn more than that, they would receive £200. Their net income after taxes and benefits would fall from £8,504 when they earn £7,300, to £7,950 when they earn £7,400. To exceed £8,504 net income, their earnings would have to rise to about £8,000; that is, they’d see less net income earning between £7,300 and £8,000.

![](https://cdn-images-1.medium.com/max/2916/0*SPY_UZBNq8oHBK_0)

The placement and size of this “earnings dead zone” (the shaded rectangle) depends on household characteristics. For example, a family of four paying £1,000 per month for rent would see it between £67,900 and £69,100 earnings, since families can earn more and still receive means-tested benefits.

![](https://cdn-images-1.medium.com/max/2948/0*wFCqcj0lTdjAlyFv)

## Conclusion

PolicyEngine UK now supports payments to households receiving means-tested benefits, non-means-tested disability benefits, and Winter Fuel Payment. You can set these values to mirror the Chancellor’s announcement, or define your own household payment scheme. Our estimates generally fall within 10% of HM Treasury’s, and we’ve also produced the first poverty and inequality analyses of the package, as well as personalised estimates that reveal welfare cliffs.

To explore the package in more detail, [see our full analysis in PolicyEngine UK](https://legacy.policyengine.org/uk/population-impact?col_benefit_payment_amount=650&col_disability_payment_amount=150&col_pensioner_payment_amount=300&ebr_energy_bills_credit=400&baseline_ebr_energy_bills_credit=200).



---

---
# Analysing Autumn Budget Universal Credit reforms with PolicyEngine
Slug: analysing-autumn-budget-universal-credit-reforms-with-policyengine
Date: 2021-10-30
Authors: Nikhil Woodruff
Tags: uk, policy
Description: See how the reform affects the UK population or your household.

---

_Chancellor of the Exchequer Rishi Sunak. Credit: [Number 10](https://www.flickr.com/photos/number10gov/49647526566)._

On Wednesday, the UK’s Chancellor of the Exchequer Rishi Sunak [published the details](https://www.gov.uk/government/topical-events/budget-2021) of the 2021 Autumn Budget, including a wide array of tax and benefit reforms. Among those were changes to Universal Credit (UC): reducing the taper rate from 63% to 55% and increasing work allowances by £500 per year. This follows, and will partially counteract, October’s reduction of the UC standard allowance by £20 per adult.

PolicyEngine estimates that this reform would cost £2.8bn per year, reduce poverty by 3.1%, and benefit 12% of the population. It will also reduce marginal tax rates by between 5.4pp and 63pp for people with income between the baseline work allowance and UC entitlement, while raising marginal tax rates by 37.4pp for people with income previously too high to receive UC.

Read on for more details, or [jump to the reform in PolicyEngine](https://legacy.policyengine.org/uk/population-impact?UC_reduction_rate=55&UC_work_allowance_with_housing=335&UC_work_allowance_without_housing=557&policy_date=20211101) to see how the reform affects the UK population and your own household.

## How Universal Credit works

Universal Credit is the central in-work means-tested benefit, currently being rolled out across the UK. The benefit replaces six existing “legacy” benefits covering unemployment, limited work capability and low earnings. The roll-out was started in 2013 and [is scheduled to complete by 2024](https://www.bbc.co.uk/news/uk-51318730), under a combination of natural migration (new claims cannot be made to benefits replaced by UC) and managed migration (transferring existing legacy benefits with transitional protection).

### The maximum rate

Universal Credit payments are paid in respect of a _benefit unit_ (one or two cohabiting adults, plus children). Entitlements are calculated based on three steps: the first, eligibility, requires that the claimant be working-age. The second step calculates the maximum entitlement, by summing any of the following elements that apply.

![*Values of components in Universal Credit, as of 28th October 2021.*](https://cdn-images-1.medium.com/max/2000/1*E5Gdno7MfZgBf6pIQsQVuQ.png)**Values of components in Universal Credit, as of 28th October 2021.**

### Reductions from income

Income received by the claimant reduces their entitlement to Universal Credit. Unearned income (other benefits, pensions and capital income) is treated differently than earned income from employment or self-employment. Income, after deducting taxes and work allowances, reduces UC entitlement in proportion to the taper rate.

![*The means test parameters of Universal Credit, as of 30th October 2021.*](https://cdn-images-1.medium.com/max/2000/1*yLCGkbJixG94IplxwCr0lA.png)**The means test parameters of Universal Credit, as of 30th October 2021.**

## Analysis

The reforms announced in the budget reduce the taper rate by 8pp, from 63% to 55%, as well as increasing both work allowances by £50 per month. This increases entitlement for those with earnings, in proportion to their earnings, and smoothens marginal tax rates.

### UK impact

PolicyEngine estimates the total cost of introducing the reform to be £2.7bn per year. The reform benefits 12% of the population, and it reduces poverty by 3.1% (working-age poverty decreases by 3.0% and child poverty by 6.0%). For context, PolicyEngine estimates that [restoring Universal Credit’s pandemic-related Standard Allowance](https://legacy.policyengine.org/uk/population-impact?UC_couple_old=596.58&UC_couple_young=490.6&UC_single_old=411.51&UC_single_young=344) would cost £4.2bn, reduce poverty by 4.3%, and benefit 18% of the UK.

Broadly, the reform is progressive; however, individuals in the first decile gain less than those in the second, third and fourth deciles, due to their lower likelihood to earn above the Work Allowance.

![](https://cdn-images-1.medium.com/max/2432/1*a0kz7ck9hBzc-npkfDT8rg.png)

Around a third of those affected see an increase in their disposable income of more than 5%. This reform targets those in the third income decile, with those in the first decile targeted around as much as those in the seventh.

![](https://cdn-images-1.medium.com/max/2712/1*9kCqPau-QsVxh0O5rAtmTw.png)

## Household impact

### Entitlement

This reform excludes unpaid and very-low-paid claimants from any gains, unlike the pandemic-related increases to the standard allowance, as those with earnings under the baseline Work Allowance will be unaffected by changes to the taper rate or allowance. As shown below, the increases to disposable income begin at the baseline work allowance, increase with earnings, and end once UC entitlement reaches zero.

![*How the reform affects net income for a non-renting two-adult, two-child household.*](https://cdn-images-1.medium.com/max/2712/1*8h6Scwp3WFIk2At1_-zQoA.png)**How the reform affects net income for a non-renting two-adult, two-child household.**

### Marginal tax rates

The marginal tax rate is the share of an additional pound of income that the government takes, through either taxation or benefit withdrawal. The reform reduces marginal tax rates in the main, but marginal tax rates will increase for some. The table below outlines the circumstances where marginal taxes will change.¹

![*How the UC reform affects marginal tax rates.*](https://cdn-images-1.medium.com/max/2000/1*5vOnR-QCusGaBhvRH_CfQQ.png)**How the UC reform affects marginal tax rates.**

A couple with two children and no rental costs will see their marginal tax rate fall if they earn between £6,180 and £32,540, and rise if they earn between £29,400 and £37,460, where they would be newly eligible for UC.

![How the reform affects marginal tax rates for a non-renting two-adult two-child household.](https://cdn-images-1.medium.com/max/2712/1*I3HUX7zt-N33mVlcW9NoyA.png)_How the reform affects marginal tax rates for a non-renting two-adult two-child household._

The reform lowers marginal tax rates more than it raises them, but its effect is reduced by Income Tax and National Insurance. Furthermore, the family is affected for longer by the taper rate, which is several times larger than any other marginal tax.

We’re pleased to share this first interactive analysis of the Autumn Budget UC reform, and the first to provide personalised household impacts. Our findings broadly resemble those from the [IFS](https://ifs.org.uk/uploads/Autumn-Budget-2021-Living-Standards-by-Xiaowei-Xu.pdf) and the [Resolution Foundation](https://www.resolutionfoundation.org/publications/the-boris-budget/), who also estimate the cost at around £3bn and identify similar distributional impacts.

For more timely analysis of tax and benefit reforms, follow us here and on social media, and to create your own policy, try PolicyEngine at [policyengine.org.](https://legacy.policyengine.org/)

_2021–11–04 update: This now reflects PolicyEngine 1.1.0, which incorporates Universal Credit’s minimum income floor for self-employed people._

_2021–11–06 update: This now reflects PolicyEngine 1.1.1, which calculates poverty consistently for the year 2021._

_2021–11–15 update: This now reflects PolicyEngine 1.1.8, which projects poverty thresholds and population to 2021._

[1]: Other programs, like the Child Benefit High-Income Tax Charge, can interact with Universal Credit to produce different results depending on household composition.



---

---
# Income Tax cuts Rishi Sunak is reportedly considering
Slug: income-tax-cuts-rishi-sunak-is-reportedly-considering
Date: 2021-12-04
Authors: Max Ghenis
Tags: uk, policy
Description: Explore the basic rate and additional rate cuts in PolicyEngine.

---

![100 Parliament Street](https://cdn-images-1.medium.com/max/2000/1*CXzE044rk2ZMpobYa7stoQ.png)_100 Parliament Street_

Yesterday, [The Times reported](https://www.thetimes.co.uk/article/rishi-sunaks-plan-to-slash-taxes-c30wd5kzx) that UK Chancellor Rishi Sunak is considering a number of tax cuts:

- Cutting the Income Tax basic rate from 20% to 19% in 2023, and then to 18% in 2024

- Scrapping the Income Tax additional rate of 45%, lowering the tax rate to 40% for income above £150,000

- Lowering the VAT headline rate, currently 20%

- Raising the threshold for inheritance tax, currently £325,000

PolicyEngine shows that the [combined Income Tax reforms](http://legacy.policyengine.org/uk/population-impact?add_rate=40&basic_rate=18) — lowering the basic rate to 18% and scrapping the additional rate — would cost £10.1bn per year, reduce poverty by 0.3%, benefit 71% of the public, and disproportionately increase the income of higher-income households.¹

## How Income Tax works

[Income Tax](https://www.gov.uk/income-tax-rates) nominally has four bands: a Personal Allowance, which is untaxed, and then a progressive structure of Basic (20%), Higher (40%), and Additional (45%) rates.

![gov.uk](https://cdn-images-1.medium.com/max/2000/0*Cui0kUXUHRCXsH37)_gov.uk_

However, because Personal Allowance phases out, Income Tax has six segments instead of four. Income in the Personal Allowance phase-out region (between £100,000 and £125,140), is taxed at a 60% marginal rate, as shown in this PolicyEngine graph.

![*Marginal tax rate schedule from Income Tax alone (PolicyEngine).²*](https://cdn-images-1.medium.com/max/3200/0*ny9SRyI1vvJWQ2XM)**Marginal tax rate schedule from Income Tax alone (PolicyEngine).²**

National Insurance and means-tested benefits significantly increase marginal tax rates, especially among low-income people, some of whom face marginal tax rates up to 69%. See [our report on the Autumn Budget Universal Credit reforms](https://blog.policyengine.org/analysing-autumn-budget-universal-credit-reforms-with-policyengine-2ce93f177428) for information and charts depicting those incentive schedules.

## PolicyEngine results

Navigating to [policyengine.org](https://legacy.policyengine.org) shows a *Policy *screen, and the left panel shows _Income tax_ and *Labour income *within that. This presents the tax rates that Sunak is reportedly considering changing. The basic rate can be adjusted at the top, and the additional rate can be repealed by setting the rate to 40% to match the higher rate.

![PolicyEngine](https://cdn-images-1.medium.com/max/3200/0*oG71EhArn_TrWtGP)_PolicyEngine_

PolicyEngine can show the impact of [lowering the basic rate to 19%](http://legacy.policyengine.org/uk/population-impact?basic_rate=19),³ [lowering the basic rate to 18%](http://legacy.policyengine.org/uk/population-impact?basic_rate=18), or [repealing the additional rate](http://legacy.policyengine.org/uk/population-impact?add_rate=40). It can also model combinations of repealing the additional rate and [also lowering the basic rate to 19%](http://legacy.policyengine.org/uk/population-impact?add_rate=40&basic_rate=19) or [also lowering the basic rate to 18%](http://legacy.policyengine.org/uk/population-impact?add_rate=40&basic_rate=18). The table below summarizes these five policy reforms.

[Interactive: 779bd0682ff1670b0c7d8e2eaf25a5b4]

The full combined policy — [lowering the basic rate to 18% and repealing the additional rate](http://legacy.policyengine.org/uk/population-impact?add_rate=40&basic_rate=18) — would be regressive, in that it would increase the net income more for higher earners than for lower earners, as a share of income.

![PolicyEngine](https://cdn-images-1.medium.com/max/3200/0*qU6Vy-7GSFaZkB6x)_PolicyEngine_

This policy benefits anyone with annual income exceeding the Personal Allowance of £12,570. But it only lowers marginal tax rates for people in the basic rate band — between £12,570 and £50,270 — and in the additional rate band — above £150,000.

![PolicyEngine](https://cdn-images-1.medium.com/max/3200/0*nzmOgGtBJfMUXFEL)_PolicyEngine_

For more results such as intra-decile charts, poverty rates by age, and net income of particular households (like your own!), explore the PolicyEngine links.

**Footnotes**

[1] This analysis is based on policy and data for October 2021, preceding Autumn Budget Universal Credit reforms that took effect last week. We do not adjust Scottish tax bands.

[2] To produce an Income Tax-only marginal tax rate chart in PolicyEngine, toggle all *Would claim [benefit] *switches off, and set the person’s age to 70 to exempt them from National Insurance.

[3] The Times estimated that a “1p cut in the basic rate of tax would cost about £6 billion a year”. This may refer to [HMRC’s estimate](https://www.gov.uk/government/statistics/direct-effects-of-illustrative-tax-changes/direct-effects-of-illustrative-tax-changes-bulletin-june-2021) that adjusting the basic rate by 1p would change revenues by 5.75bn in 2023–2024 and in 2024–2025. It may also, erroneously, trace to the [Liberal Democrats’ 2017 Manifesto](https://d3n8a8pro7vhmx.cloudfront.net/libdems/pages/1811/attachments/original/1515517284/2017_Manifesto.pdf?1515517284#page=19), which calls for a “1p rise on the basic, higher and additional rates of Income Tax to raise £6 billion”. PolicyEngine estimates that [raising each rate by 1p](http://legacy.policyengine.org/uk/population-impact?add_rate=46&basic_rate=21&higher_rate=41) would raise 5.9bn. But, in line with our 4.4bn estimate for raising only the basic rate, [HMRC estimates](https://www.gov.uk/government/statistics/direct-effects-of-illustrative-tax-changes/direct-effects-of-illustrative-tax-changes-bulletin-june-2021) that adjusting the basic rate by 1p would change revenues by 4.7bn in 2022–2023 (HMRC also does not adjust Scottish taxes in this analysis, and unlike PolicyEngine, they also do not adjust Welsh taxes).

_Updated 2021–12–06 to incorporate Autumn Budget Universal Credit reforms to the baseline policy._



---

---
# The Green Party Manifesto at PolicyFest
Slug: the-green-party-manifesto-at-policyfest
Date: 2022-01-26
Authors: Nikhil Woodruff
Tags: uk, policy
Description: Explore the Green Party Manifesto on PolicyEngine.

---

_Green Party campaigners. Credit: [John Blower](https://www.flickr.com/photos/10332960@N03/49090026921/in/photostream/)._

On Monday, I presented a PolicyEngine analysis of the Green Party of England and Wales’ 2019 manifesto at “PolicyFest”, an internal event for Green Party members. Martin Farley, who leads the party’s policy working group, and councillor Martin Osborne also co-presented at the session.

## The Green Party’s 2019 Manifesto, updated to 2021

As he [detailed in his blog post](https://martin-farley.medium.com/poverty-buster-the-impact-of-the-2019-green-party-manifesto-on-household-incomes-and-equality-9663c39b783b), Farley specified minor updates to the Green Party’s 2019 manifesto to comport with tax and benefit changes over the last three years, such as the rollout of Universal Credit. The following analysis reflects that adjusted version.

The manifesto raises revenue from several tax reforms:

- Abolishes the Personal Allowance, while increasing the higher rate threshold from £37,700 to £50,270

- Merges National Insurance rates into Income Tax

- Replaces existing property taxes (Council Tax, Stamp Duty, business rates) with a land value tax (1.2% for households, 1.9% for corporations)

- Introduces a carbon tax at £135 per tonne

The manifesto also reforms a number of benefits:

- Repeals Child Benefit, State Pension, and Pension Credit

- Repeals means-tested benefits except those related to housing, disability, and care, in both the legacy systems and components of Universal Credit

- Reduces the taper rate of Universal Credit from 55% to 40%

- Introduces a universal basic income of £75 per week for children, £94 per week for working-age adults, and £185 per week for pension-age adults

- Introduces a “single pensioner supplement” of £25 per week to pensioners living alone, reduced at a rate of 10% with non-benefit income

All of the above parameters are available now on PolicyEngine for anyone to use, including the newly-added _Single pensioner supplement_ under the _Green Party_ section.

## Analysis

PolicyEngine finds that implementing the manifesto would produce a net £15.8bn deficit, while reducing poverty by a third and leaving 67% of the population better off.

The manifesto would cut poverty similarly across age groups, though a bit more for children and seniors. The 33 percent overall reduction equals the poverty reduction seen in the 17-year period from 2003 to 2020.

![](https://cdn-images-1.medium.com/max/4656/1*XKN6nZgw8EbNyGaSoIlweg.png)

The manifesto produces a progressive distributional impact, with all income deciles outside the highest decile coming out (in aggregate) ahead. It reduces the Gini index of income inequality by 7.2% and the top 1 percent’s income share by 3.3%.

![](https://cdn-images-1.medium.com/max/4672/1*SGgumrN-B-ki1IpIHHzUfA.png)

This doesn’t mean all households within those deciles come out ahead: at least 10% of each decile come out behind, though 51% would see their income rise by at least 5%.

![](https://cdn-images-1.medium.com/max/4948/1*2hCtxWkRplhDWE5t5Eop7w.png)

Several factors explain the manifesto’s heterogeneous effects by income decile: some households receive larger welfare benefits under the existing system than the UBI; high-asset households would owe substantial land value tax; high-consumption households would owe substantial carbon taxes; and so on. To the extent that wealth and consumption diverge from income, these taxes may affect some low-income households, as we assume that all taxes are paid immediately.

The manifesto policy reduces the number of tax parameters and makes the tax code more monotonically progressive. Under the current system, most families with children and no housing costs face marginal tax rates above 50% in three earnings regions: the Universal Credit phase-out, the Child Benefit High-Income Tax Charge, and the Personal Allowance reduction. The Green Party manifesto policy eliminates all three, resulting in a progressive marginal tax schedule with only three rates (32%, 42%, and 47%). Families with housing costs or other qualifications for remaining means-tested benefits will continue to have high marginal tax rates in some earnings regions.

![*Marginal tax rates for a two-child, single-parent household with *£30,000 income and no housing costs](https://cdn-images-1.medium.com/max/3704/1*fDQGsO2DuAFM-cZvtutCSg.png)\**Marginal tax rates for a two-child, single-parent household with *£30,000 income and no housing costs\*

Overall, we find that the Green Party manifesto reduces poverty and inequality, benefits the majority of the population, simplifies tax and benefit rules, and reduces marginal tax rates on earnings, especially for low-income households. However, it produces a £15.8 billion deficit on a static basis. See the results in more detail, as well as a customizable household calculator and the option to reform the manifesto, [on PolicyEngine here](https://legacy.policyengine.org/uk/population-impact/green-party/manifesto-2019).

_Updated on 2022–02–04 to reflect PolicyEngine’s new accuracy-enhancing survey weights, and to increase the higher rate threshold from £37,700 to £50,270 following discussions with the Green Party._



---

---
# How PolicyEngine estimates the effects of UK carbon taxes
Slug: how-policyengine-estimates-the-effects-of-uk-carbon-taxes
Date: 2022-04-23
Authors: Nikhil Woodruff
Tags: uk, technical
Description: By fusing datasets with machine learning, we empower anyone to integrate custom carbon taxes with other tax and benefit reforms.

---

A carbon tax is a fixed price paid by corporations for every tonne of carbon dioxide emitted as part of their production process. Typically, it’s levied at the fossil fuel source (oil well, coal mine, gas site, etc.), or at the border for high-carbon imports. This tax has been [proposed](https://www.bloomberg.com/news/articles/2021-11-06/white-house-backed-carbon-tax-in-sight-for-biden-s-climate-bill) and [implemented](https://taxfoundation.org/carbon-taxes-in-europe-2021/) in multiple countries, often with the aim of reducing carbon emissions.

PolicyEngine allows users to simulate policies implementing carbon taxes in the UK (see the UBI Center policy menu), and adjust the assumptions on their incidence. In this post, we’ll go through how we estimate the effects of the tax.

![*Where to find carbon taxes in the PolicyEngine UK policy screen.*](https://cdn-images-1.medium.com/max/3200/0*mqJzs0Oc0Q53LaRM)**Where to find carbon taxes in the PolicyEngine UK policy screen.**

## Breaking down the carbon tax

PolicyEngine is a *static *model; that is, we assume that policy reforms do not change behaviour. Still, we allocate the burden of taxes to households, including taxes levied on corporations like a carbon tax.

Static models can allocate production taxes in three ways:

1. To consumers in the form of higher prices

1. To shareholders in the form of lower investment values

1. To employees in the form of lower wages

PolicyEngine currently models burdens on consumers and shareholders only, not yet employees. Our carbon tax model also allows users to change the share of the tax borne by consumers versus shareholders (the default value is 100% consumer burden).

The following two sections describe how we allocate the consumer and shareholder portions of the carbon tax to households, respectively.

## Estimating households’ carbon consumption

We use several data sources to estimate households’ carbon emissions:

- The Family Resources Survey (FRS)

- The Living Costs and Food Survey (LCFS)

- Carbon footprint estimates from the Office of National Statistics (ONS)

The FRS forms the foundation of PolicyEngine because of its detailed data on income, benefits, and demographics. However, it doesn’t contain information on household spending by consumption category; for that, we use the LCFS (which also has less detailed data on income and demographics). Exploiting the common variables across data sets, we build a model from the LCFS that predicts spending given income, and apply that to the FRS households. Specifically, we use our [synthimpute technology](http://github.com/policyengine/synthimpute) to build and train a random forest model to predict the distribution of possible spending values for each category (we do this after [reweighting](https://blog.policyengine.org/how-machine-learning-tools-make-policyengine-more-accurate-17af859cdd97)). We then sample from this distribution, adding a bias to preserve the correct total spending across all FRS households. At the end of this, we have predicted spending by category for each household in the FRS.

We apply a similar method with the ONS carbon footprint statistics. This data reports the total carbon emissions associated with each category of spending (the same categorisation as the LCFS uses). We also know the total spending associated with each category from the Living Costs and Food Survey (and now in the FRS, too). This enables us to estimate the _carbon intensity_ of each category: the carbon emissions associated with each pound spent. We can then multiply this intensity directly by the amount spent on each category to find the estimated carbon emissions for a given household.

![*Carbon emissions intensity by spending category.*](https://cdn-images-1.medium.com/max/2000/0*GBk5kkc5LsEaYZuf)**Carbon emissions intensity by spending category.**

This full process then provides estimated carbon emissions for each household in the FRS.

## Estimating households’ exposure to carbon taxes through shareholding

Since we don’t model the ability of firms to lower wages, the other half of the static carbon tax burden is households’ exposure through ownership of firms that would pay it. We assume that shareholders of companies will pay the carbon price, proportionally to their equity. Since we don’t have data on the types of companies that households invest in (only total equity holdings), we assume that their exposure is proportional to their total equity in all firms.

We calculate this at the household level, to integrate it with the rest of our model (and because all taxes are ultimately incident on households). In a similar manner to how we imputed consumption from the LCFS, we impute corporate wealth from the Wealth and Assets Survey for each FRS household. We then calculate the total shareholder-borne carbon tax, and distribute this proportionately to households with corporate wealth: this part of the tax is then no longer paid by consumers, only shareholders.

## Overall results

As [other](https://www.lse.ac.uk/granthaminstitute/publication/distributional-impacts-of-a-carbon-tax-in-the-uk/) [research](https://www.nber.org/papers/w15239) [has](https://ifs.org.uk/publications/15817) [found](https://www.elibrary.imf.org/view/books/071/21375-9781138825369-en/ch006.xml), we estimate that carbon taxes are regressive: they represent a higher proportion of disposable income for low-income households than high-income households. This is because low-income households spend more of their income on carbon-intensive goods and services like food, transport or housing, while high-income households save proportionately more.

![*Change to net income by equivalised disposable income decile for a £100 carbon tax, assuming 100% consumer incidence.*](https://cdn-images-1.medium.com/max/2334/0*WqMXO8DRE955C9Wn)**Change to net income by equivalised disposable income decile for a £100 carbon tax, assuming 100% consumer incidence.**

Increasing the proportion of the carbon tax borne by shareholders makes the carbon tax slightly more regressive from an income perspective, though less regressive from a wealth perspective. Many policy proposals include revenue recycling options, such as a per-capita dividend, to address regressivity.

## Household impacts

PolicyEngine’s household page allows users to enter their spending on various consumption categories to estimate their burden from a carbon tax. For example, since the [Green Party 2019 Manifesto](https://blog.policyengine.org/the-green-party-manifesto-at-policyfest-ee05a2d3b06d) included a carbon tax, entering this information would make the personalised impacts more accurate.

![Where to enter spending by consumption category in the PolicyEngine household screen to estimate carbon tax burdens.](https://cdn-images-1.medium.com/max/5792/1*4RxCk4AAFIEE8iIjkW7SDQ.png)_Where to enter spending by consumption category in the PolicyEngine household screen to estimate carbon tax burdens._

By fusing multiple data sources, PolicyEngine UK for the first time empowers anyone to design custom carbon taxes in conjunction with other tax and benefit reforms, and then to compute the population-wide and personalised impacts. If you have any questions or feedback about our model, please [let us know](mailto:contact@policyengine.org).

_Thanks to ​​Inés Fernández Barhumi and Reema Mohanty for their research assistance on our carbon tax model._



---

---
# Tax cuts in Prime Minister Truss's Growth Plan 2022
Slug: tax-cuts-in-prime-minister-trusss-growth-plan
Date: 2022-09-23
Authors: Max Ghenis
Tags: uk, policy
Description: See the impact on the population and on your household in PolicyEngine UK.

---

_UK Chancellor of the Exchequer Kwasi Kwarteng_

Earlier today, UK Chancellor Kwasi Kwarteng announced the [Growth Plan 2022](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf). The plan includes several provisions affecting National Insurance, Income Tax, and Stamp Duty:

- “reducing NICs rates by 1.25 percentage points from November and cancelling the Health and Social Care Levy coming in from April 2023.” (section [3.20](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf#page=20))

- “bring forward the 1 percentage point cut to the basic rate of income tax to April 2023” ([3.21](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf#page=20))

- “the additional rate of income tax will also be removed from April 2023” ([3.22](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf#page=20))

- “reverse the 1.25 percentage point increase in dividend tax rates from April 2023” ([3.23](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf#page=20))

- “From 23 September 2022, the government will increase the threshold above which Stamp Duty Land Tax (SDLT) must be paid on the purchase of residential properties in England and Northern Ireland from £125,000 to £250,000.” ([3.29](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf#page=21))

- “From 23 September 2022, the threshold at which first-time buyers begin to pay residential SDLT will increase from £300,000 to £425,000 and the maximum value of a property on which first-time buyers relief can be claimed will also increase from £500,000 to £625,000.” ([3.30](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1105989/CCS207_CCS0822746402-001_SECURE_HMT_Autumn_Statement_2022_BOOK_Web_Accessible.pdf#page=21))

[As we wrote yesterday](https://blog.policyengine.org/stamp-duties-in-policyengine-uk-6087dc05c135), PolicyEngine fuses property values across government surveys to provide the UK’s only publicly available model of stamp duties. Our unified, enhanced dataset and model allows us to score the Growth Plan’s Stamp Duty reforms alongside the Income Tax and National Insurance reforms, which we did [within minutes of its announcement](https://twitter.com/nikhil_woodruff/status/1573235941053026305) on Twitter.

**You can [see the population impact of the package here](https://legacy.policyengine.org/uk/population-impact?dividend_basic_rate=7_5&dividend_higher_rate=32_5&NI_add_rate=2&NI_class_4_add_rate=2&NI_main_rate=12&NI_class_4_main_rate=9&dividend_additional_rate=38_1&basic_rate=19&sdlt_on_non_first_home_2_rate=0&sdlt_first_time_buyer_value_limit=625000&sdlt_on_first_time_buyer_homes_2_threshold=425000&add_rate=40) and [compute the impact on your own household here](https://legacy.policyengine.org/uk/household?dividend_basic_rate=7_5&dividend_higher_rate=32_5&NI_add_rate=2&NI_class_4_add_rate=2&NI_main_rate=12&NI_class_4_main_rate=9&dividend_additional_rate=38_1&basic_rate=19&sdlt_on_non_first_home_2_rate=0&sdlt_first_time_buyer_value_limit=625000&sdlt_on_first_time_buyer_homes_2_threshold=425000&add_rate=40).** We’ve provided top-level results below.

## Impact on the UK population

Our static microsimulation model finds that the package, assuming all provisions occurred over the 2022 calendar year, would:

- Cost £16.2 billion

- Benefit 80% of the population, disproportionately those in higher income and wealth deciles

- Reduce poverty by 1.4%, disproportionately among seniors (1.9%)

- Increase income inequality: the policy increases the Gini index by 1.2%, the top 10%’s income share by 1.0%, and the top 1%’s income share by 2.2%

The policy has a larger net income benefit to those in higher income, both in relative and absolute terms. For example, it raises the top income decile’s net income by an average of £2,738 (2.5%) and that of the bottom decile by £45 (0.4%). The policy similarly benefits high wealth deciles more than low wealth deciles, though to a lesser degree.

![](https://cdn-images-1.medium.com/max/3200/0*K6sPZQEFXrGUDLLn)

[\*\*Explore more population-level charts in PolicyEngine here.](https://legacy.policyengine.org/uk/population-impact?dividend_basic_rate=7_5&dividend_higher_rate=32_5&NI_add_rate=2&NI_class_4_add_rate=2&NI_main_rate=12&NI_class_4_main_rate=9&dividend_additional_rate=38_1&basic_rate=19&sdlt_on_non_first_home_2_rate=0&sdlt_first_time_buyer_value_limit=625000&sdlt_on_first_time_buyer_homes_2_threshold=425000&add_rate=40)\*\*

## Impact on hypothetical households

The benefit of the reform increases with income for individual households, as well as in aggregate. For example, a single person with £50,000 employment income will gain £842, while a single person with £200,000 income will gain £5,220.

![](https://cdn-images-1.medium.com/max/2592/0*9MKAdl_sTwSpw7J3)

Their marginal tax rate falls by:

- 2.2p for income between £12,570 and £50,270

- 1.2p for income between £50,270 and £150,000

- 6.2p for income above £150,000

![](https://cdn-images-1.medium.com/max/2512/0*phxsV1pO3hY9D9CZ)

The policy affects a family of four (married, two children) differently due to the interaction between Income Tax and Universal Credit.

![](https://cdn-images-1.medium.com/max/2616/0*IFpdJgHe_DhBije5)

Their marginal tax rate falls less in the Universal Credit taper zone, by about 1.0p.

![](https://cdn-images-1.medium.com/max/2576/0*rBTcqEAVkIAKhnRz)

[\*\*Compute how the reform would affect your own household here.](https://legacy.policyengine.org/uk/household?dividend_basic_rate=7_5&dividend_higher_rate=32_5&NI_add_rate=2&NI_class_4_add_rate=2&NI_main_rate=12&NI_class_4_main_rate=9&dividend_additional_rate=38_1&basic_rate=19&sdlt_on_non_first_home_2_rate=0&sdlt_first_time_buyer_value_limit=625000&sdlt_on_first_time_buyer_homes_2_threshold=425000&add_rate=40)\*\*

## Be your own Chancellor

As always, you can also [experiment with a custom reform alongside Growth Plan 2022](https://legacy.policyengine.org/uk/policy?dividend_basic_rate=7_5&dividend_higher_rate=32_5&NI_add_rate=2&NI_class_4_add_rate=2&NI_main_rate=12&NI_class_4_main_rate=9&dividend_additional_rate=38_1&basic_rate=19&sdlt_on_non_first_home_2_rate=0&sdlt_first_time_buyer_value_limit=625000&sdlt_on_first_time_buyer_homes_2_threshold=425000&add_rate=40). If you’d prefer an alternative reform, how would you design it? Compute the impact in PolicyEngine and [let us know](http://twitter.com/thepolicyengine)!

![Labour Income Tax reforms under the Growth Plan 2022](https://cdn-images-1.medium.com/max/3200/0*4yqZPnpAmiRqYiUe)_Labour Income Tax reforms under the Growth Plan 2022_



---

---
# From idea to impact: scoring a policy reform on the new PolicyEngine UK
Slug: from-idea-to-impact-scoring-a-policy-reform-on-the-new-policyengine-uk
Date: 2023-01-12
Authors: Nikhil Woodruff
Tags: uk, technical
Description: A walkthrough of the new app on a UK tax-benefit reform.

---

Last week saw the 10-year anniversary of the introduction of the Child Benefit High Income Tax Charge, which recoups the value of the Child Benefit from high-income parents. Let’s walk through how to estimate the impact of abolishing it.

## The landing page

The landing page now has a new look. We know that PolicyEngine users usually fall into two categories: people who want to calculate their household’s taxes and benefits (sometimes under a policy reform), and people who want to run economic analyses of custom-built policy reforms (and also simulate example households). So we’ve split these use-cases up on the landing page.

We’re interested in building a new reform, so we’ll select _Compute the impact of policy reforms_.

## Building a policy

![](https://cdn-images-1.medium.com/max/2000/0*4JH9dNcZ-PG3uQfT)

_The policy builder page on PolicyEngine._

On this part of the app, we can specify the details of our policy reform, and simulate it on the economy. There are three panes in this view.

The _left pane_ is for navigation: use this to select what the middle pane should be showing. The top half is a menu of all the _input parameters_: policy parameters you can change to build a reform (for example, the basic rate of income tax). The bottom half is a menu of all the _outputs_: things the model can tell you about how your reform affects the economy (for example, the effect on poverty rates).

The _middle pane_ shows different things depending on what you’ve selected in the left pane. If you select a policy parameter, it’ll give you the option to change that parameter. If you select an output, it’ll show you a chart and some explanation.

The _right pane_ lets you control your policy reform at a high level: giving it a name, selecting where and when to simulate it, and against what baseline. You can also use this pane to move on from this screen and see how a specific household fares under a reform.

We want to build a reform that abolishes the High-Income Tax Charge: first, we need to select the right parameter. The left pane organises parameters by government department, so we could find it by navigating into _HMRC > Income Tax > Tax charges_.

But a faster way is to use the search bar in the top-left to jump straight to it. Search for _Child Benefit Tax Charge_ and you’ll see two parameters: one for the rate at which Child Benefit is phased out, and one for the threshold at which this happens.

![](https://cdn-images-1.medium.com/max/3200/0*12cujazBA1WE-nEb)

_Searching for the Child Benefit Tax Charge parameter._

We’ll select the phase-out rate. The middle screen now shows that parameter: its title, description, and a graph of its value over time. This is one of the most powerful new features in PolicyEngine: the ability to specify a time-dated parametric reform to _any_ degree of complexity. Instead of just being able to set a parameter’s value for the current year, you can set it for any time period, as many times as you’d like using the start-end date dialogue.

For now though, we’ll just set it to zero.

![](https://cdn-images-1.medium.com/max/3200/0*xPMcM0vcfwHPHsjp)

_Abolishing the HITC phase-out rate._

You’ll notice the right sidebar has updated with a description of our reform, and it’s been auto-designated the name _Policy #130_. Let’s rename it to _Abolishing the Child Benefit HITC_ by typing that into the name display in the top-right.

Now, we’re ready to see the economic analysis. Click on _Calculate economic impact_ to see how it affects the UK in 2023.

## Scoring the economic impact

The middle pane now shows a menu of what the model can tell you: the effect on the budget, poverty impacts, distributional impacts and more. Navigating onto the budgetary impact chart, we can see that this reform costs £2bn.

We can also look at the distributional impact, for example by selecting _Outcomes by income decile_. This reform mainly affects households in the top half of the income distribution, and the top decile sees the highest proportion of people affected by the reform.

![](https://cdn-images-1.medium.com/max/3200/0*MvMusKcRyoGntCJy)

_Distributional analysis of the HITC abolition._

## Calculating a household’s impact

Economic analyses are important for understanding the broader picture of a reform over an entire country, but policy discussions often centre around specific examples or edge cases. We’ve streamlined the design of the household calculator on PolicyEngine to make it easier and faster to get the numbers out of the model.

Select _Enter my household_ to jump into the household analysis page. This will take you to the household page (like you would have seen if you had selected _Compute household impacts_ at the very start, but now with your policy saved).

![](https://cdn-images-1.medium.com/max/3200/0*aDVMVAJoT3m9DI8p)

_The household calculator’s landing page._

This screen is set out just like the policy screen: the left pane is for navigation, and is split between inputs and outputs. The middle pane lets you change household properties instead of policy parameters, and the right pane now will show details about your household once you’ve entered them.

The household screen will now give you an option to start entering details about your household. Click through, and use the prompts given to specify a few basic details: adults and children, location, income and age (you’ll be able to add more later).

Once you’ve entered these, you’ll be taken straight to the _Net income_ page, which tells you how your household is affected by the reform.

![](https://cdn-images-1.medium.com/max/3200/0*kIyBGsv4KCRTA7oI)

_The net income screen._

This screen can tell us exactly why the household is affected like this: expand individual sections to trace down where the change comes from.

Another major new feature comes under the _Varying your earnings_ option in the bottom left pane: the ability to see how specific properties of a household change in response to earnings, not just net income. Here, we can use it to see how the HITC changed by income, with and without the reform.

![](https://cdn-images-1.medium.com/max/3200/0*dvGPkEAKASbQiCai)

_The HITC by income, under the abolition reform._

We can also see the impact on marginal tax rates: for a household with £55,000 income, abolishing the HITC lowers their MTR from 62% to 43%.

From here, you can go back and change any input variable (by the left navigation menu, or with the search box in the top left), go back and change the policy reform, or revisit any other part of the app.

Let us know what policy ideas you create, by tagging @ThePolicyEngine.



---

---
# The New PolicyEngine
Slug: uk-the-new-policyengine
Date: 2023-01-12 00:00:01
Authors: Max Ghenis
Tags: uk, impact
Description: We're taking economic policy to the next level with the most accessible tax and benefit model ever built.

---

At PolicyEngine, we strive to make tax and benefit policy accessible to everyone. That’s why we’ve not only built an open source rules engine for researchers, but also a free, intuitive web app where anyone can explore policies and customisable reforms.

Today we’re launching a new version of our web app that makes public policy more transparent and interactive than ever before. Our new app makes it easier to find the specific information you’re looking for, whether that’s navigating your household through taxes and benefits under current law, understanding how a policy reform could affect you, or designing a new policy. We’ve also added new functionality to increase the customisability, analytics, and shareability.

<center>[Interactive: AyN1kky8qew]</center>

If you’ve used PolicyEngine before, we think you’ll find the new version easier to use, and especially more delightful on mobile. We’ve also added a number of concrete new features, including:

- **Access to all household variables and policy parameters** in our model — several hundred in total — with a search box to cut down on clicks.

- **Named policies** that feed into chart titles.

- **Simplified household questionnaire** so you can estimate your taxes and benefits fast.

- **Deep linking to specific households, policies, and charts** for easier sharing.

- **Auto-generated code** to reproduce results with our open source Python package.

- **Cliff impact**, estimating how a reform affects the population share for whom an earnings increase would lower net income (more on that in a future post soon).

For more information:

1. [Read our companion blog post](https://policyengine.org/uk/research/from-idea-to-impact-scoring-a-policy-reform-on-the-new-policyengine-uk) which walks through how to use the new app, using the [Child Benefit High Income Tax Charge](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=5&region=uk&timePeriod=2023&baseline=1) as a case study

1. [Follow us on Twitter](http://twitter.com/thepolicyengine), where we’ll share tips and examples

1. [Register for our newsletter](https://t.co/leLJvbI7TQ) to stay up to date on enhancements and use cases

1. [Tune in to our webinar](https://us02web.zoom.us/meeting/register/tZIpcOmqqTsoGdQBusp41i_Vm8PSMCGu8YIN) Tuesday at 4pm

We’re as excited to share this milestone as we are to keep improving the product. To share your feedback, feel free to reach out by [email](mailto:hello@policyengine.org), [Twitter](http://twitter.com/thepolicyengine), or [GitHub](http://github.com/policyengine).

![](https://cdn-images-1.medium.com/max/3200/0*vfEEhsDH_4l8HZIg)



---

---
# Reform UK's Emergency Recovery Plan
Slug: reform-uks-emergency-recovery-plan
Date: 2023-02-09 11:15:00
Authors: Nikhil Woodruff
Tags: uk, policy
Description: See the UK party's proposed deficit-funded tax cuts in PolicyEngine

---

In June 2022, Reform UK adopted a set of policy proposals advocating broad tax cuts, funded by deficit spending. In this report, we analyse the provisions of this policy package using PolicyEngine tax-benefit modelling, comparing budgetary impacts against those reported by Reform UK and computing distributional impacts across the income spectrum.

## Reform UK’s proposals

The [Emergency Recovery Plan](https://assets.nationbuilder.com/reformuk/pages/27/attachments/original/1655061791/Reform_UK_-_Emergency_Recovery_Plan_June_22.pdf?1655061791) includes reforms to taxes on income and consumption, containing the following provisions.

![](https://cdn-images-1.medium.com/max/2000/1*jmpWEyv7OEylKpxMnTB-oA.png)

_Provisions in Reform UK’s Emergency Recovery Plan, alongside PolicyEngine’s cost estimates._

For this analysis, we considered only those occurring over the next year (therefore excluding the tax inflation indexing). We also excluded the abolition of environmental levies, non-household fuel duty and government spending cuts- these are currently out of the scope of our model.

## Overall budgetary impact

In total, we project that these reforms would reduce tax revenues by £67 billion if enacted over 2023. Welfare spending would automatically fall by £915 million due to means testing, resulting in an net cost of £66.1 billion.

![](https://cdn-images-1.medium.com/max/2000/0*3E3MPE6q_RJB1fPK)

_Overall budgetary impact of the Economic Recovery Plan._

## Distributional impact

We estimate that the average household’s income would rise by 6%, with gains highest for the seventh decile and lowest for the tenth (largely because many households in the tenth decile cannot benefit from the Personal Allowance increase due to being over the phase-out region).

![](https://cdn-images-1.medium.com/max/2000/0*3rc1RlNXmIp96LlJ)

_Relative change to net income by decile under the Economic Recovery Plan._

The first income decile sees an average income gain of £468, compared to £5,350 for the top decile.

![](https://cdn-images-1.medium.com/max/2000/0*IlIMx61Z3uTDk_WQ)

_Absolute change to net income under the Economic Recovery Plan._

By lowering consumption and income taxes together, the reforms reach all households, and 81% of households see their net income rise by over 5%. This ‘strong increase’ is lowest for the second decile at 58%, rising to 99% in the ninth decile.

![](https://cdn-images-1.medium.com/max/2000/0*7fPvGpzwxibSeDEr)

_Distribution of outcomes by income decile under the Economic Recovery Plan._

## Poverty and inequality

Under the proposed reforms, we estimate that the absolute, before-housing-costs poverty rate would fall by 2 percentage points (12.6%), representing a net decrease of 1.3 million people experiencing poverty. Deep poverty also falls 7%, from 2.3% to 2.2%.

![](https://cdn-images-1.medium.com/max/2000/0*5fjRZyfdeicohqFz)

The Emergency Recovery Plan would reduce income inequality according to the three measures we report.

![](https://cdn-images-1.medium.com/max/2000/0*Me-OW-00Wh9TVerc)

_Change to inequality metrics under the Economic Recovery Plan._

## Work incentives

The Economic Recovery Plan would have mixed effects on work incentives. The Personal Allowance increase reduces marginal tax rates for low and middle income households, while raising marginal tax rates for those on higher incomes.

For example, a married couple with two children would see their marginal tax rate fall by 9% while they remain within Universal Credit eligibility (the marginal rate does not fall by the full 20% basic rate due to the Universal Credit taper). As a result of the reforms, they would exit UC eligibility earlier, lowering marginal tax rates by up to 37 percentage points.

However, once reaching the higher rate threshold, they face a work disincentive that is now more punitive under the Economic Recovery Plan: the Marriage Allowance income limit. Under the Marriage Allowance, couples can transfer up to 10% of the Personal Allowance to the higher earner of the two, if that higher earner is a basic rate taxpayer. This causes a sudden increase in tax liability (usually described as a [‘cliff’](https://legacy.policyengine.org/us/blog/2023-02-02-how-would-reforms-affect-cliffs)) when the earner reaches the end of the basic rate region, and this cliff is made larger by the increased size of the Personal Allowance.

Further up the income spectrum, another work disincentive under current law is the phase-out of the Personal Allowance, at a rate of 50p per £1 earned over £100,000. This causes a 62% marginal tax rate under current law between £100,000 and £125,000; under the Economic Recovery Plan, this high-marginal tax rate region would be extended to £140,000.

![](https://cdn-images-1.medium.com/max/2000/0*WVDTeH4b9HS8d0At)

_Change to marginal tax rate by employment income, for a single-earner married couple with two children._

Reflecting this, the overall change to net income phases in until £65,000. After this point, gains are smoothly tapered away after £125,000 before reaching zero.

![](https://cdn-images-1.medium.com/max/2000/0*eS-8ASirEFxhcvYU)

_Change to net income by employment income, for a single-earner married couple with two children._

## See the effect on your household

As always, you can [see the impact of Reform UK’s proposals on your own household](https://legacy.policyengine.org/uk/household?focus=intro&reform=3701&region=uk&timePeriod=2023&baseline=1) (or try out a variation of them) on PolicyEngine. [Let us know](https://twitter.com/PolicyEngineUK) what policy impacts you compute!



---

---
# The UK's extended Energy Price Guarantee
Slug: projected-impact-of-the-uks-extended-energy-price-guarantee
Date: 2023-03-05 07:30:00
Authors: Nikhil Woodruff, Max Ghenis
Tags: uk, policy
Description: Analysis by PolicyEngine on the expected effects on income, poverty, and inequality.

---

_Credit: DALLE-2_

According to [a report by The Times](https://archive.is/MnyZd#selection-773.0-1329.308), Chancellor Jeremy Hunt is expected to announce an extension of the £2,500 energy price guarantee (EPG) for an additional three months. The government structures the EPG such that the typical household bill does not exceed £2,500 per year. The Times reports that the government estimates this extension to cost approximately £3 billion.

At PolicyEngine, we have conducted an analysis of the projected impact of the extended EPG. Our budgetary impact matches the government’s, at £3.1 billion, and we also find that it will provide greater benefits to high-income households in absolute terms, while lower in relative terms; as a result, the reform would reduce poverty by about 1% and income inequality by about 0.2%.

To model the EPG, we integrate consumption data (including domestic energy) from the Living Costs and Food Survey to our enhanced Family Resources Survey, which powers PolicyEngine. We then simulate energy costs with and without the EPG, controlling for seasonality (see [our model documentation](https://policyengine.github.io/policyengine-uk/programs/gov/ofgem/energy-price-guarantee.html) for more).

![](https://cdn-images-1.medium.com/max/3200/0*uJbpkMLFSK2SZTts)

We model the EPG as an increase in incomes, and find that the [absolute impact increases with income](https://legacy.policyengine.org/uk/policy?focus=policyOutput.decileAverageImpact&reform=5847&region=uk&timePeriod=2023&baseline=1): households in the bottom income decile will gain an average of £78, while those in the top decile will gain £155.

![](https://cdn-images-1.medium.com/max/3200/0*RFB646z2NHZEM6yE)

As a [percentage of net income](https://legacy.policyengine.org/uk/policy?focus=policyOutput.decileRelativeImpact&reform=5847&region=uk&timePeriod=2023&baseline=1), however, households in the bottom income decile would gain 0.7%, and those in the top decile would gain 0.1%.

![](https://cdn-images-1.medium.com/max/3200/0*wXy3ocBoFdcAR_d3)

Accordingly, we project that the EPG extension would [reduce income inequality by about 0.2%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=5847&region=uk&timePeriod=2023&baseline=1) across metrics including the Gini coefficient, the top-10 and the top-1 percent shares.

![](https://cdn-images-1.medium.com/max/3200/0*ykeEoMNKJXTRjmIb)

Extending the EPG would [lower poverty by 0.9%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=5847&region=uk&timePeriod=2023&baseline=1), disproportionately among pensioners.[^1] It would also[ lower deep poverty by 1%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.deepPovertyImpact&reform=5847&region=uk&timePeriod=2023&baseline=1), similarly across age groups.

![](https://cdn-images-1.medium.com/max/3200/0*uHZzOqtB7nZ7m0TO)

You can [view the impact interactively in PolicyEngine here](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=5847&region=uk&timePeriod=2023&baseline=1), and even model your own custom EPG reform. You can also [enter your household information](https://legacy.policyengine.org/uk/household?focus=intro&reform=5847&region=uk&timePeriod=2023&baseline=1) to see how the EPG extension would affect you (to do this, enter the ‘domestic energy consumption’ field under _Consumption / Energy_ or by searching in the top left).

At PolicyEngine, we remain committed to providing free open-source software that enables the analysis of public policy impacts. Users with access to UK Data Service microdata can [reproduce our analysis](https://legacy.policyengine.org/uk/policy?focus=policyOutput.codeReproducibility&reform=5847&region=uk&timePeriod=2023&baseline=1&household=10576) with the [open-source PolicyEngine UK microsimulation model](https://github.com/PolicyEngine/policyengine-uk). For questions or comments on these impacts, feel free to [get in touch](mailto:hello@policyengine.org).

[^1]: PolicyEngine's poverty rate impacts are lower than an initial estimate [published on the day](https://twitter.com/PolicyEngineUK/status/1631600746520010754), due to modelling improvements on cost-of-living payments in the baseline. See the changelog entry in the microsimulation model [here](https://github.com/PolicyEngine/policyengine-uk/compare/0.41.10...0.41.11).



---

---
# Breaking down poverty impacts by sex
Slug: breaking-down-uk-poverty-impacts-by-sex
Date: 2023-03-08 07:30:00
Authors: Nikhil Woodruff
Tags: uk, technical
Description: PolicyEngine estimates the impact of customisable policy reforms on poverty — overall, by age, and now by sex.

---

Welcome to the latest blog post from PolicyEngine, where we share updates on our work to build free, open-source software that helps people understand the impact of public policies. We’re excited to announce an additional feature for our existing tax and benefit reform calculator that enables users to estimate how customisable tax and benefit reforms affect the poverty rate, split by sex.

Since our inception, we’ve shown how customizable policy reforms would affect the poverty rate, overall and by age group. We model impacts under the government’s standard definition of poverty used in the Households Below Average Income publication (considering absolute poverty based on disposable income before housing costs).

We estimate that, under current law, 14.0% of the population has resources below their poverty threshold, and 2.4% has resources below half their poverty threshold (deep poverty). Women face higher poverty rates than men, and children face higher poverty rates than working-age adults, who face higher poverty rates than seniors. These poverty trends resemble those in the [HBAI report](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2021/households-below-average-income-an-analysis-of-the-income-distribution-fye-1995-to-fye-2021#main-stories), though the exact numbers differ as [we adjust survey data](https://policyengine.org/uk/research/how-machine-learning-tools-make-policyengine-more-accurate) and apply 2023 policy rules. Deep poverty does not vary much by sex, though seniors have much lower rates, due largely to Pension Credit.

![](https://cdn-images-1.medium.com/max/5236/1*UR6jZxb9w3nVy02YIkRO_A.png)

Let’s consider an example to illustrate the power of our updated tool. Suppose we want to estimate the poverty impact of the Child Benefit, an unconditional cash transfer to parents of children (or young adults in further education). With PolicyEngine, anyone can compare today’s poverty rate to a scenario without Child Benefit — overall, by age group, and now by sex.

We estimate that the Child Benefit reduces poverty by 9.3% and deep poverty by 18.5%. Our pre-existing charts show that Child Benefit disproportionately benefits children, [reducing child poverty by 15.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=1&region=uk&timePeriod=2023&baseline=3846) and [deep child poverty by 35.6%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.deepPovertyImpact&reform=1&region=uk&timePeriod=2023&baseline=3846).

Our new charts show that the [Child Benefit lowers poverty by 9.2% for men and 9.4% for women](https://legacy.policyengine.org/uk/policy?focus=policyOutput.genderPovertyImpact&reform=1&region=uk&timePeriod=2023&baseline=3846).

![](https://cdn-images-1.medium.com/max/2000/0*dTF1Zl3haJDrPs5n)

We also find that the [Child Benefit lowers deep poverty by 18% for men and 19% for women](https://legacy.policyengine.org/uk/policy?focus=policyOutput.genderDeepPovertyImpact&reform=1&region=uk&timePeriod=2023&baseline=3846).

![](https://cdn-images-1.medium.com/max/2000/0*MWOuUkGGwbL_3_Vz)

Our updated tax and benefit reform calculator is a powerful tool that uses the standard poverty definition to help policymakers, researchers, and advocates better understand the impact of public policies on poverty rates, both overall and in deep poverty, for men and women. By providing policymakers with more accurate data on the impact of policy decisions, we can inform public discourse and facilitate evidence-based decision-making.



---

---
# Analysis of the Spring Budget 2023
Slug: analysis-of-the-spring-budget-2023
Date: 2023-03-15 18:10:00
Authors: Nikhil Woodruff
Tags: uk, policy
Description: PolicyEngine analysis estimates the impact of the EPG extension and the fuel duty freeze.

---

[See the full impact on PolicyEngine here.](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=5847&region=uk&timePeriod=2023&baseline=1544)

Today saw the announcement of the 2023 Spring Budget for 2023, with significant changes to energy subsidies in particular. In this report, we analyse the budgetary, distributional, poverty, and inequality aspects of two of the largest reforms using data from the PolicyEngine UK microsimulation model.

## Policy changes modelled

- The Energy Price Guarantee (EPG) is fixed at £2,500 for three extra months (April to June), down from the £3,000 it would have been. The EPG limits the average households’ energy bills, with the government covering spending (for the fixed average household energy usage) above the cap. We estimate the cost of this policy is £3.1 billion.

- Fuel duty is frozen at 53p per litre, instead of increasing to 65p. This continues the temporary 5p cut from last year and cancels the planned Retail Price Index (RPI) inflation increase. We estimate the cost of this policy is £4.2 billion.[^1]

The combined cost of these policy changes is £7.3 billion. This is similar to HM Treasury’s estimate for FY 2023–24 at £7.8bn.[^2]

![](https://cdn-images-1.medium.com/max/2000/0*sb3J3Fm72YWNDoZy)

## Distributional Analysis

The average gain per household across income deciles ranges from £153.03 in the first decile to £484.43 in the tenth decile.

[Chart: x-axis: Age group, y-axis: Poverty rate change, type: bar]

When looking at the relative gains, the impact is largest for the first decile at 1.5%, while the smallest impact is for the tenth decile at 0.4%.

## Poverty and inequality

The reforms contribute to a reduction in poverty rates. The overall poverty rate drops from 14.96% to 14.53%, while deep poverty decreases from 2.11% to 2.05%. Children and seniors see reductions in poverty as well, with the child poverty rate declining from 21.71% to 21.24% and the senior poverty rate falling from 8.47% to 7.86%.

![](https://cdn-images-1.medium.com/max/2000/0*PT7JLE0n2bgMKeGG)

When considering gender, both males and females experience a reduction in poverty rates, with females seeing a decrease from 15.61% to 15.14% and males from 14.30% to 13.92%.

In terms of inequality, the Gini coefficient decreases slightly from 0.336 to 0.335, and the share of income for the top 10% and top 1% of earners also declines slightly.

![](https://cdn-images-1.medium.com/max/2000/0*qRNuJ84GV5roH5Vb)

## Conclusion

The Spring Budget 2023’s policy changes regarding energy and fuel have a budgetary impact of £7.3 billion, with nearly all people (98%) gaining from these reforms. The policies have a larger relative impact on lower-income households, contribute to a reduction in poverty rates and inequality under several different metrics.

[^1]: To estimate the impact of the fuel duty freeze, we compare it against a counterfactual scenario in which the fuel duty rate was raised to 65p.

[^2]: See the policy costing document [here](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1142824/Costing_Document_-_Spring_Budget_2023.pdf#page=9).



---

---
# Breaking down policy impacts by wealth decile
Slug: breaking-down-policy-impacts-by-wealth-decile
Date: 2023-03-28 09:00:00
Authors: Nikhil Woodruff
Tags: uk, technical
Description: Income isn't everything.

---

_A UK mansion. Credit: DALLE-2._

Since our earliest days, we’ve broken the impact of policy reforms by income decile. For example, our [very first report](https://policyengine.org/uk/research/analysing-autumn-budget-universal-credit-reforms-with-policyengine) found that the 2021 Autumn Budget Universal Credit reforms would raise the net income of households in the third income decile by 1.6%, more than any other decile.

![](https://cdn-images-1.medium.com/max/2432/0*YvFdT6fnE10-nRUR)

We’ve changed a lot in the past 18 months, but that chart remains one of the most important for conveying the distributional impact of a reform. We also show the impact in pounds, and the distributional impact *within *each income decile.

But income isn’t everything. The UK searched for “wealth inequality” about half as much as “income inequality” in [Google searches](https://trends.google.com/trends/explore?geo=GB&q=income%20inequality,wealth%20inequality), and three-quarters as much in [the news](https://trends.google.com/trends/explore?geo=GB&gprop=news&q=income%20inequality,wealth%20inequality).

![](https://cdn-images-1.medium.com/max/3200/0*CrX9pRSwE_xKc4uq)

Reflecting this interest in wealth inequality, PolicyEngine UK now provides breakdowns by wealth decile as well as income decile.

## How PolicyEngine breaks down by decile

Our approach largely mirrors that of income grouping: we first sort UK households by their total wealth (including corporate and property wealth). We then partition this ordered set of households into ten groups of _equal population size_ (this means that the groups might have different numbers of households, but the same number of people).

Corporate wealth includes the following:

- Non-defined benefit pensions

- Employee shares and options

- Other UK shares

- Investment ISAs

- Unit investment trusts

Property wealth includes:

- Primary residences

- Non-primary residences

- Non-residential property

PolicyEngine simulates policy reforms over a dataset of tens of thousands of households, based on the [Family Resources Survey](https://www.gov.uk/government/collections/family-resources-survey--2) (FRS). The FRS doesn’t include data on households’ wealth, so we use another survey — the [Wealth and Assets Survey](https://www.gov.uk/government/statistics/personal-wealth-statistics-and-the-wealth-and-assets-survey) (WAS) — to estimate wealth values.

## Example: 1% land value tax

Let’s explore a policy that affects income deciles differently than it affects wealth deciles: a land value tax. This policy taxes owners of land (including their residence) based on the value of the land, rather than the land and structure combined.

To see the impacts by decile for [this policy](https://legacy.policyengine.org/uk/policy?focus=policyOutput.decileAverageImpact&reform=2320&region=uk&timePeriod=2023&baseline=1), choose from the newly-added chart options in the bottom left. There are three different wealth breakdown charts:

- _Absolute impact by wealth decile_: showing the absolute (£) average impacts by decile

- _Relative impact by wealth decile_: showing the impact as a percentage of income

- _Outcomes by wealth decile_: showing the distribution of outcomes within each wealth decile, in terms of how much it affects households’ net income

![](https://cdn-images-1.medium.com/max/3200/0*p7v9OzI_T7AJz5_k)

At 1%, the policy has a progressively increasing average impact by income decile in absolute terms, but lower income deciles see their income fall more as a percentage of income. This is largely due to households who might be considered ‘asset-rich, cash-poor’. (This might not occur if people respond to the tax by reducing their wealth, but PolicyEngine does not apply such behavioural responses).

![](https://cdn-images-1.medium.com/max/3200/0*4ptlM1KqAxqHWdh7)

But if we look at the impacts by wealth decile, we find that the policy is progressive even as a percentage of income, and the bottom three deciles face no impact at all (rounded to the nearest 0.1%).

![](https://cdn-images-1.medium.com/max/3200/0*92WpS-YPO8PcmXr9)

While decile averages are useful, they don’t tell us how mixed the outcomes were in each decile. For example, a policy might benefit most people in a decile, but have an overall negative impact if those were outweighed by a smaller number of households losing out — and this would look the same as a policy which negatively affected everyone in a decile to a smaller extent.

To see what’s going on inside the deciles, we can use the _Outcomes by wealth decile_ chart. This breaks down each wealth decile, and shows the percentage of people who:

- Gained more than 5% of their income

- Gained less than 5% of their income

- Experienced no change

- Lost more than 5% of their income

- Lost more than 5% of their income

For this policy, the chart shows a clearly increasing impact across the deciles, and reveals something more about the third decile: although there is no overall rounded impact, 14% of the decile experiences some small decrease in net income- just not enough to influence the overall decile average.

![](https://cdn-images-1.medium.com/max/2860/0*15I3IwS6oH2lB4l9)

Understanding the impact of policy reforms on wealth as well as income deciles provides a more comprehensive picture of distributional effects. By incorporating this new feature, PolicyEngine UK enables users to see how different policy ideas affect people given their wealth. We encourage users to [try out the new feature](https://legacy.policyengine.org/uk) and provide feedback or feature requests through [social media](http://twitter.com/thepolicyengine) or [email](mailto:contact@policyengine.org).



---

---
# Repealing the Universal Credit two-child limit
Slug: repealing_the_two_child_limit
Date: 2023-08-07 16:00:00
Authors: Nikhil Woodruff
Tags: uk, policy
Description: How removing the limit of some benefits to two children would affect the UK in 2023.

---

_[See the full, customisable impacts on PolicyEngine
here.](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=18304&region=uk&timePeriod=2023&baseline=1)_

## Summary

Introduced in 2017, the two-child limit in Universal Credit restricted
parents from receiving financial support for more than two children
(with children born before 2017 exempt). Using the PolicyEngine
microsimulation model, we estimate that [repealing it would cost £1.8
billion in
2023](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=18304&region=uk&timePeriod=2023&baseline=1),
rising to £2.8 billion in 2025 as non-exempt age cohorts replace exempt
children. The repeal would also lower absolute child poverty before
housing costs by 310,000 this year.

While the Cameron-led Conservative government introduced the two-child
limit, last month, Labour Party leader Sir Keir Starmer [confirmed that
a Labour government would keep the
policy](https://www.theguardian.com/politics/2023/jul/16/labour-keep-two-child-benefit-cap-says-keir-starmer)
due to the cost of repealing it.

In this analysis, we examine how the policy currently affects
households, and use PolicyEngine to estimate the distributional and
poverty impacts of both full and partial repeals proposed by the Child
Poverty Action Group and the Fabian Society. We also attempt to
reproduce claims made using other microsimulation models. The
[open-source code powering the custom analyses in this report can be
found
here](https://gist.github.com/nikhilwoodruff/447d86032ff481bdeb1e35aeeb3ea18c).

[**_See how repealing the two-child limit would affect your household
here._**](https://legacy.policyengine.org/uk/household?focus=intro&reform=7226&region=uk&timePeriod=2023&baseline=1)

# How the policy affects households

Households claiming Universal Credit, or the legacy Child Tax Credit,
currently do not receive additional benefits for their third or
subsequent children. With benefit levels recently uprated as of April
2023, the two-child limit reduces benefits by up to £2,935 per child
(lowered with increased parental earnings as the family reduces their
Universal Credit entitlement). The cap applies regardless of whether a
household is in or out of work, but its impact changes with earnings due
to the normal Universal Credit taper.

Figure 1 shows the impact of removing the two-child limit under a range
of employment incomes for a single parent family. The gains are highest
(and equal) for families under around £30,000 in employment income,
after which point the taper rate begins to reclaim the extra benefit
value. For a single parent with 5 children, this value will not be
reduced to zero before more than £60,000 in earnings.

![A graph with numbers and lines Description automatically
generated](/images/posts/repealing_the_two_child_limit/hh_impact.png)

_Figure 1: the impact of removing the UC child limit on net income for a
single parent by number of children and employment income. Note: this
does not incorporate housing costs, which would extend the phase-out
region to the right._

## Repealing the cap

The most straightforward way to repeal the cap is to remove it entirely,
at a cost of £1.8bn in 2023. [^1] This net cost rises over time due to
age cohort transitions: with each year, the minimum age required to be
exempt under the 2017 transitional protection rule increases.[^2]

Under a full abolition, we estimate that the number of children in
absolute poverty before housing costs would fall by 255,000 in 2023
(relative, after housing costs child poverty would fall by 162,000). The
overall absolute, before housing costs poverty rate for all individuals
would fall by 0.7 percentage points, bringing just under 450,000 people
out of absolute poverty.

Table 1 shows a range of other estimates made by the Child Poverty
Action Group using the UKMOD microsimulation model, and PolicyEngine's
replications for comparison. The appendix contains more details about
the reasons PolicyEngine's microsimulation modelling differs from other
estimates.

| Estimate                                                      | CPAG/UKMOD | PolicyEngine | Difference | Relative |
| ------------------------------------------------------------- | ---------- | ------------ | ---------- | -------- |
| Net cost                                                      | £1.3bn     | £1.8bn       | +£500m     | +38%     |
| Child poverty reduction (relative, AHC)                       | 250,000    | 162,000      | -88,000    | -35%     |
| Children in affected households                               | 1,500,000  | 1,780,000    | +280,000   | +19%     |
| Children benefitting but remaining in poverty (relative, AHC) | 850,000    | 1,320,000    | +470,000   | +55%     |

_Table 1: comparisons between CPAG's UKMOD-based modelling results and
PolicyEngine's replications_ _for 2023._

## Alternative repeal methods

The Fabian Society's 2021 report _"Going with the grain"_ proposes
instead repealing the two-child limit for families with a parent who
meets one of the following conditions:

- Having employment or self-employment income

- Receiving disability benefits

- Having a child aged two or under

We estimate this partial abolition would cost £1.3 billion in 2023,
saving £500m compared to the full repeal. The Fabian Society modelling,
based on the IPPR tax-transfer model, projected that the number of
households hit by the two-child limit would fall by 94% from 790,000 to
75,000. This projection assumes a full roll-out of the policy as it
would be in 2035, where the transitional protection rule does not occur.

PolicyEngine estimates in 2023 that 333,000 households are affected by
the two-child limit (close to [estimates by the House of Commons Library
in April 2021 that 317,500 families were
affected](https://commonslibrary.parliament.uk/research-briefings/cbp-9301/)),
and that this would fall by 302,000 to 31,000 (a reduction of 93%, close
to the Fabian Society estimate).

## Conclusion

PolicyEngine's modelling largely aligns with the findings from other
microsimulation models but finds around 30% lower net costs and poverty
impacts than CPAG.

Funding proposals also feature in the discussion around the two-child
limit. Tom Clark, fellow at the Joseph Rowntree Foundation, [pointed to
a 1p increase in the higher rate of income tax as a possible
option](https://twitter.com/prospect_clark/status/1680875250542575618?s=20).
Given our higher net cost estimate for the two-child limit repeal, we
estimate this would leave £470m deficit (distributional impacts shown in
Figure 2).

![A graph of a graph showing the amount of income decile Description
automatically generated](/images/posts/repealing_the_two_child_limit/decile_chart.png)

_Figure 2: [the distributional impacts of funding the two-child limit
repeal with a 1p higher rate
increase.](https://legacy.policyengine.org/uk/policy?focus=policyOutput.decileRelativeImpact&reform=18067&region=uk&timePeriod=2023&baseline=1)_

PolicyEngine's microsimulation modelling is completely open-source. [See
the full analysis for the repeal on PolicyEngine
here.](https://legacy.policyengine.org/uk/policy?focus=policyOutput.decileRelativeImpact&reform=7226&region=uk&timePeriod=2023&baseline=1)
If you have feedback or questions on the results in this report, please
do [get in touch](mailto:hello@policyengine.org).

## Appendix: reconciling administrative and survey data

When first estimating the impacts of this reform, we used our Family Resources Survey-based
microdata and reached impacts of lower magnitude. However,
administrative statistics suggested that the true impacts may in fact be
larger, so we extended our data enhancement process to repair the
specific biases remaining present in the FRS under the guidance of the
administrative statistics.

Microsimulation models based on survey microdata often reach estimates
differing from administrative data, due to sampling or measurement bias
in the data collection process. PolicyEngine applies a calibration
process to adjust for this as much as possible by both imputing missing
income data and reweighting households to repair consistency with
administrative totals.

To illustrate, take the following example (based on completely
hypothetical characteristics).

| Household               | Total income | Original weight | Calibrated weight |
| ----------------------- | ------------ | --------------- | ----------------- |
| High-earner             | £80,000      | 2m              | 5m                |
| Low-earner              | £25,000      | 25m             | 22m               |
| Original survey total   | £785bn       | 27m             | 27m               |
| Administrative total    | £950bn       | 27m             |                   |
| Calibrated survey total | £950bn       | 27m             |                   |

By adjusting survey weights, we can shift the distributions of survey
variables to reconcile them with more trusted administrative data. This
requires collecting as many administrative statistics as possible, and
calibrating as closely as possible to them all, together. In the example
above, it was possible to match exactly, but this often isn't possible
in practice because we are operating on a survey, and not a census.

A key learning point in this report was the government's [administrative
statistics on households affected by the two-child
limit](https://www.gov.uk/government/statistics/universal-credit-and-child-tax-credit-claimants-statistics-related-to-the-policy-to-provide-support-for-a-maximum-of-2-children-april-2023/universal-credit-and-child-tax-credit-claimants-statistics-related-to-the-policy-to-provide-support-for-a-maximum-of-two-children-april-2023).
Using benefit administrative databases, the Department for Work and
Pensions estimated that in April 2023 around 1.5 million children lived
in households meeting two conditions:

- The household claims Universal Credit or the Child Tax Credit.

- The household does not receive a child element for at least one
  child.

Our initial model estimate was lower than this (around £1.3m children),
largely due to biases in the Family Resources Survey not fully countered
by our data enhancement process (although we included child counts and
Universal Credit caseloads in our calibration function, we did not
include this specific intersection).

To correct this underestimate, we recalibrated the survey microdata,
applying an extra penalty to the algorithm for deviating from:

- The number of households affected by the UC and CTC two-child
  limits, respectively.

- The number of children living in UC- and CTC-claiming households
  with 3, 4, and 5-plus children, respectively.

Figure 3 shows how this process operates for the first of these
parameters. Note that PolicyEngine still carries out this process for
the other 2,000+ statistics we target, ensuring that the model weights
do not over-calibrate towards this new set of statistical targets.

![A graph of a graph Description automatically
generated](/images/posts/repealing_the_two_child_limit/calibration.png)

_Figure 3: An example of PolicyEngine's calibration process, in which
survey weights are adjusted to shift the FRS projection of UC-claiming,
child limit-affected households towards the administrative estimate._

PolicyEngine now reproduces this 1.5m statistic. However, what we
subsequently found suggests that the 1.5m figure is an underestimate of
the true number of children affected by the reform. Because the
administrative data does not include households brought into eligibility
by reforms, it cannot include households who are not currently eligible
for Universal Credit but would be under an abolition of the two-child
limit.[^3] These households are represented by points on the diagonal
slope in Figure 1.

We estimate 200,000 children fall into this category, bringing the
number of children living in households affected by the two-child limit
to 1.7 million.

[^1]:
    Our cost estimate of £1.8bn is 38% higher than the widely-reported
    £1.3bn [estimate by the Child Poverty Action
    Group](https://cpag.org.uk/sites/default/files/files/policypost/CPAG_Budget_Submission_March_2023.pdf),
    drawn from the UKMOD microsimulation model. PolicyEngine [applies
    machine learning-based algorithms to survey
    microdata](https://policyengine.org/uk/research/how-machine-learning-tools-make-policyengine-more-accurate)
    to counter measurement and sampling bias present in the input data,
    which could explain some of the disparity.

[^2]:
    For example, in 2019 only children aged below two could be
    affected. This age of exemption increases until 2035, at which point
    no children can be exempt under the transitional protection rule.

[^3]:
    Administrative data might in practice include a small number of
    these households, because households whose income fluctuations mean
    they move along the edge of entitlement might stay on administrative
    databases.



---

---
# New King's College London research uses PolicyEngine
Slug: citizens-economic-council
Date: 2023-11-04 09:00:00
Authors: Nikhil Woodruff
Tags: uk, impact
Description: A ‘Citizens' Economic Council' explores PolicyEngine-scored tax-benefit impacts.

---

Findings from a new deliberative public engagement project, [published](https://citizensecon.org.uk/project-report) this week by King’s College London and Ipsos, used PolicyEngine’s open-source modelling to examine public preferences for tax-benefit policymaking. Entitled the _[Citizens’ Economic Council on the Cost of Living](https://citizensecon.org.uk)_, the project was led by Dr Christopher Holmes and sought to understand the public’s answer to “_how the UK government should respond to the cost-of-living crisis through fiscal policy?”_. This project followed a previous iteration of the _Citizens’ Economic Council_ focussed on monetary policy

Guided by an advisory board of 18 experts in economic policymaking and deliberative research, the project recruited 39 UK citizens and, over six three-hour sessions involving economic background guidance from expert speakers, explored their views on a ‘menu of options’ for fiscal policy reforms.

![Advisory board](/images/posts/citizens-economic-council/advisory-board.png)
_See the full advisory board [here](https://citizensecon.org.uk/about-us)._

A key focus of the project was on the ability of deliberative engagement to understand how the public views benefits and tradeoffs of individual policy choices when combined together, rather than individual policy provisions on their own. From the report:

_“The project team worked with PolicyEngine in order to develop two contrasting policy package options… this budget-equivalence meant that **participants faced a trade-off** in terms of how the costs and benefits of each policy package were distributed amongst UK households”_

PolicyEngine worked directly with the project team to draw the budget-equivalent policy options presented to the participants, with illustrative impacts both at the macro level and on individual households.

_“The policy modelling provided by Policy Engine was a **key strength** of the project because, in the two policy scenarios it was used for, it gave very clear ‘stakes’ to the hypothetical policy decisions that participants were being asked to make. **They made the trade-offs self-evident and unavoidable.**”_

For the project, PolicyEngine also created an interactive, simplified tool for participants to try their own variations of the policy packages and see how they’d affect the UK and a set of example households. This tool is freely accessible for everyone on the project website [here](https://citizensecon.org.uk/policymodelling) and embedded below.

You can read the full report by [King’s College London](https://citizensecon.org.uk/project-report) here.

[Interactive: cec]



---

---
# Autumn Statement 2023 tax-benefit reforms
Slug: autumn-statement-2023
Date: 2023-11-22 17:25
Authors: Nikhil Woodruff
Tags: uk, policy
Description: Chancellor Jeremy Hunt just announced National Insurance cuts and benefit uprating. We've evaluated these reforms.

---

_See the Autumn Statement 2023 on PolicyEngine [here](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=37636&region=uk&timePeriod=2024&baseline=1)._

Today, the Chancellor of the Exchequer Jeremy Hunt delivered the annual [Autumn Statement](https://assets.publishing.service.gov.uk/media/655d0a83544aea000dfb321d/Autumn_Statement_2023_Policy_Costings_-_Final.pdf), in which he announced several tax and benefit reforms, including two to National Insurance Contributions (NICs):

- Lowering the main rate of Class 1 (employee) NICs by 2p
- Lowering the main rate of Class 4 (self-employed) NICs by 1p
- Abolishing Class 2 NICs

In this post, we'll use PolicyEngine to estimate the budgetary, distributional and poverty impacts of these reforms.

_See how the combined reforms would affect your own household using our [personalised calculator](https://legacy.policyengine.org/uk/household?focus=intro&reform=37636&region=uk&timePeriod=2023&baseline=1)_

## Autumn Budget 2023 reforms

The Autumn Budget included reforms to National Insurance and benefit uprating, which we have modelled in our baseline and as a reform, respectively. It also includes other reforms absent from the PolicyEngine model, and notably omits previously speculated reforms.

### National Insurance

Chancellor Hunt announced three reforms to National Insurance:

- [Lowering Employee (Class 1) NICs by 2p](https://assets.publishing.service.gov.uk/media/655d0a83544aea000dfb321d/Autumn_Statement_2023_Policy_Costings_-_Final.pdf#page=9), from 12% to 10%, from 6 January 2024
- [Lowering Self-Employed (Class 4) NICs by 1p](https://assets.publishing.service.gov.uk/media/655d0a83544aea000dfb321d/Autumn_Statement_2023_Policy_Costings_-_Final.pdf#page=10), from 9% to 8%, from April 2024
- [Abolishing Class 2 NICs](https://assets.publishing.service.gov.uk/media/655d0a83544aea000dfb321d/Autumn_Statement_2023_Policy_Costings_-_Final.pdf#page=11), a £3.15 per week levy on self-employed people's profits above £12,570, from April 2024

This aligns in part with [The Times's report last night](https://www.thetimes.co.uk/article/national-living-wage-rise-jeremy-hunt-autumn-statement-j9f0pssxw) that Hunt would lower the main NIC rates (Class 1 and 4) by 1p; the report did not mention the Class 2 NICs.

In modelling these NIC reforms, we assume they all take effect on 1 January 2024, and evaluate their impact over calendar year 2024. In the future, we intend to model the true mid-year effective dates of policies like these.

### Benefit uprating

Hunt also announced uprating benefits by inflation. While the Times reported last night that he would do this, [Christians against Poverty](https://capuk.org/news-and-blog/what-will-be-in-the-autumn-statement) and [others](https://www.theguardian.com/society/2023/nov/15/jeremy-hunt-urged-not-to-use-sharp-fall-in-inflation-to-squeeze-benefits) had previously reported that they may rise by less. Historically, the government has often but not always uprated benefits with inflation.

Specifically, the State Pension will rise by 8.5%, the pace of earnings growth. State Pension is uprated by the triple lock, which guarantees that the payment level increases by the highest of inflation, average earnings growth, or 2.5%.

Non-State Pension benefits will rise by 6.7%, the inflation rate as measured by the difference in the Consumer Price Index (CPI) from September 2022 to September 2023.

In its [Autumn Statement 2023 Policy Costings document](https://assets.publishing.service.gov.uk/media/655d0a83544aea000dfb321d/Autumn_Statement_2023_Policy_Costings_-_Final.pdf#page=64), HM Treasury defines its _Default indexation assumed in the baseline_ as above. Since HM Treasury treats these announcements as following defaults rather than reforms, we follow suit and have only updated the baseline.

Compared to a counterfactual where benefits are not uprated at all, we estimate that this set of upratings will [cost £5.9 billion in 2024](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&timePeriod=2024&region=uk&reform=1&baseline=37721).

### Other reforms

Hunt also announced a number of other reforms not modelled in PolicyEngine, including a freeze on alcohol duty, additional business tax breaks, investment in AI and manufacturing, and a rise in the minimum wage.

He notably did _not_ announce reforms that outlets had previously reported he was considering, such as lowering the basic rate of Income Tax from 20p to 19p ([the Financial Times](https://www.ft.com/content/aafea716-30d5-4518-98fe-169f6995173e)) or cutting Stamp Duty and Inheritance tax ([The Times](https://www.thetimes.co.uk/article/autumn-statement-2023-predictions-jeremy-hunt-budget-tax-cuts-03sms6x82)).

## Household impacts of NIC cuts

For a [single person with only employment income](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=37636&region=uk&timePeriod=2023&baseline=1&household=32608), this reform produces a benefit if they earn at least £12,570. It would produce the maximum benefit of £377 if they earn at least £50,500.

![Figure 1: Impact of cutting 2p from NI rates on a single person](https://user-images.githubusercontent.com/6076111/285001945-5d30d660-75c5-4fcd-9651-9b2fccab300a.png)

These reforms lower marginal tax rates for individuals earning within that region by 2 percentage points.

![Figure 2: Impact of cutting 2p from NI rates on a single person's marginal tax rates](https://user-images.githubusercontent.com/6076111/285002391-620c0fa8-7a39-4bd5-a68f-c0afa987d029.png)

_See how the National Insurance cuts would affect your own household using our [personalised calculator](https://legacy.policyengine.org/uk/household?focus=intro&reform=37636&region=uk&timePeriod=2023&baseline=1)._

## Societal impact of NIC cuts

Applying the PolicyEngine microsimulation model, we can estimate the impact of these reforms on the UK's budget, distributional outcomes, and poverty. We assume the NIC reforms take effect on 1 January 2024, and evaluate their impact over calendar year 2024.

### Budgetary impacts

Our microsimulation model projects that this NI cut will [cost £10.5 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=37636&region=uk&timePeriod=2024&baseline=1) in 2024.

Our estimates exceed those from HM Treasury by about 12%, disproportionately due to Class 4 NICs. This largely results from our static model, compared to HM Treasury's behavioural responses, which assume that earnings will rise in response to lower tax rates. However, unlike HM Treasury, we also model the impact on benefits, which lowers our cost estimate: as benefits are calculated on post-tax income, tax cuts reduce benefits payments.

| Reform                             | HM Treasury | PolicyEngine | Relative difference | PolicyEngine link                                                                                                                  |
| ---------------------------------- | ----------- | ------------ | ------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| Lower Class 1 NICs from 12% to 10% | 8.72        | 9.69         | 11.2%               | [#28973](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=28973&region=uk&timePeriod=2024&baseline=1) |
| Lower Class 4 NICs from 9% to 8%   | 0.35        | 0.44         | 26.9%               | [#37642](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=37642&region=uk&timePeriod=2024&baseline=1) |
| Abolish Class 2 NICs               | 0.38        | 0.41         | 8.8%                | [#37665](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=37665&region=uk&timePeriod=2024&baseline=1) |
| Total                              | 9.44        | 10.54        | 11.7%               | [#37636](https://legacy.policyengine.org/uk/policy?focus=policyOutput.netIncome&reform=37636&region=uk&timePeriod=2024&baseline=1) |

### Distributional impacts

Households in the bottom income decile would [gain an average of £12](https://legacy.policyengine.org/uk/policy?focus=policyOutput.decileAverageImpact&reform=37636&region=uk&timePeriod=2024&baseline=1), while those in the top decile would gain an average of £1,067.

![Figure 3: Relative impact by income decile of Autumn Budget NI reforms](https://user-images.githubusercontent.com/6076111/284982468-181d24ac-ff5c-498b-95eb-35a1311af7bb.png)

As a result of the reform, [66% of the population](https://legacy.policyengine.org/uk/policy?focus=policyOutput.intraDecileImpact&reform=37636&region=uk&timePeriod=2024&baseline=1) would see their household net income rise, disproportionately those in higher-income households: around 90% of the top three deciles benefit, compared to around 25% of the bottom three.

![Figure 4: Percentage of individuals gaining from Autumn Budget NI reforms, by income decile](https://user-images.githubusercontent.com/6076111/284982567-35937f5f-a82a-44e0-8a11-fb651413519b.png)

The reform has a [small, ambiguous effect on income inequality](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=37636&region=uk&timePeriod=2024&baseline=1): while the Gini index rises by 0.4%, the top 1% share of income falls by 0.4%. It [does not affect cliffs](https://legacy.policyengine.org/uk/policy?focus=policyOutput.cliffImpact&reform=37636&region=uk&timePeriod=2024&baseline=1). Absolute, before-housing-costs [poverty falls by 0.5%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact&reform=37636&region=uk&timePeriod=2024&baseline=1), or around 60,000 individuals.

## Conclusion

In summary, PolicyEngine estimates the Autumn Budget 2023's National Insurance reforms will cost £10.5 billion in 2024, and will benefit two in three Britons, disproportionately those in higher-income households. We project a small, ambiguous effect on income inequality, and a 0.5% poverty reduction. We invite readers to use our [personalised calculator](https://legacy.policyengine.org/uk/household?focus=intro&reform=37636&region=uk&timePeriod=2023&baseline=1) to estimate the impact on their own household, and to follow our work for more analyses of current tax and benefit policies.



---

---
# Autumn 2023 model calibration update
Slug: uk-calibration-2023-q4
Date: 2023-12-04 09:00:00
Authors: Nikhil Woodruff
Tags: uk, technical
Description: Evaluating PolicyEngine's model performance with the latest official statistics.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "PolicyEngine's free and open-source microsimulation model estimates the budgetary, distributional and poverty impacts of UK tax and benefit reforms by simulating the full details of policy over a large representative dataset of UK households. In this post, we'll provide a brief overview of how PolicyEngine UK's microsimulation model works, and an update on how we maintain and validate the model's accuracy.\n",
    "\n",
    "## Model overview\n",
    "\n",
    "PolicyEngine UK is a *static* microsimulation model- it does not (yet) incorporate behavioural responses like labour supply reactions to policy changes. Instead, we assume that households do not change their behaviour in response to policy changes, and that the only way that policy changes affect households is through their direct effects on household incomes.\n",
    "\n",
    "To estimate the direct effects of policy changes, we apply the actual policy rules as specified in legislation to each of a large (tens of thousands) survey of UK households. We can then change the rules, and see how the totals of different variables change. For example, we could change the personal tax allowance from £12,570 to £15,000 and aggregate the tax payments before and after the policy change to estimate how much more tax is collected from the households in our survey.\n",
    "\n",
    "The model is written in Python, and you can follow all of our real-time development [on GitHub](https://github.com/PolicyEngine/PolicyEngine-UK). Other models exists maintained by other organisations which use the same microsimulation approach: the IFS' TAXBEN, UKMOD at the University of Essex, and, the IPPR model, and internal models at HMRC and DWP. However, only PolicyEngine UK and UKMOD publish their policy implementation details and validation statistics.\n",
    "\n",
    "## How PolicyEngine differs from other models\n",
    "\n",
    "PolicyEngine's core approach to estimate policy impacts is the same as other static microsimulation models. However, we use a novel data science-based approach to improve the accuracy of the model's outputs significantly compared to other models (where we have been able to compare).\n",
    "\n",
    "Microsimulation models are widely used by researchers to estimate policy impacts (questions for which we don't know the answer). But when we attempt to validate the models by asking them questions for which we do know the answer (for example, total Income Tax revenue in 2021), we often find that the model answers are significantly different from the ground truth. This problem is large and *exists in every microsimulation model that publishes details of attempts to measure it*.\n",
    "\n",
    "Assuming that the policy implementations in the model are correct (while the law is complex and we cannot test every possible household, we publish and meet hundreds of automated tests on every version update), the most likely explanation for this is that the model's survey data is not representative of the population: the model's outputs are only as good as the data that we feed into it.\n",
    "\n",
    "We have adopted an approach to reduce this problem by using machine learning techniques to improve the survey's accuracy by using data from other trusted sources: OBR, HMRC, DWP, ONS and others. We essentially do the following:\n",
    "\n",
    "1. Take the initial survey data\n",
    "2. Add synthetic households (using other microdata) and previous-year households with zero weight\n",
    "3. Collect trusted external statistics describing tax-benefit and demographic properties of the UK\n",
    "4. Train a machine learning model adjust the weights of the survey to best fit those external statistics\n",
    "\n",
    "The resulting weighted survey powers PolicyEngine's impact estimates.\n",
    "\n",
    "## Validation\n",
    "\n",
    "PolicyEngine meets tax-benefit and demographic totals closely, and estimates program impacts over a five-year horizon. For example, the chart below shows our projections for three key benefits: Child Benefit, Housing Benefit and Universal Credit.\n",
    "\n",
    "*Figure 1: PolicyEngine UK's projections for three key benefits*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "alignmentgroup": "True",
         "hovertemplate": "time_period=2023<br>name=%{x}<br>value=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "2023",
         "marker": {
          "color": "rgb(208, 225, 242)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2023",
         "offsetgroup": "2023",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "13",
          "14",
          "51"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          "Child Benefit budgetary impact (UK)",
          "Housing Benefit budgetary impact (GB)",
          "Universal Credit budgetary impact (GB)"
         ],
         "xaxis": "x",
         "y": [
          13383145472,
          13913753600,
          50906255360
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "time_period=2024<br>name=%{x}<br>value=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "2024",
         "marker": {
          "color": "rgb(148, 196, 223)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2024",
         "offsetgroup": "2024",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "14",
          "14",
          "60"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          "Child Benefit budgetary impact (UK)",
          "Housing Benefit budgetary impact (GB)",
          "Universal Credit budgetary impact (GB)"
         ],
         "xaxis": "x",
         "y": [
          13624675328,
          14093811712,
          60263690240
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "time_period=2025<br>name=%{x}<br>value=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "2025",
         "marker": {
          "color": "rgb(74, 152, 201)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2025",
         "offsetgroup": "2025",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "13",
          "12",
          "74"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          "Child Benefit budgetary impact (UK)",
          "Housing Benefit budgetary impact (GB)",
          "Universal Credit budgetary impact (GB)"
         ],
         "xaxis": "x",
         "y": [
          13181886464,
          11833491456,
          74151739392
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "time_period=2026<br>name=%{x}<br>value=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "2026",
         "marker": {
          "color": "rgb(23, 100, 171)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2026",
         "offsetgroup": "2026",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "13",
          "11",
          "85"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          "Child Benefit budgetary impact (UK)",
          "Housing Benefit budgetary impact (GB)",
          "Universal Credit budgetary impact (GB)"
         ],
         "xaxis": "x",
         "y": [
          12733571072,
          10747688960,
          84828307456
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "time_period=2027<br>name=%{x}<br>value=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "2027",
         "marker": {
          "color": "rgb(8, 48, 107)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2027",
         "offsetgroup": "2027",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "13",
          "11",
          "85"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          "Child Benefit budgetary impact (UK)",
          "Housing Benefit budgetary impact (GB)",
          "Universal Credit budgetary impact (GB)"
         ],
         "xaxis": "x",
         "y": [
          12897866752,
          11162318848,
          84850057216
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "barmode": "group",
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.2,
          "sizey": 0.2,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Calendar year"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "ticktext": [
          "Child Benefit",
          "Housing Benefit",
          "Universal Credit"
         ],
         "tickvals": [
          "Child Benefit budgetary impact (UK)",
          "Housing Benefit budgetary impact (GB)",
          "Universal Credit budgetary impact (GB)"
         ],
         "title": {
          "text": ""
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Budgetary impact (£)"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import plotly.express as px\n",
    "from policyengine_core.charts import *\n",
    "from plotly.express.colors import sample_colorscale\n",
    "\n",
    "training_log_cps = pd.read_csv(\n",
    "    \"/Users/nikhil/policyengine/policyengine-uk/calibration_log_cps.csv.gz\"\n",
    ")\n",
    "\n",
    "chosen_metrics = [\n",
    "    \"Child Benefit budgetary impact (UK)\",\n",
    "    \"Housing Benefit budgetary impact (GB)\",\n",
    "    \"Universal Credit budgetary impact (GB)\",\n",
    "]\n",
    "\n",
    "training_log_cps[\"Source dataset\"] = \"Enhanced FRS\"\n",
    "\n",
    "training_log = training_log_cps\n",
    "training_log_targets = training_log.copy()\n",
    "training_log_targets[\"value\"] = training_log_targets[\"target\"]\n",
    "training_log_targets[\"Source dataset\"] = \"Official\"\n",
    "training_log = pd.concat([training_log, training_log_targets])\n",
    "\n",
    "last_value_df = (\n",
    "    training_log[training_log.name.isin(chosen_metrics)]\n",
    "    .groupby([\"Source dataset\", \"time_period\", \"name\"])\n",
    "    .last()\n",
    "    .reset_index()[[\"name\", \"value\", \"Source dataset\", \"time_period\"]]\n",
    ")\n",
    "\n",
    "x = np.linspace(0.2, 1, 5)\n",
    "c = sample_colorscale(\"Blues\", list(x))\n",
    "\n",
    "last_value_df[\"time_period\"] = last_value_df.time_period.astype(str)\n",
    "last_value_df[\"text\"] = last_value_df[\"value\"].apply(lambda x: f\"{x/1e9:,.0f}\")\n",
    "fig = px.bar(\n",
    "    last_value_df[last_value_df[\"Source dataset\"] == \"Enhanced FRS\"],\n",
    "    y=\"value\",\n",
    "    color=\"time_period\",\n",
    "    x=\"name\",\n",
    "    barmode=\"group\",\n",
    "    text=\"text\",\n",
    ")\n",
    "\n",
    "fig = format_fig(fig)\n",
    "\n",
    "for i in range(len(fig.data)):\n",
    "    fig.data[i].marker.color = c[i]\n",
    "\n",
    "fig.update_layout(\n",
    "    legend_title=\"Calendar year\",\n",
    "    xaxis_tickvals=chosen_metrics,\n",
    "    xaxis_ticktext=[\"Child Benefit\", \"Housing Benefit\", \"Universal Credit\"],\n",
    "    xaxis_title=\"\",\n",
    "    yaxis_title=\"Budgetary impact (£)\",\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "But how does PolicyEngine align with the best estimates of the ground truth? We can compare PolicyEngine's estimates with two other sources to estimate how our data enhancement approach performs: the original survey data, and official statistics and projections from government. Shown below is, for each calendar year in the budget horizon, how the relative errors in tax-benefit-related statistical targets become better or worse. Over 80% of these targets improve.\n",
    "\n",
    "*Figure 2: Relative errors in tax-benefit-related statistical targets over the budget horizon*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.1<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.1",
         "marker": {
          "color": "rgb(208, 225, 242)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.1",
         "offsetgroup": "0.1",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-97%",
          "-97%",
          "-96%",
          "-95%",
          "-95%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.967161295679655,
          -0.9665338614596114,
          -0.9614765266017463,
          -0.9494102637212299,
          -0.9492514722153143
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.2<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.2",
         "marker": {
          "color": "rgb(186, 214, 235)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.2",
         "offsetgroup": "0.2",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-90%",
          "-93%",
          "-88%",
          "-89%",
          "-88%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.9043447421673796,
          -0.9337532953599778,
          -0.8847304521490373,
          -0.8896093752424434,
          -0.8792145712751785
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.3<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.3",
         "marker": {
          "color": "rgb(157, 201, 225)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.3",
         "offsetgroup": "0.3",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-81%",
          "-87%",
          "-81%",
          "-73%",
          "-74%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.8110603644944836,
          -0.8738339683905142,
          -0.81124316954283,
          -0.7349765689564652,
          -0.740099859529137
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.4<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.4",
         "marker": {
          "color": "rgb(121, 181, 217)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.4",
         "offsetgroup": "0.4",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-69%",
          "-73%",
          "-62%",
          "-60%",
          "-61%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.6867712887373829,
          -0.7276712410620164,
          -0.6183807519887554,
          -0.5967738509121482,
          -0.6136852889015592
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.5<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.5",
         "marker": {
          "color": "rgb(89, 162, 207)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.5",
         "offsetgroup": "0.5",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-53%",
          "-49%",
          "-42%",
          "-46%",
          "-46%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.532507788089771,
          -0.48792520537155004,
          -0.4234084965363902,
          -0.456630710766908,
          -0.4570276610369267
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.6<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.6",
         "marker": {
          "color": "rgb(61, 141, 195)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.6",
         "offsetgroup": "0.6",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-31%",
          "-35%",
          "-23%",
          "-15%",
          "-28%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.30926114209345007,
          -0.351501400264333,
          -0.22566637202479098,
          -0.15250959815339463,
          -0.27905846896201036
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.7<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.7",
         "marker": {
          "color": "rgb(37, 117, 183)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.7",
         "offsetgroup": "0.7",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "-7%",
          "-9%",
          "+16%",
          "+15%",
          "+2%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.07258991422363714,
          -0.09278470931922089,
          0.16282420521911092,
          0.15342919085323034,
          0.023917597681361376
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.8<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.8",
         "marker": {
          "color": "rgb(19, 95, 167)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.8",
         "offsetgroup": "0.8",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "+40%",
          "+35%",
          "+80%",
          "+75%",
          "+58%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.4000869790054718,
          0.3468064382617247,
          0.7978370276367839,
          0.7524222196862302,
          0.5756495132681535
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "decile=0.9<br>time_period=%{x}<br>rel_error_abs_change=%{y}<br>text=%{text}<extra></extra>",
         "legendgroup": "0.9",
         "marker": {
          "color": "rgb(8, 71, 142)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "0.9",
         "offsetgroup": "0.9",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "+145%",
          "+139%",
          "+205%",
          "+190%",
          "+154%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          1.454125352347277,
          1.3895231672651769,
          2.0456083047397895,
          1.9031989913182896,
          1.535294585914649
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "barmode": "group",
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.2,
          "sizey": 0.2,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Quantile"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "uniformtext": {
         "minsize": 8
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Calendar year"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "tickformat": "+.0%",
         "title": {
          "text": "Change in relative error"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Convert to [name, value, time_period, source]\n",
    "# source: (value at epoch=0 -> \"Original FRS\", value at epoch=last -> \"Enhanced FRS\", target at epoch=0 -> \"Official\")\n",
    "import warnings\n",
    "\n",
    "warnings.filterwarnings(\"ignore\")\n",
    "\n",
    "original_frs_values = (\n",
    "    training_log_cps[training_log_cps.epoch == 0]\n",
    "    .copy()[[\"name\", \"value\", \"time_period\"]]\n",
    "    .sort_values([\"name\", \"time_period\"])\n",
    ")\n",
    "original_frs_values[\"source\"] = \"Original FRS\"\n",
    "\n",
    "enhanced_frs_values = (\n",
    "    training_log_cps[training_log_cps.epoch == training_log_cps.epoch.max()]\n",
    "    .copy()[[\"name\", \"value\", \"time_period\"]]\n",
    "    .sort_values([\"name\", \"time_period\"])\n",
    ")\n",
    "enhanced_frs_values[\"source\"] = \"Enhanced FRS\"\n",
    "\n",
    "official_values = (\n",
    "    training_log_cps[training_log_cps.epoch == 0]\n",
    "    .copy()[[\"name\", \"target\", \"time_period\"]]\n",
    "    .sort_values([\"name\", \"time_period\"])\n",
    ")\n",
    "official_values[\"value\"] = official_values[\"target\"]\n",
    "del official_values[\"target\"]\n",
    "official_values[\"source\"] = \"Official\"\n",
    "\n",
    "enhanced_frs_values[\"error\"] = (\n",
    "    official_values[\"value\"].values - enhanced_frs_values[\"value\"].values\n",
    ")\n",
    "original_frs_values[\"error\"] = (\n",
    "    official_values[\"value\"].values - original_frs_values[\"value\"].values\n",
    ")\n",
    "enhanced_frs_values[\"abs_error\"] = np.abs(enhanced_frs_values[\"error\"].values)\n",
    "original_frs_values[\"abs_error\"] = np.abs(original_frs_values[\"error\"].values)\n",
    "enhanced_frs_values[\"rel_error\"] = (\n",
    "    enhanced_frs_values[\"error\"].values / official_values[\"value\"].values\n",
    ")\n",
    "original_frs_values[\"rel_error\"] = (\n",
    "    original_frs_values[\"error\"].values / official_values[\"value\"].values\n",
    ")\n",
    "enhanced_frs_values[\"rel_error_abs\"] = np.abs(\n",
    "    enhanced_frs_values[\"rel_error\"].values\n",
    ")\n",
    "original_frs_values[\"rel_error_abs\"] = np.abs(\n",
    "    original_frs_values[\"rel_error\"].values\n",
    ")\n",
    "\n",
    "enhanced_frs_values[\"rel_error_original\"] = original_frs_values[\n",
    "    \"rel_error_abs\"\n",
    "].values\n",
    "enhanced_frs_values[\"rel_error_abs_change\"] = (\n",
    "    enhanced_frs_values[\"rel_error_abs\"].values\n",
    "    / original_frs_values[\"rel_error_abs\"].values\n",
    "    - 1\n",
    ")\n",
    "enhanced_frs_values[\"error_abs_change\"] = (\n",
    "    enhanced_frs_values[\"abs_error\"].values\n",
    "    / original_frs_values[\"abs_error\"].values\n",
    "    - 1\n",
    ")\n",
    "\n",
    "df = enhanced_frs_values\n",
    "\n",
    "a = (\n",
    "    df[df.rel_error_original > 0.03]\n",
    "    .groupby(\"time_period\")\n",
    "    .rel_error_abs_change.quantile(\n",
    "        [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]\n",
    "    )\n",
    "    .reset_index()\n",
    ")\n",
    "a.columns = [\"time_period\", \"decile\", \"rel_error_abs_change\"]\n",
    "a[\"decile\"] = a.decile.astype(str)\n",
    "a[\"text\"] = a[\"rel_error_abs_change\"].apply(lambda x: f\"{x:+.0%}\")\n",
    "fig = (\n",
    "    px.bar(\n",
    "        a,\n",
    "        x=\"time_period\",\n",
    "        y=\"rel_error_abs_change\",\n",
    "        color=\"decile\",\n",
    "        barmode=\"group\",\n",
    "        text=\"text\",\n",
    "    )\n",
    "    .update_traces(\n",
    "        # text should always be horizontal\n",
    "        # textangle=0,\n",
    "    )\n",
    "    .update_layout(\n",
    "        uniformtext_minsize=8,\n",
    "    )\n",
    ")\n",
    "\n",
    "x = np.linspace(0.2, 1, 10)\n",
    "c = sample_colorscale(\"Blues\", list(x))\n",
    "\n",
    "fig = format_fig(fig)\n",
    "\n",
    "for i in range(len(fig.data)):\n",
    "    fig.data[i].marker.color = c[i]\n",
    "\n",
    "fig.update_layout(\n",
    "    legend_title=\"Quantile\",\n",
    "    xaxis_title=\"Calendar year\",\n",
    "    yaxis_title=\"Change in relative error\",\n",
    "    yaxis_tickformat=\"+.0%\",\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We've also made all our calibration validation results available in an interactive dashboard, which is available on GitHub [here](https://github.com/nikhilwoodruff/policyengine-uk-validation) (screenshot below). We welcome feedback or comments on our approach- feel free to [get in touch](https://legacy.policyengine.org/uk/contact).\n",
    "\n",
    "![Figure 3: PolicyEngine UK's calibration validation dashboard](https://github.com/PolicyEngine/policyengine-app/assets/35577657/c4d0e71e-cc6b-4191-aaaa-5970f4ac3cc9)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# Spring Budget 2024 proposals
Slug: spring-budget-2024
Date: 2024-03-04 09:00:00
Authors: Anthony Volk, Nikhil Woodruff
Tags: uk, policy
Description: PolicyEngine estimates reported likely tax-benefit reforms ahead of the UK Spring Budget.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "On Wednesday, 6th March, Chancellor of the Exchequer Jeremy Hunt will present the government's 2024 Spring Budget. Ahead of the announcement, media reports speculate that the Chancellor is considering cutting the main National Insurance rate, in an extension to his previous cuts in the Autumn Statement 2023 (analysed by PolicyEngine in [this report](https://legacy.policyengine.org/uk/research/autumn-statement-2023)).\n",
    "\n",
    "In this post, we'll estimate the impacts of such a cut upon the budget, as well as upon society-wide economic outcomes. We'll also look at the impact these changes would have upon individual UK households.\n",
    "\n",
    "## Budget reform options\n",
    "\n",
    "Separate media sources identify four potential reforms that the Chancellor is considering:\n",
    "\n",
    "* Cuts to Employee (Class 1) National Insurance Contributions (NICs) by either 1p[^1] or 2p[^2]\n",
    "* A 2p cut to the basic rate of tax, lowering the rate from 20p to 18p[^3]\n",
    "\n",
    "PolicyEngine's top-level economic impact estimates follow below. In modelling these reforms, we assume each took effect on 1 January 2024 and will evaluate their impacts over calendar year 2024.\n",
    "\n",
    "[^1]:\n",
    "      [The Guardian, 2024](https://www.theguardian.com/politics/2024/mar/02/tax-and-spending-cuts-will-backfire-economists-warn-jeremy-hunt)\n",
    "[^2]:\n",
    "      [Financial Times, 2024](https://www.ft.com/content/c2d56d45-c061-4d5a-bf4f-1eddd1fa7d25)\n",
    "[^3]:\n",
    "      [Financial Times, 2024](https://www.ft.com/content/1b4f19d7-c7e5-4d16-a7c1-1c12ec0d0592)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Table 1: Potential budget reforms and their impacts*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[1], line 68\u001b[0m\n\u001b[1;32m     65\u001b[0m percentages_better_off \u001b[38;5;241m=\u001b[39m []\n\u001b[1;32m     67\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;28mlen\u001b[39m(provisions)):\n\u001b[0;32m---> 68\u001b[0m     impacts \u001b[38;5;241m=\u001b[39m \u001b[43mget_impacts\u001b[49m\u001b[43m(\u001b[49m\u001b[43mreforms\u001b[49m\u001b[43m[\u001b[49m\u001b[43mi\u001b[49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     69\u001b[0m     budgetary_impacts\u001b[38;5;241m.\u001b[39mappend(impacts[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mbudgetary_impact\u001b[39m\u001b[38;5;124m\"\u001b[39m])\n\u001b[1;32m     70\u001b[0m     reform_ids\u001b[38;5;241m.\u001b[39mappend(impacts[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mreform_id\u001b[39m\u001b[38;5;124m\"\u001b[39m])\n",
      "Cell \u001b[0;32mIn[1], line 37\u001b[0m, in \u001b[0;36mget_impacts\u001b[0;34m(reform_dict)\u001b[0m\n\u001b[1;32m     34\u001b[0m reform \u001b[38;5;241m=\u001b[39m Reform\u001b[38;5;241m.\u001b[39mfrom_dict(reform_dict, country_id\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124muk\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m     35\u001b[0m reformed \u001b[38;5;241m=\u001b[39m Microsimulation(reform\u001b[38;5;241m=\u001b[39mreform)\n\u001b[0;32m---> 37\u001b[0m budgetary_impact \u001b[38;5;241m=\u001b[39m \u001b[43mbaseline\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mhousehold_net_income\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m2024\u001b[39;49m\u001b[43m)\u001b[49m\u001b[38;5;241m.\u001b[39msum() \u001b[38;5;241m-\u001b[39m reformed\u001b[38;5;241m.\u001b[39mcalculate(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mhousehold_net_income\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;241m2024\u001b[39m)\u001b[38;5;241m.\u001b[39msum()\n\u001b[1;32m     38\u001b[0m poverty_baseline \u001b[38;5;241m=\u001b[39m baseline\u001b[38;5;241m.\u001b[39mcalculate(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124min_poverty\u001b[39m\u001b[38;5;124m\"\u001b[39m, map_to\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mperson\u001b[39m\u001b[38;5;124m\"\u001b[39m, period\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m2024\u001b[39m)\u001b[38;5;241m.\u001b[39mmean()\n\u001b[1;32m     39\u001b[0m poverty_reform \u001b[38;5;241m=\u001b[39m reformed\u001b[38;5;241m.\u001b[39mcalculate(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124min_poverty\u001b[39m\u001b[38;5;124m\"\u001b[39m, map_to\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mperson\u001b[39m\u001b[38;5;124m\"\u001b[39m, period\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m2024\u001b[39m)\u001b[38;5;241m.\u001b[39mmean()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:784\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    782\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m added_variable \u001b[38;5;129;01min\u001b[39;00m adds_list:\n\u001b[1;32m    783\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m added_variable \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mtax_benefit_system\u001b[38;5;241m.\u001b[39mvariables:\n\u001b[0;32m--> 784\u001b[0m         values \u001b[38;5;241m=\u001b[39m values \u001b[38;5;241m+\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    785\u001b[0m \u001b[43m            \u001b[49m\u001b[43madded_variable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mvariable\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mentity\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mkey\u001b[49m\n\u001b[1;32m    786\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    787\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m    788\u001b[0m         \u001b[38;5;28;01mtry\u001b[39;00m:\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:849\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    847\u001b[0m     array \u001b[38;5;241m=\u001b[39m formula(population, period)\n\u001b[1;32m    848\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 849\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[43mformula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters_at\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    851\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m array\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_uk/variables/household/income/benefit.py:101\u001b[0m, in \u001b[0;36mhousehold_benefits.formula\u001b[0;34m(household, period, parameters)\u001b[0m\n\u001b[1;32m     95\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m contrib\u001b[38;5;241m.\u001b[39mabolish_council_tax:\n\u001b[1;32m     96\u001b[0m     benefits \u001b[38;5;241m=\u001b[39m [\n\u001b[1;32m     97\u001b[0m         benefit\n\u001b[1;32m     98\u001b[0m         \u001b[38;5;28;01mfor\u001b[39;00m benefit \u001b[38;5;129;01min\u001b[39;00m benefits\n\u001b[1;32m     99\u001b[0m         \u001b[38;5;28;01mif\u001b[39;00m benefit \u001b[38;5;241m!=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcouncil_tax_benefit\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    100\u001b[0m     ]\n\u001b[0;32m--> 101\u001b[0m general_benefits \u001b[38;5;241m=\u001b[39m \u001b[43madd\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    102\u001b[0m \u001b[43m    \u001b[49m\u001b[43mhousehold\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    103\u001b[0m \u001b[43m    \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    104\u001b[0m \u001b[43m    \u001b[49m\u001b[43m[\u001b[49m\n\u001b[1;32m    105\u001b[0m \u001b[43m        \u001b[49m\u001b[43mbenefit\u001b[49m\n\u001b[1;32m    106\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mbenefit\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mbenefits\u001b[49m\n\u001b[1;32m    107\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;28;43;01mif\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mbenefit\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01mnot\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mbasic_income\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m]\u001b[49m\n\u001b[1;32m    108\u001b[0m \u001b[43m    \u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    109\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    110\u001b[0m non_sp_benefits \u001b[38;5;241m=\u001b[39m add(\n\u001b[1;32m    111\u001b[0m     household,\n\u001b[1;32m    112\u001b[0m     period,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    117\u001b[0m     ],\n\u001b[1;32m    118\u001b[0m )\n\u001b[1;32m    119\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m (\n\u001b[1;32m    120\u001b[0m     add(household, period, benefits)\n\u001b[1;32m    121\u001b[0m     \u001b[38;5;241m+\u001b[39m general_benefits \u001b[38;5;241m*\u001b[39m uprating\u001b[38;5;241m.\u001b[39mall\n\u001b[1;32m    122\u001b[0m     \u001b[38;5;241m+\u001b[39m non_sp_benefits \u001b[38;5;241m*\u001b[39m uprating\u001b[38;5;241m.\u001b[39mnon_sp\n\u001b[1;32m    123\u001b[0m )\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/commons/formulas.py:227\u001b[0m, in \u001b[0;36madd\u001b[0;34m(entity, period, variables, options)\u001b[0m\n\u001b[1;32m    207\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21madd\u001b[39m(\n\u001b[1;32m    208\u001b[0m     entity: Population,\n\u001b[1;32m    209\u001b[0m     period: Period,\n\u001b[1;32m    210\u001b[0m     variables: List[\u001b[38;5;28mstr\u001b[39m],\n\u001b[1;32m    211\u001b[0m     options: List[\u001b[38;5;28mstr\u001b[39m] \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m,\n\u001b[1;32m    212\u001b[0m ):\n\u001b[1;32m    213\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"Sums a list of variables.\u001b[39;00m\n\u001b[1;32m    214\u001b[0m \n\u001b[1;32m    215\u001b[0m \u001b[38;5;124;03m    Args:\u001b[39;00m\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    225\u001b[0m \u001b[38;5;124;03m        ArrayLike: The result of the operation.\u001b[39;00m\n\u001b[1;32m    226\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m--> 227\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfor_each_variable\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    228\u001b[0m \u001b[43m        \u001b[49m\u001b[43mentity\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvariables\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43magg_func\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43madd\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43moptions\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43moptions\u001b[49m\n\u001b[1;32m    229\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/commons/formulas.py:197\u001b[0m, in \u001b[0;36mfor_each_variable\u001b[0;34m(entity, period, variables, agg_func, group_agg_func, options)\u001b[0m\n\u001b[1;32m    192\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:  \u001b[38;5;66;03m# Group-to-group aggregation\u001b[39;00m\n\u001b[1;32m    193\u001b[0m     variable_population \u001b[38;5;241m=\u001b[39m entity\u001b[38;5;241m.\u001b[39msimulation\u001b[38;5;241m.\u001b[39mpopulations[\n\u001b[1;32m    194\u001b[0m         variable_entity\u001b[38;5;241m.\u001b[39mkey\n\u001b[1;32m    195\u001b[0m     ]\n\u001b[1;32m    196\u001b[0m     person_shares \u001b[38;5;241m=\u001b[39m variable_population\u001b[38;5;241m.\u001b[39mproject(\n\u001b[0;32m--> 197\u001b[0m         \u001b[43mvariable_population\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    198\u001b[0m     ) \u001b[38;5;241m/\u001b[39m variable_population\u001b[38;5;241m.\u001b[39mproject(variable_population\u001b[38;5;241m.\u001b[39mnb_persons())\n\u001b[1;32m    199\u001b[0m     values \u001b[38;5;241m=\u001b[39m entity\u001b[38;5;241m.\u001b[39msum(person_shares)\n\u001b[1;32m    200\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/population.py:134\u001b[0m, in \u001b[0;36mPopulation.__call__\u001b[0;34m(self, variable_name, period, options)\u001b[0m\n\u001b[1;32m    130\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39msimulation\u001b[38;5;241m.\u001b[39mcalculate_divide(\n\u001b[1;32m    131\u001b[0m         variable_name, period, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcalculate_kwargs\n\u001b[1;32m    132\u001b[0m     )\n\u001b[1;32m    133\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 134\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimulation\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    135\u001b[0m \u001b[43m        \u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcalculate_kwargs\u001b[49m\n\u001b[1;32m    136\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:849\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    847\u001b[0m     array \u001b[38;5;241m=\u001b[39m formula(population, period)\n\u001b[1;32m    848\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 849\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[43mformula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters_at\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    851\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m array\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_uk/variables/gov/dwp/housing_benefit.py:255\u001b[0m, in \u001b[0;36mhousing_benefit.formula\u001b[0;34m(benunit, period, parameters)\u001b[0m\n\u001b[1;32m    254\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mformula\u001b[39m(benunit, period, parameters):\n\u001b[0;32m--> 255\u001b[0m     housing_benefit_entitlement \u001b[38;5;241m=\u001b[39m \u001b[43mbenunit\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    256\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mhousing_benefit_pre_benefit_cap\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\n\u001b[1;32m    257\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    258\u001b[0m     benefit_cap_reduction \u001b[38;5;241m=\u001b[39m benunit(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mbenefit_cap_reduction\u001b[39m\u001b[38;5;124m\"\u001b[39m, period)\n\u001b[1;32m    259\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m where(\n\u001b[1;32m    260\u001b[0m         housing_benefit_entitlement \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m,\n\u001b[1;32m    261\u001b[0m         max_(\u001b[38;5;241m0\u001b[39m, housing_benefit_entitlement \u001b[38;5;241m-\u001b[39m benefit_cap_reduction),\n\u001b[1;32m    262\u001b[0m         \u001b[38;5;241m0\u001b[39m,\n\u001b[1;32m    263\u001b[0m     )\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/population.py:134\u001b[0m, in \u001b[0;36mPopulation.__call__\u001b[0;34m(self, variable_name, period, options)\u001b[0m\n\u001b[1;32m    130\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39msimulation\u001b[38;5;241m.\u001b[39mcalculate_divide(\n\u001b[1;32m    131\u001b[0m         variable_name, period, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcalculate_kwargs\n\u001b[1;32m    132\u001b[0m     )\n\u001b[1;32m    133\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 134\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimulation\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    135\u001b[0m \u001b[43m        \u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcalculate_kwargs\u001b[49m\n\u001b[1;32m    136\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:849\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    847\u001b[0m     array \u001b[38;5;241m=\u001b[39m formula(population, period)\n\u001b[1;32m    848\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 849\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[43mformula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters_at\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    851\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m array\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_uk/variables/gov/dwp/housing_benefit.py:241\u001b[0m, in \u001b[0;36mhousing_benefit_pre_benefit_cap.formula\u001b[0;34m(benunit, period, parameters)\u001b[0m\n\u001b[1;32m    240\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mformula\u001b[39m(benunit, period, parameters):\n\u001b[0;32m--> 241\u001b[0m     entitlement \u001b[38;5;241m=\u001b[39m \u001b[43mbenunit\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mhousing_benefit_entitlement\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    242\u001b[0m     eligible \u001b[38;5;241m=\u001b[39m benunit(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mhousing_benefit_eligible\u001b[39m\u001b[38;5;124m\"\u001b[39m, period)\n\u001b[1;32m    243\u001b[0m     would_claim \u001b[38;5;241m=\u001b[39m benunit(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mwould_claim_HB\u001b[39m\u001b[38;5;124m\"\u001b[39m, period)\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/population.py:134\u001b[0m, in \u001b[0;36mPopulation.__call__\u001b[0;34m(self, variable_name, period, options)\u001b[0m\n\u001b[1;32m    130\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39msimulation\u001b[38;5;241m.\u001b[39mcalculate_divide(\n\u001b[1;32m    131\u001b[0m         variable_name, period, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcalculate_kwargs\n\u001b[1;32m    132\u001b[0m     )\n\u001b[1;32m    133\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 134\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimulation\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    135\u001b[0m \u001b[43m        \u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcalculate_kwargs\u001b[49m\n\u001b[1;32m    136\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:849\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    847\u001b[0m     array \u001b[38;5;241m=\u001b[39m formula(population, period)\n\u001b[1;32m    848\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 849\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[43mformula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters_at\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    851\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m array\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_uk/variables/gov/dwp/housing_benefit.py:215\u001b[0m, in \u001b[0;36mhousing_benefit_entitlement.formula\u001b[0;34m(benunit, period, parameters)\u001b[0m\n\u001b[1;32m    214\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mformula\u001b[39m(benunit, period, parameters):\n\u001b[0;32m--> 215\u001b[0m     rent \u001b[38;5;241m=\u001b[39m \u001b[43mbenunit\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mbenunit_rent\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    216\u001b[0m     LHA \u001b[38;5;241m=\u001b[39m benunit(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mLHA_eligible\u001b[39m\u001b[38;5;124m\"\u001b[39m, period\u001b[38;5;241m.\u001b[39mthis_year)\n\u001b[1;32m    217\u001b[0m     applicable_amount \u001b[38;5;241m=\u001b[39m benunit(\n\u001b[1;32m    218\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mhousing_benefit_applicable_amount\u001b[39m\u001b[38;5;124m\"\u001b[39m, period\n\u001b[1;32m    219\u001b[0m     )\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/population.py:134\u001b[0m, in \u001b[0;36mPopulation.__call__\u001b[0;34m(self, variable_name, period, options)\u001b[0m\n\u001b[1;32m    130\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39msimulation\u001b[38;5;241m.\u001b[39mcalculate_divide(\n\u001b[1;32m    131\u001b[0m         variable_name, period, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcalculate_kwargs\n\u001b[1;32m    132\u001b[0m     )\n\u001b[1;32m    133\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 134\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msimulation\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    135\u001b[0m \u001b[43m        \u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcalculate_kwargs\u001b[49m\n\u001b[1;32m    136\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:784\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    782\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m added_variable \u001b[38;5;129;01min\u001b[39;00m adds_list:\n\u001b[1;32m    783\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m added_variable \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mtax_benefit_system\u001b[38;5;241m.\u001b[39mvariables:\n\u001b[0;32m--> 784\u001b[0m         values \u001b[38;5;241m=\u001b[39m values \u001b[38;5;241m+\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    785\u001b[0m \u001b[43m            \u001b[49m\u001b[43madded_variable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mvariable\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mentity\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mkey\u001b[49m\n\u001b[1;32m    786\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    787\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m    788\u001b[0m         \u001b[38;5;28;01mtry\u001b[39;00m:\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:554\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    550\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_period_consistency(period, variable)\n\u001b[1;32m    552\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m variable\u001b[38;5;241m.\u001b[39mdefined_for \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    553\u001b[0m     mask \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m--> 554\u001b[0m         \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    555\u001b[0m \u001b[43m            \u001b[49m\u001b[43mvariable\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mdefined_for\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mvariable\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mentity\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mkey\u001b[49m\n\u001b[1;32m    556\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    557\u001b[0m         \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m\n\u001b[1;32m    558\u001b[0m     )\n\u001b[1;32m    559\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m np\u001b[38;5;241m.\u001b[39mall(\u001b[38;5;241m~\u001b[39mmask):\n\u001b[1;32m    560\u001b[0m         array \u001b[38;5;241m=\u001b[39m holder\u001b[38;5;241m.\u001b[39mdefault_array()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/microsimulation.py:54\u001b[0m, in \u001b[0;36mMicrosimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, use_weights, decode_enums)\u001b[0m\n\u001b[1;32m     52\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m     53\u001b[0m     period \u001b[38;5;241m=\u001b[39m get_period(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdefault_calculation_period)\n\u001b[0;32m---> 54\u001b[0m values \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmap_to\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdecode_enums\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     55\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m use_weights:\n\u001b[1;32m     56\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m values\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:377\u001b[0m, in \u001b[0;36mSimulation.calculate\u001b[0;34m(self, variable_name, period, map_to, decode_enums)\u001b[0m\n\u001b[1;32m    374\u001b[0m np\u001b[38;5;241m.\u001b[39mrandom\u001b[38;5;241m.\u001b[39mseed(\u001b[38;5;28mhash\u001b[39m(variable_name \u001b[38;5;241m+\u001b[39m \u001b[38;5;28mstr\u001b[39m(period)) \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m1000000\u001b[39m)\n\u001b[1;32m    376\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 377\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_calculate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable_name\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    378\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(result, EnumArray) \u001b[38;5;129;01mand\u001b[39;00m decode_enums:\n\u001b[1;32m    379\u001b[0m         result \u001b[38;5;241m=\u001b[39m result\u001b[38;5;241m.\u001b[39mdecode_to_str()\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:570\u001b[0m, in \u001b[0;36mSimulation._calculate\u001b[0;34m(self, variable_name, period)\u001b[0m\n\u001b[1;32m    568\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m    569\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_for_cycle(variable\u001b[38;5;241m.\u001b[39mname, period)\n\u001b[0;32m--> 570\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_formula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvariable\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    572\u001b[0m     \u001b[38;5;66;03m# If no result, use the default value and cache it\u001b[39;00m\n\u001b[1;32m    573\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m array \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    574\u001b[0m         \u001b[38;5;66;03m# Check if the variable has a previously defined value\u001b[39;00m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:849\u001b[0m, in \u001b[0;36mSimulation._run_formula\u001b[0;34m(self, variable, population, period)\u001b[0m\n\u001b[1;32m    847\u001b[0m     array \u001b[38;5;241m=\u001b[39m formula(population, period)\n\u001b[1;32m    848\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 849\u001b[0m     array \u001b[38;5;241m=\u001b[39m \u001b[43mformula\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpopulation\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters_at\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    851\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m array\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_uk/variables/household/demographic/person.py:293\u001b[0m, in \u001b[0;36mis_household_head.formula\u001b[0;34m(person, period, parameters)\u001b[0m\n\u001b[1;32m    292\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mformula\u001b[39m(person, period, parameters):\n\u001b[0;32m--> 293\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mperson\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_rank\u001b[49m\u001b[43m(\u001b[49m\u001b[43mperson\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mhousehold\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperson\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mage\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mperiod\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/population.py:242\u001b[0m, in \u001b[0;36mPopulation.get_rank\u001b[0;34m(self, entity, criteria, condition)\u001b[0m\n\u001b[1;32m    238\u001b[0m ids \u001b[38;5;241m=\u001b[39m entity\u001b[38;5;241m.\u001b[39mmembers_entity_id\n\u001b[1;32m    240\u001b[0m \u001b[38;5;66;03m# Matrix: the value in line i and column j is the value of criteria for the jth person of the ith entity\u001b[39;00m\n\u001b[1;32m    241\u001b[0m matrix \u001b[38;5;241m=\u001b[39m numpy\u001b[38;5;241m.\u001b[39masarray(\n\u001b[0;32m--> 242\u001b[0m     [\n\u001b[1;32m    243\u001b[0m         entity\u001b[38;5;241m.\u001b[39mvalue_nth_person(\n\u001b[1;32m    244\u001b[0m             k, filtered_criteria, default\u001b[38;5;241m=\u001b[39mnumpy\u001b[38;5;241m.\u001b[39minf\n\u001b[1;32m    245\u001b[0m         )\n\u001b[1;32m    246\u001b[0m         \u001b[38;5;28;01mfor\u001b[39;00m k \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(biggest_entity_size)\n\u001b[1;32m    247\u001b[0m     ]\n\u001b[1;32m    248\u001b[0m )\u001b[38;5;241m.\u001b[39mtranspose()\n\u001b[1;32m    250\u001b[0m \u001b[38;5;66;03m# We double-argsort all lines of the matrix.\u001b[39;00m\n\u001b[1;32m    251\u001b[0m \u001b[38;5;66;03m# Double-argsorting gets the rank of each value once sorted\u001b[39;00m\n\u001b[1;32m    252\u001b[0m \u001b[38;5;66;03m# For instance, if x = [3,1,6,4,0], y =  numpy.argsort(x) is [4, 1, 0, 3, 2] (because the value with index 4 is the smallest one, the value with index 1 the second smallest, etc.) and z =  numpy.argsort(y) is [2, 1, 4, 3, 0], the rank of each value.\u001b[39;00m\n\u001b[1;32m    253\u001b[0m sorted_matrix \u001b[38;5;241m=\u001b[39m numpy\u001b[38;5;241m.\u001b[39margsort(numpy\u001b[38;5;241m.\u001b[39margsort(matrix))\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/population.py:243\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m    238\u001b[0m ids \u001b[38;5;241m=\u001b[39m entity\u001b[38;5;241m.\u001b[39mmembers_entity_id\n\u001b[1;32m    240\u001b[0m \u001b[38;5;66;03m# Matrix: the value in line i and column j is the value of criteria for the jth person of the ith entity\u001b[39;00m\n\u001b[1;32m    241\u001b[0m matrix \u001b[38;5;241m=\u001b[39m numpy\u001b[38;5;241m.\u001b[39masarray(\n\u001b[1;32m    242\u001b[0m     [\n\u001b[0;32m--> 243\u001b[0m         \u001b[43mentity\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvalue_nth_person\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    244\u001b[0m \u001b[43m            \u001b[49m\u001b[43mk\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mfiltered_criteria\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdefault\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mnumpy\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43minf\u001b[49m\n\u001b[1;32m    245\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    246\u001b[0m         \u001b[38;5;28;01mfor\u001b[39;00m k \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(biggest_entity_size)\n\u001b[1;32m    247\u001b[0m     ]\n\u001b[1;32m    248\u001b[0m )\u001b[38;5;241m.\u001b[39mtranspose()\n\u001b[1;32m    250\u001b[0m \u001b[38;5;66;03m# We double-argsort all lines of the matrix.\u001b[39;00m\n\u001b[1;32m    251\u001b[0m \u001b[38;5;66;03m# Double-argsorting gets the rank of each value once sorted\u001b[39;00m\n\u001b[1;32m    252\u001b[0m \u001b[38;5;66;03m# For instance, if x = [3,1,6,4,0], y =  numpy.argsort(x) is [4, 1, 0, 3, 2] (because the value with index 4 is the smallest one, the value with index 1 the second smallest, etc.) and z =  numpy.argsort(y) is [2, 1, 4, 3, 0], the rank of each value.\u001b[39;00m\n\u001b[1;32m    253\u001b[0m sorted_matrix \u001b[38;5;241m=\u001b[39m numpy\u001b[38;5;241m.\u001b[39margsort(numpy\u001b[38;5;241m.\u001b[39margsort(matrix))\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/policyengine_core/populations/group_population.py:320\u001b[0m, in \u001b[0;36mGroupPopulation.value_nth_person\u001b[0;34m(self, n, array, default)\u001b[0m\n\u001b[1;32m    316\u001b[0m result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfilled_array(default, dtype\u001b[38;5;241m=\u001b[39marray\u001b[38;5;241m.\u001b[39mdtype)\n\u001b[1;32m    317\u001b[0m \u001b[38;5;66;03m# For households that have at least n persons, set the result as the value of criteria for the person for which the position is n.\u001b[39;00m\n\u001b[1;32m    318\u001b[0m \u001b[38;5;66;03m# The map is needed b/c the order of the nth persons of each household in the persons vector is not necessarily the same than the household order.\u001b[39;00m\n\u001b[1;32m    319\u001b[0m result[nb_persons_per_entity \u001b[38;5;241m>\u001b[39m n] \u001b[38;5;241m=\u001b[39m array[members_map][\n\u001b[0;32m--> 320\u001b[0m     \u001b[43mpositions\u001b[49m\u001b[43m[\u001b[49m\u001b[43mmembers_map\u001b[49m\u001b[43m]\u001b[49m \u001b[38;5;241m==\u001b[39m n\n\u001b[1;32m    321\u001b[0m ]\n\u001b[1;32m    323\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(array, EnumArray):\n\u001b[1;32m    324\u001b[0m     result \u001b[38;5;241m=\u001b[39m EnumArray(result, array\u001b[38;5;241m.\u001b[39mpossible_values)\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "from policyengine_uk.model_api import *\n",
    "from policyengine_uk import Microsimulation\n",
    "import pandas as pd\n",
    "\n",
    "# DataFrame with columns: [provision name, provision cost in 2024, percent better off, provision poverty impact in 2024, inequality impact in 2024]\n",
    "\n",
    "reforms = []\n",
    "\n",
    "ni_rate_cut_1p = {\n",
    "    \"gov.hmrc.national_insurance.class_1.rates.employee.main\": {\n",
    "        \"year:2024:5\": 0.09,\n",
    "    }\n",
    "}\n",
    "\n",
    "ni_rate_cut_2p = {\n",
    "    \"gov.hmrc.national_insurance.class_1.rates.employee.main\": {\n",
    "        \"year:2024:5\": 0.08,\n",
    "    }\n",
    "}\n",
    "\n",
    "base_rate_cut_2p = {\n",
    "    \"gov.hmrc.income_tax.rates.uk[0].rate\": {\n",
    "        \"year:2024:5\": 0.18,\n",
    "    }\n",
    "}\n",
    "\n",
    "reforms = [ni_rate_cut_1p, ni_rate_cut_2p, base_rate_cut_2p]\n",
    "\n",
    "provisions = [\"1p NI cut\", \"2p NI cut\", \"2p basic rate cut\"]\n",
    "\n",
    "baseline = Microsimulation()\n",
    "\n",
    "\n",
    "def get_impacts(reform_dict: dict) -> dict:\n",
    "    reform = Reform.from_dict(reform_dict, country_id=\"uk\")\n",
    "    reformed = Microsimulation(reform=reform)\n",
    "\n",
    "    budgetary_impact = (\n",
    "        baseline.calculate(\"household_net_income\", period=2024).sum()\n",
    "        - reformed.calculate(\"household_net_income\", 2024).sum()\n",
    "    )\n",
    "    poverty_baseline = baseline.calculate(\n",
    "        \"in_poverty\", map_to=\"person\", period=2024\n",
    "    ).mean()\n",
    "    poverty_reform = reformed.calculate(\n",
    "        \"in_poverty\", map_to=\"person\", period=2024\n",
    "    ).mean()\n",
    "    poverty_rate_change = (\n",
    "        poverty_reform - poverty_baseline\n",
    "    ) / poverty_baseline\n",
    "\n",
    "    gini_baseline = baseline.calculate(\n",
    "        \"equiv_household_net_income\", map_to=\"person\", period=2024\n",
    "    ).gini()\n",
    "    gini_reform = reformed.calculate(\n",
    "        \"equiv_household_net_income\", map_to=\"person\", period=2024\n",
    "    ).gini()\n",
    "    gini_rate_change = (gini_reform - gini_baseline) / gini_baseline\n",
    "\n",
    "    hnet_reformed = reformed.calculate(\n",
    "        \"household_net_income\", period=2024, map_to=\"person\"\n",
    "    )\n",
    "    hnet_baseline = baseline.calculate(\n",
    "        \"household_net_income\", period=2024, map_to=\"person\"\n",
    "    )\n",
    "    percent_better_off = (hnet_reformed > hnet_baseline).mean()\n",
    "    # Poverty headcount relative change\n",
    "    # Inequality gini index relative change\n",
    "    # Percent better off\n",
    "\n",
    "    return dict(\n",
    "        budgetary_impact=budgetary_impact,\n",
    "        reform_id=reform.api_id,\n",
    "        poverty_rate_change=poverty_rate_change,\n",
    "        gini_rate_change=gini_rate_change,\n",
    "        percent_better_off=percent_better_off,\n",
    "    )\n",
    "\n",
    "\n",
    "budgetary_impacts = []\n",
    "reform_ids = []\n",
    "poverty_rate_changes = []\n",
    "gini_rate_changes = []\n",
    "percentages_better_off = []\n",
    "\n",
    "for i in range(len(provisions)):\n",
    "    impacts = get_impacts(reforms[i])\n",
    "    budgetary_impacts.append(impacts[\"budgetary_impact\"])\n",
    "    reform_ids.append(impacts[\"reform_id\"])\n",
    "    poverty_rate_changes.append(impacts[\"poverty_rate_change\"])\n",
    "    gini_rate_changes.append(impacts[\"gini_rate_change\"])\n",
    "    percentages_better_off.append(impacts[\"percent_better_off\"])\n",
    "\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Reform\": provisions,\n",
    "        \"Budgetary impact\": budgetary_impacts,\n",
    "        \"Percent gaining\": percentages_better_off,\n",
    "        \"Poverty change\": poverty_rate_changes,\n",
    "        \"Inequality change\": gini_rate_changes,\n",
    "        \"PolicyEngine\": reform_ids,\n",
    "    }\n",
    ")\n",
    "\n",
    "df[\"Budgetary impact\"] = df[\"Budgetary impact\"].apply(\n",
    "    lambda x: f\"{x/1e9:+,.1f}\"\n",
    ")\n",
    "df[\"PolicyEngine\"] = df[\"PolicyEngine\"].apply(\n",
    "    lambda x: f\"[#{x}](https://legacy.policyengine.org/uk/policy?reform={x}&baseline=1&time_period=2024&region=uk)\"\n",
    ")\n",
    "df[\"Percent gaining\"] = df[\"Percent gaining\"].apply(lambda x: f\"{x:+.1%}\")\n",
    "df[\"Poverty change\"] = df[\"Poverty change\"].apply(lambda x: f\"{x:+.1%}\")\n",
    "df[\"Inequality change\"] = df[\"Inequality change\"].apply(lambda x: f\"{x:+.1%}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "| Reform            |   Budgetary impact | Percent gaining   | Poverty change   | Inequality change   | PolicyEngine                                                                                    |\n",
       "|:------------------|-------------------:|:------------------|:-----------------|:--------------------|:------------------------------------------------------------------------------------------------|\n",
       "| 1p NI cut         |               -5   | +63.8%            | +0.0%            | +0.2%               | [#49642](https://legacy.policyengine.org/uk/policy?reform=49642&baseline=1&time_period=2024&region=uk) |\n",
       "| 2p NI cut         |              -10   | +63.8%            | -0.3%            | +0.3%               | [#49643](https://legacy.policyengine.org/uk/policy?reform=49643&baseline=1&time_period=2024&region=uk) |\n",
       "| 2p basic rate cut |              -11.1 | +69.8%            | -0.4%            | +0.3%               | [#49644](https://legacy.policyengine.org/uk/policy?reform=49644&baseline=1&time_period=2024&region=uk) |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from IPython.display import Markdown\n",
    "\n",
    "Markdown(df.to_markdown(index=False))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Distributional impacts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: pandas in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (2.2.1)\n",
      "^C\n",
      "\u001b[31mERROR: Operation cancelled by user\u001b[0m\u001b[31m\n",
      "\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m A new release of pip is available: \u001b[0m\u001b[31;49m23.3.1\u001b[0m\u001b[39;49m -> \u001b[0m\u001b[32;49m24.0\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m To update, run: \u001b[0m\u001b[32;49mpython3 -m pip install --upgrade pip\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n",
      "Requirement already satisfied: nbformat in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (5.9.2)\n",
      "Requirement already satisfied: fastjsonschema in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (from nbformat) (2.19.1)\n",
      "Requirement already satisfied: jsonschema>=2.6 in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (from nbformat) (4.21.1)\n",
      "Requirement already satisfied: jupyter-core in /Users/administrator/Library/Python/3.9/lib/python/site-packages (from nbformat) (5.5.1)\n",
      "Requirement already satisfied: traitlets>=5.1 in /Users/administrator/Library/Python/3.9/lib/python/site-packages (from nbformat) (5.14.0)\n",
      "Requirement already satisfied: attrs>=22.2.0 in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (from jsonschema>=2.6->nbformat) (23.2.0)\n",
      "Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (from jsonschema>=2.6->nbformat) (2023.12.1)\n",
      "Requirement already satisfied: referencing>=0.28.4 in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (from jsonschema>=2.6->nbformat) (0.33.0)\n",
      "Requirement already satisfied: rpds-py>=0.7.1 in /Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages (from jsonschema>=2.6->nbformat) (0.18.0)\n",
      "Requirement already satisfied: platformdirs>=2.5 in /Users/administrator/Library/Python/3.9/lib/python/site-packages (from jupyter-core->nbformat) (4.1.0)\n",
      "\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m A new release of pip is available: \u001b[0m\u001b[31;49m23.3.1\u001b[0m\u001b[39;49m -> \u001b[0m\u001b[32;49m24.0\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m To update, run: \u001b[0m\u001b[32;49mpython3 -m pip install --upgrade pip\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "%pip install -U pandas\n",
    "%pip install nbformat"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Figure 1: Each provision's change in net income, by decile*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=1p NI cut<br>Decile=%{x}<br>Relative change=%{y}<br>Text=%{text}<extra></extra>",
         "legendgroup": "1p NI cut",
         "marker": {
          "color": "#17354F",
          "pattern": {
           "shape": ""
          }
         },
         "name": "1p NI cut",
         "offsetgroup": "1p NI cut",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "0.0%",
          "0.1%",
          "0.2%",
          "0.3%",
          "0.4%",
          "0.6%",
          "0.7%",
          "0.8%",
          "0.7%",
          "0.5%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          0.00017939409994996214,
          0.0005470910704261151,
          0.001545359108935586,
          0.0028808928885603272,
          0.004016404435987526,
          0.0057513039354001785,
          0.006865034386079139,
          0.007562389021527562,
          0.007463826656961707,
          0.0045059033811456805
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=2p NI cut<br>Decile=%{x}<br>Relative change=%{y}<br>Text=%{text}<extra></extra>",
         "legendgroup": "2p NI cut",
         "marker": {
          "color": "#2C6496",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2p NI cut",
         "offsetgroup": "2p NI cut",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "0.0%",
          "0.1%",
          "0.3%",
          "0.5%",
          "0.7%",
          "1.1%",
          "1.3%",
          "1.4%",
          "1.4%",
          "0.8%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          0.00033316025394293346,
          0.0010160252393705508,
          0.002869956962169209,
          0.005350232103900272,
          0.0074590449925261895,
          0.010680997385029636,
          0.012749354213501067,
          0.014044440537681295,
          0.013861406875454198,
          0.008368111894940009
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=2p basic rate cut<br>Decile=%{x}<br>Relative change=%{y}<br>Text=%{text}<extra></extra>",
         "legendgroup": "2p basic rate cut",
         "marker": {
          "color": "#616161",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2p basic rate cut",
         "offsetgroup": "2p basic rate cut",
         "orientation": "v",
         "showlegend": true,
         "text": [
          "0.1%",
          "0.3%",
          "0.4%",
          "0.5%",
          "0.8%",
          "1.0%",
          "1.2%",
          "1.3%",
          "1.4%",
          "0.9%"
         ],
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          0.0013572272663274023,
          0.002662130975722555,
          0.0043837633089392185,
          0.005372476324289575,
          0.007754855192808479,
          0.009822784942066606,
          0.012040846851525486,
          0.013215637454867495,
          0.013703926139213663,
          0.009045902660274002
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "barmode": "group",
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.2,
          "sizey": 0.2,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Reform"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Change in net income by decile"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Reform"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "tickformat": "+.1%",
         "title": {
          "text": "Relative change in net income"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from policyengine_core.charts.api import get_api_chart_data\n",
    "import plotly.express as px\n",
    "from policyengine_core.charts import *\n",
    "\n",
    "decile_df = pd.DataFrame()\n",
    "\n",
    "for i in range(len(provisions)):\n",
    "    impacts = get_impacts(reforms[i])\n",
    "    decile_data = get_api_chart_data(\n",
    "        \"uk\",\n",
    "        Reform.from_dict(reforms[i], \"uk\").api_id,\n",
    "        \"decile\",\n",
    "        \"uk\",\n",
    "        2024,\n",
    "        1,\n",
    "    )[\"relative\"]\n",
    "    for decile in range(1, 11):\n",
    "        decile_df = pd.concat(\n",
    "            [\n",
    "                decile_df,\n",
    "                pd.DataFrame(\n",
    "                    {\n",
    "                        \"Reform\": [provisions[i]],\n",
    "                        \"Decile\": [decile],\n",
    "                        \"Relative change\": [decile_data[str(decile)]],\n",
    "                        \"Text\": [f\"{decile_data[str(decile)]:.1%}\"],\n",
    "                    }\n",
    "                ),\n",
    "            ]\n",
    "        )\n",
    "\n",
    "fig = px.bar(\n",
    "    decile_df,\n",
    "    x=\"Decile\",\n",
    "    y=\"Relative change\",\n",
    "    color=\"Reform\",\n",
    "    barmode=\"group\",\n",
    "    color_discrete_map={\n",
    "        \"1p NI cut\": BLUE_PRESSED,\n",
    "        \"2p NI cut\": BLUE,\n",
    "        \"2p basic rate cut\": DARK_GRAY,\n",
    "    },\n",
    "    text=\"Text\",\n",
    ").update_layout(\n",
    "    title=\"Change in net income by decile\",\n",
    "    xaxis_title=\"Reform\",\n",
    "    yaxis_title=\"Relative change in net income\",\n",
    "    yaxis_tickformat=\"+.1%\",\n",
    ")\n",
    "\n",
    "fig = format_fig(fig)\n",
    "fig"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*This figure divides the UK into ten income groups, called 'deciles', of equal population. Decile '1' corresponds to the lowest-income Britons, and '10' corresponds to the highest. It then shows the change in post-tax income for the average member of each decile, under each possible reform.*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## National Insurance contributions, 2p decrease\n",
    "\n",
    "Under this policy, the government would reduce required contributions to the National Insurance system (Class 1 contributions) for individuals employed by an employer. The current rate of 10p, brought into force on 6 January 2024, would be further lowered to 8p.\n",
    "\n",
    "The PolicyEngine model projects that a reduction in the Class 1 NIC contribution rate by 2p costs the government approximately £10.0 billion. Under this cut, every income decile gains in aggregate, with 63.8% of households increasing their post-tax income, and none seeing a decrease in disposable. This reform would increase inequality, as measured by the Gini coefficient, by 0.3%, while reducing the poverty rate by 0.2%.\n",
    "\n",
    "For a married couple with two children making £35,000 a year, this reform would lower National Insurance payments by £214 for 2024. However, their maximum possible Universal Credit benefit also falls by £118, providing a net benefit of £96 for the year.\n",
    "\n",
    "## National Insurance contributions, 1p decrease\n",
    "\n",
    "Similar to the 2p National Insurance rate cut, under this reform, the government would reduce Class 1 National Insurance contributions by 1p, from the current rate of 10p to 9p.\n",
    "\n",
    "PolicyEngine projects that this cut would cost the government £5.0 billion. Similar to the 2p cut, under this reform, post-tax income increases for every income decile, with the same 63.8% of households gaining disposable income. This reform would slightly increase the Gini coefficient, by 0.2%, while having a negiligible impact upon the poverty rate.\n",
    "\n",
    "For the same hypothetical couple from above, this reform would lower National Insurance payments by £115 for the year. However, this family's maximum Universal Credit benefit would fall by a corresponding £63, providing an overall benefit of £52 for 2024.\n",
    "\n",
    "## Basic Rate decrease\n",
    "\n",
    "Under another speculated reform, the government would lower the Basic Rate, the tax rate of the UK's lowest tax bracket, by 2p, from its current 20p to 18p. \n",
    "\n",
    "As the Basic Rate taxes a larger pool of household income sources than the National Insurance system, PolicyEngine estimates the cost of this reform to be £11.1 billion for 2024. This policy would increase the net income of 69.6% of UK households, with every individual decile also experiencing an increase in net income. Households in higher deciles do particularly well under this reform; households in the UK's top decile would receive £1,175 in extra net income in 2024, while households in the country's lowest decile would receive £16. This policy would lower the poverty rate by 0.4% relative to its current value. However, it would raise the Gini coefficient by 0.3%.\n",
    "\n",
    "For a two-child household earning £35,000 gross income in 2024, this reform would lower income tax by £197. However, this family's maximum Universal Credit benefit would also decrease by £108, generating a net increase in post-tax income of £89.\n",
    "\n",
    "## Conclusion\n",
    "\n",
    "In anticipation of the Chancellor's Spring Budget 2024, PolicyEngine has modelled the impacts of three speculative tax reforms: two different rate cuts to Class 1 National Insurance contributions and a 2p decrease in the Basic Rate. PolicyEngine estimates the cost of a 2p Basic Rate cut to be £11.1 billion, while a 2p decrease to National Insurance contributions would be slightly less, at £10.0 billion, and a 1p National Insurance contribution decrease would be half of that, at £5.0 billion. \n",
    "\n",
    "All three policies would raise the net income of two-thirds of Britons, especially those in higher-income households, though a 2p cut to the Basic Rate would be slightly broader than the other two reforms, benefitting 69.8% of households. All three policies would exhibit small, ambiguous effects on income inequality, as well as slight reductions to the poverty rate. \n",
    "\n",
    "Finally, in a sample household composed of a married couple with two children under age 18 and a pre-tax income of £35,000, PolicyEngine would project the 2p cuts to the Basic Rate and National Insurance contributions to lower the household's tax payments by roughly £200, with a 1p National Insurance cut saving the household £115. However, these savings would correspond with a lower maximum Universal Credit for the household in each case.\n",
    "\n",
    "For more information about how these possible tax reform provisions might affect one's household or community, we invite our readers to use one of the three personalised calculators in Table 1 above, as well as to follow us on any of the social media platforms linked at the bottom of this page."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# Spring Budget 2024
Slug: uk-2024-spring-budget
Date: 2024-03-06 09:00:00
Authors: Nikhil Woodruff, Anthony Volk
Tags: uk, policy
Description: PolicyEngine estimates the impact of the UK Spring Budget.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Today, Chancellor of the Exchequer Jeremy Hunt announced the Government's Spring Budget 2024. This budget includes a variety of reforms, delineated by the Treasury [here](https://www.gov.uk/government/publications/spring-budget-2024).\n",
    "\n",
    "In this post, PolicyEngine will model the budgetary, societal, and distributional impacts of the budget's reforms to National Insurance, the High Income Child Benefit Charge, and the fuel duty. *To view the impacts of these reforms upon society in PolicyEngine's interactive reform modeling tool, visit [this link](https://legacy.policyengine.org/uk/policy?reform=49773&baseline=1&time_period=2024&region=uk&focus=policyOutput.policyBreakdown&timePeriod=2024).*\n",
    "\n",
    "## Spring Budget 2024 reforms\n",
    "The Spring 2024 Budget includes reforms to various different segments of the tax code. Of these, PolicyEngine will be modelling the following in this article:\n",
    "\n",
    "#### National Insurance Contributions (NICs)\n",
    "* Lowering the main rate of Class 1 NICs from 10p to 8p\n",
    "* Cutting the main rate of Class 4 self-employed NICs from 8p to 6p\n",
    "\n",
    "#### High Income Child Benefit Charge\n",
    "* Increasing the income threshold for the charge from £60,000 to £80,000\n",
    "* Increasing the charge's taper range from £60,000 to £80,000\n",
    "\n",
    "#### Fuel Duty\n",
    "* Extending the fuel duty's 5p rate cut for 12 months\n",
    "* Forgoing the fiscal year 2024-2025 RPI increase for the fuel duty\n",
    "\n",
    "When modelling these reforms, PolicyEngine assumes they take effect on 1 January 2024 and evaluates their impacts over calendar year 2024, differing slightly from Treasury's estimates, which are aligned with the fiscal calendar.\n",
    "\n",
    "#### Other reforms\n",
    "The Chancellor's Spring Budget 2024 also codifies a number of reforms not included in the PolicyEngine model, such as a freeze on the alcohol duty, changes to the non-domiciled taxation regime, and a duty on vaping products. These reforms will not be modelled in this article.\n",
    "\n",
    "## Reform outcomes\n",
    "Table 1 below presents PolicyEngine's estimate of each policy reform provision's key household, budgetary, and societal impact metrics. Cumulatively, the reforms are modelled to cost HM Treasury a total of £14.1 billion for calendar year 2024 and raise the net income of 77.4% of British households, particularly those with higher pre-tax income. The policies also present ambiguous impacts upon the poverty rate, while raising inequality by 0.4%."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Table 1: Household and societal impacts of each Spring Budget 2023 reform provision*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from policyengine_uk import Microsimulation\n",
    "from policyengine_uk.model_api import *\n",
    "\n",
    "reform = {\n",
    "    \"gov.hmrc.fuel_duty.petrol_and_diesel\": {\n",
    "        \"year:2024:5\": 0.5295,\n",
    "    },\n",
    "    \"gov.hmrc.income_tax.charges.CB_HITC.phase_out_start\": {\n",
    "        \"year:2024:5\": 60_000,\n",
    "    },\n",
    "    \"gov.hmrc.income_tax.charges.CB_HITC.phase_out_rate\": {\n",
    "        \"year:2024:5\": 0.05,\n",
    "    },\n",
    "    \"gov.hmrc.national_insurance.class_1.rates.employee.main\": {\n",
    "        \"year:2024:5\": 0.08,\n",
    "    },\n",
    "    \"gov.hmrc.national_insurance.class_4.rates.main\": {\n",
    "        \"year:2024:5\": 0.06,\n",
    "    },\n",
    "}\n",
    "import pandas as pd\n",
    "\n",
    "# DataFrame with columns: [provision name, provision cost in 2024, percent better off, provision poverty impact in 2024, inequality impact in 2024]\n",
    "\n",
    "reforms = []\n",
    "\n",
    "fuel_duty_freeze = {\n",
    "    \"gov.hmrc.fuel_duty.petrol_and_diesel\": {\n",
    "        \"year:2024:5\": 0.5295,\n",
    "    }\n",
    "}\n",
    "\n",
    "cb_hitc_cut = {\n",
    "    \"gov.hmrc.income_tax.charges.CB_HITC.phase_out_start\": {\n",
    "        \"year:2024:5\": 60_000,\n",
    "    },\n",
    "    \"gov.hmrc.income_tax.charges.CB_HITC.phase_out_rate\": {\n",
    "        \"year:2024:5\": 0.05,\n",
    "    },\n",
    "}\n",
    "\n",
    "ni_class_1_cut = {\n",
    "    \"gov.hmrc.national_insurance.class_1.rates.employee.main\": {\n",
    "        \"year:2024:5\": 0.08,\n",
    "    },\n",
    "}\n",
    "\n",
    "ni_class_4_cut = {\n",
    "    \"gov.hmrc.national_insurance.class_4.rates.main\": {\n",
    "        \"year:2024:5\": 0.06,\n",
    "    },\n",
    "}\n",
    "\n",
    "complete_reform = {\n",
    "    **fuel_duty_freeze,\n",
    "    **cb_hitc_cut,\n",
    "    **ni_class_1_cut,\n",
    "    **ni_class_4_cut,\n",
    "}\n",
    "\n",
    "reforms = [\n",
    "    fuel_duty_freeze,\n",
    "    cb_hitc_cut,\n",
    "    ni_class_1_cut,\n",
    "    ni_class_4_cut,\n",
    "    complete_reform,\n",
    "]\n",
    "\n",
    "provisions = [\n",
    "    \"Fuel duty freeze\",\n",
    "    \"CB HITC cut\",\n",
    "    \"NI class 1 cut\",\n",
    "    \"NI class 4 cut\",\n",
    "    \"Combined\",\n",
    "]\n",
    "\n",
    "baseline = Microsimulation()\n",
    "\n",
    "\n",
    "def get_impacts(reform_dict: dict) -> dict:\n",
    "    reform = Reform.from_dict(reform_dict, country_id=\"uk\")\n",
    "    reformed = Microsimulation(reform=reform)\n",
    "\n",
    "    budgetary_impact = (\n",
    "        baseline.calculate(\"household_net_income\", period=2024).sum()\n",
    "        - reformed.calculate(\"household_net_income\", 2024).sum()\n",
    "    )\n",
    "    poverty_baseline = baseline.calculate(\n",
    "        \"in_poverty\", map_to=\"person\", period=2024\n",
    "    ).mean()\n",
    "    poverty_reform = reformed.calculate(\n",
    "        \"in_poverty\", map_to=\"person\", period=2024\n",
    "    ).mean()\n",
    "    poverty_rate_change = (\n",
    "        poverty_reform - poverty_baseline\n",
    "    ) / poverty_baseline\n",
    "\n",
    "    gini_baseline = baseline.calculate(\n",
    "        \"equiv_household_net_income\", map_to=\"person\", period=2024\n",
    "    ).gini()\n",
    "    gini_reform = reformed.calculate(\n",
    "        \"equiv_household_net_income\", map_to=\"person\", period=2024\n",
    "    ).gini()\n",
    "    gini_rate_change = (gini_reform - gini_baseline) / gini_baseline\n",
    "\n",
    "    hnet_reformed = reformed.calculate(\n",
    "        \"household_net_income\", period=2024, map_to=\"person\"\n",
    "    )\n",
    "    hnet_baseline = baseline.calculate(\n",
    "        \"household_net_income\", period=2024, map_to=\"person\"\n",
    "    )\n",
    "    percent_better_off = (hnet_reformed > hnet_baseline).mean()\n",
    "    # Poverty headcount relative change\n",
    "    # Inequality gini index relative change\n",
    "    # Percent better off\n",
    "\n",
    "    return dict(\n",
    "        budgetary_impact=budgetary_impact,\n",
    "        reform_id=reform.api_id,\n",
    "        poverty_rate_change=poverty_rate_change,\n",
    "        gini_rate_change=gini_rate_change,\n",
    "        percent_better_off=percent_better_off,\n",
    "    )\n",
    "\n",
    "\n",
    "budgetary_impacts = []\n",
    "reform_ids = []\n",
    "poverty_rate_changes = []\n",
    "gini_rate_changes = []\n",
    "percentages_better_off = []\n",
    "\n",
    "for i in range(len(provisions)):\n",
    "    impacts = get_impacts(reforms[i])\n",
    "    budgetary_impacts.append(impacts[\"budgetary_impact\"])\n",
    "    reform_ids.append(impacts[\"reform_id\"])\n",
    "    poverty_rate_changes.append(impacts[\"poverty_rate_change\"])\n",
    "    gini_rate_changes.append(impacts[\"gini_rate_change\"])\n",
    "    percentages_better_off.append(impacts[\"percent_better_off\"])\n",
    "\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Reform\": provisions,\n",
    "        \"Budgetary impact\": budgetary_impacts,\n",
    "        \"Percent gaining\": percentages_better_off,\n",
    "        \"Poverty change\": poverty_rate_changes,\n",
    "        \"Inequality change\": gini_rate_changes,\n",
    "        \"PolicyEngine\": reform_ids,\n",
    "    }\n",
    ")\n",
    "\n",
    "df[\"Budgetary impact\"] = df[\"Budgetary impact\"].apply(\n",
    "    lambda x: f\"{x/1e9:+,.1f}\"\n",
    ")\n",
    "df[\"PolicyEngine\"] = df[\"PolicyEngine\"].apply(\n",
    "    lambda x: f\"[#{x}](https://legacy.policyengine.org/uk/policy?reform={x}&baseline=1&time_period=2024&region=uk)\"\n",
    ")\n",
    "df[\"Percent gaining\"] = df[\"Percent gaining\"].apply(lambda x: f\"{x:+.1%}\")\n",
    "df[\"Poverty change\"] = df[\"Poverty change\"].apply(lambda x: f\"{x:+.1%}\")\n",
    "df[\"Inequality change\"] = df[\"Inequality change\"].apply(lambda x: f\"{x:+.1%}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "| Reform           |   Budgetary impact | Percent gaining   | Poverty change   | Inequality change   | PolicyEngine                                                                                    |\n",
       "|:-----------------|-------------------:|:------------------|:-----------------|:--------------------|:------------------------------------------------------------------------------------------------|\n",
       "| Fuel duty freeze |               -1.7 | +44.7%            | -0.2%            | -0.1%               | [#49760](https://legacy.policyengine.org/uk/policy?reform=49760&baseline=1&time_period=2024&region=uk) |\n",
       "| CB HITC cut      |               -1.4 | +7.0%             | +0.0%            | +0.0%               | [#49761](https://legacy.policyengine.org/uk/policy?reform=49761&baseline=1&time_period=2024&region=uk) |\n",
       "| NI class 1 cut   |              -10   | +63.8%            | +0.0%            | +0.3%               | [#49643](https://legacy.policyengine.org/uk/policy?reform=49643&baseline=1&time_period=2024&region=uk) |\n",
       "| NI class 4 cut   |               -1   | +8.0%             | +0.0%            | +0.0%               | [#49762](https://legacy.policyengine.org/uk/policy?reform=49762&baseline=1&time_period=2024&region=uk) |\n",
       "| Combined         |              -14.1 | +78.9%            | -0.4%            | +0.3%               | [#49773](https://legacy.policyengine.org/uk/policy?reform=49773&baseline=1&time_period=2024&region=uk) |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from IPython.display import Markdown\n",
    "\n",
    "Markdown(df.to_markdown(index=False))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "reformed = Microsimulation()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Budgetary impacts\n",
    "\n",
    "The PolicyEngine microsimulation model projects that the six reforms covered in this article will cost a combined [£14.1 billion in 2024](https://legacy.policyengine.org/uk/policy?reform=49773&baseline=1&time_period=2024&region=uk&focus=policyOutput.policyBreakdown&timePeriod=2024). This is only slightly higher than the Treasury's projected cost of [£13.7 billion](https://assets.publishing.service.gov.uk/media/65e7920c08eef600155a5617/Published_Costing_Document_Spring_Budget_2024_Final.pdf) for the same six reforms in fiscal year 2024-2025. Some of the variance in these projections are attributable to HM Treasury's inclusion of behavioural responses to policy reforms, as well as Treasury's modelling over a the fiscal year, as opposed to the calendar year.\n",
    "\n",
    "Table 2 below presents PolicyEngine's broader estimates over 2024, 2025, and 2026, as compared to HM Treasury's [estimates](https://assets.publishing.service.gov.uk/media/65e8578eb559930011ade2cb/E03057752_HMT_Spring_Budget_Mar_24_Web_Accessible__2_.pdf) over the corresponding fiscal years (2024-2025, etc.) for the six policies investigated in this article."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "from policyengine_uk import Microsimulation\n",
    "from policyengine_uk.model_api import *\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "# DataFrame with columns: [provision name, provision cost in 2024, percent better off, provision poverty impact in 2024, inequality impact in 2024]\n",
    "\n",
    "rows = [\"PolicyEngine\", \"HM Treasury\", \"Difference\"]\n",
    "years = [\"2024\", \"2025\", \"2026\"]\n",
    "\n",
    "baseline = Microsimulation()\n",
    "\n",
    "# Assign values for HM Treasury from report\n",
    "treasury_values_bn = {\n",
    "    \"2024\": {\n",
    "        \"ni_class_1_cut\": -9.360,\n",
    "        \"ni_class_4_cut\": -0.710,\n",
    "        \"cb_hitc_cut\": -0.540,\n",
    "        \"fuel_duty_freeze\": -3.090,\n",
    "    },\n",
    "    \"2025\": {\n",
    "        \"ni_class_1_cut\": -9.295,\n",
    "        \"ni_class_4_cut\": -0.850,\n",
    "        \"cb_hitc_cut\": -0.635,\n",
    "        \"fuel_duty_freeze\": -0.820,\n",
    "    },\n",
    "    \"2026\": {\n",
    "        \"ni_class_1_cut\": -9.490,\n",
    "        \"ni_class_4_cut\": -0.735,\n",
    "        \"cb_hitc_cut\": -0.640,\n",
    "        \"fuel_duty_freeze\": -0.830,\n",
    "    },\n",
    "}\n",
    "\n",
    "treasury_totals_bn = {}\n",
    "for year in treasury_values_bn:\n",
    "    treasury_totals_bn[year] = sum(treasury_values_bn[year].values())\n",
    "\n",
    "\n",
    "# Get impacts of entire policy reform for each year and place into dict\n",
    "def get_budget_impact_year(reform_dict: dict, year: str) -> float:\n",
    "    reform = Reform.from_dict(reform_dict, country_id=\"uk\")\n",
    "    reformed = Microsimulation(reform=reform)\n",
    "\n",
    "    budgetary_impact = (\n",
    "        baseline.calculate(\"household_net_income\", period=year).sum()\n",
    "        - reformed.calculate(\"household_net_income\", year).sum()\n",
    "    )\n",
    "    return budgetary_impact\n",
    "\n",
    "\n",
    "pe_totals_bn = {}\n",
    "for year in years:\n",
    "    pe_totals_bn[year] = get_budget_impact_year(complete_reform, year) / 1e9\n",
    "\n",
    "# Calculate difference between values\n",
    "diff_totals_bn = {}\n",
    "\n",
    "for year in years:\n",
    "    diff_totals_bn[year] = treasury_totals_bn[year] - pe_totals_bn[year]\n",
    "\n",
    "chart_data = []\n",
    "for i in range(len(years)):\n",
    "    chart_data.append([])\n",
    "    chart_data[i].append(pe_totals_bn[years[i]])\n",
    "    chart_data[i].append(treasury_totals_bn[years[i]])\n",
    "    chart_data[i].append(diff_totals_bn[years[i]])\n",
    "\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Estimates\": rows,\n",
    "        \"2024 (£bn)\": chart_data[0],\n",
    "        \"2025 (£bn)\": chart_data[1],\n",
    "        \"2026 (£bn)\": chart_data[2],\n",
    "    }\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "df[\"2024 (£bn)\"] = df[\"2024 (£bn)\"].apply(lambda x: f\"{x:+,.1f}\")\n",
    "df[\"2025 (£bn)\"] = df[\"2025 (£bn)\"].apply(lambda x: f\"{x:+,.1f}\")\n",
    "df[\"2026 (£bn)\"] = df[\"2026 (£bn)\"].apply(lambda x: f\"{x:+,.1f}\")\n",
    "\n",
    "# Note - I am unsure how to format the sole percentage row"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "| Estimates    |   2024 (£bn) |   2025 (£bn) |   2026 (£bn) |\n",
       "|:-------------|-------------:|-------------:|-------------:|\n",
       "| PolicyEngine |        -14.1 |        -15.8 |        -16.4 |\n",
       "| HM Treasury  |        -13.7 |        -11.6 |        -11.7 |\n",
       "| Difference   |          0.4 |          4.2 |          4.7 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from IPython.display import Markdown\n",
    "\n",
    "Markdown(df.to_markdown(index=False))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Distributional impacts\n",
    "The six modeled reforms of the Spring Budget 2023 would increase the net income of households by 1.2% on average. Under this reform, top-earning deciles would disproportionately benefit. Decile 9, the biggest beneficiary in relative terms, would experience a 1.9% gain in disposable income, while deciles 1 through 3 receive between 0.3% and 0.4%. In absolute terms, this equates to a £46 increase in post-tax income for earners in the lowest decile and a £1,402 increase for those in the top decile (£1,386 for those in decile 9). Similarly, 99.6% of earners in decile 9 and 77.4% of earners in decile 10 experience an increase in net income under these reforms, while 36.2% of earners in the lowest decile gain."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "from policyengine_uk import Simulation\n",
    "from policyengine_core.reforms import Reform\n",
    "from policyengine_core.periods import instant\n",
    "\n",
    "\n",
    "def modify_parameters(parameters):\n",
    "    parameters.gov.hmrc.fuel_duty.petrol_and_diesel.update(\n",
    "        start=instant(\"2024-01-01\"), stop=instant(\"2028-12-31\"), value=0.5295\n",
    "    )\n",
    "    parameters.gov.hmrc.income_tax.charges.CB_HITC.phase_out_rate.update(\n",
    "        start=instant(\"2024-01-01\"), stop=instant(\"2028-12-31\"), value=0.05\n",
    "    )\n",
    "    parameters.gov.hmrc.income_tax.charges.CB_HITC.phase_out_start.update(\n",
    "        start=instant(\"2024-01-01\"), stop=instant(\"2028-12-31\"), value=60000\n",
    "    )\n",
    "    parameters.gov.hmrc.national_insurance.class_1.rates.employee.main.update(\n",
    "        start=instant(\"2024-01-01\"), stop=instant(\"2028-12-31\"), value=0.08\n",
    "    )\n",
    "    parameters.gov.hmrc.national_insurance.class_4.rates.main.update(\n",
    "        start=instant(\"2024-01-01\"), stop=instant(\"2028-12-31\"), value=0.06\n",
    "    )\n",
    "    return parameters\n",
    "\n",
    "\n",
    "class reform(Reform):\n",
    "    def apply(self):\n",
    "        self.modify_parameters(modify_parameters)\n",
    "\n",
    "\n",
    "single_situation = {\n",
    "    \"people\": {\"you\": {\"age\": {\"2024\": 40}}},\n",
    "    \"benunits\": {\"your immediate family\": {\"members\": [\"you\"]}},\n",
    "    \"households\": {\n",
    "        \"your household\": {\n",
    "            \"members\": [\"you\"],\n",
    "            \"BRMA\": {\"2024\": \"MAIDSTONE\"},\n",
    "            \"local_authority\": {\"2024\": \"MAIDSTONE\"},\n",
    "            \"region\": {\"2024\": \"LONDON\"},\n",
    "        }\n",
    "    },\n",
    "    \"axes\": [\n",
    "        [{\"name\": \"employment_income\", \"count\": 200, \"min\": 0, \"max\": 200000}]\n",
    "    ],\n",
    "}\n",
    "\n",
    "married_situation = {\n",
    "    \"people\": {\n",
    "        \"you\": {\"age\": {\"2024\": 40}},\n",
    "        \"your partner\": {\"age\": {\"2024\": 40}},\n",
    "        \"your first child\": {\"age\": {\"2024\": 10}},\n",
    "        \"your second child\": {\"age\": {\"2024\": 10}},\n",
    "    },\n",
    "    \"benunits\": {\n",
    "        \"your immediate family\": {\n",
    "            \"members\": [\n",
    "                \"you\",\n",
    "                \"your partner\",\n",
    "                \"your first child\",\n",
    "                \"your second child\",\n",
    "            ]\n",
    "        }\n",
    "    },\n",
    "    \"households\": {\n",
    "        \"your household\": {\n",
    "            \"members\": [\n",
    "                \"you\",\n",
    "                \"your partner\",\n",
    "                \"your first child\",\n",
    "                \"your second child\",\n",
    "            ],\n",
    "            \"BRMA\": {\"2024\": \"MAIDSTONE\"},\n",
    "            \"local_authority\": {\"2024\": \"MAIDSTONE\"},\n",
    "            \"region\": {\"2024\": \"LONDON\"},\n",
    "        }\n",
    "    },\n",
    "    \"axes\": [\n",
    "        [{\"name\": \"employment_income\", \"count\": 200, \"min\": 0, \"max\": 200000}]\n",
    "    ],\n",
    "}\n",
    "\n",
    "baseline_single_simulation = Simulation(situation=single_situation)\n",
    "\n",
    "reform_single_simulation = Simulation(\n",
    "    reform=reform,\n",
    "    situation=single_situation,\n",
    ")\n",
    "\n",
    "baseline_married_simulation = Simulation(situation=married_situation)\n",
    "\n",
    "reform_married_simulation = Simulation(\n",
    "    reform=reform,\n",
    "    situation=married_situation,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Household impacts\n",
    "For a single person with only employment income, the six reforms evaluated in this article produce a benefit if they earn at least £12,750, producing a maximum benefit of £754 if the individual earns £50,270 per year. This assumes the individual consumes no fuel impacted by the fuel duty freeze; if the same person were to spend the UK average of [£1,176](https://www.nimblefins.co.uk/cheap-car-insurance/average-cost-petrol-car) in 2024 on petrol, they would save a further £96, no matter what their pre-tax income.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "hovertemplate": "Employment income=%{x}<br>Net income=%{y}<extra></extra>",
         "legendgroup": "",
         "line": {
          "color": "#2C6496",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "lines",
         "name": "",
         "orientation": "v",
         "showlegend": false,
         "type": "scatter",
         "x": [
          0,
          1067.2659912109375,
          2134.531982421875,
          3201.7978515625,
          4269.06396484375,
          5336.32958984375,
          6403.595703125,
          7470.861328125,
          8538.1279296875,
          9605.3935546875,
          10672.6591796875,
          11739.9248046875,
          12807.19140625,
          13874.4560546875,
          14941.72265625,
          16008.9892578125,
          17076.255859375,
          18143.521484375,
          19210.787109375,
          20278.05078125,
          21345.318359375,
          22412.583984375,
          23479.849609375,
          24547.1171875,
          25614.3828125,
          26681.6484375,
          27748.912109375,
          28816.1796875,
          29883.4453125,
          30950.7109375,
          32017.978515625,
          33085.2421875,
          34152.51171875,
          35219.7734375,
          36287.04296875,
          37354.3046875,
          38421.57421875,
          39488.83984375,
          40556.1015625,
          41623.37109375,
          42690.63671875,
          43757.90234375,
          44825.16796875,
          45892.4375,
          46959.69921875,
          48026.96484375,
          49094.234375,
          50161.49609375,
          51228.765625,
          52296.02734375,
          53363.296875,
          54430.5625,
          55497.82421875,
          56565.09375,
          57632.359375,
          58699.625,
          59766.890625,
          60834.16015625,
          61901.421875,
          62968.6875,
          64035.95703125,
          65103.21875,
          66170.484375,
          67237.75,
          68305.0234375,
          69372.28125,
          70439.546875,
          71506.8125,
          72574.0859375,
          73641.3515625,
          74708.609375,
          75775.875,
          76843.1484375,
          77910.4140625,
          78977.6796875,
          80044.9453125,
          81112.203125,
          82179.4765625,
          83246.7421875,
          84314.0078125,
          85381.2734375,
          86448.546875,
          87515.8046875,
          88583.0703125,
          89650.3359375,
          90717.6015625,
          91784.875,
          92852.1328125,
          93919.3984375,
          94986.6640625,
          96053.9296875,
          97121.203125,
          98188.46875,
          99255.7265625,
          100322.9921875,
          101390.265625,
          102457.53125,
          103524.796875,
          104592.0546875,
          105659.3203125,
          106726.59375,
          107793.859375,
          108861.125,
          109928.390625,
          110995.6484375,
          112062.921875,
          113130.1875,
          114197.453125,
          115264.71875,
          116331.984375,
          117399.25,
          118466.515625,
          119533.78125,
          120601.046875,
          121668.3203125,
          122735.578125,
          123802.84375,
          124870.109375,
          125937.375,
          127004.6484375,
          128071.9140625,
          129139.171875,
          130206.4375,
          131273.703125,
          132340.96875,
          133408.234375,
          134475.5,
          135542.765625,
          136610.046875,
          137677.296875,
          138744.5625,
          139811.84375,
          140879.09375,
          141946.375,
          143013.625,
          144080.890625,
          145148.171875,
          146215.421875,
          147282.703125,
          148349.96875,
          149417.21875,
          150484.5,
          151551.75,
          152619.03125,
          153686.296875,
          154753.546875,
          155820.828125,
          156888.078125,
          157955.359375,
          159022.625,
          160089.890625,
          161157.15625,
          162224.40625,
          163291.6875,
          164358.953125,
          165426.21875,
          166493.484375,
          167560.734375,
          168628.015625,
          169695.28125,
          170762.546875,
          171829.8125,
          172897.09375,
          173964.34375,
          175031.609375,
          176098.875,
          177166.140625,
          178233.421875,
          179300.671875,
          180367.9375,
          181435.203125,
          182502.46875,
          183569.75,
          184637,
          185704.265625,
          186771.53125,
          187838.796875,
          188906.078125,
          189973.328125,
          191040.59375,
          192107.859375,
          193175.125,
          194242.40625,
          195309.65625,
          196376.9375,
          197444.1875,
          198511.453125,
          199578.734375,
          200645.984375,
          201713.265625,
          202780.53125,
          203847.78125,
          204915.0625,
          205982.3125,
          207049.59375,
          208116.859375,
          209184.109375,
          210251.390625,
          211318.640625,
          212385.921875
         ],
         "xaxis": "x",
         "y": [
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          4.744140625,
          26.08984375,
          47.4345703125,
          68.7802734375,
          90.1259765625,
          111.470703125,
          132.81640625,
          154.16015625,
          175.5078125,
          196.8515625,
          218.197265625,
          239.54296875,
          260.888671875,
          282.232421875,
          303.578125,
          324.923828125,
          346.26953125,
          367.615234375,
          388.958984375,
          410.3046875,
          431.65234375,
          452.99609375,
          474.341796875,
          495.685546875,
          517.03125,
          538.37890625,
          559.72265625,
          581.06640625,
          602.4140625,
          623.76171875,
          645.10546875,
          666.44921875,
          687.79296875,
          709.140625,
          730.484375,
          751.83203125,
          754,
          754.00390625,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754.00390625,
          754,
          754,
          754,
          754.00390625,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754.00390625,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754.0078125,
          754,
          754.0078125,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.2,
          "sizey": 0.2,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "tracegroupgap": 0
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "showlegend": false,
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Change to household net income by employment income for a single person"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "tickformat": ",.0f",
         "tickprefix": "£",
         "title": {
          "text": "Employment income"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "tickformat": ",.0f",
         "tickprefix": "£",
         "title": {
          "text": "Change to net income"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from policyengine_core.charts import *\n",
    "\n",
    "single_diff = pd.DataFrame(\n",
    "    {\n",
    "        \"Net income\": (\n",
    "            reform_single_simulation.calculate(\"household_net_income\", 2024)\n",
    "            - baseline_single_simulation.calculate(\n",
    "                \"household_net_income\", 2024\n",
    "            )\n",
    "        ),\n",
    "        \"Employment income\": reform_single_simulation.calculate(\n",
    "            \"employment_income\", 2024\n",
    "        ),\n",
    "    }\n",
    ")\n",
    "fig = px.line(\n",
    "    single_diff,\n",
    "    y=\"Net income\",\n",
    "    x=\"Employment income\",\n",
    "    color_discrete_sequence=[BLUE],\n",
    "    title=\"Change to household net income by employment income for a single person\",\n",
    ").update_layout(\n",
    "    xaxis_title=\"Employment income\",\n",
    "    yaxis_title=\"Change to net income\",\n",
    "    yaxis_tickformat=\",.0f\",\n",
    "    yaxis_tickprefix=\"£\",\n",
    "    xaxis_tickformat=\",.0f\",\n",
    "    xaxis_tickprefix=\"£\",\n",
    "    showlegend=False,\n",
    ")\n",
    "format_fig(fig)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For the same hypothetical person, if their income falls within the range specified above, the tax reforms analysed here would yield a 2% drop in their marginal tax rate; all others would see no change. *View this household in the interactive PolicyEngine tax calculator [here](https://legacy.policyengine.org/uk/household?reform=49773&baseline=1&time_period=2024&region=uk&focus=householdOutput.netIncome&timePeriod=2024&household=42359).*\n",
    "\n",
    "For a married couple with two children, the impacts of this reform package are slightly more complext. Again, these reforms would produce no increase to post-tax income until the head of household earns £12,750 per year, after which the families net income will rise, until reaching a peak of £2,874 when the head makes £60,000. After this point, the post-tax benefit drops as the High Income Child Benefit Charge phases in, until the end of its taper at £80,000, at which all households see a net income increase of £754. These figures do not include the impact of the fuel duty freeze. *View this household in the interactive PolicyEngine tax calculator [here](https://legacy.policyengine.org/uk/household?reform=49773&baseline=1&time_period=2024&region=uk&focus=householdOutput.earnings&timePeriod=2024&household=42361).*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "hovertemplate": "Employment income=%{x}<br>Net income=%{y}<extra></extra>",
         "legendgroup": "",
         "line": {
          "color": "#2C6496",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "lines",
         "name": "",
         "orientation": "v",
         "showlegend": false,
         "type": "scatter",
         "x": [
          0,
          1067.2659912109375,
          2134.531982421875,
          3201.7978515625,
          4269.06396484375,
          5336.32958984375,
          6403.595703125,
          7470.861328125,
          8538.1279296875,
          9605.3935546875,
          10672.6591796875,
          11739.9248046875,
          12807.19140625,
          13874.4560546875,
          14941.72265625,
          16008.9892578125,
          17076.255859375,
          18143.521484375,
          19210.787109375,
          20278.05078125,
          21345.318359375,
          22412.583984375,
          23479.849609375,
          24547.1171875,
          25614.3828125,
          26681.6484375,
          27748.912109375,
          28816.1796875,
          29883.4453125,
          30950.7109375,
          32017.978515625,
          33085.2421875,
          34152.51171875,
          35219.7734375,
          36287.04296875,
          37354.3046875,
          38421.57421875,
          39488.83984375,
          40556.1015625,
          41623.37109375,
          42690.63671875,
          43757.90234375,
          44825.16796875,
          45892.4375,
          46959.69921875,
          48026.96484375,
          49094.234375,
          50161.49609375,
          51228.765625,
          52296.02734375,
          53363.296875,
          54430.5625,
          55497.82421875,
          56565.09375,
          57632.359375,
          58699.625,
          59766.890625,
          60834.16015625,
          61901.421875,
          62968.6875,
          64035.95703125,
          65103.21875,
          66170.484375,
          67237.75,
          68305.0234375,
          69372.28125,
          70439.546875,
          71506.8125,
          72574.0859375,
          73641.3515625,
          74708.609375,
          75775.875,
          76843.1484375,
          77910.4140625,
          78977.6796875,
          80044.9453125,
          81112.203125,
          82179.4765625,
          83246.7421875,
          84314.0078125,
          85381.2734375,
          86448.546875,
          87515.8046875,
          88583.0703125,
          89650.3359375,
          90717.6015625,
          91784.875,
          92852.1328125,
          93919.3984375,
          94986.6640625,
          96053.9296875,
          97121.203125,
          98188.46875,
          99255.7265625,
          100322.9921875,
          101390.265625,
          102457.53125,
          103524.796875,
          104592.0546875,
          105659.3203125,
          106726.59375,
          107793.859375,
          108861.125,
          109928.390625,
          110995.6484375,
          112062.921875,
          113130.1875,
          114197.453125,
          115264.71875,
          116331.984375,
          117399.25,
          118466.515625,
          119533.78125,
          120601.046875,
          121668.3203125,
          122735.578125,
          123802.84375,
          124870.109375,
          125937.375,
          127004.6484375,
          128071.9140625,
          129139.171875,
          130206.4375,
          131273.703125,
          132340.96875,
          133408.234375,
          134475.5,
          135542.765625,
          136610.046875,
          137677.296875,
          138744.5625,
          139811.84375,
          140879.09375,
          141946.375,
          143013.625,
          144080.890625,
          145148.171875,
          146215.421875,
          147282.703125,
          148349.96875,
          149417.21875,
          150484.5,
          151551.75,
          152619.03125,
          153686.296875,
          154753.546875,
          155820.828125,
          156888.078125,
          157955.359375,
          159022.625,
          160089.890625,
          161157.15625,
          162224.40625,
          163291.6875,
          164358.953125,
          165426.21875,
          166493.484375,
          167560.734375,
          168628.015625,
          169695.28125,
          170762.546875,
          171829.8125,
          172897.09375,
          173964.34375,
          175031.609375,
          176098.875,
          177166.140625,
          178233.421875,
          179300.671875,
          180367.9375,
          181435.203125,
          182502.46875,
          183569.75,
          184637,
          185704.265625,
          186771.53125,
          187838.796875,
          188906.078125,
          189973.328125,
          191040.59375,
          192107.859375,
          193175.125,
          194242.40625,
          195309.65625,
          196376.9375,
          197444.1875,
          198511.453125,
          199578.734375,
          200645.984375,
          201713.265625,
          202780.53125,
          203847.78125,
          204915.0625,
          205982.3125,
          207049.59375,
          208116.859375,
          209184.109375,
          210251.390625,
          211318.640625,
          212385.921875
         ],
         "xaxis": "x",
         "y": [
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          0,
          2.134765625,
          11.7421875,
          21.345703125,
          30.951171875,
          40.556640625,
          50.162109375,
          59.765625,
          69.373046875,
          78.978515625,
          88.58203125,
          98.1875,
          107.79296875,
          117.400390625,
          127.001953125,
          136.611328125,
          146.212890625,
          155.8203125,
          165.427734375,
          175.03515625,
          184.63671875,
          194.2421875,
          203.8515625,
          213.453125,
          223.05859375,
          232.6640625,
          242.2734375,
          261.0703125,
          581.06640625,
          602.4140625,
          623.76171875,
          645.10546875,
          666.44921875,
          687.79296875,
          709.140625,
          730.484375,
          786.0625,
          1014.453125,
          1240.67578125,
          1466.89453125,
          1693.1171875,
          1919.3359375,
          2145.55859375,
          2371.77734375,
          2598,
          2824.22265625,
          2785.2265625,
          2672.1171875,
          2559.00390625,
          2445.89453125,
          2332.78125,
          2219.67578125,
          2106.5625,
          1993.453125,
          1880.33984375,
          1767.23046875,
          1654.125,
          1541.0078125,
          1427.8984375,
          1314.78515625,
          1201.67578125,
          1088.56640625,
          975.45703125,
          862.34375,
          754,
          754,
          754.00390625,
          754,
          754,
          754,
          754,
          754,
          754,
          753.99609375,
          754,
          754.00390625,
          754,
          754,
          754,
          754.00390625,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754.0078125,
          754,
          754.0078125,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754.0078125,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          754,
          753.9921875,
          754,
          754,
          754,
          754,
          754,
          754.0078125,
          754,
          754,
          754,
          754,
          754,
          754.0078125
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.2,
          "sizey": 0.2,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "tracegroupgap": 0
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Change to household net income by employment income for a married couple with two children"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "tickformat": ",.0f",
         "tickprefix": "£",
         "title": {
          "text": "Employment income"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "tickformat": ",.0f",
         "tickprefix": "£",
         "title": {
          "text": "Change to net income"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "married_diff = pd.DataFrame(\n",
    "    {\n",
    "        \"Net income\": (\n",
    "            reform_married_simulation.calculate(\"household_net_income\", 2024)\n",
    "            - baseline_married_simulation.calculate(\n",
    "                \"household_net_income\", 2024\n",
    "            )\n",
    "        ),\n",
    "        \"Employment income\": reform_married_simulation.calculate(\n",
    "            \"employment_income\", 2024, map_to=\"household\"\n",
    "        ),\n",
    "    }\n",
    ")\n",
    "fig = px.line(\n",
    "    married_diff,\n",
    "    y=\"Net income\",\n",
    "    x=\"Employment income\",\n",
    "    color_discrete_sequence=[BLUE],\n",
    "    title=\"Change to household net income by employment income for a married couple with two children\",\n",
    ").update_layout(\n",
    "    xaxis_title=\"Employment income\",\n",
    "    yaxis_title=\"Change to net income\",\n",
    "    yaxis_tickformat=\",.0f\",\n",
    "    yaxis_tickprefix=\"£\",\n",
    "    xaxis_tickformat=\",.0f\",\n",
    "    xaxis_tickprefix=\"£\",\n",
    ")\n",
    "format_fig(fig)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Conclusion\n",
    "PolicyEngine estimates the cost of the Spring Budget 2023's reforms to National Insurance, the High Income Child Benefit Charge, and the fuel duty at £14.1 billion in 2024. Cumulatively, these reforms will raise the net income of 77.4% of British households, with a disproportionately positive impact upon higher-income households. We also find a small effect on poverty reduction, as well as a 0.5% increase in inequality. For readers interested in generating their own society-wide tax reform simulations or better understanding how these reforms will impact their household in the coming fiscal year, we invite you to use our personalised [PolicyEngine calculator](https://legacy.policyengine.org/uk/policy?reform=49773&baseline=1&time_period=2024&region=uk&focus=policyOutput.policyBreakdown&timePeriod=2024), available on desktop and mobile devices."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# PolicyEngine's Spring 2024 update
Slug: obr-forecast-update-spring-24
Date: 2024-04-16 09:00:00
Authors: Nikhil Woodruff
Tags: uk, policy
Description: How PolicyEngine compares to the latest external forecasts.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The Office for Budget Responsibility's [March 2024 Economic and Fiscal Outlook](https://obr.uk/docs/dlm_uploads/E03057758_OBR_EFO-March-2024_Web-AccessibleFinal.pdf) updates government forecasts for a five-year budget window for key tax and spending programs, incorporating recent changes in both policy decisions and economic factors. Some parts of PolicyEngine's model are calibrated to be consistent with the OBR's forecasts, and today we're publishing a new version of the model that incorporates the latest information from government publications.\n",
    "\n",
    "This report contains a high-level and a detailed comparison of PolicyEngine's underlying model against government (principally OBR) and other third-party models.\n",
    "\n",
    "## UK household outlook"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from tqdm import tqdm\n",
    "\n",
    "PE_VARIABLES = [\n",
    "    \"income_tax\",\n",
    "    \"total_national_insurance\",\n",
    "    \"child_benefit\",\n",
    "    \"universal_credit\",\n",
    "    \"tax_credits\",\n",
    "    \"housing_benefit\",\n",
    "    \"ESA_income\",\n",
    "    \"income_support\",\n",
    "    \"pension_credit\",\n",
    "    \"pip\",\n",
    "    \"dla\",\n",
    "    \"attendance_allowance\",\n",
    "    \"state_pension\",\n",
    "    \"carers_allowance\",\n",
    "    \"fuel_duty\",\n",
    "    \"vat\",\n",
    "    \"council_tax\",\n",
    "    \"household_net_income\",\n",
    "]\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Year\": list(range(2021, 2028)),\n",
    "    }\n",
    ")\n",
    "for var in PE_VARIABLES:\n",
    "    df[var] = [0] * len(df[\"Year\"])\n",
    "\n",
    "for year in range(2021, 2028):\n",
    "    from policyengine_uk import Microsimulation\n",
    "\n",
    "    sim = Microsimulation()\n",
    "    for variable in PE_VARIABLES:\n",
    "        df.loc[df[\"Year\"] == year, variable] = round(\n",
    "            sim.calculate(variable, year).sum() / 1e9, 1\n",
    "        )\n",
    "\n",
    "df[\"Fuel duties\"] = df[\"fuel_duty\"]\n",
    "df[\"National Insurance\"] = df[\"total_national_insurance\"]\n",
    "df[\"Main taxes\"] = df[\"income_tax\"] + df[\"total_national_insurance\"]\n",
    "df[\"Legacy benefits\"] = (\n",
    "    df[\"tax_credits\"]\n",
    "    + df[\"housing_benefit\"]\n",
    "    + df[\"ESA_income\"]\n",
    "    + df[\"income_support\"]\n",
    ")\n",
    "df[\"Main benefits\"] = (\n",
    "    df[\"child_benefit\"]\n",
    "    + df[\"universal_credit\"]\n",
    "    + df[\"Legacy benefits\"]\n",
    "    + df[\"pension_credit\"]\n",
    "    + df[\"pip\"]\n",
    "    + df[\"dla\"]\n",
    "    + df[\"attendance_allowance\"]\n",
    "    + df[\"state_pension\"]\n",
    "    + df[\"carers_allowance\"]\n",
    ")\n",
    "\n",
    "pe_df = pd.melt(df, id_vars=[\"Year\"], value_vars=df.columns[1:])\n",
    "pe_df = pe_df.replace(\n",
    "    {\n",
    "        variable.name: variable.label\n",
    "        for variable in sim.tax_benefit_system.variables.values()\n",
    "    }\n",
    ")\n",
    "pe_df = pe_df.rename(columns={\"variable\": \"Variable\", \"value\": \"Value\"})\n",
    "\n",
    "\n",
    "# Data from latest UKMOD country report (in million GBP)\n",
    "ukmod_df = pd.DataFrame(\n",
    "    {\n",
    "        \"Year\": [2021, 2022, 2023, 2024, 2025, 2026, 2027],\n",
    "        \"Income Tax\": [207751, 245771, 303005, 364319, 372215, 383896, 398249],\n",
    "        \"NIC Employees\": [63016, 65432, 60613, 55161, 56067, 57567, 59411],\n",
    "        \"NIC Self-employed\": [5069, 5377, 5126, 4401, 4479, 4610, 4769],\n",
    "        \"NIC Employers\": [\n",
    "            95576,\n",
    "            107253,\n",
    "            110702,\n",
    "            114677,\n",
    "            116797,\n",
    "            120339,\n",
    "            124771,\n",
    "        ],\n",
    "        \"Universal Credit\": [38091, 40899, 47833, 59290, 69939, 70292, 70531],\n",
    "        \"Child Benefit\": [11040, 11150, 11845, 12382, 12677, 12697, 12660],\n",
    "        \"Child and Working Tax Credits\": [5797, 5139, 4536, 2565, 0, 0, 0],\n",
    "        \"Housing Benefit\": [10212, 9498, 9031, 7098, 5117, 5145, 5159],\n",
    "        \"Income Support\": [2523, 2317, 2049, 1199, 0, 0, 0],\n",
    "        \"ESA (income-based)\": [4991, 4593, 4124, 2321, 0, 0, 0],\n",
    "        \"Pension Credit\": [4574, 4653, 5341, 6483, 6664, 6849, 7026],\n",
    "        \"Personal Independence Payment\": [\n",
    "            13740,\n",
    "            14170,\n",
    "            15601,\n",
    "            16649,\n",
    "            17204,\n",
    "            17478,\n",
    "            17729,\n",
    "        ],\n",
    "        \"Disability Living Allowance\": [\n",
    "            3713,\n",
    "            3829,\n",
    "            4216,\n",
    "            4499,\n",
    "            4649,\n",
    "            4723,\n",
    "            4791,\n",
    "        ],\n",
    "        \"Attendance Allowance\": [3285, 3388, 3731, 3981, 4114, 4179, 4239],\n",
    "        \"New/basic State Pension\": [\n",
    "            75080,\n",
    "            77399,\n",
    "            85229,\n",
    "            92475,\n",
    "            95804,\n",
    "            98199,\n",
    "            100654,\n",
    "        ],\n",
    "        \"Second State Pension\": [\n",
    "            18574,\n",
    "            19150,\n",
    "            21082,\n",
    "            22498,\n",
    "            23247,\n",
    "            23620,\n",
    "            23958,\n",
    "        ],\n",
    "        \"Carers Allowance\": [3000, 3093, 3406, 3634, 3755, 3815, 3870],\n",
    "        \"Council Tax\": [44047, 45585, 47986, 50093, 52159, 54317, 56562],\n",
    "    }\n",
    ")\n",
    "\n",
    "ukmod_df[\"National Insurance\"] = ukmod_df[\n",
    "    [\"NIC Employees\", \"NIC Self-employed\", \"NIC Employers\"]\n",
    "].sum(axis=1)\n",
    "ukmod_df[\"Main taxes\"] = ukmod_df[\n",
    "    [\"Income Tax\", \"NIC Employees\", \"NIC Self-employed\", \"NIC Employers\"]\n",
    "].sum(axis=1)\n",
    "ukmod_df[\"Legacy benefits\"] = ukmod_df[\n",
    "    [\n",
    "        \"Child and Working Tax Credits\",\n",
    "        \"Housing Benefit\",\n",
    "        \"Income Support\",\n",
    "        \"ESA (income-based)\",\n",
    "    ]\n",
    "].sum(axis=1)\n",
    "ukmod_df[\"Main benefits\"] = ukmod_df[\n",
    "    [\n",
    "        \"Universal Credit\",\n",
    "        \"Child Benefit\",\n",
    "        \"Legacy benefits\",\n",
    "        \"Pension Credit\",\n",
    "        \"Personal Independence Payment\",\n",
    "        \"Disability Living Allowance\",\n",
    "        \"Attendance Allowance\",\n",
    "        \"Carers Allowance\",\n",
    "        \"New/basic State Pension\",\n",
    "        \"Second State Pension\",\n",
    "    ]\n",
    "].sum(axis=1)\n",
    "\n",
    "ukmod_df = pd.melt(ukmod_df, id_vars=[\"Year\"], value_vars=ukmod_df.columns[1:])\n",
    "ukmod_df = ukmod_df.rename(columns={\"variable\": \"Variable\", \"value\": \"Value\"})\n",
    "ukmod_df.Value = ukmod_df.Value / 1e3\n",
    "\n",
    "obr_df = pd.DataFrame(\n",
    "    {\n",
    "        \"Year\": [2022, 2023, 2024, 2025, 2026, 2027],\n",
    "        \"Income Tax\": [250.5, 279.2, 302.7, 315.8, 331.4, 348.7],\n",
    "        \"National Insurance\": [179.2, 168.1, 173.6, 179.8, 186.1, 192.1],\n",
    "        \"Child Benefit\": [12.5, 13.5, 13.5, 13.5, 13.5, 13.5],\n",
    "        \"Personal Tax Credits\": [7.3, 1.6, -0.1, -0.1, -0.1, -0.1],\n",
    "        \"Housing Benefit (within cap)\": [14.8, 13.8, 11.9, 11.9, 11.6, 10.7],\n",
    "        \"Housing Benefit (outside cap)\": [0.1, 0.0, 0.0, 0.0, 0.0, 0.0],\n",
    "        \"Universal Credit (within cap)\": [40.7, 49.5, 55.0, 57.9, 60.8, 63.7],\n",
    "        \"Universal Credit (outside cap)\": [11.1, 17.4, 19.3, 19.7, 20.0, 20.1],\n",
    "        \"DLA and PIP\": [28.4, 32.7, 35.3, 38.0, 40.9, 43.4],\n",
    "        \"Attendance Allowance\": [6.7, 7.7, 8.0, 8.2, 8.4, 8.6],\n",
    "        \"Pension Credit\": [5.4, 5.8, 5.9, 5.7, 5.4, 5.1],\n",
    "        \"State Pension\": [124.6, 138.1, 146.0, 150.5, 153.2, 155.1],\n",
    "        \"Fuel duties\": [25.1, 24.6, 24.7, 27.3, 27.6, 28.0],\n",
    "        \"VAT\": [159.7, 169.6, 173.9, 180.3, 188.0, 195.9],\n",
    "        \"Council Tax\": [44.0, 46.3, 48.6, 51.2, 53.9, 56.8],\n",
    "    }\n",
    ")\n",
    "\n",
    "obr_df[\"Universal Credit\"] = obr_df[\n",
    "    [\"Universal Credit (within cap)\", \"Universal Credit (outside cap)\"]\n",
    "].sum(axis=1)\n",
    "obr_df[\"Housing Benefit\"] = obr_df[\n",
    "    [\"Housing Benefit (within cap)\", \"Housing Benefit (outside cap)\"]\n",
    "].sum(axis=1)\n",
    "obr_df[\"Main taxes\"] = obr_df[[\"Income Tax\", \"National Insurance\"]].sum(axis=1)\n",
    "obr_df[\"Legacy benefits\"] = obr_df[\n",
    "    [\n",
    "        \"Personal Tax Credits\",\n",
    "        \"Housing Benefit (within cap)\",\n",
    "        \"Housing Benefit (outside cap)\",\n",
    "    ]\n",
    "].sum(axis=1)\n",
    "obr_df[\"Main benefits\"] = obr_df[\n",
    "    [\n",
    "        \"Universal Credit (within cap)\",\n",
    "        \"Universal Credit (outside cap)\",\n",
    "        \"Child Benefit\",\n",
    "        \"DLA and PIP\",\n",
    "        \"Attendance Allowance\",\n",
    "        \"Pension Credit\",\n",
    "        \"State Pension\",\n",
    "    ]\n",
    "].sum(axis=1)\n",
    "\n",
    "obr_df = pd.melt(obr_df, id_vars=[\"Year\"], value_vars=obr_df.columns[1:])\n",
    "obr_df = obr_df.rename(columns={\"variable\": \"Variable\", \"value\": \"Value\"})\n",
    "\n",
    "pe_df[\"Source\"] = \"PolicyEngine\"\n",
    "ukmod_df[\"Source\"] = \"UKMOD\"\n",
    "obr_df[\"Source\"] = \"OBR\"\n",
    "df = pd.concat([pe_df, ukmod_df, obr_df])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import plotly.express as px\n",
    "from policyengine_core.charts import *\n",
    "from plotly.express.colors import sample_colorscale\n",
    "import numpy as np\n",
    "\n",
    "# RF-style 'rainbow' chart.\n",
    "\n",
    "# Compute average income in each decile for each year\n",
    "\n",
    "\n",
    "def rainbow_chart(variable: str):\n",
    "    dist_net_income_df = pd.DataFrame()\n",
    "\n",
    "    for year in range(2021, 2028):\n",
    "        sim = Microsimulation()\n",
    "        net_income = sim.calculate(variable, year) * sim.calculate(\n",
    "            \"inflation_adjustment\", year\n",
    "        )\n",
    "        decile = sim.calculate(\"household_income_decile\", year)\n",
    "        avg_by_decile = net_income.groupby(decile).mean()\n",
    "        avg_by_decile = avg_by_decile.reset_index()\n",
    "        avg_by_decile[\"Year\"] = year\n",
    "        dist_net_income_df = pd.concat([dist_net_income_df, avg_by_decile])\n",
    "\n",
    "    dist_net_income_df = dist_net_income_df[dist_net_income_df.index > 0]\n",
    "    dist_net_income_df.columns = [\"Decile\", \"Value\", \"Year\"]\n",
    "\n",
    "    dist_net_income_df_forward_shifted = dist_net_income_df.copy()\n",
    "    dist_net_income_df_forward_shifted.Year += 1\n",
    "    dist_net_income_change_df = (\n",
    "        dist_net_income_df.set_index([\"Decile\", \"Year\"])\n",
    "        / dist_net_income_df_forward_shifted.set_index([\"Decile\", \"Year\"])\n",
    "        - 1\n",
    "    ).reset_index()\n",
    "    dist_net_income_change_df = dist_net_income_change_df.dropna()\n",
    "    dist_net_income_change_df.Decile = dist_net_income_change_df.Decile.astype(\n",
    "        str\n",
    "    )\n",
    "    x = np.linspace(0.1, 0.9, 10)\n",
    "    c = sample_colorscale(\"balance\", list(x))\n",
    "\n",
    "    fig = px.bar(\n",
    "        dist_net_income_change_df,\n",
    "        x=\"Year\",\n",
    "        y=\"Value\",\n",
    "        color=\"Decile\",\n",
    "        barmode=\"group\",\n",
    "        color_discrete_map={str(i): c[i - 1] for i in range(1, 11)},\n",
    "    )\n",
    "\n",
    "    return format_fig(fig).update_layout(\n",
    "        title=\"Figure 1: annual year-on-year change in real household net income forecast by decile\",\n",
    "        height=400,\n",
    "        yaxis_tickformat=\"+.0%\",\n",
    "        yaxis_range=[-0.1, 0.1],\n",
    "        yaxis_title=\"Relative year-on-year change\",\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=1<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "1",
         "marker": {
          "color": "rgb(38, 62, 148)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "1",
         "offsetgroup": "1",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.06098550302574912,
          -0.024777739988302017,
          -0.06919046377067062,
          0.02568336434674312,
          -0.034802688160677775,
          -0.024373664670781947
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=2<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "2",
         "marker": {
          "color": "rgb(16, 105, 189)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "2",
         "offsetgroup": "2",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.01604705517785776,
          -0.044150857440637736,
          -0.04928612532101795,
          0.011212540159080353,
          -0.005984095325190175,
          -0.011708984889061136
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=3<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "3",
         "marker": {
          "color": "rgb(73, 146, 186)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "3",
         "offsetgroup": "3",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.023927406540540375,
          -0.02588969963203125,
          -0.05766072876991135,
          0.019617924796277553,
          -0.003459407854223051,
          -0.00919984699556009
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=4<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "4",
         "marker": {
          "color": "rgb(144, 182, 195)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "4",
         "offsetgroup": "4",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          -0.019351008351608856,
          -0.018928234520711684,
          -0.04400594501352828,
          0.010420792542917168,
          -0.006890706292805637,
          -0.01543495328029909
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=5<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "5",
         "marker": {
          "color": "rgb(210, 216, 219)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "5",
         "offsetgroup": "5",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.008041644903471257,
          -0.01635818299901548,
          -0.026779281687234424,
          -0.0011183785639852228,
          -0.021142575618871895,
          -0.01776586554249282
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=6<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "6",
         "marker": {
          "color": "rgb(230, 210, 204)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "6",
         "offsetgroup": "6",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.053361422154542204,
          -0.05195141967140937,
          -0.008388390670859835,
          0.0014066026592536307,
          -0.012417506245419596,
          -0.009155019914818485
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=7<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "7",
         "marker": {
          "color": "rgb(214, 159, 139)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "7",
         "offsetgroup": "7",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.06885705752116045,
          -0.0730764604461368,
          0.007512420668321695,
          0.0056511371291085855,
          0.0023882315861369907,
          -0.009976150495451863
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=8<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "8",
         "marker": {
          "color": "rgb(197, 104, 76)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "8",
         "offsetgroup": "8",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.06363717711829153,
          -0.039491342890727976,
          0.012743846908935375,
          0.004380777926949575,
          0.00462299597657867,
          -0.001350515752682968
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=9<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "9",
         "marker": {
          "color": "rgb(174, 48, 39)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "9",
         "offsetgroup": "9",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.03390593979175516,
          -6.199970403297783e-05,
          0.003100317550160714,
          0.009654179412011077,
          -0.0010631178772319005,
          0.006137202431111488
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Decile=10<br>Year=%{x}<br>Value=%{y}<extra></extra>",
         "legendgroup": "10",
         "marker": {
          "color": "rgb(125, 17, 40)",
          "pattern": {
           "shape": ""
          }
         },
         "name": "10",
         "offsetgroup": "10",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.051711122865027326,
          -0.022260216445154524,
          0.011172574332359186,
          0.010072355896902474,
          0.03511376610909589,
          0.0028147473179358506
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "barmode": "group",
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 400,
        "images": [
         {
          "sizex": 0.15,
          "sizey": 0.15,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1.1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Decile"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Figure 1: annual year-on-year change in real household net income forecast by decile"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Year"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "range": [
          -0.1,
          0.1
         ],
         "tickformat": "+.0%",
         "title": {
          "text": "Relative year-on-year change"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "rainbow_chart(\"household_net_income\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Figure 1 shows PolicyEngine's principal forecast for (real) household disposable incomes, up to and including calendar year 2027. In 2025, we project average relative increases in real disposable income for most income deciles, of between 0 and 3%. In 2026 and 2027, net income falls for most deciles, except for the top four.\n",
    "\n",
    "All income measures in this report are before housing costs."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "def poverty_rate_chart_df():\n",
    "    pov_df = pd.DataFrame()\n",
    "    for year in range(2022, 2028):\n",
    "        sim = Microsimulation()\n",
    "        in_poverty = sim.calculate(\"in_poverty\", map_to=\"person\", period=year)\n",
    "        child_poverty = in_poverty[sim.calculate(\"is_child\")].mean()\n",
    "        wa_poverty = in_poverty[sim.calculate(\"is_WA_adult\")].mean()\n",
    "        senior_poverty = in_poverty[sim.calculate(\"is_SP_age\")].mean()\n",
    "        all_poverty = in_poverty.mean()\n",
    "        pov_df = pd.concat(\n",
    "            [\n",
    "                pov_df,\n",
    "                pd.DataFrame(\n",
    "                    {\n",
    "                        \"Year\": [year],\n",
    "                        \"Children\": [child_poverty],\n",
    "                        \"Working-age adults\": [wa_poverty],\n",
    "                        \"Seniors\": [senior_poverty],\n",
    "                        \"All\": [all_poverty],\n",
    "                    }\n",
    "                ),\n",
    "            ]\n",
    "        )\n",
    "\n",
    "    return pov_df\n",
    "\n",
    "\n",
    "pov_df = poverty_rate_chart_df()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "hovertemplate": "variable=All<br>Year=%{x}<br>value=%{y}<extra></extra>",
         "legendgroup": "All",
         "line": {
          "color": "#4C78A8",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "markers+lines",
         "name": "All",
         "orientation": "v",
         "showlegend": true,
         "type": "scatter",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.14915348845705703,
          0.15255748691590837,
          0.17178459441404054,
          0.16456900659431725,
          0.17376096837592594,
          0.1839555876431336
         ],
         "yaxis": "y"
        },
        {
         "hovertemplate": "variable=Children<br>Year=%{x}<br>value=%{y}<extra></extra>",
         "legendgroup": "Children",
         "line": {
          "color": "#F58518",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "markers+lines",
         "name": "Children",
         "orientation": "v",
         "showlegend": true,
         "type": "scatter",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.27281412587719256,
          0.3039218034607991,
          0.31191894762846734,
          0.2910883325456953,
          0.29423284133503347,
          0.31178026278011817
         ],
         "yaxis": "y"
        },
        {
         "hovertemplate": "variable=Working-age adults<br>Year=%{x}<br>value=%{y}<extra></extra>",
         "legendgroup": "Working-age adults",
         "line": {
          "color": "#E45756",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "markers+lines",
         "name": "Working-age adults",
         "orientation": "v",
         "showlegend": true,
         "type": "scatter",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.10929488945587383,
          0.11802532720613122,
          0.13606327885571504,
          0.1283247688889464,
          0.13584665237975,
          0.1416472090065762
         ],
         "yaxis": "y"
        },
        {
         "hovertemplate": "variable=Seniors<br>Year=%{x}<br>value=%{y}<extra></extra>",
         "legendgroup": "Seniors",
         "line": {
          "color": "#72B7B2",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "markers+lines",
         "name": "Seniors",
         "orientation": "v",
         "showlegend": true,
         "type": "scatter",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.12418169874974387,
          0.07091406830812352,
          0.1138586834299001,
          0.12944351080881158,
          0.1584197776217525,
          0.17507432232385708
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.15,
          "sizey": 0.15,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1.1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Age group"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Figure 2: absolute poverty forecast by age group"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Year"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "range": [
          0,
          0.4
         ],
         "tickformat": ".0%",
         "title": {
          "text": "Percentage"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig = px.line(\n",
    "    pov_df,\n",
    "    x=\"Year\",\n",
    "    y=[\"All\", \"Children\", \"Working-age adults\", \"Seniors\"],\n",
    "    color_discrete_sequence=px.colors.qualitative.T10,\n",
    ")\n",
    "\n",
    "fig = format_fig(fig).update_layout(\n",
    "    yaxis_range=[0, 0.4],\n",
    "    yaxis_tickformat=\".0%\",\n",
    "    title=\"Figure 2: absolute poverty forecast by age group\",\n",
    "    legend_title=\"Age group\",\n",
    "    yaxis_title=\"Percentage\",\n",
    ")\n",
    "# Add squares to each point\n",
    "\n",
    "fig.update_traces(mode=\"markers+lines\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Figure 2 shows the forecast for poverty rates (absolute, before housing costs): increases for all major age groups. With the exception of a reduction in pensioner poverty in 2023 (largely due to benefit increases), we forecast increases in absolute poverty rates for all age groups until at least 2027.\n",
    "\n",
    "The [latest](https://www.gov.uk/government/statistics/households-below-average-income-for-financial-years-ending-1995-to-2023/households-below-average-income-an-analysis-of-the-uk-income-distribution-fye-1995-to-fye-2023) official absolute poverty rates from the government's Households Below Average Income series (which is for FY2022-23) differs slightly from our 2022 estimates (see Appendix A for a comparison and explanation of senior poverty rate trend differences):\n",
    "\n",
    "| Age group         | HBAI (%) | PolicyEngine (%) | Difference |\n",
    "|--------------------|------|--------------|--|\n",
    "| Children           | 22   | 27           |+5|\n",
    "| Working-age adults | 15   | 11           |-4|\n",
    "| Seniors            | 19   | 12           |-5|\n",
    "| All                | 17   | 15           |-2|\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "PolicyEngine replicates official forecasts closely, largely due to both calibrating some outputs directly to be consistent (making many of these comparisons - all but VAT and fuel duty - _ex post_), and replicating the use of the OBR's economic determinant forecasts. The next sections evaluate PolicyEngine's model forecasts against OBR forecasts for key programs. We also compare against UKMOD, developed at the University of Essex, using their latest (March 2024) [country report](https://www.iser.essex.ac.uk/research/publications/working-papers/cempa/cempa4-24) as reference.\n",
    "\n",
    "PolicyEngine’s calibration routine (specified in more detail in our [working paper](https://legacy.policyengine.org/uk_data_enhancement.pdf)) calibrates the underlying household survey data weights to reduce inconsistency between the Family Resources Survey and other, more accurate government statistics on taxes and benefits. We use optimisation techniques [like the DWP does](https://assets.publishing.service.gov.uk/media/5a7dddcc40f0b65d88634e32/initial-review-family-resources-survey-weighting-scheme.pdf) in generating the initial FRS household weights, but we include statistics on tax revenues and benefit expenditures as well as demographics instead of excluding them. We also include imputations from other surveys on income and expenditure as part of this process. For a comparison to UKMOD’s approach, see Appendix B.\n",
    "\n",
    "### Income Tax\n",
    "\n",
    "PolicyEngine matches Income Tax revenue within 1% in 2024, with this accuracy falling to within 3% in 2027 as we project receipts to grow more slowly than the OBR."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 | 250.5 |          250.2 |   245.8 |                     -0.1 |              -1.9 |\n",
       "|   2023 | 279.2 |          279.4 |   303   |                      0.1 |               8.5 |\n",
       "|   2024 | 302.7 |          299.8 |   364.3 |                     -1   |              20.4 |\n",
       "|   2025 | 315.8 |          310.1 |   372.2 |                     -1.8 |              17.9 |\n",
       "|   2026 | 331.4 |          324.2 |   383.9 |                     -2.2 |              15.8 |\n",
       "|   2027 | 348.7 |          339.3 |   398.2 |                     -2.7 |              14.2 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from IPython.display import Markdown\n",
    "\n",
    "\n",
    "def variable_table(variable):\n",
    "    table = df[df.Variable.isin([variable]) & (df.Year > 2021)].pivot_table(\n",
    "        index=\"Year\", columns=[\"Source\"], values=\"Value\"\n",
    "    )\n",
    "    table[\"PolicyEngine / OBR (%)\"] = (\n",
    "        table.PolicyEngine / table.OBR - 1\n",
    "    ).apply(lambda x: f\"{x * 100:+.1f}\")\n",
    "    if \"UKMOD\" in table.columns:\n",
    "        table.UKMOD = table.UKMOD.apply(lambda x: round(x, 1))\n",
    "        table[\"UKMOD / OBR (%)\"] = (table.UKMOD / table.OBR - 1).apply(\n",
    "            lambda x: f\"{x * 100:+.1f}\"\n",
    "        )\n",
    "    return Markdown(table.to_markdown())\n",
    "\n",
    "\n",
    "variable_table(\"Income Tax\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### National Insurance\n",
    "\n",
    "PolicyEngine underestimates total National Insurance receipts by around 6% in 2024, rising to 8% in 2027."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 | 179.2 |          165.7 |   178.1 |                     -7.5 |              -0.6 |\n",
       "|   2023 | 168.1 |          164.7 |   176.4 |                     -2   |               4.9 |\n",
       "|   2024 | 173.6 |          163.8 |   174.2 |                     -5.6 |               0.3 |\n",
       "|   2025 | 179.8 |          166.8 |   177.3 |                     -7.2 |              -1.4 |\n",
       "|   2026 | 186.1 |          171.5 |   182.5 |                     -7.8 |              -1.9 |\n",
       "|   2027 | 192.1 |          176.5 |   189   |                     -8.1 |              -1.6 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"National Insurance\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### VAT\n",
    "\n",
    "PolicyEngine and the OBR match closely despite PolicyEngine not explicitly calibrating to VAT receipts. The difference is less than 1% in 2024 and 2025, and 2% in 2027 (UKMOD does not model VAT so is unavailable for comparison)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   PolicyEngine / OBR (%) |\n",
       "|-------:|------:|---------------:|-------------------------:|\n",
       "|   2022 | 159.7 |          156   |                     -2.3 |\n",
       "|   2023 | 169.6 |          165.7 |                     -2.3 |\n",
       "|   2024 | 173.9 |          175.6 |                      1   |\n",
       "|   2025 | 180.3 |          181.2 |                      0.5 |\n",
       "|   2026 | 188   |          186.7 |                     -0.7 |\n",
       "|   2027 | 195.9 |          193.2 |                     -1.4 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"VAT\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Council Tax\n",
    "\n",
    "We match Council Tax receipts closely (as does UKMOD)- Council Tax is imputed but relying on reported values by region (rather than simulated across local authorities), and all three models use the same OBR uprating forecasts to increase year-by-year."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 |  44   |           42   |    45.6 |                     -4.5 |               3.6 |\n",
       "|   2023 |  46.3 |           45.2 |    48   |                     -2.4 |               3.7 |\n",
       "|   2024 |  48.6 |           47.9 |    50.1 |                     -1.4 |               3.1 |\n",
       "|   2025 |  51.2 |           50.4 |    52.2 |                     -1.6 |               2   |\n",
       "|   2026 |  53.9 |           53.3 |    54.3 |                     -1.1 |               0.7 |\n",
       "|   2027 |  56.8 |           55.9 |    56.6 |                     -1.6 |              -0.4 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"Council Tax\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Fuel duty\n",
    "\n",
    "Fuel duty is matched by around 10% on average, but is more volatile in PolicyEngine's model than the OBR forecast (UKMOD does not model fuel duty so cannot be used for comparison).\n",
    "\n",
    "The deviation is likely caused by the fact that the OBR accounts for the impact of car electrification on revenues, unlike PolicyEngine which does not.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   PolicyEngine / OBR (%) |\n",
       "|-------:|------:|---------------:|-------------------------:|\n",
       "|   2022 |  25.1 |           24.1 |                     -4   |\n",
       "|   2023 |  24.6 |           23.5 |                     -4.5 |\n",
       "|   2024 |  24.7 |           28   |                     13.4 |\n",
       "|   2025 |  27.3 |           29.5 |                      8.1 |\n",
       "|   2026 |  27.6 |           30.9 |                     12   |\n",
       "|   2027 |  28   |           33.3 |                     18.9 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"Fuel duties\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Universal Credit\n",
    "\n",
    "PolicyEngine's Universal Credit forecast is around 4% higher in 2024 than the OBR's, rising to 7.5% in 2027. This likely reflects uncertainty over the rollout of Universal Credit from legacy benefits."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 |  51.8 |           57.6 |    40.9 |                     11.2 |             -21   |\n",
       "|   2023 |  66.9 |           68.7 |    47.8 |                      2.7 |             -28.6 |\n",
       "|   2024 |  74.3 |           77.6 |    59.3 |                      4.4 |             -20.2 |\n",
       "|   2025 |  77.6 |           83   |    69.9 |                      7   |              -9.9 |\n",
       "|   2026 |  80.8 |           87.2 |    70.3 |                      7.9 |             -13   |\n",
       "|   2027 |  83.8 |           90.1 |    70.5 |                      7.5 |             -15.9 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"Universal Credit\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Legacy benefits\n",
    "\n",
    "We match the OBR's forecasts for legacy benefit spending by around 7% on average."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 |  22.2 |           24.2 |    21.5 |                      9   |              -3.2 |\n",
       "|   2023 |  15.4 |           17.2 |    19.7 |                     11.7 |              27.9 |\n",
       "|   2024 |  11.8 |           13.4 |    13.2 |                     13.6 |              11.9 |\n",
       "|   2025 |  11.8 |           11.9 |     5.1 |                      0.8 |             -56.8 |\n",
       "|   2026 |  11.5 |           12.3 |     5.1 |                      7   |             -55.7 |\n",
       "|   2027 |  10.6 |           11.7 |     5.2 |                     10.4 |             -50.9 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"Legacy benefits\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Child Benefit\n",
    "\n",
    "We match Child Benefit spending by around 10% on average."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 |  12.5 |           12.6 |    11.2 |                      0.8 |             -10.4 |\n",
       "|   2023 |  13.5 |           14.4 |    11.8 |                      6.7 |             -12.6 |\n",
       "|   2024 |  13.5 |           15   |    12.4 |                     11.1 |              -8.1 |\n",
       "|   2025 |  13.5 |           15   |    12.7 |                     11.1 |              -5.9 |\n",
       "|   2026 |  13.5 |           14.9 |    12.7 |                     10.4 |              -5.9 |\n",
       "|   2027 |  13.5 |           15   |    12.7 |                     11.1 |              -5.9 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"Child Benefit\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Pension Credit\n",
    "\n",
    "Pension Credit sees the most divergence between PolicyEngine and the OBR of all simulated programs: £3bn on average, which represents aroud 40% of the size of the OBR forecast. UKMOD also shows differences up to 40% (but lower overall). Given that Pension Credit affects the pensioners with extremely low incomes (whose data in the FRS is less reliable), this is an area for further investigation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   UKMOD |   PolicyEngine / OBR (%) |   UKMOD / OBR (%) |\n",
       "|-------:|------:|---------------:|--------:|-------------------------:|------------------:|\n",
       "|   2022 |   5.4 |            9.3 |     4.7 |                     72.2 |             -13   |\n",
       "|   2023 |   5.8 |            5.2 |     5.3 |                    -10.3 |              -8.6 |\n",
       "|   2024 |   5.9 |            2.9 |     6.5 |                    -50.8 |              10.2 |\n",
       "|   2025 |   5.7 |            3.1 |     6.7 |                    -45.6 |              17.5 |\n",
       "|   2026 |   5.4 |            3.6 |     6.8 |                    -33.3 |              25.9 |\n",
       "|   2027 |   5.1 |            4.2 |     7   |                    -17.6 |              37.3 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"Pension Credit\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### State Pension\n",
    "\n",
    "In 2024, we match the OBR on State Pension forecast within 7%, though this narrows to within 2% in 2026 and 2027."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "|   Year |   OBR |   PolicyEngine |   PolicyEngine / OBR (%) |\n",
       "|-------:|------:|---------------:|-------------------------:|\n",
       "|   2022 | 124.6 |          125.1 |                      0.4 |\n",
       "|   2023 | 138.1 |          148.2 |                      7.3 |\n",
       "|   2024 | 146   |          155.9 |                      6.8 |\n",
       "|   2025 | 150.5 |          157.5 |                      4.7 |\n",
       "|   2026 | 153.2 |          155.9 |                      1.8 |\n",
       "|   2027 | 155.1 |          153.5 |                     -1   |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "variable_table(\"State Pension\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Appendix: senior poverty rates\n",
    "\n",
    "We project a significantly lower senior poverty estimate for 2023 than HBAI largely because of our modelling of the Energy Price Guarantee. We modelled this as an increase to incomes, rather than a decrease in consumption. Figure 3 shows the senior poverty rate with and without this intervention."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "from policyengine_core.reforms import Reform\n",
    "\n",
    "no_epg_subsidy = Reform.from_dict(\n",
    "    {\n",
    "        \"gov.ofgem.energy_price_guarantee\": {\n",
    "            \"year:2020:10\": 1_000_000,\n",
    "        }\n",
    "    },\n",
    "    country_id=\"uk\",\n",
    ")\n",
    "\n",
    "\n",
    "def poverty_rate_chart_df():\n",
    "    pov_df = pd.DataFrame()\n",
    "    for year in range(2022, 2028):\n",
    "        baseline = Microsimulation()\n",
    "        sim = Microsimulation(reform=no_epg_subsidy)\n",
    "        in_poverty_b = baseline.calculate(\n",
    "            \"in_poverty\", map_to=\"person\", period=year\n",
    "        )\n",
    "        senior_poverty_b = in_poverty_b[baseline.calculate(\"is_SP_age\")].mean()\n",
    "        in_poverty_no_epg = sim.calculate(\n",
    "            \"in_poverty\", map_to=\"person\", period=year\n",
    "        )\n",
    "        senior_poverty_no_epg = in_poverty_no_epg[\n",
    "            sim.calculate(\"is_SP_age\")\n",
    "        ].mean()\n",
    "        pov_df = pd.concat(\n",
    "            [\n",
    "                pov_df,\n",
    "                pd.DataFrame(\n",
    "                    {\n",
    "                        \"Year\": [year],\n",
    "                        \"Baseline\": [senior_poverty_b],\n",
    "                        \"No EPG subsidy\": [senior_poverty_no_epg],\n",
    "                    }\n",
    "                ),\n",
    "            ]\n",
    "        )\n",
    "\n",
    "    return pov_df\n",
    "\n",
    "\n",
    "pov_df = poverty_rate_chart_df()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "hovertemplate": "variable=Baseline<br>Year=%{x}<br>value=%{y}<extra></extra>",
         "legendgroup": "Baseline",
         "line": {
          "color": "#72B7B2",
          "dash": "solid"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "markers+lines",
         "name": "Baseline",
         "orientation": "v",
         "showlegend": true,
         "type": "scatter",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.12418169874974387,
          0.07091406830812352,
          0.1138586834299001,
          0.12944351080881158,
          0.1584197776217525,
          0.17507432232385708
         ],
         "yaxis": "y"
        },
        {
         "hovertemplate": "variable=No EPG subsidy<br>Year=%{x}<br>value=%{y}<extra></extra>",
         "legendgroup": "No EPG subsidy",
         "line": {
          "color": "#72B7B2",
          "dash": "dash"
         },
         "marker": {
          "symbol": "circle"
         },
         "mode": "markers+lines",
         "name": "No EPG subsidy",
         "orientation": "v",
         "showlegend": true,
         "type": "scatter",
         "x": [
          2022,
          2023,
          2024,
          2025,
          2026,
          2027
         ],
         "xaxis": "x",
         "y": [
          0.12876935776938392,
          0.09515916239260568,
          0.1138586834299001,
          0.12944351080881158,
          0.1584197776217525,
          0.17507432232385708
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.15,
          "sizey": 0.15,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1.1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Policy"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Figure 3: senior absolute poverty forecast under alternative policy scenarios"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Year"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "range": [
          0,
          0.4
         ],
         "tickformat": ".0%",
         "title": {
          "text": "Percentage"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig = px.line(\n",
    "    pov_df,\n",
    "    x=\"Year\",\n",
    "    y=[\"Baseline\", \"No EPG subsidy\"],\n",
    "    color_discrete_sequence=[px.colors.qualitative.T10[3]] * 2,\n",
    ")\n",
    "\n",
    "fig = format_fig(fig).update_layout(\n",
    "    yaxis_range=[0, 0.4],\n",
    "    yaxis_tickformat=\".0%\",\n",
    "    title=\"Figure 3: senior absolute poverty forecast under alternative policy scenarios\",\n",
    "    legend_title=\"Policy\",\n",
    "    yaxis_title=\"Percentage\",\n",
    ")\n",
    "# Add squares to each point\n",
    "\n",
    "fig.update_traces(mode=\"markers+lines\")\n",
    "\n",
    "# Make the second line dashed\n",
    "\n",
    "fig.data[1].line.dash = \"dash\"\n",
    "\n",
    "fig"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Appendix B: modelling assumptions\n",
    "\n",
    "Both PolicyEngine and UKMOD face choices in how much to calibrate their models to administrative aggregates. These choices can involve inheriting calibration from the Department for Work and Pensions' (DWP) microdata calibration, applying uprating factors, and determining benefit take-up rates.\n",
    "\n",
    "PolicyEngine has opted for a broader-scale calibration approach. We use optimisation techniques similar to those employed by the DWP when generating the initial Family Resources Survey (FRS) household weights. However, while the DWP primarily focuses on calibrating to demographic totals, PolicyEngine also includes statistics on tax revenues and benefit expenditures in the calibration process. Furthermore, we incorporate imputations from other surveys on income and expenditure to refine the microdata.\n",
    "\n",
    "In contrast, UKMOD relies on the original FRS weights calibrated by the DWP to demographic totals, and limits adjustments to applying uprating factors and policy-related mechanical changes, such as transitioning households from legacy benefits to Universal Credit, adjusting unemployment status, and modelling benefit take-up rates.\n",
    "\n",
    "While both approaches have their merits, we believe that microsimulation models should, at a minimum, strive to replicate the reported administrative totals for years where this information is known. PolicyEngine's more extensive calibration process aims to achieve this goal and improve the model's accuracy in estimating the impacts of policy reforms on UK households.\n",
    "\n",
    "It is important to acknowledge that the level of confidence in projections may decrease for future years due to inherent uncertainties. However, calibrating the model to match known administrative data ensures a solid foundation for estimating policy reform impacts. Furthermore, we believe OBR projections are the best sources available for calibrating microdata in future years.\n",
    "\n",
    "We recognise that the choice of calibration approach can influence comparisons between different microsimulation models. By providing transparency about our modelling assumptions and calibration methods, we hope to facilitate a better understanding of the similarities and differences between PolicyEngine and other models, such as UKMOD.\n",
    "\n",
    "As we continue to develop and refine our model, we remain committed to striking a balance between model accuracy and transparency, while acknowledging the uncertainties associated with future projections."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# The Triple Lock Plus
Slug: uk-triple-lock-plus
Date: 2024-05-28 09:00:00
Authors: Nikhil Woodruff
Tags: uk, policy
Description: PolicyEngine estimates the impact of the UK government's proposed pension uprating policy reform.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[*See the full impact score here*](/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&baseline=1&timePeriod=2027&region=uk)\n",
    "\n",
    "Yesterday the Conservative Party proposed a new policy called the \"Triple Lock Plus\" which would prevent pensioners from paying income tax on their state pension. The policy would automatically raise the personal allowance (tax-free threshold) for pensioners each year starting from 2025, ensuring it stays ahead of the state pension amount by indexing with the ‘triple lock’ uprating index. This report analyses the potential costs, distributional impacts, and effects on poverty of the proposal.\n",
    "\n",
    "## Background\n",
    "\n",
    "Currently, the state pension in the UK is protected by the \"triple lock\". This policy dictates that the state pension increases each year by the highest of three measures: average earnings growth, price inflation (CPI), or 2.5%. Under current policy, pensioners may be liable to pay income tax on their state pension in future years if it exceeds the personal allowance, which is currently frozen until 2028.\n",
    "\n",
    "Under the proposed Triple Lock Plus, starting from the 2025/26 tax year, the personal allowance (PA) for pensioners would be automatically raised each year to ensure it remains higher than their state pension.\n",
    "\n",
    "| Year     | New pensioner PA | Current PA |\n",
    "|----------|----------------------|-------------------------|\n",
    "| 2025/26  | £13,040              | £12,570                 |\n",
    "| 2026/27  | £13,370              | £12,570                 |\n",
    "| 2027/28  | £13,710              | £12,570                 |\n",
    "| 2028/29  | £14,060              | £12,820                 |\n",
    "| 2029/30  | £14,450              | £13,080                 |\n",
    "\n",
    "As shown in the table, the pensioner personal allowance is projected to rise from £13,040 in 2025/26 to £14,450 by 2029/30, while the general personal allowance is expected to remain frozen until 2028/29.\n",
    "\n",
    "## Economic impacts\n",
    "\n",
    "PolicyEngine estimates the increasing cost of implementing the Triple Lock Plus through 2025-27:\n",
    "\n",
    "| Year | Cost estimate (£bn) |\n",
    "|------|----------------------|\n",
    "| 2025 | 0.6                  |\n",
    "| 2026 | 1.0                  |\n",
    "| 2027 | 1.3                  |\n",
    "\n",
    "The policy primarily benefits households in the lower and middle income deciles, but middle and higher wealth deciles.\n",
    "\n",
    "![Impact on income deciles](/images/posts/uk-triple-lock-plus/decile_impact.png)\n",
    "\n",
    "PolicyEngine estimates that 12% of the population would benefit (around 8m pensioners).\n",
    "\n",
    "![Percent gaining by income decile](/images/posts/uk-triple-lock-plus/intra_decile_impact.png)\n",
    "\n",
    "The Triple Lock Plus is estimated to reduce the overall poverty rate by 0.4% (0.1pp) in 2027, with pensioners experiencing the most significant decrease of 2.7 percentage points. The policy has little to no impact on poverty rates among working-age adults and children.\n",
    "\n",
    "![Poverty rate change by age group](/images/posts/uk-triple-lock-plus/poverty_impact.png)\n",
    "\n",
    "## Household impacts\n",
    "\n",
    "For a 70-year-old single pensioner receiving the New State Pension in 2027, the Triple Lock Plus would decrease their annual income tax bill by around £230 if they are a basic rate taxpayer, and around £450 if they pay the higher or additional rates.\n",
    "\n",
    "![Gain by income](/images/posts/uk-triple-lock-plus/earnings.png)\n",
    "\n",
    "## Conclusion\n",
    "\n",
    "The proposed Triple Lock Plus policy achieves the stated policy aim of preventing pensioners from paying Income Tax by virtue of their State Pension alone, with a rising per-year cost reaching £1.3 billion by 2027. Its impact on overall poverty rates and working-age households is limited, with a reduction of only 0.1 percentage points for all groups combined. In 2027, this policy essentially behaves as a transfer of £230 per year to basic rate pensioners, and £450 per year to higher and additional rate pensioners.\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Test' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m/var/folders/8f/pgfhysmd5ls3jnxb_5j7yy340000gn/T/ipykernel_84864/579046729.py\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mTest\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'Test' is not defined"
     ]
    }
   ],
   "source": [
    "Test"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# The Liberal Democrat Manifesto
Slug: lib-dem-2024-manifesto
Date: 2024-06-11 16:30:00
Authors: Nikhil Woodruff
Tags: uk, policy
Description: PolicyEngine's comprehensive impact score.

---

_Distributional impact of the Liberal Democrat 2024 Manifesto. See the full impact score [here](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57826&region=uk&timePeriod=2028&baseline=1)._

## Key findings

1. The Liberal Democrats propose a budget-neutral plan with equal spending and revenue increases of £26.8bn.

2. Welfare reforms include increasing Carer's Allowance, removing the two-child limit and benefit cap on Universal Credit. PolicyEngine estimates these reforms would cost £5.5bn.

3. Tax reforms focus on Capital Gains Tax, taxes on corporations, and consumption taxes, raising an estimated £26.5bn.

4. PolicyEngine estimates that the manifesto would lower absolute poverty by 20%, raise net income for 70% of people, and be progressive along income lines.

5. The lowest income decile would see a 9% increase in disposable income, while the highest decile would see a 2% loss.

6. Child poverty would be reduced by a quarter, lifting 1.3m children out of poverty. Overall, 2.4m people would be lifted out of poverty, and income inequality would decrease by over 3% according to the Gini index.

Yesterday the Liberal Democrats [launched](https://www.bbc.co.uk/news/articles/crgg9l8z4lpo) their manifesto, detailing key reform pledges across taxes, welfare and public spending. The party committed to equal spending and revenue increases of £26.8bn (budget neutral overall), with prominence given to healthcare, international aid and welfare, as well as capital gains tax reform and anti-avoidance spending.

For the first time, PolicyEngine will produce a comprehensive score of this and future manifestos, capturing an estimate of the economic impact of all spending and revenue changes.

In this report, we will walk through the key policy proposals and present the manifesto costings produced by the Liberal Democrats alongside PolicyEngine replications of individual provisions. Costings in tables may not sum due to rounding. Where a proposal involves a tax-benefit policy modelled by PolicyEngine, we report how well we could replicate the Liberal Democrat claim.

Where a proposal is outside the scope of PolicyEngine’s model, we assume the Liberal Democrat spending or revenue estimate is fixed and apply an assumption about the incidence of the impact on UK households.[^1]

## Spending

The Liberal Democrats propose a net £26.8bn spending increase, and include several welfare reforms among other public services reforms. The welfare changes include:

- Increasing Carer’s Allowance by £20 per week, “raising the amount carers can earn and introducing an earnings taper to end the unfair cliff edge”.
- Removing the two-child limit to Universal Credit
- Removing the benefit cap

As it is currently specified, the Carer’s Allowance reform would not produce the cost estimated by the Liberal Democrats. Although we can replicate that their £20 per week increase would cost around £1bn (assuming their unspecified means test relaxation costs around 450m), most of this cost would be offset by reduced Universal Credit payments. If we assumed that the party would end the 1-1 reductions in Universal Credit for Carer’s Allowance payments, this would add an additional £3bn to the cost element. Because of this, we estimate the Carer’s Allowance as stated in the manifesto would only benefit households by 10% as much as the Liberal Democrats estimate.

We estimate that ending the two-child limit and the benefit cap would cost £3.4bn and £700m individually. When these welfare reforms are combined, their total cost rises from £4.4bn to £5.5bn because of interactions between the policies.

Combined with increases to education, healthcare and other public service budgets, we reach the same £26.8bn cost estimate as the party’s manifesto costings.

| **Provision**                         | **Liberal Democrats (£bn)** | **PolicyEngine (£bn)**                                                                                                                 |
| ------------------------------------- | --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| Carer's Allowance increase            | 1.4                         | [0.1](https://legacy.policyengine.org/uk/policy?reform=57787&focus=policyOutput.policyBreakdown&timePeriod=2028&region=uk&baseline=1)  |
| Removing the two-child limit          | -                           | [3.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=54700&region=uk&timePeriod=2028&baseline=1)  |
| Removing the benefit cap              | -                           | [0.7](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57793&region=uk&timePeriod=2028&baseline=1)  |
| Total welfare reforms                 | 5.5                         | [5.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57795&region=uk&timePeriod=2028&baseline=1)  |
| Increase education spending £6.6bn    | 6.6                         | [6.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57797&region=uk&timePeriod=2028&baseline=1)  |
| Increase NHS spending £8.4bn          | 8.4                         | [8.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57798&region=uk&timePeriod=2028&baseline=1)  |
| Increase other public spending £6.3bn | 6.3                         | [6.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57799&region=uk&timePeriod=2028&baseline=1)  |
| Total spending changes                | 26.8                        | [26.8](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57824&region=uk&timePeriod=2028&baseline=1) |

## Taxes

The manifesto proposes a £26.5 increase in tax revenues. We separate this into three distinct areas: taxes on capital gains, taxes incident largely on owners of capital, and taxes incident largely on consumers.

The Liberal Democrats propose reforms to Capital Gains Tax, including raising the Annual Exempt Amount (AEA) to £5,000 (from £3,000). We estimate this raises £300m on its own. The party also proposes several reforms to the tax which do not have enough detail to reproduce: “adjusting the rates”, “a new tax-free allowance for inflation”, and “introducing a relief for small businesses”. We estimate that a 5p rise in all Capital Gains Tax rates together with the AEA increase would match the Liberal Democrat-provided cost estimate of £5.2bn.

We estimate that of the remaining £21.3bn in tax rises, £17.7bn would be largely incident on owners of capital and £3.6bn would fall on consumers. When combined with the Capital Gains Tax reforms, we reach a very slightly (£400m) lower revenue estimate of £26.5bn to the party’s £26.9bn.

| Provision                            | Liberal Democrats | PolicyEngine                                                                                                                           |
| ------------------------------------ | ----------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| Raise AEA to £5,000                  | -                 | [0.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57808&region=uk&timePeriod=2028&baseline=1)  |
| Effectively increase rates by 5p     | -                 | [5.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57817&region=uk&timePeriod=2028&baseline=1)  |
| Total Capital Gains Tax reforms      | 5.2               | [5.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57813&region=uk&timePeriod=2028&baseline=1)  |
| Increase taxes on capital £17.7bn    | 17.7              | [17.7](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57818&region=uk&timePeriod=2028&baseline=1) |
| Increase taxes on consumption £3.6bn | 3.6               | [3.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57820&region=uk&timePeriod=2028&baseline=1)  |
| Total tax reforms                    | 26.9              | [26.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57823&region=uk&timePeriod=2028&baseline=1) |

## Economic impact

PolicyEngine estimates that the combined Liberal Democrat manifesto would, in 2024:

- Cost £200m
- Lower absolute poverty by 20 percent (of the current poverty rate)
- Raise net income for 70% of people

We also estimate that this level of redistribution would be progressive along income lines, with the lowest income decile seeing a 9% increase in disposable income, and a loss of 2% for the highest income decile.

![Impact by income decile](/images/posts/lib-dem-2024-manifesto/decile_impact.jpeg 'image_tooltip')

We also estimate that people in lower income deciles are more likely to be better off under the plans than those in higher deciles, though the lowest decile still has 10% of people worse off under the manifesto policy.

![Impacts within income deciles](/images/posts/lib-dem-2024-manifesto/intra_decile_impact.jpeg 'image_tooltip')

On poverty rates, PolicyEngine estimates that the manifesto policy would reduce absolute child poverty by a quarter, lowering the number of children in poverty by 1.3m and the number of people in poverty by 2.4m. We also estimate that the Gini index of income inequality would fall by over 3%.

![Poverty rate impacts](/images/posts/lib-dem-2024-manifesto/poverty_impact.jpeg 'image_tooltip')

## Conclusion

The Liberal Democrat manifesto redistributes £27bn progressively, largely from owners of corporations to consumers of healthcare, welfare and other public services. We estimate this causes large reductions in poverty and inequality, and with 70% of the population benefiting at the expense of a largely higher-income 30%.

We welcome questions and comments on our findings or methodology- please feel free to [get in touch](mailto:contact@policyengine.org).

<!-- Footnotes themselves at the bottom. -->

## Notes

[^1]: Where a policy is clearly a tax on corporations or consumption, we distribute the burden according to imputed corporate wealth and consumption, respectively. For public service budget changes we apply the ONS’ estimates of public service consumption by income decile.



---

---
# The Conservative Manifesto
Slug: conservative-2024-manifesto
Date: 2024-06-12 16:30:00
Authors: Nikhil Woodruff, Pavel Makarchuk, Anthony Volk
Tags: uk, policy
Description: PolicyEngine's comprehensive impact score.

---

_Distributional impact of the Conservative 2024 Manifesto. See the full impact score [here](https://legacy.policyengine.org/uk/policy?focus=policyOutput.distributionalImpact.incomeDecile.relative&reform=58041&region=uk&timePeriod=2029&baseline=1)._

## Key findings

1. The Conservatives propose a plan which we estimate will increase spending by £5.8bn over the next five years.

2. The spending reform will include increases in education expenditures and NHS funding, while decreasing other public spending, raising a total of £43.9bn.

3. Tax reforms include lowering employee NICs while cutting self-employment NICs, additionally introducing the Triple Lock Plus and reforming the HICBC while abolishing stamp duty for first-time homebuyers. This will be partially offset by anti-tax avoidance spending which we assume falls largely on corporations, for an overall cost of £49.7bn.

4. PolicyEngine concludes that the manifesto would increase poverty by 5.8%, increasing the senior poverty rate by 19.0%.

5. The impacts of the manifesto would largely be regressive. The manifesto reduces disposable income for the bottom ten percent of people by 6.4%.

6. The majority of people in the five lowest income deciles would experience a negative impact on net income while the majority of people in the five highest income deciles would experience a positive net income change.

On June 11th, the Conservative and Unionist Party [released](https://manifesto.conservatives.com/) their manifesto, outlining pivotal reforms in taxation, welfare, and public expenditure for the next five years. The party committed to a net spending decrease of £2bn through 2030, with emphasis on healthcare, education, and defence, alongside tax policy changes such as lowering employee and self-employment NICs.

For the first time, PolicyEngine will produce a comprehensive score of this and future manifestos, capturing an estimate of the economic impact of all spending and revenue changes.

In this report, we will walk through the key policy proposals and present the manifesto costings produced by the Conservatives alongside PolicyEngine replications of individual provisions. Costings in tables may not sum due to rounding. Where a proposal involves a tax-benefit policy modelled by PolicyEngine, we report how well we could replicate the Conservative claim.

Where a proposal is outside the scope of PolicyEngine’s model, we assume the Conservative spending or revenue estimate is fixed and apply an assumption about the incidence of the impact on UK households.

See the appendix for a full breakdown of our replication of the Conservatives’ tax cut [revenue impact estimates](https://public.conservatives.com/static/documents/GE2024/Conservative-Costings-Document-GE2024.pdf).

## Spending

The Conservatives propose a net spending decrease of £44bn through 2029. This would be driven primarily by procedural changes to welfare spending aimed at diminishing fraud and limiting eligibility (though without detail over specific eligibility changes), thereby lowering cost. This would be coupled with more minor cost-saving measures, including:

- Downsizing the civil service
- Lowering research and development funding
- Increasing international student visa fees

The Conservatives also propose spending increases to national defence, the NHS, and on some programs we classify as education-related (National Service and apprenticeship subsidies). Because none of these changes impact benefits modelled by PolicyEngine, we assume the Conservatives' costings and use the ONS’ estimates of the distributional impact of public service spending categories.

| **Provision**                          | **Conservatives (£bn)** | **PolicyEngine (£bn)**                                                                                                                  |
| -------------------------------------- | ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| Increase education spending £2.4bn     | 2.4                     | [2.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58028&region=uk&timePeriod=2029&baseline=1)   |
| Increase NHS funding £2.3bn            | 2.3                     | [2.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58059&region=uk&timePeriod=2029&baseline=1)   |
| Decrease other public spending £48.6bn | -48.6                   | [-48.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58064&region=uk&timePeriod=2029&baseline=1) |
| Total spending changes                 | -43.9                   | [-43.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58038&region=uk&timePeriod=2029&baseline=1) |

## Taxes

The Conservative manifesto balances its decrease in spending with a series of tax policy changes that generate a net negative budgetary impact of £49.7bn over the manifesto’s five-year period. These changes include:

- Lowering the employee NIC base rate step-wise to 6%
- Gradually abolishing self-employed NICs
- Increasing the personal allowance for pensioners with the Triple Lock Plus
- Ending the HICBC single-earner penalty
- Abolishing the Stamp Duty Land Tax (SDLT) for first-time homebuyers

These changes are underpinned by increased enforcement of anti-tax avoidance and evasion policies, which the Conservatives project to generate £20bn over the manifesto period, and which PolicyEngine projects would predominantly function as taxes upon capital (we assume their revenue estimate is correct).

We estimate that the Conservatives’ tax policy changes would have a slightly larger negative budgetary impact (£8.8bn) than the party manifesto. While most of our estimates were close to those of the manifesto, we find that ending the HICBC single-earner penalty would cost £10.2bn, as opposed to the Conservatives’ £4.5bn estimate.

We also find roughly double the budgetary impact of abolishing the Stamp Duty Land Tax (SDLT) for first-time homebuyers, at a cost of £4.4bn, versus the Conservatives’ estimate of £2.3bn.

| **Provision**                                       | **Conservatives (£bn)** | **PolicyEngine (£bn)**                                                                                                                  |
| --------------------------------------------------- | ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| Lowering the employee NIC base rate step-wise to 6% | -39.4                   | [-41.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57887&region=uk&timePeriod=2029&baseline=1) |
| Abolishing self-employed NICs                       | -6.8                    | [-6.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57894&region=uk&timePeriod=2029&baseline=1)  |
| Triple Lock Plus                                    | -8.8                    | [-7.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&region=uk&timePeriod=2029&baseline=1)  |
| Reforming the HICBC single-earner policy            | -4.5                    | [-10.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2029&baseline=1&reform=57905) |
| Abolish stamp duty for first-time homebuyers        | -2.3                    | [-4.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57915&region=uk&timePeriod=2029&baseline=1)  |
| Taxes incident on capital                           | 20.0                    | [20.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58131&region=uk&timePeriod=2029&baseline=1)  |
| Total tax changes                                   | -41.9                   | [-49.7](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2029&baseline=1) |

## Overall

The Conservative manifesto, according to their costings, balances £41.9bn of tax cuts against £43.9bn generated by decreasing benefit spending, yielding a net budgetary surplus of £2bn. However, PolicyEngine’s estimate of the Conservatives’ total tax changes is £7.8bn higher than those in the manifesto, leading us to estimate an overall deficit of £5.8bn. As explained in the tax change section, this may be driven by modelling differences in the Conservatives’ HICBC policy costing, as well as assumptions on the housing market’s impact on the Conservatives’ stamp duty modifications.

In the chart below, negative numbers refer to increased government expenditures, while positive numbers refer to budgetary savings.

| **Provision**          | **Conservatives (£bn)** | **PolicyEngine (£bn)**                                                                                                                  |
| ---------------------- | ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| Total spending changes | -43.9                   | [-43.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58038&region=uk&timePeriod=2029&baseline=1) |
| Total tax changes      | 41.9                    | [49.7](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2029&baseline=1)  |
| Overall net change     | 2.0                     | [-5.8](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58041&region=uk&timePeriod=2029&baseline=1)  |

## Economic impact

PolicyEngine estimates that the complete Conservative manifesto would, in 2029:

- Cost £0.9bn
- Raise poverty by 6%
- Increase net income for 46% of the population, while decreasing it for 52%

We estimate the Conservatives’ manifesto to be [mostly regressive along income lines](https://legacy.policyengine.org/uk/policy?focus=policyOutput.winnersAndLosers.incomeDecile&reform=58041&region=uk&timePeriod=2029&baseline=1), with the lowest decile experiencing a 6.4% decrease in disposable income, while those in the highest income bracket would see a 0.3% increase, and those in bracket 9 would experience the greatest relative increase of 1.6%.

![Impact by income decile](/images/posts/conservative-2024-manifesto/decile_impact.png 'image_tooltip')

We also conclude that people in the lowest income deciles are more likely to experience the negative impacts of the proposal, with over 95% of people in the first income decile experiencing a decrease in net income. The majority of people in income deciles above the fifth start to experience net income increases with [overall 46% of the population benefiting](https://legacy.policyengine.org/uk/policy?focus=policyOutput.winnersAndLosers.incomeDecile&reform=58041&region=uk&timePeriod=2029&baseline=1), in net income terms, and 52% of people experience net income decreases.

![Impacts within income deciles](/images/posts/conservative-2024-manifesto/intra_decile_impact.png 'image_tooltip')

Regarding poverty rates, PolicyEngine estimates that the proposed policy changes would [increase the overall poverty rate 5.8%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact.regular.byAge&reform=58041&region=uk&timePeriod=2029&baseline=1). The percentage of seniors in poverty would increase by 19% to a total of 13.4%, while child and working-age adult poverty rates would increase by 3.5% and 4.6% respectively.

![Poverty rate impacts](/images/posts/conservative-2024-manifesto/poverty_impact.png 'image_tooltip')

## Conclusion

The Conservative manifesto proposes a series of tax cuts, balanced with welfare spending cuts and anti-tax avoidance provisions, that the party projects to create a budgetary surplus of £2bn between 2025 and 2029. PolicyEngine estimates that these provisions would actually generate a budgetary deficit of £5.8bn, with key differences in modelled impacts of the Child Benefit High Income Tax Charge and the Stamp Duty tax cut for first-time buyers. We estimate that the Conservatives’ policies would redistribute income from those in the lowest brackets toward those in the uppermost, causing noticeable increases in inequality and poverty, particularly for seniors.

We welcome questions and comments on our findings or methodology- please feel free to [get in touch](mailto:contact@policyengine.org).

<!-- Footnotes themselves at the bottom. -->

## Appendix

We estimate the following per-year scores for each of the tax provisions of the manifesto below.

PolicyEngine estimates of Conservative manifesto tax cuts.
| **Provision**| **2025 (£bn)** | **2026 (£bn)**|**2027 (£bn)**|**2028 (£bn)**|**2029 (£bn)**|**Total**|
| ------------ | -------------- | -------------- | ----------- | ----------- | ----------- | ------- |
| Halve employee NICs | [5.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57887&region=uk&timePeriod=2025&baseline=1) | [5.1](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57887&region=uk&timePeriod=2026&baseline=1) |[10.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57887&region=uk&timePeriod=2027&baseline=1) |[10.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57887&region=uk&timePeriod=2028&baseline=1) | [10.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57887&region=uk&timePeriod=2029&baseline=1) | 41.3 |
| Abolish self-employed NICs | [0.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57894&region=uk&timePeriod=2025&baseline=1) |[0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57894&region=uk&timePeriod=2026&baseline=1) |[1.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57894&region=uk&timePeriod=2027&baseline=1) |[1.8](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57894&region=uk&timePeriod=2028&baseline=1) |[2.1](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57894&region=uk&timePeriod=2029&baseline=1) | 6.5 |
| Triple Lock Plus | [0.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&region=uk&timePeriod=2025&baseline=1) |[1.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&region=uk&timePeriod=2026&baseline=1) |[1.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&region=uk&timePeriod=2027&baseline=1) |[1.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&region=uk&timePeriod=2028&baseline=1) |[2.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=56385&region=uk&timePeriod=2029&baseline=1) | 7.3 |
| Reform HICBC single-earner provisions | [0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=1&reform=57905) |[2.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2026&baseline=1&reform=57905) |[2.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2027&baseline=1&reform=57905) |[2.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2028&baseline=1&reform=57905) |[2.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2029&baseline=1&reform=57905) |10.2 |
| Abolish stamp duty for first-time buyers | [0.8](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57915&region=uk&timePeriod=2025&baseline=1) |[0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57915&region=uk&timePeriod=2026&baseline=1) |[0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57915&region=uk&timePeriod=2027&baseline=1) |[0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57915&region=uk&timePeriod=2028&baseline=1) |[0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=57915&region=uk&timePeriod=2029&baseline=1) |4.4 |
| Anti-tax avoidance investment | [-2.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58122&region=uk&timePeriod=2025&baseline=1) |[-3.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58122&region=uk&timePeriod=2026&baseline=1) |[-4.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58122&region=uk&timePeriod=2027&baseline=1) |[-5.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58122&region=uk&timePeriod=2028&baseline=1) |[-6.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58122&region=uk&timePeriod=2029&baseline=1) | -20.0 |
| Total | [4.7](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2025&baseline=1) |[7.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2026&baseline=1) |[12.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2027&baseline=1) |[12.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2028&baseline=1) |[12.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58015&region=uk&timePeriod=2029&baseline=1) |49.7|

These compare to the Conservatives’ estimates below.
| **Provision**| **2025 (£bn)** | **2026 (£bn)**|**2027 (£bn)**|**2028 (£bn)**|**2029 (£bn)**|**Total**|
| ------------ | -------------- | -------------- | ----------- | ----------- | ----------- | ------- |
| Halve employee NICs | 4.7 | 4.8 | 9.7 | 10.0 | 10.3 | 39.5 |
| Abolish self-employed NICs | 0.4 | 0.9 | 1.3 | 1.7 | 2.6 | 6.9 |
| Triple Lock Plus | 0.8 | 1.4 | 2.0 | 2.2 | 2.4 | 8.8 |
| Reform HICBC single-earner provisions | 0 | 1.0 | 1.0 | 1.2 | 1.3 | 4.5 |
| Abolish stamp duty for first-time buyers | 0.3 | 0.4 | 0.5 | 0.6 | 0.6 | 2.4 |
| Anti-tax avoidance investment | -2.0 | -3.0 | -4.0 | -5.0 | -6.0 | -20.0 |
| Total | 6.2 | 8.5 | 15.5 | 15.7 | 17.2 | 41.9 |

Overall, we estimate differences in per-year revenue impacts of between £600m and £2.1bn.

Revenue impact, billions of pounds
| **Budgetary impact (£bn)**| **2025** | **2026**|**2027**|**2028**|**2029**|**Total**|
| ------------ | -------------- | -------------- | ----------- | ----------- | ----------- | ------- |
| Conservatives | -1.0 | 2.0 | 0.0 | 0.8 | 0.3 | 2.1 |
| PolicyEngine | [-1.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58040&region=uk&timePeriod=2025&baseline=1) | [0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58040&region=uk&timePeriod=2026&baseline=1) | [-2.1](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58040&region=uk&timePeriod=2027&baseline=1) | [-1.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58040&region=uk&timePeriod=2028&baseline=1) | [-0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=58040&region=uk&timePeriod=2029&baseline=1) | -5.8 |



---

---
# The Labour Party Manifesto
Slug: labour-2024-manifesto
Date: 2024-06-29 14:00:00
Authors: Nikhil Woodruff, Anthony Volk
Tags: uk, policy
Description: PolicyEngine's comprehensive impact score.

---

_Distributional impact of the Labour 2024 Manifesto. See the full impact score [here](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60777&region=uk&timePeriod=2028&baseline=1)._

## Key findings

- Labour propose a budget-surplus plan which raises £7.5bn and spends £4.2bn, benefiting 73% of people.
- Spending reforms are largely focussed on public services, while tax reforms are likely to be incident mostly on high-earners.
- PolicyEngine estimates that the private school VAT application is progressive along income deciles.
- We project that the lowest income decile would see a 2.4% rise in net income, while the top decile would see a 1% fall in net income.
- We also project modest reductions in absolute poverty and inequality.

On June 13, Labour [released](https://labour.org.uk/updates/stories/labour-manifesto-2024-sign-up/) their 2024 election manifesto, laying out their revenue and spending priorities for the coming parliament. In their manifesto, Labour does not provide a total figure for expected expenditures or tax revenue for the entirety of the five-year parliament. However, they do provide [cost estimates](https://labour.org.uk/change/labours-fiscal-plan/) for the 2028-29 fiscal year, which PolicyEngine uses as the basis of its modelling.

In the manifesto, Labour set out a revenue-positive series of priorities. In fiscal year 2028-29, the party aims to raise £7.4bn through tax revisions and spend £4.8bn funding new expenditures, with the majority of this value allocated to increased NHS spending, NHS-adjacent healthcare programs, and education programs.

For the first time, PolicyEngine will produce a comprehensive score of this and future manifestos, capturing an estimate of the economic impact of all spending and revenue changes.

In this report, we will walk through Labour’s key policy proposals and present the manifesto costings produced by Labour alongside PolicyEngine replications of individual provisions. Costings in tables may not sum due to rounding. Where a proposal involves a tax-benefit policy modelled by PolicyEngine, we report our alignment to the Labour claim.

Where a proposal is outside the scope of PolicyEngine’s model, we assume the Labour spending or revenue estimate is fixed and apply an assumption about the incidence of the impact on UK households.[^1]

## Spending

Labour proposes a net spending increase of £4.8bn in 2028-29. The bulk of this spending would be allocated to new or expanded health and education programs, the most significant of which would include:

- Funding 40,000 more weekly NHS operations, scans, and appointments
- Increased funding to HMRC to reduce tax avoidance
- Hiring 6,500 new teachers
- Recruiting 8,500 new mental health employees
- Providing free breakfast clubs in every primary school

None of these involve changes to benefits modelled by PolicyEngine, so we assume their cost estimates and use the ONS’ estimates of the distributional impact of public service spending categories.

| Provision                             | Labour (£bn) | PolicyEngine (£bn)                                                                                                                    |
| ------------------------------------- | ------------ | ------------------------------------------------------------------------------------------------------------------------------------- |
| Increase education spending £1.3bn    | 1.3          | [1.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60023&region=uk&timePeriod=2028&baseline=1) |
| Increase NHS funding £2.0bn           | 2.0          | [2.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60024&region=uk&timePeriod=2028&baseline=1) |
| Increase other public spending £0.9bn | 0.9          | [0.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60025&region=uk&timePeriod=2028&baseline=1) |
| Total spending changes                | 4.2          | [4.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60027&region=uk&timePeriod=2028&baseline=1) |

## Revenue

Labour’s manifesto also proposes a £7.4 billion increase in tax revenues, funded through four tax policy revisions:

- Removal of the non-domiciled tax status and investments in reducing tax avoidance
- Application of VAT and business rates to private school tuition fees
- Application of standard income tax rates to carried interest
- An increase of 1% to the residential property stamp duty for non-UK residents

| Provision                                                                          | Labour (£bn) | PolicyEngine (£bn)                                                                                                                                               |
| ---------------------------------------------------------------------------------- | ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Remove non-dom tax incentive and reduce tax avoidance                              | 5.2          | [5.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.distributionalImpact.incomeDecile.relative&reform=60770&region=uk&timePeriod=2028&baseline=1) |
| Apply VAT and business rates to private schools                                    | 1.5          | [1.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&region=uk&timePeriod=2028&baseline=1&reform=60760)                            |
| Close carried interest tax provision                                               | 0.6          | [0.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60028&region=uk&timePeriod=2024&baseline=1)                            |
| Increase stamp duty on purchases of residential property by non-UK residents by 1% | 0.04         | 0.0                                                                                                                                                              |
| Total tax changes                                                                  | 7.3          | [7.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60773&region=uk&timePeriod=2028&baseline=1)                            |

PolicyEngine models the impact of levying VAT on private schools, largely following the evidence base contributed by [the IFS](https://ifs.org.uk/publications/tax-private-school-fees-and-state-school-spending) and [UCL](https://www.tandfonline.com/doi/full/10.1080/09645292.2021.1874878).[^2] Using patterns of income and private school attendance, our model estimates distributional and inequality impacts of the reform.

In order to capture the likely distributional impact of non-dom status removal, we represent this as a tax on income over £100,000 raising £3.2bn in revenue.[^3] We model the tax on carried interest as a tax incident on owners of capital.

## Economic impact

PolicyEngine estimates that in 2028 the Labour Party manifesto would:

- Raise £3.3bn
- Lower poverty by 2%
- Raise net income for 73% of people

We estimate that gains would be progressive along income lines, with the lowest decile seeing a 2.4% increase in net income and the highest decile seeing a 1% loss.

![Impact by income decile](/images/posts/labour-2024-manifesto/decile.png)

We also estimate that people in lower and middle income deciles are highly likely to benefit. Only the top decile sees a majority of people come out behind, and more than 80% in each of the bottom eight deciles come out ahead or the same.

![Winners and losers by income decile](/images/posts/labour-2024-manifesto/winners.png)

On poverty, we estimate modest reductions in absolute poverty across all age groups, particularly aimed at seniors. We also project that the Gini index of income inequality would by 0.6%.

![Poverty impact by age group](/images/posts/labour-2024-manifesto/poverty.png)

## Conclusion

The Labour manifesto redistributes £4.2bn and raises £3.3bn surplus revenue progressively, with small tax rises largely concentrated on the highest income decile funding public spending that benefits the lower and middle of the income distribution the most. We estimate this causes a small reduction in absolute poverty, and an increase in living standards for 73% of the population.

<!-- Footnotes themselves at the bottom. -->

## Notes

[^1]: Where a policy is clearly a tax on corporations or consumption, we distribute the burden according to imputed corporate wealth and consumption, respectively. For public service budget changes we apply the ONS’ estimates of public service consumption by income decile. Where a policy is clearly only incident on high incomes, we model it as a progressive tax after an appropriate income level.

[^2]: See our open-source model addition [here](https://github.com/PolicyEngine/policyengine-uk/pull/880/files). We do not model the business rate increase.

[^3]: [Advani et al](https://warwick.ac.uk/fac/soc/economics/research/centres/cage/manage/publications/bn36.2022.pdf) found that only 0.3% of people who have ever been non-doms earn less than £100,000, and non-dom status becomes more prevalent at higher incomes.



---

---
# Validation against the Survey of Personal Incomes
Slug: uk-spi-validation
Date: 2024-08-14 01:00:00
Authors: Anthony Volk
Tags: uk, technical
Description: Evaluating PolicyEngine's model performance against the UK SPI.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Validation against the Survey of Personal Incomes\n",
    "\n",
    "To ensure accuracy and precision, PolicyEngine periodically validates its free and open-source simulation and microsimulation model against existing external datasets. This process involves taking external datasets meant to represent a particular slice of British society and loading their inputs, such as total individual employment income, into our data model. We then compare our calculated outputs with theirs in an effort to find discrepancies between the two. In this post, we'll describe our efforts to validate our model against the newly released [Survey of Personal Incomes (SPI) 2020/21](https://www.gov.uk/government/statistics/personal-incomes-statistics-for-the-tax-year-2020-to-2021/personal-income-statistics-2020-to-2021-supporting-documentation) dataset.\n",
    "\n",
    "## The UK Survey of Personal Incomes\n",
    "\n",
    "The Survey of Personal Incomes (SPI) is a comprehensive dataset produced by HM Revenue and Customs (HMRC). It provides detailed information on individuals' income, tax, and other financial data based on a sample of HMRC records. The SPI is among the most comprehensive UK individual-level financial datasets, and is used by HMRC, HM Treasury, and individual Members of Parliament, among others.[^1]\n",
    "\n",
    "## Validation results\n",
    "\n",
    "We chose to validate PolicyEngine against the SPI's total individual income, using the SPI's input variables to compare PolicyEngine UK's calculated total income tax against the SPI's reported amount. \n",
    "\n",
    "To do so, we first remove the SPI's \"composite records,\" which are used to represent smaller population groups as a collective. This group of records is only meant to be employed within society-wide modelling, and its outputs cannot be correctly computed using its inputs. This group of records contains 1,770 observations, representing around 0.2% of total records.\n",
    "\n",
    "We then treat relevant variables from the SPI 2020/21 dataset[^2] as input variables into the PolicyEngine UK model. Using this data, we run household-level simulations for each input and categorise the outputs logarithmically based on how close PolicyEngine's calculated 2020/21 total income tax is to that of the SPI. We treat a result within £10 as a match due to differences in rounding. Our final match statistics are displayed in the table below."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "vscode": {
     "languageId": "plaintext"
    }
   },
   "source": [
    "| Total error (£) | Percentage of all records |\n",
    "|-----------------|---------------------------|\n",
    "| <=10            | 92.7%                     |\n",
    "| <100            | 93.5%                     |\n",
    "| <1,000          | 98.3%                     |\n",
    "| >=1,000         | 1.7%                      |"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For 92.7% of individuals included within the SPI, PolicyEngine UK's calculated total income tax is within £10 of the SPI's calculated amount. We view this as a robust demonstration of PolicyEngine's accuracy and precision.\n",
    "\n",
    "## Analysing model discrepancies\n",
    "\n",
    "For the remaining records where our calculations do not closely match the SPI, we believe the differences are attributable to two main factors:\n",
    "\n",
    "1. Differences in input information: The SPI sometimes uses additional input data that is not available to PolicyEngine, leading to differences in calculations.\n",
    "2. Structural differences: At times, the SPI model's structure differs from that of PolicyEngine in a way that complicates further model validation.\n",
    "\n",
    "Four relevant error clusters appeared among the records where the SPI and PolicyEngine calculate differing outputs:\n",
    "\n",
    "1. Cases where an individual appears to transfer a portion of their Personal Allowance to their spouse as part of the Marriage Allowance. This is because the SPI removes the transferred amount from the individual's Personal Allowance, but does not indicate that the subsequent lower amount is driven by the Marriage Allowance. This may represent as much as 37,998 records (4.8% of total).\n",
    "1. Cases where an individual receives less than £100,000 in annual income and is non-resident for taxation purposes. In this situation, the individual receives £0 Personal Allowance, even though our model would project a full £12,500 allowance. The SPI uses a variable that is not publicly available to calculate this status. This represents 2,054 records (0.3% of total).\n",
    "1. Cases where both the SPI and PolicyEngine calculate the same amount of taxable savings income for an individual receiving any form of savings income classified by the SPI as \"Other Investment Income\" (e.g., interest on securities), but the SPI finds that they owe around £1,000 more in income tax than we do. This represents 1,276 records (0.2% of total).\n",
    "1. Cases where an individual near the Personal Allowance taper value who claims Gift Aid receives a full Personal Allowance of £12,500 within the SPI model. The SPI model's Gift Aid variable signifies the amount an individual deducts due to Gift Aid donations, while PolicyEngine's represents an individual's total Gift Aid-eligible donations. We then calculate the indivdual's deduction amount from this value. This error represents 738 records (0.1% of total).\n",
    "\n",
    "## Conclusion\n",
    "PolicyEngine's UK model shows a high level of parity with the SPI's 2020/21 data, with almost 93% of records with the same inputs returning the same total income tax calculation. While some discrepancies exist, they are limited in scope and often attributable to either testability limitations within the SPI's structure or to inputs that the SPI has not made publicly available. This validation exercise builds upon our previous validations, such as our [Autumn 2023 model calibration](https://legacy.policyengine.org/uk/research/uk-calibration-2023-q4). We welcome questions and comments on our findings or methodology - please feel free to [get in touch](mailto:contact@policyengine.org)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[^1]: https://data.europa.eu/data/datasets/hmrc-survey-of-personal-incomes-spi?locale=en\n",
    "[^2]: https://www.gov.uk/government/statistics/personal-incomes-statistics-for-the-tax-year-2020-to-2021"
   ]
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# Labour's reforms to VAT tax on private schools
Slug: school-vat
Date: 2024-10-17 01:00:00
Authors: Vahid Ahmadi
Tags: uk, tax, policy, vat
Description: PolicyEngine projects Labour's private school tax plan would raise £7.7 billion over five years, mainly affecting wealthier households.

---

## Key findings

- We estimate a [£1.5 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2025&baseline=1) revenue increase from Labour's proposal to raise the VAT rate on private schools to 20%.
- Our analysis projects that Labour's proposal to remove tax exemptions from private schools would raise a total of £7.7 billion in tax revenue over the five-year period from FY2025 to FY2029.
- We estimate that the Gini index of income inequality would decrease slightly by 0.01% in FY2025.
- We also estimate that Labour's plan would lower net income for 3.3% of people.

Labour has proposed a policy change aimed at reducing educational inequality and raising additional revenue for the public sector. Their plan involves removing tax exemptions from private schools, including VAT exemptions and business rates relief. In this report, we provide a comprehensive analysis of Labour's proposal using household data, offering a score of the policy's potential outcomes. This approach (compared to using administrative data) allows us to examine a broader range of potential effects, including changes in the income distribution. In this report, we analyse Labour's key policy proposals by implementing them in our household model. We present our estimated impacts based on the policy reform details and ISC census data, providing a comprehensive view of the potential effects on households.

## Economic impact

### Budgetary impact

PolicyEngine's static analysis[^1] of Labour's plan to remove tax exemptions from private schools estimates a budgetary impact of £1.5 billion. This aligns with the Institute for Fiscal Studies [(IFS)](https://ifs.org.uk/news/removing-tax-exemptions-private-schools-likely-have-little-effect-numbers-private-sector), which projects a £1.3-1.5 billion net gain to public finances per year.

The chart presents PolicyEngine's estimates of the effects of Labour's proposed VAT policy on private schools over the next five years. It shows projections for both the raised tax revenue and the percentage of people experiencing lower net income from FY2025 to FY2029.

| Year | Budgetary impact (£ billion)                                                                                                           | People affected (%) |
| :--- | :------------------------------------------------------------------------------------------------------------------------------------- | :------------------ |
| 2025 | [1.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2025&baseline=1) | 3.3                 |
| 2026 | [1.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2026&baseline=1) | 3.3                 |
| 2027 | [1.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2027&baseline=1) | 3.3                 |
| 2028 | [1.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2028&baseline=1) | 3.4                 |
| 2029 | [1.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2029&baseline=1) | 3.4                 |

### Distributional impact

Our analysis of Labour's proposal to remove tax exemptions from private schools reveals a mixed impact on household incomes. While the overall effect is modest, with an average decrease in net household income of 0.1% in FY2025, the impact is progressively distributed across income groups:

- Deciles 1-3: The lowest income groups experience negligible changes in their net income.
- Deciles 4-6: Middle-income households see minimal effects from the policy, with only slight changes to their net income.
- Deciles 7-8: Upper-middle income groups are slightly affected, experiencing small but noticeable reductions in their net income.
- Deciles 9-10: The highest income households bear the brunt of the policy's impact, with the most significant reductions in net income, as they are the primary users of private schools.

![](/images/posts/school_vat/income.png)

### Winners and losers

Our analysis of Labour's plan reveals a targeted impact on household incomes across different income groups in FY2025. The policy would decrease net income for 3% of the population, with effects predominantly concentrated in higher income deciles. The lowest income groups (deciles 1-3) see no change, while the impact begins to appear from the 4th decile upwards. The most significant effect is observed in the highest income group (decile 10), where 13% of households experience a loss of less than 5% in their net income. Overall, 97% of the population sees no change in their net income, indicating that the policy's financial impact is limited to a small segment of relatively higher-income households.

![](/images/posts/school_vat/winner-loser.png)

### Inequality impact

Labour's proposal to remove tax exemptions from private schools is projected to have a modest impact on income inequality from FY2025. The Gini index, a common measure of income inequality, is projected to decrease by 0.01%. This suggests a slight overall reduction in income disparity across the population. The policy also appears to have a targeted impact on high-income groups, with the income share of the top 10% decreasing by 0.01%. The income share of the top 1% is also expected to decrease slightly by the same amount.

![](/images/posts/school_vat/gini-plot.png)

## Conclusion

We estimate that Labour's plan would raise £1.5 billion in revenue in FY2025, primarily affecting higher-income households, with 3.3% of the population experiencing a decrease in net income. It also would cause a modest reduction in income inequality, decreasing the Gini index by 0.01%.

[^1]: Our analysis does not account for potential long-term changes in consumer preferences that may result from applying different VAT rates. The analysis assumes static behavioural responses and does not model potential shifts in educational choices or school operations that might occur over time.



---

---
# Levying VAT on private school fees in the Autumn Budget
Slug: vat-school-comparison
Date: 2024-10-31 15:00:00
Authors: Vahid Ahmadi
Tags: uk, tax, policy, vat, featured
Description: PolicyEngine projects the reforms to private school VAT would raise £1.5 billion in 2025.

---

[_See the full impact on PolicyEngine here._](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2025&baseline=1)

The Autumn Budget 2024 confirms the previously signalled intention to levy VAT on private school fees. Using PolicyEngine's open-source model, we analyse the fiscal and distributional implications of this reform.

## Budgetary impacts

We project the private school VAT reform will raise [£1.5 to £1.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2025&baseline=1) per year, totalling £7.7 billion from 2025 to 2029\.

Projections from [HM Treasury](https://assets.publishing.service.gov.uk/media/6721d2c54da1c0d41942a8d2/Policy_Costing_Document_-_Autumn_Budget_2024.pdf#page=34) and the [OBR](https://obr.uk/docs/dlm_uploads/OBR_Economic_and_fiscal_outlook_Oct_2024.pdf#page=66) each total £8.6 billion, 12% higher than ours, as shown below.

#### Revenue from private school VAT by scorekeeper (£ billions)

| Fiscal Year  | 2024-25 | 2025-26                                                                                                                                | 2026-27                                                                                                                                | 2027-28                                                                                                      | 2028-29                                                                                                                               | 2029-30                                                                                                                               | Total |
| :----------- | :------ | :------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------ | :---- |
| PolicyEngine | 0.0     | [1.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2025&baseline=1) | [1.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=60649&region=uk&timePeriod=2026&baseline=1) | [1.5](https://legacy.policyengine.org/uk/policy?focus=gov&reform=60649&region=uk&timePeriod=2027&baseline=1) | [1.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60649&region=uk&timePeriod=2028&baseline=1) | [1.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=60649&region=uk&timePeriod=2029&baseline=1) | 7.7   |
| HM Treasury  | 0.5     | 1.5                                                                                                                                    | 1.6                                                                                                                                    | 1.6                                                                                                          | 1.7                                                                                                                                   | 1.7                                                                                                                                   | 8.6   |
| OBR          | 0.5     | 1.5                                                                                                                                    | 1.6                                                                                                                                    | 1.6                                                                                                          | 1.7                                                                                                                                   | 1.7                                                                                                                                   | 8.6   |

The variations between our estimates and official projections may stem from different assumptions about the total value of private school fees or varying projections of future enrollment patterns.

The OBR and HM Treasury both estimate the impact of introducing VAT on private school fees but differ in key assumptions. The OBR assumes an effective VAT rate of 15.4%, factoring in cost recoveries, with two-thirds of the cost passed to parents as higher fees, nearly a quarter absorbed by reduced services, and the rest through efficiencies. They use a demand elasticity of 0.5, predicting that around 35,000 fewer pupils will attend private schools, mostly due to fewer new joiners. In contrast, HM Treasury applies the full standard rate of 20%, calculating the tax base by multiplying pupil numbers by average fees and projecting this over time based on earnings growth. Our analysis assumes no behavioural responses and focuses only on the direct cost impact of VAT, using a static calculation without adjustments over time.

### Distributional Impact

This reform disproportionately affects households in the upper income deciles, reducing the net income of the top decile by 0.15% on average.

![](/images/posts/school_vat/income.png)

The policy would decrease net income for 3% of the population, with effects concentrated in higher income deciles.

![](/images/posts/school_vat/winner-loser.png)

When analysing impacts by wealth rather than income, this reform contributes to the pattern where all wealth deciles see lower net income, though with notably larger effects on wealthier households who are more likely to use private education[^1].

[^1]: [Recent studies](https://francisgreenspersonalwebpage.com/2021/02/11/income-housing-and-private-school-access-in-britain/) show that private school attendance is concentrated among wealthier households in the UK.



---

---
# How PolicyEngine UK models behavioural responses
Slug: behavioural-responses
Date: 2024-11-12 15:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, behavioral-responses, featured
Description: PolicyEngine has enhanced its modelling with behavioural responses, including income, substitution and capital gains elasticities.

---

Public policies change incentives and behaviours. When governments introduce or modify policies, individuals respond by adjusting their decisions. Workers may change their work hours,[^1] investors might shift when they realise gains,[^2] and businesses often adapt their practices in response.[^3] The static analysis fails to capture how individuals adjust their economic decisions when facing new incentives.  
This report presents how PolicyEngine currently models three key behavioural responses to policy changes :

1. Income effects on labour supply
2. Substitution effects on labour supply
3. Capital gains tax responses

To model these responses, we apply _elasticities,_ which quantify the magnitude of the response: larger elasticities indicate stronger behavioural responses, while smaller ones suggest more limited adjustments. PolicyEngine empowers users to set their own elasticities, while we apply our best guesses in our reports. This review describes these responses and our selected elasticities.

## Labour supply

PolicyEngine models how individuals adjust their earnings through income and substitution effects. For example, one might work less if they have more income (they purchase leisure with income effects), or if they take home less for an additional hour of work (they substitute leisure over consumption at the margin).

### The income elasticity

When people become richer, they might choose to work less. The income elasticity measures this behaviour \- how much work changes when net income changes after taxes and transfers.

By default, PolicyEngine applies the [Congressional Budget Office (CBO)](https://www.cbo.gov/sites/default/files/112th-congress-2011-2012/reports/43674-laborsupplyfiscalpolicy.pdf#page=4)’s central estimate of a **\-0.05** income elasticity, meaning a 10% rise in net income leads to a 0.5% drop in work. The [Office of Budget Responsibility](https://obr.uk/docs/dlm_uploads/NICS-Cut-Impact-on-Labour-Supply-Note.pdf#page=7) also applies a \-0.05 income elasticity for single mothers and men who are not single fathers, while applying elasticities between \-0.037 and \-0.185 for married or cohabitating women and lone parents, depending on the age of the youngest child.

### The substitution elasticity

People work partly based on how much they keep from each extra hour of work. The substitution elasticity measures how work changes when this reward changes. For example, higher tax rates or steeper benefit phase-outs mean keeping less from each additional hour, which might lead to less overtime or part-time work. By default, PolicyEngine applies the [Congressional Budget Office (CBO)](https://www.cbo.gov/sites/default/files/112th-congress-2011-2012/reports/43674-laborsupplyfiscalpolicy.pdf#page=4)’s central elasticity averaged over primary earners, which is **0.25**, meaning people work 2.5% less when they keep 10% less from each extra hour after taxes and transfers.  
Unlike the [OBR](https://obr.uk/docs/dlm_uploads/NICS-Cut-Impact-on-Labour-Supply-Note.pdf), which separately models extensive margins (participation) and intensive margins (hours worked), PolicyEngine follows CBO in using single elasticities that combine both responses. The OBR's intensive margin elasticities vary by demographic group, ranging from 0.094 to 0.439. PolicyEngine plans to add separate extensive margin responses in future versions, which will require estimating potential wages for individuals currently out of the labour force.

### An illustrative example

To understand how these elasticities work, consider a worker earning £30,000 per year. This worker currently faces a marginal tax rate of [28%](https://legacy.policyengine.org/uk/household?focus=householdOutput.netIncome&household=49381) (combining income tax and National Insurance) and takes home [£24,961](https://legacy.policyengine.org/uk/household?focus=householdOutput.netIncome&household=49381) after taxes and transfers. At the current tax rates, this worker's net-of-tax wage rate is 72% of her gross wage. Now imagine a new policy that increases basic income tax by 1p (from 20% to 21%). In this case, PolicyEngine calculates that this new policy decreases her net income by [£175](https://legacy.policyengine.org/uk/household?focus=householdOutput.netIncome&reform=53461&region=uk&timePeriod=2025&baseline=1&household=49381).

For this worker earning £14.42 per hour (£30,000/2,080 hours), the take-home pay per extra hour drops from £10.38 to £10.21 under the new policy – a 1.6% decrease. Using PolicyEngine's central estimates, we calculate two effects:

1. Substitution effect: Workers reduce hours by 0.25% for each 1% decrease in wages. A 1.6% wage decrease leads to a 0.4% reduction in hours (1.6% × 0.25).
2. Income effect: Workers increase hours by 0.05% for each 1% drop in income. The £175 decrease represents a 0.7% drop in take-home pay (£175/£24,961), leading to a 0.035% increase in hours (0.7% × \-0.05).

The net effect combines these responses: 0.4% decrease minus 0.035% increase equals a 0.365% decrease. Given the baseline of £30,000 earnings and 2,080 hours, this translates to a predicted 7 fewer work hours and £109 less earnings per year.

## Capital gains elasticity

When tax rates on investment gains change, people adjust when they sell their investments,[^4] how much they invest, and how they structure their investments. The capital gains elasticity measures this effect. While conceptually similar to the substitution effect for labour supply (measured with respect to the net-of-tax marginal wage), economists generally represent the capital gains elasticity as the percent change in capital gains with respect to a 1p change in the capital gains tax rate. It therefore has the opposite sign of substitution elasticity.

We have not identified any UK-specific studies on capital gains elasticities, so PolicyEngine relies on US research evidence. US studies distinguish between permanent elasticities (long-term responses to sustained tax changes) and transitory elasticities (temporary responses as people time their sales around tax changes). Dowd and McClelland (2019)[^5] found an overall elasticity of \-0.79 examining US federal and state tax returns from 1999-2008. Earlier work by Auten and Clotfelter (1982)[^6] found a permanent elasticity of \-0.37 and a higher transitory elasticity of \-1.05.  
PolicyEngine uses an elasticity of **\-0.7** as a default amount for the UK context, reflecting our belief that UK capital gains respond less to policy change than US capital gains do. Several factors drive this difference: the US has more tax-advantaged investment vehicles, more generous real estate tax treatment,[^7] a more active trading culture,[^8][^9] and the ability to relocate investments across state tax jurisdictions to minimise combined state and federal liabilities.[^10] The UK's unified tax system and fewer tax-advantaged accounts suggest a smaller response to tax changes. Users can adjust this default elasticity in their analysis.

## How PolicyEngine models behavioural responses

By default, the PolicyEngine web app assumes no behavioural responses. When users specify nonzero elasticities, it adds behavioural responses to its tax-benefit calculations. For each simulated reform, the model first computes the effects of policy changes on income and tax rates. Then, it estimates three behavioural changes: how total income changes affect work, how marginal tax changes affect work hours, and how tax rates influence investment timing. Because each person’s earnings can affect household net income differently, we calculate marginal tax rates with respect to each of the top three earners, and apply each of their labour supply responses, separately. Finally, we recalculate taxes and benefits following the earnings and capital gains change.

## Comparing static and dynamic analysis

Here we demonstrate how incorporating behavioural responses affects policy analysis by examining a tax reform proposed by the UK government in October 2024: change to Capital Gains Tax. For a detailed analysis of this and other reforms proposed in the Autumn Budget, see [PolicyEngine's reform impact analysis](https://policyengine.org/uk/research/autumn-budget-2024-policy-choices).

In estimating the impacts of this reform, we model how individuals with capital gains respond to changes in their marginal tax rate. The table below compares the five-year revenue impacts under both static and dynamic scenarios.

| Reform                                          | Static revenue impact | Dynamic revenue impact | Relative change |
| :---------------------------------------------- | :-------------------- | :--------------------- | :-------------- |
| Basic rate to 18% Higher/additional rate to 24% | 21.5                  | 10.1                   | \-53%           |

## Conclusion

In this report, we present how PolicyEngine models three behavioural responses:

1. **Income effect for labour supply: \-0.05 elasticity** (a 10% increase to net income reduces work hours by 0.5%)
2. **Substitution effect for labour supply: 0.25 elasticity** (a 10% increase to the net marginal wage increases work hours by 2.5%)
3. **Capital gains response: \-0.7 elasticity** (a 10% increase in the marginal tax rate with respect to capital gains reduces capital gains by 7%)

While this report focuses on these three core elasticities, PolicyEngine is expanding its behavioural modelling capabilities. For instance, we developed responses to [employer National Insurance contributions](https://policyengine.org/uk/research/autumn-budget-24-employer-ni), indicating the extent to which employers pass on the burden to lower wages. Using the CGT reform as an example demonstrates the importance of these behavioural responses. PolicyEngine's flexibility allows users to adjust behavioural response assumptions such as labour elasticities and capital gains elasticity to analyse the impact of public policies.

[^1]: Chetty, R., Guren, A., Manoli, D., & Weber, A. (2011). Are Micro and Macro Labor Supply Elasticities Consistent? A Review of Evidence on the Intensive and Extensive Margins. American Economic Review, 101(3), 471–475.

[^2]: Saez, E., Slemrod, J., & Giertz, S. H. (2012). The Elasticity of Taxable Income with Respect to Marginal Tax Rates: A Critical Review. Journal of Economic Literature, 50(1), 3-50.

[^3]: Feldstein, M., Behavioural Responses to Taxation: Lessons from the Tax Reform Act of 1986, American Economic Review, 1995\.

[^4]: Burman, Leonard E., and William C. Randolph. "Measuring permanent responses to capital-gains tax changes in panel data." The American Economic Review (1994): 794-809.

[^5]: Dowd, Tim, and Robert McClelland. 2019\. "The Bunching of Capital Gains Realizations." National Tax Journal 72(2): 323-358.

[^6]: Auten, Gerald, and Charles Clotfelter. 1982\. "Permanent versus Transitory Tax Effects and the Realization of Capital Gains." Quarterly Journal of Economics 97(4): 613-632.

[^7]: U.S. Congress, House Committee on Financial Services, _The Future of Housing in America: A Comparison of the United Kingdom and United States Models of Affordable Housing_, hearing, 114th Congress, 2nd session, May 12, 2016\.

[^8]: Odean, T. (1999). Do investors trade too much? _American Economic Review_, 89(5), 1279-1298.

[^9]: Financial Expert. (n.d.). [A summary of the differences between UK and US investors](https://www.financial-expert.co.uk/differences-between-uk-and-us-investors/).

[^10]: [Tax Policy Center (2023)](https://taxpolicycenter.org/briefing-book/how-do-us-taxes-compare-internationally)



---

---
# Benefits uprating 2025/26
Slug: Benefit-uprating-25
Date: 2024-10-31 15:00:00
Authors: Vahid Ahmadi
Tags: uk, benefit, inflation
Description: PolicyEngine projects Labour's 1.7% benefits uprating would cost £2.5 billion, mainly benefiting lower-income households.

---

## Key findings

PolicyEngine estimates that the 1.7% benefits uprating for 2025/26:

- increases government costs by [£2.5 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=69807&mode=lite)
- lowers poverty by 1.8%
- raises net income for 45.9% of people

Labour's announcement follows the established pattern of annual benefits uprating in the Social Security Administration Act 1992\. Benefits and tax credits rose by [6.7%](https://commonslibrary.parliament.uk/research-briefings/cbp-9872/#:~:text=DWP%20benefits%20that%20are%20linked,by%208.5%25%20from%20April%202024.) in April 2024 (matching September-to-September CPI changes). Labour have confirmed they will implement a [1.7%](https://www.theguardian.com/society/2024/oct/16/surprise-fall-inflation-badly-timed-uk-benefit-recipients) increase in April 2025, matching CPI growth from September 2023 to September 2024\. This uprating will apply to various benefits, including Universal Credit, Attendance Allowance, Carer's Allowance, Income Support and Tax Credits. The increase fulfils the statutory requirement established by Section 150 of the [Social Security Administration Act 1992](https://www.legislation.gov.uk/ukpga/1992/5/section/150/enacted), which mandates that certain benefits must rise at least in line with inflation.

In this report, we analyse Labour's key proposals by modelling their impact on households. We present our estimated impacts of the 1.7% benefits uprating plan for 2025/26, providing a comprehensive view of its effects on households across the UK.

## Economic impact

### Budgetary impact

PolicyEngine compares the actual uprating plan (increasing by 1.7%), which is the responsibility of the UK government, with a scenario where benefits are frozen at their current level for the next year. The 1.7% uprating increases government costs by £2.5 billion.

### Distributional impact

Our analysis shows that the uprating provides larger relative benefits for low-income households: it raises the lowest income decile's net income by 0.8%, and the top decile's by less than 0.1%.

![](/images/posts/benefit_uprating/dist-income-effect.png)

Uprating would benefit around 45% of the population, disproportionately those in the bottom half of the income distribution. 0.5% of the population – entirely in the lowest income decile – would gain at least 5% of their net income.

![](/images/posts/benefit_uprating/win-losser.png)

### Poverty impact

The 1.7% benefits uprating reduces the total poverty rate (absolute, before housing costs) by 1.8% and the child poverty rate by 4.0%.

![](/images/posts/benefit_uprating/poverty-effect.png)

### Inequality impact

Our analysis measures the impact of the 1.7% benefits uprating on inequality through multiple metrics. The reduction in inequality is shown by a 0.27% decrease in the Gini index, with smaller income shares for the highest earners – the top 10% share falls by 0.14% and the top 1% share by 0.17%.

![](/images/posts/benefit_uprating/inequality-effect.png)

## Conclusion

Compared to leaving them fixed, uprating benefit levels by 1.7% for the 2025/26 fiscal year would cost £2.5 billion. It would benefit 45.9% of the population, disproportionately those in lower-income households, while lowering poverty by 1.8% and the Gini index of income inequality by 0.27%.



---

---
# Capital Gains Tax reforms in the Autumn Budget 2024
Slug: cgt-autumn-budget
Date: 2024-11-06 15:00:00
Authors: Vahid Ahmadi
Tags: uk, tax, featured
Description: PolicyEngine estimates that the UK's 2024 Capital Gains Tax reforms will raise £6.4 billion between 2025-2029.

---

The Autumn Budget 2024 includes substantial reforms to Capital Gains Tax (CGT), with Chancellor Rachel Reeves announcing rate increases across all tax bands. The changes raise the rates from 10% and 20% to 18% and 24%, respectively.

When accounting for behavioural responses, we project that these changes will raise £6.4 billion from 2025 to 2029\. In 2025 without behavioural responses, they will affect 1.2% of the population and reduce the Gini index of income inequality by 0.4%.

## Budgetary impacts

We project the CGT reforms will raise £6.4 billion from 2025 to 2029\.

| Fiscal Year   | 2024-25 | 2025-26                                                                                                                               | 2026-27                                                                                                                               | 2027-28                                                                                                                               | 2028-29                                                                                                                               | 2029-30                                                                                                                               | Total |
| :------------ | :------ | :------------------------------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------ | :---- |
| Revenue (£bn) | 0.0     | [1.0](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69739&region=uk&timePeriod=2025&baseline=1) | [1.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69739&region=uk&timePeriod=2026&baseline=1) | [1.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69739&region=uk&timePeriod=2027&baseline=1) | [1.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69739&region=uk&timePeriod=2028&baseline=1) | [1.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69739&region=uk&timePeriod=2029&baseline=1) | 6.4   |

These estimates are 29% less than HMT and 26% less than the OBR. These variations may stem from different assumptions about behavioural responses. In our model, we assume individuals will adjust their capital gains realisations with an elasticity of \-0.7 with respect to the marginal tax rate; neither HMT nor OBR specify their assumptions on this front.

| Source       | 2024-25 | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 | Total |
| ------------ | ------- | ------- | ------- | ------- | ------- | ------- | ----- |
| PolicyEngine | 0.0     | 1.0     | 1.2     | 1.4     | 1.4     | 1.4     | 6.4   |
| HM Treasury  | 0.1     | 1.4     | 1.4     | 1.4     | 2.2     | 2.5     | 9.0   |
| OBR          | 0.1     | 1.4     | 1.3     | 1.3     | 2.1     | 2.4     | 8.6   |

Assuming [no behavioural change](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69732&region=uk&timePeriod=2025&baseline=1), we project the change to generate £22.2 billion from 2025 to 2029\. While the OBR also provides estimates it describes as static, those account for changes in realisation behaviour, making them incomparable to our static results.

## Distributional impact

The CGT reforms affect 1.2% of the population, with impacts limited to the highest income decile. Within the top 10%, 5% see income losses above 5%, another 5% face losses under 5%, while 90% experience no change. The policy has no impact on income levels across the bottom nine deciles.

Our [distributional analysis](https://legacy.policyengine.org/uk/policy?focus=policyOutput.inequalityImpact&reform=69732&region=uk&timePeriod=2025&baseline=1) shows no change in poverty measures, while the Gini index falls by 0.4%. Across most of the income distribution (the bottom 90% of households), incomes remain unchanged.

![](/images/posts/cgt-autumn-budget-pic/cgt-win-loser.png)

Read more of PolicyEngine’s Autumn Budget 2024 coverage:

- [Employer National Insurance reforms](https://policyengine.org/uk/research/autumn-budget-24-employer-ni)
- [Private school VAT changes](https://policyengine.org/uk/research/vat-school-comparison)
- [Fuel Duty freeze](https://policyengine.org/uk/research/autumn-budget-24-fuel-duty)



---

---
# Autumn Budget policy choices
Slug: autumn-budget-2024-policy-choices
Date: 2024-10-24 16:30:00
Authors: Nikhil Woodruff
Tags: uk, autumn-budget, featured, policy
Description: PolicyEngine estimates that four reported tax reforms would raise £23 billion per year

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Image credit: The Labour Party*\n",
    "\n",
    "*See the full impact estimate for 2025 [here](https://legacy.policyengine.org/uk/policy?reform=68829&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=1).*\n",
    "\n",
    "\n",
    "## Key findings\n",
    "\n",
    "1. PolicyEngine estimates that four reported tax reforms to Income Tax, National Insurance, Capital Gains Tax and VAT would raise £23 billion in FY2025.\n",
    "2. Our model estimates that these reforms would reduce income inequality by 0.6%, and have no significant impact on the government’s absolute before-housing-costs poverty rate.\n",
    "\n",
    "\n",
    "## Background\n",
    "\n",
    "On 30th October, the Chancellor Rachel Reeves will announce proposals for the UK’s tax and spending decisions (and any changes to them) over the next five years in the first Autumn Budget of the new Labour government. [Media](https://www.bbc.co.uk/news/articles/cdxl1zd07l1o) [reports](https://www.theguardian.com/uk-news/2024/oct/17/budget-2024-uk-tax-raises-rachel-reeves) expect these decisions to include both existing manifesto commitments (VAT on private school fees and non-dom tax reform) as well as reforms not included in Labour’s last election manifesto (employer National Insurance and Capital Gains Tax reform).\n",
    "\n",
    "In this report, we outline PolicyEngine’s estimates of the household sector impacts of each of these four most reported-on policy reforms, and their combined impact if all are announced together.\n",
    "\n",
    "\n",
    "## Policy choices\n",
    "\n",
    "\n",
    "### Tax avoidance\n",
    "\n",
    "Labour says [in their manifesto](https://labour.org.uk/change/labours-fiscal-plan/) they would ‘close non-dom tax loopholes’ and ‘close the carried interest tax loophole’ as well as invest in reducing tax avoidance. They said this would raise on average £5.9 billion each year over the parliament in their manifesto. Due to limited information on the impact of this reform, we approximate it as a tax on earnings over £100,000.\n",
    "\n",
    "\n",
    "### Private school VAT\n",
    "\n",
    "In their manifesto, Labour also committed to levying VAT (as well as business rates) on private school fees from FY2025. We estimate this raises around £1.5 billion per year, assuming no behavioural responses, mostly from higher-income deciles. Read more detail about the policy in our recently-published report [here](https://legacy.policyengine.org/uk/research/school-vat).\n",
    "\n",
    "\n",
    "### Employer NICs\n",
    "\n",
    "The UK government is [reportedly](https://www.bbc.co.uk/news/articles/cly4leklk3qo) considering raising National Insurance Contributions (NICs) for employers, by levying NICs on employers' contributions to workers’ pensions. Currently employers pay 13.8% tax on earnings above around £9,500. We use a behavioural model that assumes 40% employee wage incidence, 30% consumer incidence and 30% capital incidence in the first year, rising to 70% employee wage incidence and 15% consumer-capital incidence by the fifth.\n",
    "\n",
    "\n",
    "### Capital Gains Tax\n",
    "\n",
    "Robert Peston of ITV [reports](https://x.com/Peston/status/1847000929913983451) that the Chancellor will raise the higher and additional rate of capital gains from 20% to 24%, raising ‘a few billion’. \n",
    "\n",
    "We impute capital gains to households in our microdata using administrative data published in CAGE Working Paper no. 465, Capital Gains and UK Inequality (Advani &Arun Advani, Andy Summers, 2020) ([here](https://warwick.ac.uk/fac/soc/economics/research/centres/cage/manage/publications/wp465.2020.pdf)). Due to absence of studies in the UK context, we borrow from [recent US literature](https://taxpolicycenter.org/sites/default/files/publication/165863/the_sensitivity_of_the_tax_elasticity_of_capital_gains_to_lagged_tax_rates_and_migration.pdf) to assume an elasticity of capital gains with respect to the marginal tax rate on capital gains income of -0.5.[^1]\n",
    "\n",
    "\n",
    "[^1]: We will publish an in-depth report detailing our capital gains methodology in the future.\n",
    "\n",
    "\n",
    "## Economic impacts\n",
    "\n",
    "PolicyEngine [estimates](https://legacy.policyengine.org/uk/policy?reform=68829&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=1) that these reforms combined would raise £25 billion per year over five years, with over half of the revenue impact from the employer NICs reform. The table below summarises these reforms’ impacts over the budget window (with the behavioural responses as stated previously).\n",
    "\n",
    "\n",
    "| Year | 2025 | 2026 | 2027 | 2028 | 2029 | 2025-29 |\n",
    "|------|------|------|------|------|------|---------|\n",
    "| Levy employer pension NICs | 14.1 | 13.8 | 13.2 | 12.6 | 12.9 | 66.6 |\n",
    "| Levy private school VAT | 1.5 | 1.5 | 1.5 | 1.6 | 1.6 | 7.7 |\n",
    "| Raise CGT to 24% | 1.6 | 1.9 | 2.0 | 2.3 | 2.3 | 10.1 |\n",
    "| Reduce tax avoidance | 5.9 | 5.9 | 5.9 | 5.9 | 5.9 | 29.5 |\n",
    "| **Total** | **[23.1](https://legacy.policyengine.org/uk/policy?reform=69049&focus=policyOutput.distributionalImpact.incomeDecile.relative&region=uk&timePeriod=2025&baseline=1)** | **23.1** | **22.6** | **22.4** | **22.7** | **113.9** |"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=Reduce tax avoidance<br>Decile=%{x}<br>Impact=%{y}<extra></extra>",
         "legendgroup": "Reduce tax avoidance",
         "marker": {
          "color": "#4C78A8",
          "pattern": {
           "shape": ""
          }
         },
         "name": "Reduce tax avoidance",
         "offsetgroup": "Reduce tax avoidance",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          13012253.120063782,
          822122.3548812866,
          6628.087516784668,
          5718719.044231415,
          11626170.525367737,
          1598769.6617965698,
          14278462.482940674,
          42283001.16581726,
          114404226.20637512,
          5696249498.772247
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=Levy private school VAT<br>Decile=%{x}<br>Impact=%{y}<extra></extra>",
         "legendgroup": "Levy private school VAT",
         "marker": {
          "color": "#F58518",
          "pattern": {
           "shape": ""
          }
         },
         "name": "Levy private school VAT",
         "offsetgroup": "Levy private school VAT",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          34622068.16183472,
          19866349.070915222,
          16637325.785709381,
          63643858.966973305,
          40506401.04219341,
          93347665.88846588,
          94060279.80747223,
          179738760.63454437,
          319683798.96165466,
          635810366.5480957
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=Levy employer pension NICs<br>Decile=%{x}<br>Impact=%{y}<extra></extra>",
         "legendgroup": "Levy employer pension NICs",
         "marker": {
          "color": "#E45756",
          "pattern": {
           "shape": ""
          }
         },
         "name": "Levy employer pension NICs",
         "offsetgroup": "Levy employer pension NICs",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          37566478.3089447,
          258559892.85049438,
          367331760.0690117,
          678500524.290266,
          887692716.7636237,
          1384953057.018219,
          2009641972.6995697,
          2052224977.0562515,
          2791688470.7457275,
          3675937549.9935913
         ],
         "yaxis": "y"
        },
        {
         "alignmentgroup": "True",
         "hovertemplate": "Reform=Raise CGT to 24%<br>Decile=%{x}<br>Impact=%{y}<extra></extra>",
         "legendgroup": "Raise CGT to 24%",
         "marker": {
          "color": "#72B7B2",
          "pattern": {
           "shape": ""
          }
         },
         "name": "Raise CGT to 24%",
         "offsetgroup": "Raise CGT to 24%",
         "orientation": "v",
         "showlegend": true,
         "textposition": "auto",
         "type": "bar",
         "x": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "xaxis": "x",
         "y": [
          447.51342010498047,
          -15.358901977539062,
          -2771.110050201416,
          879251.5545797348,
          -43548.71178197861,
          -81779.86475372314,
          -10952.139694213867,
          -8997.554916381836,
          197159.7639465332,
          1596946268.878601
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "annotations": [
         {
          "showarrow": false,
          "text": "0.1",
          "x": 1,
          "y": 85201247.1042633,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "0.3",
          "x": 2,
          "y": 279248348.9173889,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "0.4",
          "x": 3,
          "y": 383972942.83218765,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "0.7",
          "x": 4,
          "y": 748742353.8560505,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "0.9",
          "x": 5,
          "y": 939781739.6194029,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "1.5",
          "x": 6,
          "y": 1479817712.7037277,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "2.1",
          "x": 7,
          "y": 2117969762.8502884,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "2.3",
          "x": 8,
          "y": 2274237741.301697,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "3.2",
          "x": 9,
          "y": 3225973655.677704,
          "yshift": 15
         },
         {
          "showarrow": false,
          "text": "11.6",
          "x": 10,
          "y": 11604943684.192535,
          "yshift": 15
         }
        ],
        "barmode": "relative",
        "font": {
         "color": "black",
         "family": "Roboto Serif"
        },
        "height": 600,
        "images": [
         {
          "sizex": 0.15,
          "sizey": 0.15,
          "source": "https://raw.githubusercontent.com/PolicyEngine/policyengine-app-v2/main/app/public/assets/logos/policyengine/teal.png",
          "x": 1.1,
          "xanchor": "right",
          "xref": "paper",
          "y": -0.15,
          "yanchor": "bottom",
          "yref": "paper"
         }
        ],
        "legend": {
         "title": {
          "text": "Reform"
         },
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "modebar": {
         "bgcolor": "rgba(0,0,0,0)",
         "color": "rgba(0,0,0,0)"
        },
        "showlegend": true,
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "white",
              "width": 0.5
             },
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "#C8D4E3",
             "linecolor": "#C8D4E3",
             "minorgridcolor": "#C8D4E3",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "pattern": {
              "fillmode": "overlay",
              "size": 10,
              "solidity": 0.2
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "fillpattern": {
             "fillmode": "overlay",
             "size": 10,
             "solidity": 0.2
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "autotypenumbers": "strict",
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "white",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "#C8D4E3"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "white",
          "polar": {
           "angularaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           },
           "bgcolor": "white",
           "radialaxis": {
            "gridcolor": "#EBF0F8",
            "linecolor": "#EBF0F8",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "yaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           },
           "zaxis": {
            "backgroundcolor": "white",
            "gridcolor": "#DFE8F3",
            "gridwidth": 2,
            "linecolor": "#EBF0F8",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "#EBF0F8"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           },
           "bgcolor": "white",
           "caxis": {
            "gridcolor": "#DFE8F3",
            "linecolor": "#A2B1C6",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "#EBF0F8",
           "linecolor": "#EBF0F8",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "#EBF0F8",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Revenue impact of possible reforms by household income decile"
        },
        "width": 800,
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "tickvals": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
         ],
         "title": {
          "text": "Income decile"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Change in revenues (£ billion)"
         }
        }
       }
      }
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from policyengine_uk import Microsimulation\n",
    "from policyengine_core.reforms import Reform\n",
    "\n",
    "REDUCE_TAX_AVOIDANCE = {\n",
    "    \"gov.contrib.policyengine.budget.high_income_incident_tax_change\": {\n",
    "        \"2025-01-01.2030-12-31\": 5.9,\n",
    "    },\n",
    "}\n",
    "\n",
    "PRIVATE_SCHOOL_VAT = {\n",
    "    \"gov.contrib.labour.private_school_vat\": {\n",
    "        \"2025-01-01.2030-12-31\": 0.2,\n",
    "    }\n",
    "}\n",
    "\n",
    "EMPLOYER_NICS = {\n",
    "    \"gov.contrib.policyengine.employer_ni.exempt_employer_pension_contributions\": {\n",
    "        \"2025-01-01.2030-12-31\": False,\n",
    "    },\n",
    "    \"gov.contrib.policyengine.employer_ni.employee_incidence\": {\n",
    "        \"2025-01-01.2025-12-31\": 0.4,\n",
    "        \"2026-01-01.2026-12-31\": 0.5,\n",
    "        \"2027-01-01.2027-12-31\": 0.6,\n",
    "        \"2028-01-01.2028-12-31\": 0.7,\n",
    "        \"2029-01-01.2030-12-31\": 0.7,\n",
    "    },\n",
    "    \"gov.contrib.policyengine.employer_ni.consumer_incidence\": {\n",
    "        \"2025-01-01.2030-12-31\": 0.5,\n",
    "    },\n",
    "    \"gov.contrib.policyengine.employer_ni.capital_incidence\": {\n",
    "        \"2025-01-01.2030-12-31\": 0.5,\n",
    "    },\n",
    "}\n",
    "\n",
    "CGT = {\n",
    "    \"gov.hmrc.cgt.higher_rate\": {\n",
    "        \"2025-01-01.2030-12-31\": 0.24,\n",
    "    },\n",
    "    \"gov.hmrc.cgt.additional_rate\": {\n",
    "        \"2025-01-01.2030-12-31\": 0.24,\n",
    "    },\n",
    "    \"gov.simulation.capital_gains_responses.elasticity\": {\n",
    "        \"2025-01-01.2030-12-31\": -0.5,\n",
    "    },\n",
    "}\n",
    "\n",
    "baseline = Microsimulation()\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "decile = baseline.calculate(\"household_income_decile\", 2025).clip(1, 10)\n",
    "\n",
    "reform_labels = [\n",
    "    \"Reduce tax avoidance\",\n",
    "    \"Levy private school VAT\",\n",
    "    \"Levy employer pension NICs\",\n",
    "    \"Raise CGT to 24%\",\n",
    "]\n",
    "\n",
    "reforms = [\n",
    "    REDUCE_TAX_AVOIDANCE,\n",
    "    PRIVATE_SCHOOL_VAT,\n",
    "    EMPLOYER_NICS,\n",
    "    CGT,\n",
    "]\n",
    "\n",
    "df_reform = []\n",
    "df_decile = []\n",
    "df_value = []\n",
    "\n",
    "from tqdm import tqdm\n",
    "\n",
    "baseline_deciles = (\n",
    "    baseline.calculate(\"gov_balance\", 2025).groupby(decile).sum()\n",
    ")\n",
    "last_deciles = None\n",
    "\n",
    "for i in range(len(reforms)):\n",
    "    combined_reform = {}\n",
    "    for j in range(i + 1):\n",
    "        combined_reform.update(reforms[j])\n",
    "\n",
    "    reform = Reform.from_dict(combined_reform)\n",
    "\n",
    "    reformed = Microsimulation(reform=reform)\n",
    "\n",
    "    deciles = reformed.calculate(\"gov_balance\", 2025).groupby(decile).sum()\n",
    "\n",
    "    if last_deciles is None:\n",
    "        last_deciles = baseline_deciles\n",
    "\n",
    "    decile_change = deciles - last_deciles\n",
    "\n",
    "    last_deciles = deciles\n",
    "\n",
    "    df_reform.extend([reform_labels[i]] * 10)\n",
    "    df_decile.extend(list(range(1, 11)))\n",
    "    df_value.extend(decile_change.values)\n",
    "\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Reform\": df_reform,\n",
    "        \"Decile\": df_decile,\n",
    "        \"Impact\": df_value,\n",
    "    }\n",
    ")\n",
    "\n",
    "import plotly.express as px\n",
    "from policyengine_core.charts import format_fig\n",
    "\n",
    "fig = px.bar(\n",
    "    df,\n",
    "    x=\"Decile\",\n",
    "    y=\"Impact\",\n",
    "    color=\"Reform\",\n",
    "    color_discrete_sequence=px.colors.qualitative.T10,\n",
    ").update_layout(\n",
    "    xaxis_title=\"Income decile\",\n",
    "    yaxis_title=\"Change in revenues (£ billion)\",\n",
    "    title=\"Revenue impact of possible reforms by household income decile\",\n",
    "    showlegend=True,\n",
    "    legend_title=\"Reform\",\n",
    "    xaxis_tickvals=list(range(1, 11)),\n",
    ")\n",
    "\n",
    "# Add a label to each bar combination with the total revenue\n",
    "\n",
    "for i in range(1, 11):\n",
    "    fig.add_annotation(\n",
    "        x=i,\n",
    "        y=df[df[\"Decile\"] == i][\"Impact\"].sum(),\n",
    "        text=f\"{df[df['Decile'] == i]['Impact'].sum()/1e9:,.1f}\",\n",
    "        showarrow=False,\n",
    "        # offset down a bit\n",
    "        yshift=15,\n",
    "    )\n",
    "\n",
    "format_fig(fig)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We estimate that these reforms would reduce the Gini coefficient of income inequality by 0.6%. 47% of the revenue impact comes from the richest income decile (mostly from the reforms other than employer NICs). \n",
    "\n",
    "The Employer NICs reform is mostly flat (as a percentage of income) across the income distribution in FY2025, because of the lower employee incidence. Assuming a higher consumption/capital incidence for this reform creates a more regressive (with respect to income) impact, while assuming a higher employee incidence moves the impact to be progressive along income deciles. The 40/30/30 split in the first year approximately balances these out. The Times [reports](https://www.thetimes.com/uk/politics/article/rachel-reeves-to-protect-public-sector-workers-from-tax-raid-0n25hxkgg) that the Treasury estimates the employer NICs reform would raise £15.4 billion in FY2025 (our estimate is 7% lower).\n",
    "\n",
    "Absolute, before-housing-costs poverty as measured by the government’s Households Below Average Income definition does not change, because none of the reforms except for the wage incidence of employer NICs affect the definition of income used for this metric.\n",
    "\n",
    "\n",
    "## Conclusion\n",
    "\n",
    "PolicyEngine estimates that these four reforms would raise £23 billion per year over the five-year budget window. We also estimate that these would be progressive in that they would reduce the Gini coefficient of income inequality, but that they would not change the government’s central poverty rates on their own.\n",
    "\n",
    "\n",
    "## Appendix: behavioural responses\n",
    "\n",
    "For our estimates of the impacts of reforms to Capital Gains Tax (CGT) and employer National Insurance, we assume that individuals with capital gains respond to changes in their marginal tax rate and employers respond to changes in their tax liability by adjusting employee wages. We do not account for behavioural responses to private school VAT or reduced tax avoidance measures.\n",
    "\n",
    "The table below shows the impact of these behavioural responses on the total five-year revenue impact of each provision, and in total. Overall, we estimate that behavioural responses to these tax reforms would lower the revenue impact by around 25%.\n",
    "\n",
    "\n",
    "| Reform | Static revenue impact | Dynamic revenue impact | Absolute change | Relative change |\n",
    "|--------|---------------------|----------------------|-----------------|-----------------|\n",
    "| Levy employer pension NICs | 90.3 | 66.6 | -23.7 | -26% |\n",
    "| Levy private school VAT | 7.7 | 7.7 | 0 | 0% |\n",
    "| Raise CGT to 24% | 21.5 | 10.1 | -11.4 | -53% |\n",
    "| Reduce tax avoidance | 5.9 | 5.9 | 0 | 0 |\n",
    "| **Total** | **149.0** | **113.9** | **-35.1** | **-24%** |"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# Levying employer National Insurance on pension contributions
Slug: autumn-budget-2024-employer-nic-pension-contributions
Date: 2024-10-26 09:00:00
Authors: Nikhil Woodruff
Tags: uk, autumn-budget, policy
Description: PolicyEngine estimates the now-scrapped Autumn Budget reform would have raised between £10 and £18 billion per year, depending on how employers pass it on to wages.

---

The Times [reports](https://www.thetimes.com/uk/politics/article/rachel-reeves-to-increase-national-insurance-employers-nhs-cfr73kh2g) that the UK government has scrapped [previously](https://www.bbc.co.uk/news/articles/cly4leklk3qo)\-[reported](https://www.reuters.com/world/uk/uk-employers-sound-alarm-over-possible-social-security-hike-2024-10-15/) plans to levy NICs on employers' contributions to workers’ pensions. This report examines the potential impacts using PolicyEngine's microsimulation model, considering the effect on income tax and benefits if employers respond by reducing wages. We find that it would have raised about £18 billion per year if employers pass on the full cost to prices, or £10 billion if they pass it on entirely to workers immediately.

# The proposal

According to the BBC and others, the Chancellor considered removing the current exemption for employer pension contributions from employer NICs. Currently, employers are liable for NICs on employee compensation, but not on employer contributions to pension schemes. HMRC estimates that this relief [cost](https://www.gov.uk/government/statistics/main-tax-expenditures-and-structural-reliefs) £15.4bn in FY 2022-23.

# Economic impact

We modelled two scenarios bookmarking the range of potential impacts:

1\. Static assumption: no changes occur in employment incomes. Employers pay the additional NICs they are liable for. We assume that the increased employer NIC costs are passed on to prices uniformly.  
2\. Fixed employer cost assumption: employers immediately keep total employment costs fixed by reducing wages such that the new wage plus employer NICs liability is equal to the prior total. There is no extra employer cost to distribute.

## Household example

To illustrate the second approach, the table below shows the calculated impacts of the reform on a worker with a £40,000 annual salary and £4,000 in employer pension contributions.

| Variable                             | Current law | No wage change | Fixed employer cost | No wage change \- current law | Fixed employer cost \- current law |
| :----------------------------------- | :---------- | :------------- | :------------------ | :---------------------------- | :--------------------------------- |
| Wages                                | £40,000     | £40,000        | £39,515             | £0                            | \-£485                             |
| Employer pension contribution        | £4,000      | £4,000         | £4,000              | £0                            | £0                                 |
| Employer NI on wages                 | £4,245      | £4,245         | £4,178              | £0                            | \-£67                              |
| Employer NI on pension contributions | £0          | £552           | £552                | £552                          | £552                               |
| Employer cost                        | £48,245     | £48,797        | £48,245             | £552                          | £0                                 |
| Employee tax                         | £7,839      | £7,839         | £7,703              | £0                            | \-£136                             |
| Total taxes                          | £12,084     | £12,636        | £12,433             | £552                          | £349                               |

Under the ‘no wage change’ assumption, the government receives an extra £552 from the employer. We allocate this tax burden to individuals according to consumption, under the assumption that firms pass on employer NICs in higher prices.

Under the ‘fixed employment cost’ assumption, the government receives £552 from the employer, who has paid for it by reducing the worker’s wages £485 and therefore reducing the rest of their employer NI liability by £67. And additionally, the employee now pays £136 less in Income Tax and employee National Insurance because of their lower salary. Overall, the government now nets out £349 from these changes, which is 37% lower than if the employer had passed on the costs by (successfully) raising prices.

## Economy

We apply this logic to all of the roughly 100,000 households in our representative microdata, aggregating the changes in tax liabilities and benefit entitlements. Under the static model, we estimate that revenues rise by around £18 billion per year, raising £90 billion over five years.

| Year        | Revenue impact (employer NICs) | Revenue impact (other) | Revenue impact                                                                                                                         | Wages |
| :---------- | :----------------------------- | :--------------------- | :------------------------------------------------------------------------------------------------------------------------------------- | :---- |
| 2025        | 17.2                           | 0                      | [17.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69356&region=uk&timePeriod=2025&baseline=1) | 0     |
| 2026        | 17.7                           | 0                      | [17.7](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69356&region=uk&timePeriod=2026&baseline=1) | 0     |
| 2027        | 18.1                           | 0                      | [18.1](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69356&region=uk&timePeriod=2027&baseline=1) | 0     |
| 2028        | 18.4                           | 0                      | [18.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69356&region=uk&timePeriod=2028&baseline=1) | 0     |
| 2029        | 18.9                           | 0                      | [18.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69356&region=uk&timePeriod=2029&baseline=1) | 0     |
| **2025-29** | **90.3**                       | **0**                  | **90.3**                                                                                                                               | **0** |

If employers pass on NICs in the form of reduced wages, we estimate that employer NIC revenues rise by around £15 billion per year, but are offset by on average £5 billion per year in personal tax liabilities and benefit entitlements as a result of the (average) £15 billion in wage reductions.

Overall, this raises £9.6 billion in 2025, totalling £50 billion over five years.

| Year        | Revenue impact (Employer NICs) | Revenue impact (other) | Revenue impact                                                                                                                         | Wages      |
| :---------- | :----------------------------- | :--------------------- | :------------------------------------------------------------------------------------------------------------------------------------- | :--------- |
| 2025        | 15.1                           | \-5.5                  | [9.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69355&region=uk&timePeriod=2025&baseline=1)  | \-15.2     |
| 2026        | 15.6                           | \-5.8                  | [9.8](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69355&region=uk&timePeriod=2026&baseline=1)  | \-15.7     |
| 2027        | 15.9                           | \-6.0                  | [9.9](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69355&region=uk&timePeriod=2027&baseline=1)  | \-16.0     |
| 2028        | 16.2                           | \-6.1                  | [10.1](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69355&region=uk&timePeriod=2028&baseline=1) | \-16.3     |
| 2029        | 16.6                           | \-6.3                  | [10.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69355&region=uk&timePeriod=2029&baseline=1) | \-16.7     |
| **2025-29** | **79.4**                       | **\-29.7**             | **49.7**                                                                                                                               | **\-79.9** |

## Employee pass-through sensitivity

Our assumption that employers pass on some fraction of the increased payroll costs is based upon [economic](https://www.cbo.gov/system/files/2021-06/57089-Payroll-Taxes.pdf) [research](https://www.sciencedirect.com/science/article/pii/S0047272718300926) suggesting that employers often pass on the cost of increased payroll taxes to employees through lower wages or reduced hiring. Our model can vary this assumption: for example, we could assume that employers reduce wages by 50% of the distance to the fixed-cost wage, or any other fraction. The chart below shows the resultant budgetary impacts in FY 2025 under five simulated employee incidence shares: 0%, 25%, 50%, 75% and 100%. As expected, this effect is effectively linear. Revenue impacts decrease as employee incidence increases, because lower incomes push up costs by increasing benefit spending and decreasing tax liabilities.

![](/images/posts/autumn-budget-2024-employer-nic-pension-contributions/revenue-impact-of-increasing-employer-ni-by-employee-incidence.png)

# Conclusion

The potential change to levy employer NICs on pension contributions could increase government revenue, but the actual impact depends on how employers respond. If employers absorb the cost or pass it on to prices, the revenue gain could be as high as £18 billion per year. However, if employers respond by reducing wages, the net revenue gain could fall 45% to around £10 billion per year, due to offsetting effects on personal taxes and benefits.



---

---
# Employer National Insurance reforms in the Autumn Budget 2024
Slug: autumn-budget-24-employer-ni
Date: 2024-10-30 16:30:00
Authors: Nikhil Woodruff
Tags: uk, autumn-budget, policy, featured
Description: PolicyEngine projects the reforms to employer NI would raise £23 billion in 2025 and affect two thirds of people.

---

_Credit: World Economic Forum/Walter Duerst_

[See the full impact on PolicyEngine here.](https://legacy.policyengine.org/uk/policy?reform=69728&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=1)

The Chancellor Rachel Reeves has announced reforms to employer National Insurance (NI) contributions, marking the most substantial revenue-raising measure in the Autumn Budget 2024. The changes include raising the main rate from 13.8% to 15.0% while simultaneously lowering the Secondary Threshold at which employers begin contributing from £9,100 to £5,000 per year. Additionally, Reeves has raised the [Employment Allowance](https://www.gov.uk/claim-employment-allowance) from £5,000 to £10,000 and eliminated its cap. This analysis focuses on the rate rise and threshold reduction.

## The reforms

Employers currently pay NICs of 13.8% on employee earnings above £175 per week (£9,100 per year). Last week, The Times reported that the Chancellor was expected to raise the employer NI rate by “between one and two percentage points”, and “make a ­’significant’ cut to the earnings ­thresholds at which employers start making national insurance contributions.” Reeves did so, increasing the rate by 1.2p to 15.0%, and lowering the threshold to £5,000 per year.

The Employment Allowance is a tax relief for small businesses that reduces National Insurance liabilities, available to companies whose National Insurance payments were below £100,000 in the previous tax year.

## Methodology notes

As I wrote in the [Institute for Economic Affairs blog](https://iea.org.uk/publications/raising-employer-nic-in-the-autumn-budget/) last week, the extent to which employers pass on NIC rises to workers in lower wages can affect revenues by up to a factor of two, due to interactions with tax and benefit changes. In line with the [empirical literature](https://link.springer.com/article/10.1007/s13209-012-0091-x), we assume that employers pass on 40% of the NIC change in the first year, rising 10 percentage points per year up until stabilising at 70% by 2028.

## UK impacts

Using PolicyEngine's open-source model, we estimate both the budgetary and distributional impacts of these NI changes. Our analysis incorporates behavioural responses, though we also provide static estimates for comparison with official figures.

### Budgetary impact

We project that the employer NI reforms will raise £108.4 billion over five years when accounting for behavioural responses. This represents the largest revenue source among the Budget's major tax changes. The yearly breakdown shows:

| Fiscal year   | 2024-25 | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 | Total |
| ------------- | ------- | ------- | ------- | ------- | ------- | ------- | ----- |
| Revenue (£bn) | 0.0     | 23.3    | 22.4    | 21.3    | 20.3    | 21.1    | 108.4 |

The declining revenue profile reflects our modelling of behavioural responses, particularly the increasing wage pass-through from employers to employees over time. Without these behavioural effects, we estimate the reform would raise £147.0 billion - nearly £40 billion more.

### Comparison with official estimates

HM Treasury and the Office for Budget Responsibility (OBR) do not publish budgetary impact estimates of the reforms to the rate and threshold on their own, but they do estimate the combined impact with two other reforms: increasing the [Employment Allowance](https://www.gov.uk/claim-employment-allowance) from £5,000 to £10,000 and removing the Employment Allowance cap. We include these estimates for reference. HM Treasury’s static estimate of the combined policies is £122.3 billion over five years (our static estimate of just the threshold and rate changes is £147.0 billion). The OBR’s dynamic estimate of the combined policies is £79.9 billion, while our estimate of the reduced subset is £108.4 billion.

Note that we also use different assumptions about the incidence of the tax reform on employee wages. We assume that 40% of the incidence is born by wages in 2025, rising 10 percentage points per year before stabilising at 70% in 2028, while the OBR assumes that it flows 100% to real wages in the medium term. HMT does not specify its behavioural assumptions.

#### Static analysis comparison

_All figures in £ billions_

| Source       | 2024-25 | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 | Total |
| ------------ | ------- | ------- | ------- | ------- | ------- | ------- | ----- |
| PolicyEngine | 0.0     | 28.4    | 28.8    | 29.2    | 29.7    | 30.9    | 147.0 |
| HM Treasury  | 0.0     | 23.8    | 23.7    | 24.2    | 24.9    | 25.7    | 122.3 |
| OBR          | 0.0     | 23.9    | 24.3    | 24.7    | 25.6    | 26.4    | 124.9 |

#### Dynamic analysis comparison

_All figures in £ billions_

| Source       | 2024-25 | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 | Total |
| ------------ | ------- | ------- | ------- | ------- | ------- | ------- | ----- |
| PolicyEngine | 0.0     | 23.3    | 22.4    | 21.3    | 20.3    | 21.1    | 108.4 |
| OBR          | 0.0     | 18.3    | 14.6    | 15.2    | 15.7    | 16.1    | 79.9  |

### Distributional impacts

PolicyEngine estimates that the reforms to employer NI will reduce net income by between 0.1 and 0.6 percent among household income deciles, with the impact strongest for the upper middle of the distribution.

![Decile impact](/images/posts/autumn-budget-24-employer-ni/decile.png)

The reforms are projected to affect two thirds of people, and over 90% of the top three income deciles. 94% of the lowest income decile is unaffected by the tax reforms.

![Winners and losers](/images/posts/autumn-budget-24-employer-ni/winners.png)

PolicyEngine estimates no significant (&lt;1%) change to before-housing-costs absolute poverty or income inequality.



---

---
# Fuel duty reforms in the Autumn Budget 2024
Slug: autumn-budget-24-fuel-duty
Date: 2024-10-30 17:30:00
Authors: Nikhil Woodruff
Tags: uk, autumn-budget, policy, featured
Description: PolicyEngine projects the reforms to fuel duty will cost £2.4 billion in 2025.

---

_[See the full impact on PolicyEngine here.](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=69734&region=uk&timePeriod=2025&baseline=1)_

Chancellor Rachel Reeves today confirmed that duty will remain frozen at £0.5295 per litre for FY 2025, before rising with retail price inflation in future years, continuing a policy approach that has been maintained for several years.

## UK impacts

Using PolicyEngine's open-source model, we analyse this freeze's fiscal and distributional implications.

### Budgetary impact

We project the fuel duty freeze will reduce revenue by £6.4 billion over five years, with the largest impact in the first year:

| Fiscal Year   | 2024-25 | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 | Total |
| ------------- | ------- | ------- | ------- | ------- | ------- | ------- | ----- |
| Revenue (£bn) | 0.0     | -2.4    | -1.0    | -1.0    | -1.0    | -1.0    | -6.4  |

The larger initial impact reflects the difference between the freeze and previously planned increases, while subsequent years reflect the revenue impact of the lagged inflation increases. We assume no behavioural responses in this estimate.

### Comparison with official estimates

Our estimates deviate by 3% with official projections. HM Treasury forecasts a £6.6 billion revenue reduction, while the OBR similarly projects a £6.6 billion cost - both very close to our £6.4 billion estimate.

The small variations between estimates may stem from slightly different assumptions about fuel consumption patterns or behavioural responses (we assume none), but the overall alignment suggests broad agreement about the fiscal implications of the freeze.

### Distributional impact

We estimate this policy would raise net incomes by up to 0.5% across the income distribution. The lowest income decile sees a rise of 0.5%, and higher income deciles see a lower rise.

![Decile impacts](/images/posts/autumn-budget-24-fuel-duty/decile.png)

We estimate no impact on the absolute poverty rate, but a slight (0.2%) reduction in income inequality.

## Methodology notes

Our analysis employs PolicyEngine's open-source model, examining the direct impact of the duty freeze. We assume no behavioural responses for these estimates.



---

---
# Nuffield Foundation awards £250k to enhance PolicyEngine UK
Slug: uk-nuffield-grant
Date: 2024-12-19 14:00:00
Authors: Max Ghenis
Tags: uk, featured
Description: Grant will support expanding and localising tax-benefit microsimulation capabilities.

---

PolicyEngine has received a [£251,296 grant](https://www.nuffieldfoundation.org/project/enhancing-localising-and-democratising-tax-benefit-policy-analysis) from the Nuffield Foundation to enhance our UK tax-benefit microsimulation model. The one-year project will improve the comprehensiveness, accuracy, and accessibility of PolicyEngine UK, expanding its capabilities while growing its user community.

The funding will support several major expansions to PolicyEngine UK's modelling capabilities, including:

- Creation of representative micro-datasets for each local authority and constituency
- Integration of all childcare subsidies and major public service spending, including education, NHS, adult social care, and travel subsidies at the household level
- Development of an open dashboard validating PolicyEngine's outputs against other microsimulation models
- Implementation of user-centric, AI-capable design improvements

"Tax-benefit microsimulation is essential for understanding the impacts of fiscal policy, yet most models are proprietary or expensive," said Max Ghenis, CEO of PolicyEngine. "With the Nuffield Foundation's support, we'll make these tools more comprehensive and accessible to inform critical policy discussions across the UK."

The project includes extensive community engagement through training workshops and a user symposium, helping policy professionals and other stakeholders leverage PolicyEngine's capabilities. This builds on PolicyEngine's existing adoption by think tanks, academics, and parliamentarians.

PolicyEngine's enhanced UK model will remain free and open-source, advancing our mission to democratise policy analysis tools. Organisations interested in using or contributing to PolicyEngine can learn more at [policyengine.org/uk](policyengine.org/uk).



---

---
# New AI feature helps people understand their taxes and benefits
Slug: uk-household-ai
Date: 2024-12-26 09:00:00
Authors: Anthony Volk
Tags: uk, featured, ai
Description: We’re applying large language models to clarify complex policy rules.

---

PolicyEngine has developed a new artificial intelligence feature that transforms complex tax and benefit calculations into clear, accessible explanations. This innovation emerged from our participation in the Georgetown Beeck Center’s [Policy2Code Challenge](https://digitalgovernmenthub.org/get-involved/policy2code/) with a central question: How can we help users better understand their tax and benefit eligibility?

<center>[Interactive: fnuDyLKpt90]</center>

Users frequently encounter intricate calculations spanning multiple programmes, each with distinct thresholds, phase-outs, and dependencies. Our solution combines PolicyEngine’s open-source rules engine with artificial intelligence to explain these calculations in plain language, building on our [previous work applying AI to policy analysis](https://policyengine.org/uk/research/gpt-analysis).

# Technical architecture

The system integrates PolicyEngine’s tax-benefit rules with Anthropic’s Claude 3.5 Sonnet API. When calculating programme amounts like Universal Credit or Income Tax, PolicyEngine processes thousands of intermediate calculations involving household income, deductions, and other eligibility factors. Our new explanation system passes these complex intermediate calculations to the AI system, which generates natural language explanations.

For example, consider [an individual earning £15,000](https://legacy.policyengine.org/uk/household?focus=householdOutput.netIncome&household=50185). PolicyEngine calculates that they pay £486 in Income Tax. Users can now click a tooltip followed by an “**Explain with AI ✨**” button to receive a comprehensive explanation of this amount, including the Personal Allowance and potential changes that could affect their tax.

The AI system analyses both final outcomes and the intermediate calculations contributing to them. Many variables in PolicyEngine’s system involve dozens of intermediate steps, calculated at both monthly and annual levels. This new feature makes these calculation chains transparent and comprehensible.

# Applications and impact

This explanation tool serves diverse needs across the policy ecosystem. Whether you’re a household trying to understand your taxes and benefits, a professional analysing complex policy interactions, or a researcher exploring programme mechanics, the system breaks down intricate calculations into clear explanations.

Following PolicyEngine’s existing policy analysis framework, the explanations adapt to different audiences, ranging from simplified overviews to detailed technical analyses. This flexibility makes complex policy calculations accessible while preserving the depth needed for technical users.

# Development roadmap

Having launched this feature in the PolicyEngine web app, we will extend it to [API](https://legacy.policyengine.org/uk/api) customers in Q1 2025. PolicyEngine welcomes feedback on improving accessibility across user groups as we continue development.

---

_Max Ghenis, Pavel Makarchuk, Rachel Lawrie, and Li-Heng Pan also contributed to this feature._



---

---
# PolicyEngine UK in 2024: A year in review
Slug: uk-year-in-review-2024
Date: 2024-12-28 09:00:00
Authors: Max Ghenis, Nikhil Woodruff
Tags: uk, year-in-review, featured
Description: From AI-powered analysis to election impact, we transformed policy research through technology.

---

In 2024, PolicyEngine UK made significant strides in democratising policy analysis through technological innovation and comprehensive coverage of major policy developments. Together with our [achievements in the US](https://policyengine.org/us/research/us-year-in-review-2024), we've expanded the frontier of evidence-based policymaking on both sides of the Atlantic. Here’s a detailed look at our achievements and impact this year.

<center>[Interactive: 1JAjg_sBZSs]</center>

## Platform evolution

Our platform underwent major technological advances to enhance both capability and accessibility:

### Behavioural response modelling

We introduced sophisticated [behavioural response modelling](https://policyengine.org/uk/research/behavioural-responses) for both labour supply and capital gains, enabling more nuanced analysis of how policy changes influence individual economic decisions. This advancement allows users to better understand the dynamic effects of tax and benefit reforms.

### AI-powered explanations

Our new [AI-powered tax and benefit explanations](https://policyengine.org/uk/research/uk-household-ai) break down complex calculations into clear, understandable language. This feature makes policy analysis more accessible to users regardless of their technical background.

![](https://cdn-images-1.medium.com/max/2000/0*JlUblY7SyFZ-6W-2)

### Enhanced user experience

The introduction of user accounts now allows researchers and policy analysts to save and track their policy simulations over time, facilitating more comprehensive longitudinal analysis.

## Policy analysis impact

### Election year coverage

In preparation for the election, we provided detailed analysis of major party manifestos:

- [Labour](https://policyengine.org/uk/research/labour-2024-manifesto)

- [Conservatives](https://policyengine.org/uk/research/conservative-2024-manifesto)

- [Liberal Democrats](https://policyengine.org/uk/research/lib-dem-2024-manifesto)

Our innovative [manifesto comparison calculator](https://policyengine.org/uk/2024-manifestos) enabled citizens to understand both personal and societal impacts of each party’s platform.

![](https://cdn-images-1.medium.com/max/2198/0*dsVB47oKiySshCUP)

### Budget analysis

We delivered comprehensive analysis of both major fiscal events:

Our [Spring Budget 2024](https://policyengine.org/uk/research/uk-2024-spring-budget) assessment covered:

- National Insurance reforms

- High Income Child Benefit Charge adjustments

- Fuel duty impact analysis

For the Autumn Budget, we examined:

- [Changes to employer National Insurance](https://policyengine.org/uk/research/autumn-budget-24-employer-ni)

- [Capital Gains Tax reforms](https://policyengine.org/uk/research/cgt-autumn-budget)

- [Private school VAT implementation](https://policyengine.org/uk/research/vat-school-comparison)

- [Fuel duty freeze continuation](https://policyengine.org/uk/research/autumn-budget-24-fuel-duty)

![](https://cdn-images-1.medium.com/max/2000/0*uWZp_57V9_wILFjm)

## Future developments

![](https://cdn-images-1.medium.com/max/2000/0*9jZJm9_IHxclHfdA)

With [support from the Nuffield Foundation](https://policyengine.org/uk/research/uk-nuffield-grant), we’re embarking on several initiatives to further enhance PolicyEngine UK in 2025:

- Creating representative micro-datasets for each local authority and constituency

- Integrating childcare subsidies and public service spending analysis

- Developing an open dashboard for model validation

- Continuing [monthly training sessions](https://us06web.zoom.us/meeting/register/uAPu44gCRZuXJv7lZvM0GQ) we started in the fall

![](https://cdn-images-1.medium.com/max/2592/0*Zssa4z97z_5Ye5Ws)

## Learn more

Watch our [end-of-year webinar ](https://www.youtube.com/watch?v=1JAjg_sBZSs)for a comprehensive review of our achievements and platform capabilities. Visit [policyengine.org](https://legacy.policyengine.org) to explore our tools and contribute to evidence-based policy discussions.



---

---
# Exempting young children from the two-child limit
Slug: young-child-exemption-two-child-limit
Date: 2025-03-06 00:00:00
Authors: Vahid Ahmadi, Pavel Makarchuk
Tags: uk, policy, featured
Description: Analysis of the potential impact of limiting the two-child limit to families with children under 5 years old.

---

The Guardian [reports](https://www.theguardian.com/society/2025/feb/26/parents-under-fives-could-be-exempted-two-child-benefit-cap-uk) that UK ministers are considering exempting young children from the two-child limit. In this report, we simulate the effect of this policy, which affects both Universal Credit (UC) and the Child Tax Credit (CTC).

# Current policy implementation

The two-child limit currently applies to:

- Universal Credit child elements
- Child Tax Credit child elements

By default, families can only claim these benefits for their first two children, with some exceptions:

1. Children born before April 6, 2017 are exempt from the limit
2. Multiple births (e.g., twins or triplets) where only one child would take the family over the two-child limit
3. Children adopted from local authority care
4. Children living with family or friends (kinship care)
5. Children born as a result of non-consensual conception

PolicyEngine currently models the date-based exemption (children born before April 2017) and does not model the other exemption conditions.

# Reforms reportedly under consideration

The Guardian states:

> _Ministers are trying to find ways to alleviate the impact of the two-child limit for universal credit or child tax credit, which was imposed by the Conservatives in 2017, without spending £3.6bn to remove it entirely, according to those briefed on the discussions._

> _Among the options is applying the limit only to those with children who are five and over, exempting parents of disabled children, exempting parents in work and increasing child benefit payments for parents of young children. A separate proposal to move to a three-child limit has also been discussed, but is understood not to be under serious consideration._

We model the first of these options: exempting parents of children under 5 years old from the two-child limit. We assume this age exemption applies to the family as a whole: if any child is under the threshold, all children are exempt. The exemption adds to existing exemptions (e.g., children born before April 2017 are unaffected).

# Economic impact of the reform

Using PolicyEngine’s microsimulation model, we estimate that exempting parents of children under 5 years old from the two-child limit would cost [£504 million](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=77114&region=uk&timePeriod=2025&baseline=1) in 2025: [£480 million](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=77113&region=uk&timePeriod=2025&baseline=1) from UC and [£25 million](https://legacy.policyengine.org/uk/policy?reform=77112&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=1) from the CTC.

The exemption would [reduce overall poverty by 0.3%](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact.regular.byAge&reform=77113&region=uk&timePeriod=2025&baseline=1) and child poverty by 0.6%. It would also reduce the Gini index of income inequality by 0.09%. 5% of Britons would benefit from the reform, with those in the fifth income decile most likely to gain.

We invite users to experiment with other age thresholds for this exemption in the [PolicyEngine interface](https://legacy.policyengine.org/uk/policy?focus=gov.contrib.two_child_limit.age_exemption.universal_credit&reform=77113&region=uk&timePeriod=2025&baseline=1).



---

---
# The impact of Personal Independence Payment, and freezing its level in 2025
Slug: pip-and-freeze
Date: 2025-03-11
Authors: Nikhil Woodruff
Tags: uk, policy, featured
Description: How the disability benefit, and one reform the government is reportedly considering, affect the UK household sector.

---

The UK provides [Personal Independence Payment](https://www.gov.uk/pip) (PIP) is a government benefit paying support to individuals who have long-term physical or mental health conditions or disabilities. News outlets have [reported](https://www.itv.com/news/2025-03-07/government-to-make-6bn-welfare-savings-with-benefits-shake-up) that the UK government plans to reform the requirements to claim PIP, including potential changes to eligibility criteria, assessment processes, or payment rates.

# How PIP works

To be eligible for PIP, claimants must be between the ages of 16 and state pension age, have a long-term physical or mental health condition or disability expected to last at least 12 months, and face difficulties performing everyday tasks or moving around. The Department for Work and Pensions, which administers the benefit, assesses eligibility through a points-based system evaluating the claimant’s ability to manage daily activities and mobility. The program does not vary payments by income.

# How PIP affects the UK

In 2025 and assuming our [standard behavioural responses](https://policyengine.org/uk/research/behavioural-responses), we [estimate](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&baseline=78633&timePeriod=2025&region=uk) that the government will spend £30 billion on PIP payments, affecting the household incomes of 10.3% of people. These payments increase the incomes of the bottom half of the income distribution by more than 1%, and increase the income of the lowest income decile by 17%.

![Impact by decile](/images/posts/pip-and-freeze/image_1.png)

We estimate that PIP [lowers](https://legacy.policyengine.org/uk/policy?focus=policyOutput.povertyImpact.regular.byAge&reform=1&baseline=78633&timePeriod=2025&region=uk) the absolute, before housing costs (BHC) poverty rate by 1.3pp (884,000 people), and the deep absolute BHC poverty rate by 0.5pp (340,000 people).

![Poverty impact](/images/posts/pip-and-freeze/image_2.png)

We estimate that PIP increases (by over 5%) the net income for 10% of the population, and around 23% of the lowest income decile.

![Outcomes by decile](/images/posts/pip-and-freeze/image_3.png)

By applying [our standard behavioural assumptions](https://policyengine.org/uk/research/behavioural-responses), we estimate that PIP reduces earnings by £288 million in 2025, 0.02% of total UK earnings, equivalent to around 7,800 full time jobs at the UK average wage.[^1] By comparing this to [no behavioural assumptions](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&baseline=78632&timePeriod=2025&region=uk), we find that this translates to a £102 million reduction in tax revenues and a £25 million increase in other benefit spending; that is, behaviour increases the cost by 0.4%.

We also find that PIP reduces income inequality (as measured by the Gini coefficient of net household income) by 2.8%.

# Freezing PIP rates in 2025

By keeping PIP levels the same in FY 2025/26, PolicyEngine [estimates](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=78417&baseline=1&timePeriod=2025&region=uk) that the government would raise £464 million over that time period. These impacts would affect the household incomes of 9.7% of people and reduce the incomes of the bottom half of the income distribution by between 0.05% and 0.1%.

![Impact by decile](/images/posts/pip-and-freeze/image_4.png)

The freeze of PIP rates would affect around 17% of the third and fourth deciles, and between 5% and 10% of the remaining deciles.

![Outcome by decile](/images/posts/pip-and-freeze/image_5.png)

The reform would not affect poverty rates by more than 0.1pp, and would raise income inequality slightly (by 0.04%).

## Notes

[^1]: This effect is due to the income elasticity of substitution - individuals reducing their labour supply at the margin due to higher net income.



---

---
# Restricting eligibility for the Personal Independence Payment Daily Living part
Slug: uk-pip-reforms
Date: 2025-03-18
Authors: Nikhil Woodruff, Max Ghenis
Tags: uk, policy, featured
Description: We simulate potential realisations of the Government's new £5 billion reform.

---

Work and Pensions Secretary Liz Kendall has [announced](https://www.gov.uk/government/consultations/pathways-to-work-reforming-benefits-and-support-to-get-britain-working-green-paper/pathways-to-work-reforming-benefits-and-support-to-get-britain-working-green-paper#section-1--what-the-reformed-system-will-look-like) reforms to the Personal Independence Payment (PIP) that would reduce benefits by £5 billion by 2029-30. The reform restricts eligibility for the daily living (DL) part based on severity.

Using the open-source PolicyEngine microsimulation model, we simulated the impact of two potential realisations of this policy:

1. Assign each PIP DL participant an equal chance of losing eligibility
2. Assign only non-enhanced PIP DL participants an equal chance of losing eligibility

We then calibrated each potential realisation to reduce benefits by £5 billion by 2029-30.

## How PIP works

DWP qualifies people for PIP based on a [points system](https://www.legislation.gov.uk/uksi/2013/377). Daily living and mobility parts each require at least 8 points for the lower (standard) amount and 12 points for the higher (enhanced) parts. Daily living has 10 activities; mobility has two. PIP does not have an income or asset limit.

**Table 1: PIP amounts (2025)**

| **Component**     | **Lower weekly rate** | **Higher weekly rate** |
| ----------------- | --------------------- | ---------------------- |
| Daily living part | £72.65                | £108.55                |
| Mobility part     | £28.70                | £75.75                 |

We uprate these elements with inflation, projecting that by 2029, the daily living part will be [£80.31 (lower)](https://legacy.policyengine.org/uk/policy?reform=1&focus=gov.dwp.pip.daily_living.standard) and [£119.99 (higher)](https://legacy.policyengine.org/uk/policy?reform=1&focus=gov.dwp.pip.daily_living.enhanced) per week.

## The reform

The [green paper](https://www.gov.uk/government/consultations/pathways-to-work-reforming-benefits-and-support-to-get-britain-working-green-paper/pathways-to-work-reforming-benefits-and-support-to-get-britain-working-green-paper#section-1--what-the-reformed-system-will-look-like) states:

_"We will introduce a new, additional eligibility requirement so that a minimum of 4 points must be scored on one PIP daily living activity to receive the daily living element of the benefit. This means that people who only score the lowest points on each of the PIP daily living activities will lose their entitlement in future."_

## The simulation results

The reform may affect both non-enhanced and enhanced PIP DL enrollees, so we simulated realisations that remove both non-enhanced only and all PIP DL enrollees. For each realisation, we adjusted the removal share of the affected population to result in £5 billion in reduced benefit payments.

**Table 2: Total impacts of PIP DL reforms in 2029**

| **Realisation**       | **Cut to PIP DL non-enhanced** | **Cut to total PIP DL** | **Poverty** | **Deep poverty** |
| --------------------- | ------------------------------ | ----------------------- | ----------- | ---------------- |
| Only cut non-enhanced | 62%                            | 35%                     | 134,000     | 28,000           |
| Cut all               | 25%                            | 25%                     | 119,000     | 63,000           |

In the realisation that cuts both enhanced and non-enhanced, the reform increases female poverty in greater absolute numbers than male, but the reverse is true for deep poverty.

**Table 3: Poverty impacts by gender of PIP DL reforms in 2029**
| **Realisation** | **Male poverty** | **Female poverty** | **Male deep poverty** | **Female deep poverty** |
|-----------------|------------------|--------------------|-----------------------|-------------------------|
| Only cut non-enhanced | 29,000 | 28,000 | 8,000 | 3,000 |
| Cut all | 55,000 | 64,000 | 34,000 | 28,000 |

Our model and analysis [code](https://gist.github.com/nikhilwoodruff/1d1b89276162a09aa81061d6abd6e21a) is open-source. All poverty statistics represent absolute poverty before housing costs. We invite users to explore other PIP reforms at policyengine.org/uk.



---

---
# Benefits in PolicyEngine
Slug: uk-benefits-post
Date: 2025-05-28 00:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, featured, benefit
Description: PolicyEngine models different benefit components in the UK, including means-tested and non-means-tested benefits.

---

This article outlines how PolicyEngine models the UK benefit system. It details benefits in the UK welfare system and the implementation within the PolicyEngine microsimulation. This article serves as a technical reference for understanding how the PolicyEngine UK microsimulation model performs benefit calculations.

Table 1 summarises estimates for each benefit in the UK system, comparing PolicyEngine's 2025-26 fiscal year expenditure projections with those from the government (such as the Office for Budget Responsibility) and showing the percentage difference between them. While PolicyEngine accounts for interactions when tax and benefit programmes are introduced or removed, Table 1 shows only the direct expenditure for each benefit for consistency with government reports.

**Table 1: Summary of UK benefit expenditure estimates**

| Programme                     | PolicyEngine estimate 2025 (£bn)                                                                                                       | OBR estimate 2025-26 (£bn)                                                                                                                                             | PolicyEngine affected population estimate 2025 (%) |
| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------- |
| Universal Credit              | 79.4                                                                                                                                   | [77.4](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2024)                                                                        | 21.8                                               |
| Housing Benefit               | [7.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80663)  | [11.6](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2024)                                                                        | 2.9                                                |
| Tax Credits                   | [<1.0](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80677) | [<1.0](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2024)                                                                        | 0.1                                                |
| Pension Credit                | [7.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80685)  | [6.0](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-pensioner-benefits/)                                                                | 3.6                                                |
| Personal Independence Payment | [30.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80686) | [28.7](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-disability-benefits/)                                                              | 10.3                                               |
| Disability Living Allowance   | [9.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80689)  | [7.5](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-disability-benefits/)                                                               | 4.5                                                |
| Attendance Allowance          | [10.2](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80692) | [8.0](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-disability-benefits/)                                                               | 3.9                                                |
| Child Benefit                 | [12.3](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80696) | [12.5](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-child-benefit/#:~:text=Child%20benefit%20is%20a%20cash,the%20UK%20in%202023%2D24.) | 31.3                                               |
| Winter Fuel Payment           | [<1.0](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80702) | [<1.0](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2024)                                                                        | 2.7                                                |

As government estimates for childcare programmes are available for the 2024 fiscal year, we present them separately in the table below. Table 2 compares UK childcare programme costs, showing PolicyEngine's expenditure estimates for 2025 alongside both previous year estimates and official government projections.

**Table 2: Summary of UK childcare programmes expenditure estimates**

| Programme           | PolicyEngine estimate 2025 (£bn)                                                                                                                               | PolicyEngine estimate 2024 (£bn)                                                                                                                               | Government report 2024 (£bn)                                                                                  | PolicyEngine affected population estimate 2025 (%) |
| ------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------- | -------------------------------------------------- |
| Tax-free childcare  | [0.7](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=82972)                          | [0.6](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2024&baseline=83892)                          | [0.6](https://www.gov.uk/government/statistics/tax-free-childcare-statistics-september-2024)                  | 2.8                                                |
| Extended childcare  | [4.4](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80613&uk_local_areas_beta=true) | [2.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2024&baseline=83897&uk_local_areas_beta=true) | [2.5](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | 4.3                                                |
| Universal childcare | [1.8](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=82975)                          | [1.6](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2024&baseline=83887)                          | [1.7](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | 2.6                                                |
| Targeted childcare  | [0.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=82974)                          | [0.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2024&baseline=83888)                          | [0.6](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) | 0.5                                                |

This post has two main sections. The first covers means-tested benefits—such as Universal Credit, legacy programmes, and pension-age benefits—which vary with household income and savings. The second examines non-means-tested benefits, including disability, child, and retirement programmes, which are based on individual circumstances rather than income. For each benefit, the post details eligibility criteria, calculation methods, and how payments differ across the income distribution.

## Means-tested benefits

The government provides means-tested benefits based on household income, financial circumstances, and savings, with payments decreasing as income rises. The term 'means-testing' refers to the assessment of a claimant's financial resources to determine eligibility and payment amount. PolicyEngine models means-tested benefits by accounting for interactions between income sources, capital limits, and household composition. In the following sections, we examine each means-tested benefit in detail.

### Universal Credit

The Department for Work and Pensions (DWP) provides [Universal Credit](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/universal_credit/universal_credit.py), a means-tested benefit that replaces six legacy benefits for working-age people. Our calculation methodology first determines a household’s maximum entitlement by summing various elements based on household circumstances, then reduces this amount based on income (applying the taper rate), and finally applies a benefit cap if necessary.

- **[Standard allowance](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/universal_credit/standard_allowance/uc_standard_allowance.py)**: All eligible claimants receive the standard allowance as the core component of Universal Credit. The amount varies by age and by whether the claimant applies individually or as part of a couple. For 2025, a single person under 25 receives £311.68 per month, while a single person over 25 receives £393.45 per month. Couples where both members are under 25 receive £489.23 per month, while couples with at least one member over 25 receive £617.60 per month.

- **[Child element](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/universal_credit/child_element/uc_child_element.py)**: In 2025, HM Revenue and Customs (HMRC) pays £333.33 per month for a first child born before April 2017 and £287.92 for other children. The two-child limit, introduced in April 2017, restricts payments to the first two children in most cases, with exemptions for situations such as multiple births or non-consensual conception. PolicyEngine identifies each eligible child in the household, checks whether the higher rate applies, applies the two-child limit where relevant, and sums the monthly amounts.

- **[Housing costs element](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/universal_credit/housing_costs_element/uc_housing_costs_element.py)**: For social housing tenants, the DWP sets eligible housing costs equal to the full rent. For private rentals, DWP caps the amount using Local Housing Allowance (LHA) rates, which vary by location and required property size. DWP then reduces the award based on non-dependent deductions for other adults in the household. PolicyEngine applies these caps using household composition and geographical location to simulate how LHA rates and non-dependent deductions affect benefit calculations.

- **[Work allowances](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/universal_credit/work_allowance/uc_work_allowance.py) and [taper rate](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/universal_credit/income/uc_income_reduction.py)**: DWP reduces Universal Credit as earnings rise, applying a taper rate after accounting for any work allowance. In 2025, the work allowance is £404 per month for households receiving housing-related payments and £673 for those without. DWP deducts 55p from Universal Credit for every £1 earned above the allowance. PolicyEngine first checks if the household includes children or someone with limited capability for work. If so, it applies the work allowance and then reduces Universal Credit by the taper rate on earnings above that amount.

- **Benefit cap**: DWP enforces a maximum limit on total benefit income through the benefit cap, setting higher thresholds for London residents and exempting households with significant earnings or disability benefits. PolicyEngine checks whether a household qualifies for an exemption and, if not, applies the cap based on household composition and location.

#### Economic analysis

PolicyEngine projects that Universal Credit will cost £79.4 billion in 2025-26, 2.6% more than the UK government's estimate of [£77.4 billion](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2024) for 2025-26. Figure 1 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

To show the impact of Universal Credit on household finances, we plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=84661&region=uk&timePeriod=2025&baseline=1&household=50678) with two 10-year-old children. Abolishing this benefit reduces the household's net income in the low-income range. Figure 2 shows this effect on household net income.

**. Household net income with and without Universal Credit**

[Chart: . Household net income with and without Universal Credit]

### Housing Benefit

DWP provides [Housing Benefit](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/housing_benefit/housing_benefit.py) to people who do not receive Universal Credit, covering part or all of their rental costs. DWP calculates the award based on eligible rent—capped by Local Housing Allowance (LHA) for private rentals—and reduces it by 65% of income above the applicable threshold. It applies further reductions for non-dependent adults living in the household. DWP uses different rules for working-age and pension-age claimants and plans to transfer all working-age recipients to Universal Credit by [March 2026](https://www.gov.uk/guidance/move-to-universal-credit-if-you-get-a-migration-notice-letter).

DWP [excludes](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/housing_benefit/applicable_income/housing_benefit_applicable_income.py) certain income types through disregards, such as partial earnings and specific benefit payments. These include higher partial earnings disregards for lone parents, full disregards for benefits like Personal Independence Payment, and partial disregards for pension contributions and childcare costs. DWP [sets](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/housing_benefit/non_dep_deduction/housing_benefit_non_dep_deductions.py) the non-dependent deduction amount based on the non-dependent’s income and circumstances. A non-dependent is an adult such as an adult child or parent who lives with the claimant and is expected to contribute to housing costs.

#### Economic analysis

PolicyEngine projects that Housing Benefit will cost [£7.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80663) in 2025-26, 34.5% less than the UK government's estimate of [£11.6 billion](https://www.gov.uk/government/publications/benefit-expenditure-and-caseload-tables-2024) for 2025-26. Figure 3 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://gist.github.com/vahid-ahmadi/73f7361aedf338796c5ecdf64d3822f1) receiving £10,000 in Housing Benefit per year. Removing this benefit reduces the household's net income in the low-income range. Figure 4 shows this effect on household net income.

**. Household net income with and without Housing Benefit**

[Chart: . Household net income with and without Housing Benefit]

### Tax Credits

HMRC provided [Tax Credits](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/tax_credits.py) to increase the incomes of families with children and individuals in low-paid work. The system included two components—Child Tax Credit and Working Tax Credit—which claimants could receive separately or together. In [April 2025](https://www.gov.uk/tax-credits-have-ended), HMRC ended all Tax Credit payments and instructed claimants to apply for Universal Credit or Pension Credit to continue receiving support.

- PolicyEngine calculates Tax Credits using the following steps:
- Calculate the maximum entitlement for both Child Tax Credit and Working Tax Credit.
- Determine the relevant income threshold, which differs for claimants receiving both credits versus Child Tax Credit only.
- Reduce the entitlement by 41% of income above the threshold, withdrawing Working Tax Credit first, followed by Child Tax Credit.
- Exclude payments below the minimum threshold.

Tax Credits include two main components, which PolicyEngine models as follows:

- **Child Tax Credit (CTC)**: In 2025, HMRC paid Child Tax Credit to families with children, regardless of employment status. The credit included a £570 annual family element for households with at least one qualifying child, and a £3,455 annual child element for each eligible child. HMRC also paid additional amounts for children with disabilities. The two-child limit applied to children born after April 2017.

- **Working Tax Credit (WTC)**: In 2025, HMRC paid Working Tax Credit to individuals in low-paid work. It provided a basic element of £2,435 per year to all eligible claimants and added further amounts for couples, lone parents, and those working at least 30 hours per week. HMRC also covered up to 70% of eligible childcare costs—capped at £175 per week for one child or £300 for two or more children—through a dedicated childcare element.

HMRC reduces Tax Credits by 41% of income above the relevant threshold: £7,455 for households receiving both WTC and CTC, and £18,725 for those receiving CTC only. For every £1 above the threshold, HMRC withdraws 41p in Tax Credits.

#### Economic analysis

PolicyEngine projects that Tax Credits will cost less than [£1 billion](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80677) in 2025-26, in line with the UK government's estimate of less than £1 billion for 2025-26.

### Pension Credit

DWP provides [Pension Credit](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/pension_credit/pension_credit.py) to pensioners whose income falls below a specified threshold. DWP divides Pension Credit into two parts: Guarantee Credit and Savings Credit. PolicyEngine applies a 70% take-up rate to reflect that not all eligible pensioners claim the benefit. This rate represents the proportion of eligible individuals who receive payments. We incorporate this behavioural assumption to produce more accurate aggregate estimates. PolicyEngine calculates Pension Credit using the following steps:

- Check whether the household includes at least one person of State Pension age.
- Calculate Guarantee Credit entitlement.
- Calculate Savings Credit entitlement, if applicable.
- Combine the two components.
- Apply the take-up rate to simulate real-world claiming behaviour.

Pension Credit includes two main components, which we describe in detail below:

- **Guarantee Credit**: DWP [tops up](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/pension_credit/guarantee_credit/guarantee_credit.py) weekly income to a guaranteed minimum level. In 2025, it sets the minimum at £218.15 per week for singles and £332.95 for couples. DWP adds further amounts for severe disability, caring responsibilities, and dependent children. PolicyEngine calculates the shortfall between the applicable minimum (including any additions) and the claimant’s assessed income, and pays that amount as Guarantee Credit.

- **Savings Credit**: DWP [pays](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/pension_credit/savings_credit/savings_credit.py) Savings Credit to pensioners with modest savings or income above the basic State Pension level. It's only available to those who reached State Pension age before April 2016. For 2025, the income threshold is £189.80 per week for singles and £301.22 per week for couples. The amount increases at a rate of 60% of income above the threshold, then decreases at 40% of income above the minimum guarantee level. PolicyEngine calculates Savings Credit using the following methodology:

- Check if the claimant reached State Pension age before April 2016.
- Determine relevant income for calculating Savings Credit.
- Calculate the maximum possible Savings Credit as 60% of the difference between the minimum guarantee and the threshold.
- Award Savings Credit at 60% of income above the threshold, up to the maximum.
- Reduce the award by 40% of income above the minimum guarantee.

#### Economic analysis

PolicyEngine projects that Pension Credit will cost [£7.4 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80685) in 2025-26, 23.3% more than the UK government's estimate of [£6.0 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-pensioner-benefits/) for 2025-26. Figure 5 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.pythonReproducibility&reform=1&region=uk&timePeriod=2025&baseline=80685&household=53633) with a 70-year-old adult. Removing Pension Credit reduces the household’s net income in the low-income range. Figure 6 shows this effect on household net income.

**. Household net income with and without Pension Credit**

[Chart: . Household net income with and without Pension Credit]

## Non-means-tested benefits

Non-means-tested benefits address specific needs or circumstances, regardless of household income. Unlike means-tested benefits, these payments remain fixed as income increases. PolicyEngine identifies eligibility based on defined characteristics or conditions rather than financial resources. In the following sections, we describe each non-means-tested programme and explain how we model them.

### Personal Independence Payment (PIP)

DWP provides [Personal Independence Payment (PIP)](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/pip/pip.py) to individuals with long-term health conditions or disabilities. The benefit includes two components: daily living and mobility. DWP pays each component at either a standard or enhanced rate, depending on an assessment of the claimant’s needs. PIP replaced Disability Living Allowance for working-age adults and uses a points-based system to determine eligibility and payment levels. PolicyEngine calculates PIP using the following steps:

- Identify individuals with disabilities in the dataset.
- Assign daily living and mobility components based on reported needs.
- Apply the rate for each component.
- Combine both components to determine the total PIP.

For 2025, the [daily living](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/pip/daily_living.py) component is £108.55 per week at the enhanced rate and £72.65 per week at the standard rate. The [mobility](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/pip/mobility.py) component is £75.75 per week at the enhanced rate and £28.70 per week at the standard rate.

#### Economic analysis

PolicyEngine projects that PIP will cost [£30.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80686) in 2025-26, 6.6% more than the UK government's estimate of [£28.7 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-disability-benefits/) for 2025-26. Figure 7 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=1&region=uk&timePeriod=2025&baseline=80686&household=53477). When the individual receives the mobility component of PIP, they also receive the disability component of Universal Credit, which raises take-home income compared to the scenario without PIP. At lower income levels, this additional benefit increases household income. As earnings rise and the household loses eligibility for Universal Credit, the difference in take-home income between the two scenarios levels off. Figure 8 shows take-home income under both scenarios.

**. Household net income with and without PIP**

[Chart: . Household net income with and without PIP]

### Disability Living Allowance (DLA)

DWP provides [Disability Living Allowance (DLA)](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/dla/dla.py), which includes two components: self-care (equivalent to PIP’s daily living component) and mobility. DWP continues to pay DLA for children, while most working-age adults have transitioned to PIP. Some adults who received DLA before PIP was introduced remain on the benefit under transitional protection. PolicyEngine calculates DLA using the following steps:

- Identify eligible children and protected adults in the dataset.
- Assign the self-care component using a three-tier scheme (higher, middle, or lower rate) based on care needs.
- Assign the mobility component using a two-tier scheme (higher or lower rate) based on the severity of mobility limitations, then apply the appropriate rate.
- Combine both components to calculate the total DLA.

For 2025, the [self-care](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/dla/self_care.py) component has three possible rates: higher (£108.55 per week), middle (£72.65 per week), and lower (£28.70 per week). The [mobility](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/dla/mobility.py) component has two rates: higher (£75.75 per week) and lower (£28.70 per week). We calculate the annual amount by multiplying the weekly rates by 52.

#### Economic analysis

PolicyEngine projects that Disability Living Allowance will cost [£9.3 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80689) in 2025-26, 24.0% more than the UK government's estimate of [£7.5 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-disability-benefits/) for 2025-26. Figure 9 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.netIncome&reform=1&region=uk&timePeriod=2025&baseline=80689&household=53482). When the individual receives the mobility component of Disability Living Allowance (DLA), they also qualify for the disability component of Universal Credit, which increases take-home income compared to the scenario without DLA. At lower income levels, this additional benefit raises household income. As earnings increase and the household loses eligibility for Universal Credit, the difference in take-home income between the two scenarios levels off. Figure 10 shows take-home income under both scenarios.

**. Household net income with and without DLA**

[Chart: . Household net income with and without DLA]

### Attendance Allowance

DWP provides [Attendance Allowance](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/attendance_allowance.py) at two rates, based on the level of care required. DWP pays this benefit to individuals who became disabled after reaching State Pension age, since they cannot claim PIP or DLA for the first time after this point. PolicyEngine calculates Attendance Allowance using the following steps:

- Identify individuals over State Pension age with care needs.
- Determine the rate based on whether care is needed during the day, night, or both.
- Assign the weekly rate and calculate the annual amount.

For 2025, the higher rate is £108.55 per week and the lower rate is £72.65 per week. The higher rate applies to those needing care both day and night, or those who are ill. The lower rate applies to those needing care either during the day or at night. PolicyEngine calculates the annual amount by multiplying the weekly rate by 52. DWP uprates all three disability benefits annually using the Consumer Price Index (CPI). This ensures that benefit rates maintain their real value against inflation, protecting the purchasing power of disabled recipients.

#### Economic analysis

PolicyEngine projects that Attendance Allowance will cost [£10.2 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80692) in 2025-26, 27.5% more than the UK government's estimate of [£8.0 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-disability-benefits/) for 2025-26. Figure 11 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=1&region=uk&timePeriod=2025&baseline=80692&household=53560) receiving £5,000 per year in Attendance Allowance. Removing this benefit reduces the household’s net income. Figure 12 shows this effect on household finances.

**. Household net income with and without Attendance Allowance**

[Chart: . Household net income with and without Attendance Allowance]

### Child Benefit

HMRC pays [Child Benefit](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/child_benefit.py) for children under 16, or under 20 if they remain in approved education or training. Unlike means-tested benefits, HMRC pays Child Benefit at a flat rate, regardless of household income. In 2025, the rate is £26.04 per week for the first child and £17.24 per week for each additional child. PolicyEngine calculates Child Benefit using the following steps:

- Identify eligible children in each household.
- Apply the higher rate to the eldest (or only) eligible child.
- Apply the standard rate to additional eligible children.
- Calculate the High Income Child Benefit Charge (HITC), if applicable.
- Determine the net Child Benefit after applying the HITC.

The [High Income Child Benefit Charge (HITC)](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/charges/child_benefit_hitc.py) effectively withdraws this benefit when individual income exceeds £50,000, with complete withdrawal at £60,000. HMRC increases the charge proportionally with income within this range. For each £100 of income above £50,000, it reclaims 1% of the Child Benefit through the tax system.

#### Economic analysis

PolicyEngine projects that Child Benefit will cost [£12.3 billion](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80696) in 2025-26, 1.6% less than the UK government's estimate of [£12.5 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/welfare-spending-child-benefit/#:~:text=Child%20benefit%20is%20a%20cash,the%20UK%20in%202023%2D24.) for 2025-26. Figure 13 shows the distributional impact of this programme.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?reform=1&focus=householdOutput.earnings&region=uk&timePeriod=2025&baseline=80696&household=53314) with £10,000 in annual childcare expenses. Removing Child Benefit reduces the household’s net income. Figure 14 shows this effect on household net income.

**. Household net income with and without Child Benefit**

[Chart: . Household net income with and without Child Benefit]

### State Pension

DWP provides the [State Pension](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/state_pension.py) based on an individual’s National Insurance contribution history rather than their current financial circumstances. PolicyEngine calculates State Pension using the following steps:

- Check whether the individual has reached State Pension age.
- Identify which State Pension scheme applies (pre- or post-April 2016).
- Calculate entitlement based on National Insurance contributions and apply the corresponding rate.

Two schemes apply, depending on when the individual reached State Pension age:

- **[New State Pension](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/dwp/state_pension/new_state_pension/)**: For those reaching State Pension age on or after April 6, 2016. For 2025, the full rate is £221.20 per week, reduced proportionally for those with fewer than 35 qualifying years of National Insurance contributions (minimum 10 years required). The calculation multiplies the full rate by the fraction of qualifying years divided by 35, with a minimum threshold of 10 qualifying years.

- **[Basic State Pension](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/dwp/state_pension/basic_state_pension/)**: For those who reached State Pension age before April 6, 2016. For 2025, the full rate is £169.50 per week, plus Additional State Pension based on earnings-related contributions. The Basic State Pension requires 30 qualifying years for a full pension, with a proportional reduction for those with fewer years.

Both schemes apply the [triple lock](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/dwp/state_pension/triple_lock/) for annual uprating, increasing pensions by whichever is highest: inflation, earnings growth, or a fixed rate of 2.5%. PolicyEngine evaluates all three measures each year and applies the maximum value to model the triple lock.

### Winter Fuel Payment

DWP pays the [Winter Fuel Payment](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dwp/WFA.py) as an annual payment to older individuals to cover winter heating costs. PolicyEngine calculates Winter Fuel Payment using the following steps:

- Identify households with members of eligible age.
- Determine the payment rate based on age and household composition.
- Assign the annual payment amount.

In 2025, DWP pays £200 to households with someone aged 66 to 79 and £300 to those with someone aged 80 or over. In households with multiple pensioners, DWP allocates the payment to ensure no household receives more than the maximum amount.

In Scotland, the Pension Age Winter Heating Payment (PAWHP) has [replaced](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/social_security_scotland/pawhp.py) this benefit, with similar rate structure. This reflects the devolution of certain benefits to the Scottish government, which has implemented its own version of the payment with similar eligibility criteria and rates.

#### Economic analysis

PolicyEngine projects that Winter Fuel Payment will cost less than [£1 billion](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80702) in 2025-26, in line with the UK government's estimate of less than £1 billion for 2025-26.

### Tax-free childcare

HMRC operates the [Tax-Free Childcare](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/tax_free_childcare/tax_free_childcare.py) scheme, which adds a government top-up to parental childcare payments made through an online account. Parents deposit funds into the account, and HMRC adds a contribution based on the total amount paid. PolicyEngine calculates Tax-Free Childcare using the following steps:

- Identify households with eligible children.
- Check income conditions and work requirements for parents.
- Calculate childcare expenses and the corresponding government contribution.
- Apply the maximum contribution cap per child.

In 2025, the government contributes 20% of childcare costs, effectively adding £2 for every £8 parents spend. The annual top-up is capped at £2,000 per standard child and £4,000 per disabled child. This 20% rate mirrors the value of basic rate income tax relief. Eligibility criteria include age requirements (children under 12, or under 17 if disabled), income conditions, and work requirements (both parents must generally be working, with exceptions for disability).

#### Economic analysis

PolicyEngine projects that tax-free childcare will cost [£0.6 billion](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2024&baseline=83892) in 2024-25, in line with the UK government's estimate of [£0.6 billion](https://www.gov.uk/government/statistics/tax-free-childcare-statistics-september-2024) for 2024-25. Figure 15 shows the distributional effect of this benefit.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=73038&region=uk&timePeriod=2025&baseline=76821&household=51616) with one child aged 3. These households become eligible for Tax-Free Childcare (TFC) when the earner makes at least [£9,516](https://www.gov.uk/tax-free-childcare) per year at age 21 or older. The benefit ends at £100,000, creating a drop in take-home income. This threshold creates a gap between households just above and just below the eligibility cutoff. Figure 16 shows this effect on household net income.

**. Household net income with and without TFC**

[Chart: . Household net income with and without TFC]

Households with income just above £100,000 lose eligibility, resulting in a sharp drop in their childcare entitlement—often described as an earnings cliff. At this threshold, families transition from receiving childcare funding to losing it entirely.

### Universal childcare entitlement

The Department for Education (DfE) provides the [universal childcare entitlement](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/universal_childcare_entitlement/universal_childcare_entitlement.py), which grants free childcare hours to all children aged 3 to 4, regardless of parental income or work status. PolicyEngine calculates universal childcare entitlement using the following steps:

- Identify children aged [3 to 4 years old](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/universal_childcare_entitlement/universal_childcare_entitlement_eligible.py).
- Apply the standard entitlement of 570 hours per year.
- Calculate the funding amount using the applicable funding rate.

In 2025, the entitlement provides 570 hours per year—equivalent to 15 hours per week over 38 weeks—funded at £5.88 per hour. This results in an annual in-kind value of £3,351.60 per eligible child.

#### Economic analysis

PolicyEngine projects that universal childcare entitlement will cost [£1.6 billion](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2024&baseline=83887) in 2024-25, 5.9% less than the UK government's estimate of [£1.7 billion](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) for 2024-25. Figure 17 shows the distributional impact of this benefit.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?reform=1&focus=householdOutput.earnings&region=uk&timePeriod=2025&baseline=82975&household=53312) with one child aged 3. Households cannot receive Tax-Free Childcare (TFC) and universal childcare at the same time. Figure 18 shows household net income based on the head's employment income.

**. Household net income with and without universal childcare entitlement**

[Chart: . Household net income with and without universal childcare entitlement]

### Extended childcare entitlement

DfE provides the [extended childcare entitlement](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/extended_childcare_entitlement/extended_childcare_entitlement.py), which offers additional free childcare hours to working parents. This extends the universal entitlement by adding 15 hours per week for children aged 3 to 4, and from 2024, it begins to cover younger children as well. PolicyEngine calculates extended childcare entitlement using the following steps:

- Identify children in eligible age ranges.
- Check parental work and income conditions.
- Apply the hourly entitlement based on the child's age.
- Calculate the funding amount using age-specific rates.

In 2025, the entitlement varies by child age: children aged 9 to 23 months and 2 years receive 15 hours per week, increasing to 30 hours per week in 2026, while children aged 3 to 4 years receive 30 hours per week, which combines the universal 15 hours with an additional 15 hours.

The funding rates vary by age: £11.22 per hour for children under 2, £8.28 per hour for 2-year-olds, and £5.88 per hour for children aged 3 and over. These different rates reflect the higher staffing requirements and costs of caring for younger children.

#### Economic analysis

PolicyEngine projects that extended childcare entitlement will cost [£2.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2024&baseline=83897&uk_local_areas_beta=true) in 2024-25, 4.0% more than the UK government's estimate of [£2.5 billion](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) for 2024-25. Figure 19 shows the distributional effect of this benefit.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=1&region=uk&timePeriod=2025&baseline=80613&household=53312) with one child aged 3. Households become eligible for extended childcare entitlement when earning at least [£9,516 annually](https://www.gov.uk/free-childcare-if-working/check-youre-eligible) for adults aged 21 or over. The benefit ends at £100,000, causing a drop in take-home pay. Households earning above this threshold lose eligibility entirely. Figure 20 shows this effect on household net income.

**. Household net income with and without extended childcare entitlement**

[Chart: . Household net income with and without extended childcare entitlement]

### Targeted childcare entitlement

DfE provides the [targeted childcare entitlement](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/targeted_childcare_entitlement/targeted_childcare_entitlement.py), which offers free childcare to 2-year-olds in lower-income families. PolicyEngine calculates targeted childcare entitlement using the following steps:

- Identify children aged 2 years old.
- Check if the family receives qualifying benefits or meets income criteria.
- Apply the standard entitlement of 570 hours per year.
- Calculate the funding amount using the 2-year-old rate.

In 2025, the programme provides 570 hours per year (15 hours per week over 38 weeks), funded at £8.28 per hour. This results in an annual value of £4,719.60 per eligible child. The Department for Education grants eligibility to families receiving qualifying benefits or meeting income thresholds: under £16,190 per year for Tax Credit recipients, or earned income below £15,400 per year for those on Universal Credit.

#### Economic analysis

PolicyEngine projects that targeted childcare entitlement will cost [£0.5 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2024&baseline=83888) in 2024-25, in line with the UK government's estimate of [£0.6 billion](https://skillsfunding.service.gov.uk/view-latest-funding/national-funding-allocations/DSG/2024-to-2025) for 2024-25. Figure 21 shows the distributional effect of this benefit.

[Chart: type: bar]

#### Gross salary vs take-home pay at the household level

We plot net income for a [single-earner household](https://legacy.policyengine.org/uk/household?focus=householdOutput.earnings&reform=1&region=uk&timePeriod=2025&baseline=82974&household=53310) with one child aged 2. Figure 22 shows household net income based on the head’s employment income.

**. Household net income with and without targeted childcare entitlement**

[Chart: . Household net income with and without targeted childcare entitlement]

### Care to Learn

DfE provides the [Care to Learn](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/dfe/study_childcare_entitlement/study_childcare_entitlement.py) programme, which covers childcare costs for young parents in education. PolicyEngine calculates Care to Learn using the following steps:

- Identify eligible young parents under 20 years old.
- Verify they are in non-tertiary education (not university or higher education).
- Check if they live in England and are not apprentices.
- Calculate the funding amount based on regional rates (London versus outside London).

In 2025, the scheme provides weekly payments up to £195 for those living in London and £180 for those outside London. PolicyEngine multiplies this weekly amount by the number of weeks in a year, resulting in annual values up to £10,140 for London residents and £9,360 for those outside London.

To [qualify](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/dfe/care_to_learn), claimants must be under 20, live in England, be in eligible education, and not be apprentices. The Family Resources Survey does not include relevant cases, so PolicyEngine cannot estimate the economic impact of this programme. However, PolicyEngine implements the programme and includes it in household benefit calculations.

### Energy Bills Support

The UK government introduced several temporary programmes to reduce household energy costs. These schemes were delivered by HM Treasury and local authorities, depending on the mechanism:

- **[Energy Bills Credit](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/treasury/energy_bills_rebate/energy_bills_credit.py)**: HM Treasury provided £400 per household as monthly reductions on electricity bills from October 2022 to March 2023. The discount applied automatically to all domestic electricity accounts over six monthly instalments. The government concluded the scheme in [March 2024](https://www.gov.uk/guidance/energy-bills-discount-scheme) and did not extend it beyond the winter period.

- **[Council Tax Rebate](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/treasury/energy_bills_rebate/council_tax_rebate.py)**: Local authorities paid £150 to households in Council Tax bands A–D in England, with similar programmes in devolved nations. Councils distributed these payments between April and September 2022, and the scheme officially closed in [November 2022](https://www.gov.uk/guidance/council-tax-rebate-factsheet).

- **[Energy Price Guarantee](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/treasury/price_cap_subsidy/energy_price_cap_subsidy.py)**: HM Treasury capped typical household energy bills at £2,500 per year by limiting unit prices for gas and electricity. The government compensated energy suppliers for the difference between market rates and the guaranteed cap. This scheme ended in [June 2023](https://www.gov.uk/government/publications/energy-bills-support/energy-price-guarantee-up-until-30-june-2023).

### Cost of Living Support Payment

HMRC and DWP provided the [Cost of Living Support Payment](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/treasury/cost_of_living_support/cost_of_living_support_payment.py) as a one-off payment to households facing higher living costs. For the 2022–23 period, the payments included:

- £650 for recipients of means-tested benefits, paid in two instalments.
- £150 for recipients of disability benefits.
- £300 for pensioners eligible for the Winter Fuel Payment.

## Conclusion

PolicyEngine models the current UK benefits system and potential reforms, showing distributional impacts by income decile. Users analyse how benefit changes affect household incomes, government budgets, and behavioural responses such as labour supply. The model captures how benefit design influences household decisions and economic outcomes. We invite you to explore these policy effects on the PolicyEngine interface.



---

---
# Taxes in PolicyEngine
Slug: uk-taxes-post
Date: 2025-04-08 00:00:00
Authors: Vahid Ahmadi, Nikhil Woodruff
Tags: uk, policy, featured, tax
Description: PolicyEngine models different tax components in the UK, including direct taxes, indirect taxes, and proposed taxes.

---

This post provides an overview of how taxes are modelled in PolicyEngine UK. It details both existing taxes in the UK tax system and proposed/contributed taxes that are simulated within our platform. Each tax component is linked to its specific implementation in the codebase, making this post a technical reference for understanding how tax calculations are performed in the PolicyEngine UK microsimulation model.

The post is organised into three main sections. First, we explain direct taxes (income tax, national insurance, and capital gains tax), which are collected directly from individuals and businesses. Next, we cover indirect taxes (VAT and fuel duty) which are embedded in the prices of goods and services. Finally, we explore both existing property and land taxes (including stamp duty variations across UK nations, business rates, and council tax) and contributed/proposed taxes (such as carbon tax, wealth tax, land value tax, and others) that are modelled in PolicyEngine but not currently implemented in the UK.

Table 1 below summarises key metrics for each tax in the UK system, comparing PolicyEngine's 2025-26 fiscal year revenue projections with those from the government (such as the Office for Budget Responsibility) and showing the percentage difference between them. While PolicyEngine models interactions from instituting or repealing tax and benefit programmes, this chart shows only the direct revenue collected from each tax, for consistency with government reports. In the following sections, we dive deeper into each of these taxes, examining their structure, implementation, and distributional impact across income groups.

**Table 1: Summary of UK tax revenue estimates for 2025-26 (£ billions)**

| Programme                     | PolicyEngine                                                                                                                            | Government                                                                                                                                                                                                                                                                                                                 | Agency | Difference |
| ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ | ---------- |
| Income tax                    | [322.2](https://gist.github.com/vahid-ahmadi/505f1a571d3e71e594a4565b75380c56)                                                          | [328.7](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/income-tax/)                                                                                                                                                                                                                                           | OBR    | -2.0%      |
| National Insurance            | [179.7](https://gist.github.com/vahid-ahmadi/699656a3705a44c817473d06c7f5d8f6)                                                          | [198.8](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/national-insurance-contributions-nics/)                                                                                                                                                                                                                | OBR    | -9.6%      |
| Capital gains tax             | [17.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79852)  | [16.2](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/capital-gains-tax/)                                                                                                                                                                                                                                     | OBR    | +6.8%      |
| VAT                           | [198.6](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79853) | [182.1](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/vat/)                                                                                                                                                                                                                                                  | OBR    | +9.1%      |
| Fuel duty                     | [28.3](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79854)  | [27.3](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/fuel-duties/)                                                                                                                                                                                                                                           | OBR    | +3.7%      |
| Property transaction taxes    | [12.5](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=81619)  | [15.1](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/property-transaction-taxes/)                                                                                                                                                                                                                            | OBR    | -17.2%     |
| Business rates (England only) | [24.3](https://gist.github.com/vahid-ahmadi/1d2f4af86a1f171b8339b860beb4cc37)                                                           | [27.8](https://www.gov.uk/government/statistics/national-non-domestic-rates-collected-by-councils-in-england-forecast-2025-to-2026/national-non-domestic-rates-collected-by-councils-in-england-forecast-for-2025-to-2026#:~:text=Local%20authorities%20estimate%20the%20non,scheme%20are%20taken%20into%20consideration.) | DLUHC  | -12.6%     |

## Direct taxes

Direct taxes are collected from individuals and businesses based on income, profits or gains. The three main direct taxes in the UK system—income tax, National Insurance, and capital gains tax—work together to tax different forms of income and wealth accrual. Our projections in this section are underpinned by data from the UK's Family Resources Survey (FRS) and the Survey of Personal Incomes (SPI), with validation against official HMRC statistics. In this post, all estimates provided are static estimates. PolicyEngine models behavioural responses to policy changes as well.

### Income tax

HMRC administers this tax using a band system with different rates for certain income types, implemented in PolicyEngine via the [`income_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/income_tax.py) variable.

- **Standard income tax components**
  These are the main rate bands that determine tax payments on different portions of income. The UK uses a system where portions of income are taxed at different rates.
  - **Basic rate**: Applied to taxable income between the personal allowance and higher rate threshold at a rate of 20% for 2025, calculated in PolicyEngine as [`basic_rate_earned_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bracketized_liability/basic_rate_earned_income_tax.py).
  - **Higher rate**: Applied to taxable income between the higher rate threshold (£37,700 above personal allowance in 2025) and additional rate threshold at a rate of 40% for 2025, calculated in PolicyEngine as [`higher_rate_earned_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bracketized_liability/higher_rate_earned_income_tax.py).
  - **Additional rate**: Applied to taxable income over the additional rate threshold (£125,140 in 2025) at a rate of 45% for 2025, calculated in PolicyEngine as [`add_rate_earned_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bracketized_liability/add_rate_earned_income_tax.py).

- **Income tax bases**
  These represent the different sources of income subject to income tax in the UK. Each type has specific rules about deductions, allowances and sometimes different tax rates.
  - **Employment income**: Income from employment, including salaries, wages, bonuses and employment benefits. This income type is taxed through the PAYE system and represented by the [`taxable_employment_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_employment_income.py) variable.
  - **Self-employment income**: Income from self-employment, freelance work or running a business as a sole trader. Self-employed individuals pay income tax on profits after business expenses, calculated as [`taxable_self_employment_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_self_employment_income.py).
  - **Pension income**: Income from state pensions, workplace pensions and private pensions, calculated as [`taxable_pension_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_pension_income.py) in PolicyEngine.
  - **Property income**: Income from renting out property, after deducting allowable expenses. This includes rental from UK and overseas properties owned by UK residents, calculated as [`taxable_property_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_property_income.py).
  - **Dividend income**: Income from company dividends, taxed at lower rates than other income (8.75% basic rate, 33.75% higher rate, and 39.35% additional rate for 2025). A dividend allowance of £500 for 2025 applies before dividend tax rates, with taxable amounts calculated as [`taxable_dividend_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_dividend_income.py).
  - **Savings interest income**: Interest earned on savings accounts, bonds and other interest-bearing investments. The personal savings allowance permits taxpayers to earn some interest tax-free, with eligible starter rate income calculated as [`savings_starter_rate_income`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/bracketized_savings_income/savings_starter_rate_income.py).
  - **Miscellaneous income**: Other taxable income including royalties, trust income and casual earnings, calculated as [`taxable_miscellaneous_income`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_miscellaneous_income.py).
  - **Social security income**: The UK taxes state pension, incapacity benefit, contributory jobseeker's allowance, contributory employment and support allowance, and carer's allowance. The UK does not tax other benefits such as universal credit and personal independence payment. PolicyEngine calculates this as [`taxable_social_security_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bases/taxable_social_security_income.py).

- **Allowances and reliefs**
  These are amounts that can be earned tax-free or deductions that reduce taxable income, defined by various parameters and calculated as part of [`allowances`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/allowances).
  - **Personal allowance**: The amount of income that can be earned before paying income tax, set at £12,570 in 2025-26. The UK reduces the personal allowance at a 50% rate when income exceeds £100,000. PolicyEngine represents this in the [`personal_allowance`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/allowances) variable.
  - **Marriage allowance**: Allows a spouse or civil partner to transfer 10% of their personal allowance. Only available when the higher earner is a basic rate taxpayer and the lower earner has unused allowance, calculated as [`marriage_allowance`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/allowances/marriage_allowance.py).
  - **Dividend allowance**: Tax-free allowance for dividend income set at £500 in 2025, defined by the `dividend_allowance` parameter in [`dividend_allowance.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/income_tax/allowances/dividend_allowance.yaml).
  - **Trading allowance**: The UK excludes up to £1,000 of trading income for self-employed individuals in 2025-26. Claiming this prevents deduction of business expenses from income, set through the `trading_allowance` parameter in [`trading_allowance.yaml`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/hmrc/income_tax/allowances).
  - **Property allowance**: The UK excludes up to £1,000 of property income from taxation in 2025-26. PolicyEngine represents this value in the `property_allowance` parameter in [`property_allowance.yaml`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/hmrc/income_tax/allowances).
  - **Tax-free savings income**: The UK exempts savings-interest income up to £1,000 for basic-rate taxpayers, £500 for higher-rate taxpayers, and £0 for additional-rate taxpayers in 2025. PolicyEngine applies this allowance through the savings-income bracketisation process in [`bracketized_savings_income`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/bracketized_savings_income/), using the rates defined in [`savings_starter_rate_income`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/bracketized_savings_income/savings_starter_rate_income.py).
  - **Loss relief**: Allows business or property losses to be offset against other income to reduce tax, calculated as [`loss_relief`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/reliefs/loss_relief.py).
  - **Capital allowances**: Tax relief for businesses on the cost of purchasing assets used in the business. These allow businesses to deduct the cost of machinery, equipment and vehicles from taxable profits. PolicyEngine represents this in the [`capital_allowances`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/reliefs/capital_allowances.py) variable.

- **Income tax charges**
  These are tax charges that withdraw benefits or allowances in specific circumstances, implemented in [`variables/gov/hmrc/income_tax/charges`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/variables/gov/hmrc/income_tax/charges/).
  - **Child benefit high income tax charge (HITC)**: A tax charge on high earners who or whose partner receives child benefit. Child benefit rates in 2025 are £26.04 per week for the eldest child and £17.24 per week for each additional child. The HITC withdraws this benefit when income exceeds a threshold, with full withdrawal at a higher threshold, calculated as [`child_benefit_hitc`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/income_tax/charges/child_benefit_hitc.py).

PolicyEngine projects that the UK will collect [£322.2 billion](https://gist.github.com/vahid-ahmadi/505f1a571d3e71e594a4565b75380c56) in income tax revenue in 2025, 2.0% less than the OBR's forecast of [£328.7 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/income-tax/). Figure 1 shows the distributional impact of this programme.

[Chart: type: bar]

### National Insurance

National Insurance operates alongside income tax and funds state benefits and the NHS.
National Insurance consists of contributions paid by employees, employers and the self-employed, with overall liability calculated as [`national_insurance`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/national_insurance.py).

- **Class 1** (Employees and employers)
  These are contributions paid on employee earnings above the primary threshold.
  - **Primary contributions (employees)**: Paid by employees at 8% on earnings between the primary threshold (£241.73 per week in 2025) and upper earnings limit, with a lower rate above the upper limit. This is deducted via the PAYE system alongside income tax, calculated as [`ni_class_1_employee_primary`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_1/ni_class_1_employee_primary.py).
  - **Secondary contributions (employers)**: Paid by employers at a flat rate on employee earnings above the secondary threshold. This represents a cost for employers and affects employment costs, calculated as [`ni_class_1_employer`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_1/ni_class_1_employer.py).
  - **Additional rate contributions**: The UK levies a rate of National Insurance on employment income in excess of the upper earnings limit, calculated as [`ni_class_1_employee_additional`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_1/ni_class_1_employee_additional.py).

- **Class 2** (Self-employed - flat rate)
  A flat weekly rate paid by self-employed people with profits above the small profits threshold, calculated as [`ni_class_2`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_2/ni_class_2.py).
- **Class 3** (Voluntary contributions)
  Optional contributions people can make to fill gaps in their National Insurance record, calculated as [`ni_class_3`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_3/ni_class_3.py).
- **Class 4** (Self-employed - percentage-based)
  Percentage-based contributions paid by self-employed people on their profits. They function similar to income tax with different rates applied to different profit levels, calculated as [`ni_class_4`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_4/ni_class_4.py).
  - **Main rate**: Paid on self-employed profits between the lower profits limit and upper profits limit, calculated as [`ni_class_4_main`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_4/ni_class_4_main.py).
  - **Additional rate**: Paid on self-employed profits above the upper profits limit, calculated as [`ni_class_4_maximum`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/national_insurance/class_4/ni_class_4_maximum.py).

PolicyEngine projects that the UK will collect [£179.7 billion](https://gist.github.com/vahid-ahmadi/699656a3705a44c817473d06c7f5d8f6) in National Insurance revenue in 2025, 9.6% less than the OBR's forecast of [£198.8 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/national-insurance-contributions-nics/). Figure 2 shows the distributional impact of this programme.

[Chart: type: bar]

### Capital gains tax

Capital gains tax applies to profits from asset sales, unlike income tax and National Insurance which apply to earnings.
Capital gains tax is charged on the profit when selling or disposing of an asset that has increased in value. It applies to most assets including investments, second properties and business assets, but not main residences, calculated as [`capital_gains_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/capital_gains_tax/capital_gains_tax.py).

- **Basic rate (10%)**: Applied to gains for basic rate taxpayers on most assets (18% on residential property for 2025). The applicable rate depends on the taxpayer's income tax band and the asset type, defined by the [`basic_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/cgt/basic_rate.yaml) parameter.
- **Higher rate (20%)**: Applied to gains for higher and additional rate taxpayers (28% on residential property for 2025), defined by the [`higher_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/cgt/higher_rate.yaml) parameter.
- **Annual exempt amount**: A tax-free allowance for capital gains set at £3,000 in 2025, defined by the [`annual_exempt_amount`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/cgt/annual_exempt_amount.yaml) parameter.

**Data imputation**:
Since capital gains are not directly observed in the Family Resources Survey (FRS) data, they are imputed using a joint distribution approach based on data from "[Capital Gains and UK Inequality](https://ideas.repec.org/p/wrk/warwec/1260.html)" paper by Arun Advani and Andy Summers. This dataset provides detailed percentiles of capital gains (p05, p10, p25, p50, p75, p90, p95) across more than 60 income bands, enabling the model to fit a spline to each band's percentiles to create a joint distribution. For each individual in the simulation, the probability of having capital gains is determined by their income band, and if they are modelled to have gains, the amount is randomly sampled from the relevant spline. These values are then uprated from 2017 to present day using the OBR's non-labour income forecast, allowing the model to accurately account for the concentration of capital gains among higher income individuals.

**Behavioural responses**:
The PolicyEngine-UK model incorporates behavioural responses through the [`capital_gains_behavioural_response`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/capital_gains_tax/responses.py) variable, which captures how individuals change realisation decisions in response to tax changes. This modelling is controlled by an elasticity parameter, which can be adjusted to simulate different levels of taxpayer sensitivity. For more information, you can read [this post](https://policyengine.org/uk/research/behavioural-responses).

PolicyEngine projects that the UK will collect [£17.3 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79852) in capital gains tax revenue in 2025, 6.8% more than the OBR's forecast of [£16.2 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/capital-gains-tax/). Figure 3 shows the distributional impact of this programme.

[Chart: type: bar]

### Council tax/domestic rates

Residential properties are subject to council tax, except in Northern Ireland which uses domestic rates.
Council tax is a local tax on domestic properties in England, Scotland and Wales, funding local services. In PolicyEngine, we apply the reported amounts from the Family Resources Survey data. Northern Ireland uses a rates system based on rental values rather than the banded approach of council tax, calculated as [`domestic_rates`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/local_authorities/domestic_rates.py).

## Indirect taxes

Indirect taxes are collected by intermediaries and passed to the government. They form part of the price of goods and services that consumers pay. Our indirect tax simulations rely on consumption data imputed to the Family Resources Survey dataset, calibrated to match aggregate statistics from HMRC and other government sources. In this post, all estimates provided are static estimates.

### Value added tax (VAT)

VAT generates revenue for the UK government.
VAT is a consumption tax placed on products and services at each stage where value is added, calculated in PolicyEngine as [`vat`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/vat.py).

- **Standard rate (20%)**: Applied to most goods and services in the UK in 2025, defined by the [`standard_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/vat/standard_rate.yaml) parameter.
- **Reduced rate (5%)**: Applied to certain goods and services including domestic fuel and children's car seats in 2025, defined by the [`reduced_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/vat/reduced_rate.yaml) parameter.

The VAT calculation sums the tax from standard-rated items (consumption × 20%) and reduced-rated items (consumption × 5%), then divides by a factor to account for under-reporting. This approach ensures that modelled VAT revenue aligns with official government statistics.

**Data imputation**:
The consumption data for VAT calculations comes from the Living Costs and Food Survey (LCFS), which follows the Classification of Individual Consumption by Purpose (COICOP) system. Due to under-reporting in survey data, the calculation is divided by 0.38 to match official HMRC VAT receipts. The model assumes that approximately 50% of consumption is subject to the standard VAT rate, while about 3% is subject to the reduced rate (primarily domestic fuel), as specified by the [`reduced_rate_share`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/vat/reduced_rate_share.yaml) parameter. The remaining consumption is either zero-rated or exempt. Consumption data is uprated using the OBR's Consumer Price Index forecast.

PolicyEngine projects that the UK will collect [£198.6 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79853) in value added tax (VAT) revenue in 2025, 9.1% more than the OBR's forecast of [£182.1 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/vat/). Figure 4 shows the distributional impact of this programme.

[Chart: type: bar]

### Fuel duty

The UK applies excise duties to specific products, including fuels.
Fuel duty is an excise tax charged on purchases of petrol, diesel and other fuels for vehicles or heating, calculated as [`fuel_duty`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/fuel_duty/fuel_duty.py).

- **Petrol and diesel rates**: Set at £0.5795 per litre for both petrol and diesel in 2025, defined by the [`petrol_and_diesel`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/fuel_duty/petrol_and_diesel.yaml) parameter.

PolicyEngine projects that the UK will collect [£28.3 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79854) in fuel duty revenue in 2025, 3.7% more than the OBR's forecast of [£27.3 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/fuel-duties/). Figure 5 shows the distributional impact of this programme.

[Chart: type: bar]

## Property and land taxes

The UK tax system includes taxes on property ownership, occupation and transactions. These taxes vary by nation and property type. Our property tax simulations use property values from the Family Resources Survey enhanced with housing market data and transaction patterns. Property transaction taxes (SDLT, LBTT, LTT) are modelled assuming a 4.5% annual property turnover rate. All estimates in this section are static estimates that do not reflect potential changes in property ownership or transaction behaviour due to tax changes.

Since property transactions are infrequent events for most households, PolicyEngine's model employs a smoothing mechanism that converts one-time transaction taxes into expected annual values. Rather than simulating which specific households purchase property in a given year, our approach multiplies each household's potential tax liability by the annual property sale rate (4.5%). This provides a representation of the economic burden of transaction taxes across the population over time. First-time buyer relief eligibility is modelled probabilistically based on age brackets derived from HMRC statistics, and both residential and non-residential property transactions are included in the calculations. Corporate property tax incidence is also distributed to households based on shareholding patterns to provide a comprehensive view of property tax burdens.

The Office for Budget Responsibility (OBR) estimates that revenue from property transaction taxes, including Stamp Duty Land Tax (SDLT), Land and Buildings Transaction Tax (LBTT), and Land Transaction Tax (LTT), for 2025-26 is [£15.1 billion](https://obr.uk/forecasts-in-depth/tax-by-tax-spend-by-spend/property-transaction-taxes/).

### Stamp duty land tax (SDLT) - England & Northern Ireland

SDLT is a tax paid when purchasing property over certain price thresholds in England and Northern Ireland, calculated as [`stamp_duty_land_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/stamp_duty_land_tax.py). In PolicyEgine, the calculation splits into residential and non-residential components for both purchases and rentals. For residential properties, tax rates vary based on purchase type (first-time vs. subsequent, main vs. additional residence), with bracket taxation applying higher rates only to portions above each threshold. Additional properties face surcharges when exceeding minimum thresholds. Rental agreements are taxed on the net present value of rent. Corporate transactions distribute tax burden to households based on shareholding percentages and statistical revenue values. Expected revenue is calculated using a 4.5% annual property turnover rate, representing the estimated percentage of property value changing hands yearly.

- **Residential property**
  These rates apply to homes and residential properties with different structures for different buyer types, defined in [`residential`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/residential/).
  - **Main residence rates (including first-time buyer relief)**: Standard rates apply in bands from the nil-rate band (£0) to portions over the highest threshold. For 2025, thresholds are £0, £125,000, £250,000, £925,000, and £1,500,000, with corresponding rates of 0%, 2%, 5%, 10%, and 12%. First-time buyers receive relief with higher nil-rate thresholds and reduced rates up to a maximum property value, defined in property-specific rate files within [`residential`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/residential/).
  - **Additional property surcharge**: An extra percentage of SDLT is charged on additional residential properties over a threshold, defined in the surcharge parameters within [`residential`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/residential/).
  - **Rental agreements**: SDLT applies to the net present value of rent over the lease term when exceeding a threshold, defined by residential rent parameters in [`rent.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/residential/rent.yaml).

- **Non-residential property**
  These apply to commercial property purchases like shops, offices and agricultural land, defined in [`non_residential`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/non_residential/).
  - **Purchase rates**: Rates apply in bands from the nil-rate band to portions over higher thresholds, defined by non-residential purchase parameters in [`purchase.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/non_residential/purchase.yaml).
  - **Rental agreements**: SDLT applies to the net present value of commercial lease rent above a threshold, defined by non-residential rent parameters in [`rent.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/stamp_duty/non_residential/rent.yaml).

PolicyEngine projects that the UK will collect [£11.4 billion](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=79870) in stamp duty revenue in 2025. Figure 6 shows the distributional impact of this programme.

[Chart: type: bar]

### Land and buildings transaction tax (LBTT) - Scotland

Scotland uses a different property transaction tax than England and Northern Ireland. Land and Buildings Transaction Tax (LBTT) is Scotland's equivalent to SDLT, applying to property and land transactions in Scotland, calculated as [`lbtt`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/revenue_scotland/lbtt.py). PolicyEngine implements Scotland-specific rate schedules with brackets, differentiating between first-time buyers and standard purchases. Additional property transactions incur both standard tax plus a percentage-based surcharge on the entire property value, creating a higher effective rate on second homes. Rental agreements use net present value calculation, taxing only the difference between previous and current cumulative rent. The tax applies exclusively to Scottish residents through a country code filter. Expected revenue is calculated using a 4.5% annual property turnover rate, representing the estimated percentage of total residential property value changing hands yearly. Non-residential transactions use separate rate schedules for both purchases and rental agreements.

- **Residential property**
  Scotland's residential property transaction tax applies to home purchases with specific rates, defined in [`residential`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/residential/).
  - **Standard rates**: Rates apply in bands with thresholds at £0, £145,000, £250,000, £325,000, and £750,000 for 2025, with corresponding rates of 0%, 2%, 5%, 10%, and 12%, defined by the [`rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/residential/rate.yaml) parameter.
  - **First-time buyer relief**: First-time buyers pay no LBTT up to a higher threshold than standard purchases, defined by the [`first_time_buyer_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/residential/first_time_buyer_rate.yaml) parameter.
  - **Additional dwelling supplement**: A surcharge applies to additional residential properties over a threshold, defined by the [`additional_residence_surcharge`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/residential/additional_residence_surcharge.yaml) parameter.
  - **Rental agreements**: LBTT applies to the net present value of residential lease rent above a threshold, defined by the rent parameters in [`rent.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/rent.yaml).

- **Non-residential property**
  These apply to commercial property transactions in Scotland with distinct rates, defined in [`non_residential.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/non_residential.yaml).
  - **Purchase rates**: Rates apply in bands from the nil-rate band to portions over higher thresholds, defined by specific band parameters in [`non_residential.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/non_residential.yaml).
  - **Rental agreements**: LBTT applies to the net present value of commercial lease rent above a threshold, defined by specific rent parameters in [`rent.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/revenue_scotland/lbtt/rent.yaml).

PolicyEngine projects that the UK will collect [£669.0 million](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=1&region=uk&timePeriod=2025&baseline=80006) in land and buildings transaction tax revenue in 2025. Figure 7 shows the distributional impact of this programme.

[Chart: type: bar]

### Land transaction tax (LTT) - Wales

Wales has its own property transaction tax system. Land Transaction Tax (LTT) is Wales' equivalent to SDLT, applying to property and land transactions in Wales, calculated as [`land_transaction_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/wra/land_transaction_tax.py). LTT implements separate calculation pathways for primary residences and higher-rate properties, each with distinct progressive bracket structures. Unlike SDLT and LBTT implementations, no specific first-time buyer relief appears in the LTT coding structure. The tax applies to both property purchases and rental agreements, with rental calculations using an incremental approach on net present values. Geographic restriction ensures only Welsh households face LTT liability through country code comparison. Non-residential transactions use separate rate schedules for both purchases and rentals. Expected revenue is calculated by applying a 4.5% annual property turnover rate to the whole property stock, representing the estimated percentage of total residential property value changing hands yearly.

- **Residential property**
  Wales' residential property transaction tax applies to home purchases with its own rate structure, defined in [`residential`](https://github.com/PolicyEngine/policyengine-uk/tree/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/residential/).
  - **Primary residence rates**: Rates apply in bands with thresholds at £0, £180,000, £250,000, £400,000, £750,000, and £1,500,000 for 2025, with corresponding rates of 0%, 3.5%, 5%, 7.5%, 10%, and 12%, defined by the [`primary`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/residential/primary.yaml) parameter.
  - **Higher rates for additional properties**: A surcharge applies to purchases of additional residential properties, defined by the [`higher_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/residential/higher_rate.yaml) parameter.
  - **Rental agreements**: LTT applies to the net present value of residential lease rent above thresholds, defined by specific rent parameters in [`rent.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/rent.yaml).

- **Non-residential property**
  These apply to commercial property purchases and leases in Wales with specific rates, defined in [`non_residential.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/non_residential.yaml).
  - **Purchase rates**: Rates apply in bands from the nil-rate band to portions over higher thresholds, defined by specific band parameters in [`non_residential.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/non_residential.yaml).
  - **Rental agreements**: LTT applies to the net present value of commercial lease rent with threshold and rate structures, defined by specific rental parameters in [`rent.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/wra/land_transaction_tax/rent.yaml).

PolicyEngine projects that the UK will collect [£388.3 million](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80023) in land transaction tax revenue in 2025. Figure 8 shows the distributional impact of this programme.

[Chart: type: bar]

### Business rates

The UK imposes annual taxes on property occupation, including business rates for non-domestic properties like shops, offices, and factories. At PolicyEngine, business rates are modelled as a corporate tax with incidence distributed to households based on their shareholding in the corporate sector. The model allocates the total business rates revenue from each UK nation (England, Scotland, Wales, and Northern Ireland) to households in proportion to their corporate wealth holdings through the [business_rates](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/gov/hmrc/business_rates.py) variable. Business rates are set by central government but collected by local authorities. The economic incidence of business rates is represented by distributing the total revenue burden based on households' corporate wealth holdings, reflecting the assumption that business rates are ultimately paid by shareholders through reduced returns on investments.

- **Corporate tax on non-domestic properties**: Calculated as a percentage (the multiplier) of a property's assessed rateable value, defined in business rates statistics parameters in [`statistics.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/business_rates/statistics.yaml).
- **Regional variation (England, Scotland, Wales, Northern Ireland)**: Each nation sets its own multipliers and relief schemes, creating regional differences, defined in region-specific sections within [`statistics.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/hmrc/business_rates/statistics.yaml).

PolicyEngine projects that the UK will collect [£24.3 billion](https://legacy.policyengine.org/uk/policy?reform=1&focus=policyOutput.policyBreakdown&region=uk&timePeriod=2025&baseline=80029) in business rates revenue in 2025, 12.6% less than the UK government's estimate of [£27.8 billion](https://www.gov.uk/government/statistics/national-non-domestic-rates-collected-by-councils-in-england-forecast-2025-to-2026/national-non-domestic-rates-collected-by-councils-in-england-forecast-for-2025-to-2026#:~:text=Local%20authorities%20estimate%20the%20non,scheme%20are%20taken%20into%20consideration.) for England alone in 2025-2026. Figure 9 shows the distributional impact of this programme.

[Chart: type: bar]

## Contributed/proposed taxes

Beyond modelling the existing UK tax system, PolicyEngine also includes several proposed taxes that are not currently implemented. These allow users to explore potential policy reforms and understand their distributional and revenue implications. Our simulations of proposed taxes use a combination of existing Family Resources Survey data enhanced with wealth, consumption, and carbon emissions data from sources including the Wealth and Assets Survey and national environmental accounts. In this post, all estimates for these proposed taxes are static estimates.

### Carbon tax

Carbon taxes can be used to price emissions and influence production and consumption patterns.
A carbon tax is a levy on carbon emissions required to produce goods and services, calculated in PolicyEngine as [`carbon_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/carbon_tax.py).

- **Per-ton CO2 emission tax**: A fixed monetary amount charged per ton of carbon dioxide equivalent emitted, defined by the carbon tax rate parameter in [`carbon_tax.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/contrib/ubi_center/carbon_tax.yaml).

- **Consumer and corporate incidence modelling**: PolicyEngine models how the tax burden would be shared between consumers and producers in the [`carbon_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/carbon_tax.py) variable implementation.
- **Applied to carbon consumption**: The tax applies to the carbon footprint of household consumption across categories, using household carbon intensity variables in [`carbon.py`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/household/consumption/carbon.py).

### Wealth tax

A wealth tax would apply to the total value of an individual's assets, calculated as [`wealth_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/wealth_tax.py).

- **Annual tax on total household wealth**: A percentage tax applied to a household's total net wealth above a threshold, defined by wealth tax rate parameters in [`wealth_tax.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/contrib/ubi_center/wealth_tax.yaml).
- **Progressive rate structure based on wealth brackets**: Higher tax rates would apply to larger wealth holdings, similar to income tax bands, defined by wealth tax bracket parameters in [`wealth_tax.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/contrib/ubi_center/wealth_tax.yaml).

#### Non-primary residence wealth tax

Some wealth tax proposals exempt the main residence from taxation.
This is a targeted wealth tax that would exempt one's main residence but tax other assets, calculated as [`non_primary_residence_wealth_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/cec/non_primary_residence_wealth_tax.py).

- **Wealth tax that exempts main residence**: Applies only to assets beyond a household's primary home, defined by wealth tax exemption parameters in [`non_primary_residence_wealth_tax.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/contrib/cec/non_primary_residence_wealth_tax.yaml).
- **Applied to all other wealth including secondary properties, financial assets, etc.**: Would capture investment properties, shares, bonds, business assets and other wealth forms through the non-primary wealth components in [`non_primary_residence_wealth_tax.py`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/cec/non_primary_residence_wealth_tax.py).

### Land value tax (LVT)

Land value tax focuses on the value of land itself, not the buildings or improvements on it.
Land value tax is a levy on the unimproved value of land, disregarding buildings or other improvements, calculated as [`land_value_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/land_value_tax.py).

- **Tax on land value separate from improvements**: Only the underlying land value is taxed, not buildings or developments on the land. This differs from council tax and business rates, which tax the combined property value, defined by land value tax rate parameters in [`land_value_tax.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/contrib/ubi_center/land_value_tax.yaml).
- LVT includes the following components:
  - **General land value tax**: A base rate applied to all land values regardless of use or ownership type. This would capture land value derived from location and public infrastructure, included in the [`land_value_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/land_value_tax.py) calculation.
  - **Household land value tax**: A rate applied specifically to land under residential use. This could replace council tax with a system not dependent on outdated valuations, included in the residential component of [`land_value_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/land_value_tax.py).
  - **Corporate land value tax**: A rate applied to commercially used land. This could replace or supplement business rates, potentially reducing business investment distortions, included in the commercial component of [`land_value_tax`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/ubi_center/land_value_tax.py).

### Private school VAT

The UK government has introduced [VAT on private school fees](https://commonslibrary.parliament.uk/research-briefings/cbp-10125/) from January 1, 2025, ending the previous exemption for private education, calculated in [`private_school_vat.py`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/labour/private_school_vat.py) in PolicyEngine. This policy change applies the standard 20% VAT rate to private school fees that were historically exempt from VAT as part of the general exemption for educational services.

- **VAT applied to private school fees**: The standard VAT rate would apply to fees currently exempt as educational services, defined by private school VAT rate parameters in [`private_school_vat.yaml`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/parameters/gov/contrib/labour/private_school_vat.yaml).
- **Modelling by household income**: PolicyEngine models which household income groups would bear the burden of this tax in the [`private_school_vat`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/labour/private_school_vat.py) implementation.
- **Adjusts for actual private school attendance rates**: The model accounts for varying private school attendance rates across income groups using the [`private_school_attendance_rate`](https://github.com/PolicyEngine/policyengine-uk/blob/master/policyengine_uk/variables/contrib/labour/private_school_vat.py) parameter.

## Conclusion

PolicyEngine models the current UK tax system and potential reforms, with tax impacts presented by income decile. Users can analyse how changes to taxes affect government revenue and household incomes.



---

---
# Reform UK's tax-benefit reform proposals
Slug: farage-speech-may-2025
Date: 2025-05-27 19:00:00
Authors: Nikhil Woodruff
Tags: uk, policy, featured
Description: Nigel Farage has confirmed that Reform UK's manifesto will include four tax-benefit reforms that PolicyEngine estimates would cost £75 billion in 2025-26.

---

{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "c86ae1b1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[2mUsing Python 3.11.11 environment at: /Users/nikhilwoodruff/policyengine/policyengine-app/.venv\u001b[0m\n",
      "Name: policyengine-uk\n",
      "Version: 2.28.1\n",
      "Location: /Users/nikhilwoodruff/policyengine/policyengine-app/.venv/lib/python3.11/site-packages\n",
      "Requires: microdf-python, policyengine-core\n",
      "Required-by: policyengine\n"
     ]
    }
   ],
   "source": [
    "!uv pip show policyengine-uk"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9cf7ac94",
   "metadata": {},
   "source": [
    "Reform UK leader Nigel Farage today confirmed four tax-benefit policy reforms would be included in the party's manifesto for the next general election in a [speech](https://www.bbc.co.uk/news/articles/c5yx062pvlvo) in central London. The party had previously included three of these reforms in its 2024 general election manifesto, committing to:\n",
    "\n",
    "* Increase the Personal Allowance from £12,570 to £20,000\n",
    "* Increase the higher rate threshold from £50,270 to £70,000\n",
    "* Raise the Marriage Allowance maximum rate from 10% to 25%\n",
    "\n",
    "Today Farage confirmed that the party would include these reforms in the next general election manifesto, alongside a fourth commitment to repeal the two-child benefit cap on Universal Credit and Child Tax Credit payments. In the following sections, we summarise how these policies work today and quantify their impact using PolicyEngine's tax-benefit microsimulation model.\n",
    "\n",
    "_[See how these reforms would affect your household here.](https://legacy.policyengine.org/uk/household?reform=85289&focus=intro&region=uk&timePeriod=2025&baseline=1&uk_local_areas_beta=false)_\n",
    "\n",
    "## Current policy\n",
    "\n",
    "### Personal Allowance\n",
    "\n",
    "The government exempts the first £12,570 of an individual's income from income tax, known as the [**Personal Allowance**](https://www.gov.uk/income-tax-rates). The personal allowance is gradually reduced for individuals earning over £100,000, with a complete withdrawal at £125,140. The government has frozen this threshold since 2021, and is scheduled to remain at this level until 2028.\n",
    "\n",
    "### Higher rate threshold\n",
    "\n",
    "The **higher rate threshold** is the income level at which individuals start paying the higher rate of income tax (40%). Currently, this threshold is set at £37,000 (it is added to the Personal Allowance, so the effective threshold is £50,270). The government has frozen this threshold since 2021, and is scheduled to remain at this level until 2028.\n",
    "\n",
    "### Marriage Allowance\n",
    "\n",
    "The [**Marriage Allowance**](https://www.gov.uk/marriage-allowance) permits couples to transfer 10% of any unused personal allowance between spouses when one earns below the Personal Allowance threshold and the other pays the basic rate.\n",
    "\n",
    "### Two-child limit\n",
    "\n",
    "The two-child limit removes the entitlement of children born after April 2017 to Universal Credit and Child Tax Credit child element payments, if they are the third or subsequent child in a family, unless [exceptions](https://www.gov.uk/guidance/child-tax-credit-exceptions-to-the-2-child-limit#overview) apply.\n",
    "\n",
    "## Economic impacts\n",
    "\n",
    "PolicyEngine's model [estimates](https://legacy.policyengine.org/uk/policy?reform=85289&focus=policyOutput.budgetaryImpact&region=uk&timePeriod=2025&baseline=1&uk_local_areas_beta=false&simYears=5) that these reforms would cost £75 billion in 2025-26, rising to £78 billion in 2029-30. Over the five-year window from 2025-26 to 2029-30, the total cost of these reforms would be £391 billion. Table 1 below shows the estimated costs of each reform.\n",
    "\n",
    "*Table 1: Estimated revenue impacts of Reform UK's tax-benefit proposals (£ billion)*\n",
    "| Policy                                   |   2025-26 |   2026-27 |   2027-28 |   2028-29 |   2029-30 |   2025-30 |\n",
    "|:-----------------------------------------|-------:|-------:|-------:|-------:|-------:|----------:|\n",
    "| Repeal the two-child limit               |   -1.7 |   -1.8 |   -1.9 |   -2.2 |   -2.3 |      -9.9 |\n",
    "| Raise the Personal Allowance to £20,000  |  -50.7 |  -51.5 |  -52.4 |  -49.1 |  -45.5 |    -249.3 |\n",
    "| Set the higher rate threshold to £70,000 |  -22.2 |  -23.8 |  -25.5 |  -27.2 |  -29.3 |    -128   |\n",
    "| Raise the Marriage Allowance rate to 25% |   -0.7 |   -0.7 |   -0.8 |   -0.8 |   -0.9 |      -3.9 |\n",
    "| Total                                    |  -75.3 |  -77.9 |  -80.5 |  -79.3 |  -78.1 |    -391.1 |\n",
    "\n",
    "\n",
    "We also estimate that these reforms would benefit 82% of people in 2025, increase the Gini coefficient of income inequality by less than 0.1%, and reduce poverty (absolute before housing costs) by 8.6%. The reforms would raise the net incomes of households in the bottom decile by 1.3% and the top decile by 4.2%.\n",
    "\n",
    "```plotly\n",
    "{\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"x=%{x}\\u003cbr\\u003ey=%{y}\\u003cbr\\u003etext=%{text}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#2C6496\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"text\":[\"1.3%\",\"3.1%\",\"4.8%\",\"4.2%\",\"4.3%\",\"5.1%\",\"5.4%\",\"5.3%\",\"6.0%\",\"4.2%\"],\"textposition\":\"auto\",\"x\":[0,1,2,3,4,5,6,7,8,9],\"xaxis\":\"x\",\"y\":[0.012648342807095678,0.03132008664442573,0.04759230794458184,0.04246238057867267,0.04266858638634309,0.05059255780943398,0.05389949484255953,0.053063795971100475,0.06013410923690721,0.04171578019282118],\"yaxis\":\"y\",\"type\":\"bar\"}],\"layout\":{\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Income decile\"},\"tickvals\":[1,2,3,4,5,6,7,8,9,10],\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Relative net income change\"},\"tickformat\":\".0%\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"legend\":{\"tracegroupgap\":0},\"margin\":{\"t\":120,\"b\":120,\"l\":120,\"r\":120},\"barmode\":\"relative\",\"title\":{\"text\":\"Impact of Reform UK tax-benefit policies by income decile\"},\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"height\":600,\"width\":800,\"plot_bgcolor\":\"#F4F4F4\",\"paper_bgcolor\":\"#F4F4F4\",\"images\":[{\"sizex\":0.15,\"sizey\":0.15,\"source\":\"https:\\u002f\\u002fraw.githubusercontent.com\\u002fPolicyEngine\\u002fpolicyengine-app\\u002fmaster\\u002fsrc\\u002fimages\\u002flogos\\u002fpolicyengine\\u002fteal.png\",\"x\":1.1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"annotations\":[{\"showarrow\":false,\"text\":\"Source: PolicyEngine UK tax-benefit microsimulation model (version 2.28.1)\",\"x\":0,\"xanchor\":\"left\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"modebar\":{\"bgcolor\":\"#F4F4F4\",\"color\":\"#F4F4F4\",\"activecolor\":\"#F4F4F4\"},\"uniformtext\":{\"mode\":\"hide\",\"minsize\":12}}}\n",
    "\n",
    "```\n",
    "\n",
    "To view more results, visit the [PolicyEngine UK microsimulation model](https://legacy.policyengine.org/uk/policy?reform=85289&focus=policyOutput.budgetaryImpact&region=uk&timePeriod=2025&baseline=1&uk_local_areas_beta=false&simYears=5) and our [household calculator](https://legacy.policyengine.org/uk/household?reform=85289&focus=intro&region=uk&timePeriod=2025&baseline=1&uk_local_areas_beta=false) for this suite of reforms."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "f4e70450",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, enhanced_frs_2022_23.h5. Using latest version: 1.11.6\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.11.6 to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, enhanced_frs_2022_23.h5.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, enhanced_frs_2022_23.h5 to enhanced_frs_2022_23.h5\n"
     ]
    }
   ],
   "source": [
    "from policyengine import Simulation\n",
    "\n",
    "sim = Simulation(\n",
    "    country=\"uk\",\n",
    "    scope=\"macro\",\n",
    "    reform={\n",
    "        \"gov.hmrc.income_tax.allowances.personal_allowance.amount\": 20_000,\n",
    "        \"gov.hmrc.income_tax.rates.uk[1].threshold\": 50_000,\n",
    "        \"gov.hmrc.income_tax.allowances.marriage_allowance.max\": 0.25,\n",
    "        \"gov.dwp.universal_credit.elements.child.limit.child_count\": 90,\n",
    "    },\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "e9c0cb57",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, parliamentary_constituency_weights.h5. Using latest version: 1.11.6\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, parliamentary_constituency_weights.h5, 1.11.6 to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, parliamentary_constituency_weights.h5.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, parliamentary_constituency_weights.h5 to parliamentary_constituency_weights.h5\n",
      "INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No metadata found for blob, so it has no version attached.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, constituencies_2024.csv. Using latest version: None\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, constituencies_2024.csv, None to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, constituencies_2024.csv.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, constituencies_2024.csv to constituencies_2024.csv\n"
     ]
    }
   ],
   "source": [
    "result = sim.calculate_economy_comparison()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "059323e2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"x=%{x}\\u003cbr\\u003ey=%{y}\\u003cbr\\u003etext=%{text}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#2C6496\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"text\":[\"1.3%\",\"3.1%\",\"4.8%\",\"4.2%\",\"4.3%\",\"5.1%\",\"5.4%\",\"5.3%\",\"6.0%\",\"4.2%\"],\"textposition\":\"auto\",\"x\":[0,1,2,3,4,5,6,7,8,9],\"xaxis\":\"x\",\"y\":[0.012648342807095678,0.03132008664442573,0.04759230794458184,0.04246238057867267,0.04266858638634309,0.05059255780943398,0.05389949484255953,0.053063795971100475,0.06013410923690721,0.04171578019282118],\"yaxis\":\"y\",\"type\":\"bar\"}],\"layout\":{\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Income decile\"},\"tickvals\":[1,2,3,4,5,6,7,8,9,10],\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Relative net income change\"},\"tickformat\":\".0%\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"legend\":{\"tracegroupgap\":0},\"margin\":{\"t\":120,\"b\":120,\"l\":120,\"r\":120},\"barmode\":\"relative\",\"title\":{\"text\":\"Impact of Reform UK tax-benefit policies by income decile\"},\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"height\":600,\"width\":800,\"plot_bgcolor\":\"#F4F4F4\",\"paper_bgcolor\":\"#F4F4F4\",\"images\":[{\"sizex\":0.15,\"sizey\":0.15,\"source\":\"https:\\u002f\\u002fraw.githubusercontent.com\\u002fPolicyEngine\\u002fpolicyengine-app\\u002fmaster\\u002fsrc\\u002fimages\\u002flogos\\u002fpolicyengine\\u002fteal.png\",\"x\":1.1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"annotations\":[{\"showarrow\":false,\"text\":\"Source: PolicyEngine UK tax-benefit microsimulation model (version 2.28.1)\",\"x\":0,\"xanchor\":\"left\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"modebar\":{\"bgcolor\":\"#F4F4F4\",\"color\":\"#F4F4F4\",\"activecolor\":\"#F4F4F4\"},\"uniformtext\":{\"mode\":\"hide\",\"minsize\":12}}}\n"
     ]
    }
   ],
   "source": [
    "from policyengine.utils.charts import *\n",
    "import plotly.express as px\n",
    "import pandas as pd\n",
    "\n",
    "fig = px.bar(\n",
    "    y=result.decile.relative,\n",
    "    text=[f\"{x:.1%}\" for x in result.decile.relative.values()],\n",
    "    color_discrete_sequence=[BLUE],\n",
    ").update_layout(\n",
    "    title=\"Impact of Reform UK tax-benefit policies by income decile\",\n",
    "    xaxis_title=\"Income decile\",\n",
    "    xaxis_tickvals=list(range(1, 11)),\n",
    "    yaxis_title=\"Relative net income change\",\n",
    "    yaxis_tickformat=\".0%\",\n",
    ")\n",
    "\n",
    "print(format_fig(fig).update_layout().to_json())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b19d9f2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8a4b9b9",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  0%|          | 0/4 [00:00<?, ?it/s]INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, enhanced_frs_2022_23.h5. Using latest version: 1.11.6\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.11.6 to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, enhanced_frs_2022_23.h5.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, enhanced_frs_2022_23.h5 to enhanced_frs_2022_23.h5\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'gov.dwp.universal_credit.elements.child.limit.child_count': 90} Repeal the two-child limit\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 5/5 [00:52<00:00, 10.54s/it]\n",
      " 25%|██▌       | 1/4 [00:54<02:42, 54.10s/it]INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, enhanced_frs_2022_23.h5. Using latest version: 1.11.6\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.11.6 to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, enhanced_frs_2022_23.h5.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, enhanced_frs_2022_23.h5 to enhanced_frs_2022_23.h5\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'gov.dwp.universal_credit.elements.child.limit.child_count': 90, 'gov.hmrc.income_tax.allowances.personal_allowance.amount': 20000, 'gov.hmrc.income_tax.rates.uk[1].threshold': 30270} Raise the Personal Allowance to £20,000\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 5/5 [00:49<00:00,  9.97s/it]\n",
      " 50%|█████     | 2/4 [01:45<01:44, 52.39s/it]INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, enhanced_frs_2022_23.h5. Using latest version: 1.11.6\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.11.6 to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, enhanced_frs_2022_23.h5.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, enhanced_frs_2022_23.h5 to enhanced_frs_2022_23.h5\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'gov.dwp.universal_credit.elements.child.limit.child_count': 90, 'gov.hmrc.income_tax.allowances.personal_allowance.amount': 20000, 'gov.hmrc.income_tax.rates.uk[1].threshold': 50000} Set the higher rate threshold to £70,000\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 5/5 [00:49<00:00,  9.98s/it]\n",
      " 75%|███████▌  | 3/4 [02:36<00:51, 51.83s/it]INFO:root:Using Google Cloud Storage for download.\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, enhanced_frs_2022_23.h5. Using latest version: 1.11.6\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.11.6 to cache\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache exists and crc is unchanged for policyengine-uk-data-private, enhanced_frs_2022_23.h5.\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, enhanced_frs_2022_23.h5 to enhanced_frs_2022_23.h5\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'gov.dwp.universal_credit.elements.child.limit.child_count': 90, 'gov.hmrc.income_tax.allowances.personal_allowance.amount': 20000, 'gov.hmrc.income_tax.rates.uk[1].threshold': 50000, 'gov.hmrc.income_tax.allowances.marriage_allowance.max': 0.25} Raise the Marriage Allowance rate to 25%\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 5/5 [00:49<00:00,  9.86s/it]\n",
      "100%|██████████| 4/4 [03:26<00:00, 51.74s/it]\n"
     ]
    }
   ],
   "source": [
    "from policyengine import Simulation\n",
    "\n",
    "raise_pa = {\n",
    "    \"gov.hmrc.income_tax.allowances.personal_allowance.amount\": 20_000,\n",
    "    \"gov.hmrc.income_tax.rates.uk[1].threshold\": 37_700 - (20_000 - 12_570),\n",
    "}\n",
    "higher_rate_threshold = {\n",
    "    \"gov.hmrc.income_tax.rates.uk[1].threshold\": 50_000,\n",
    "}\n",
    "raise_ma_rate = {\n",
    "    \"gov.hmrc.income_tax.allowances.marriage_allowance.max\": 0.25,\n",
    "}\n",
    "repeal_two_child_limit = {\n",
    "    \"gov.dwp.universal_credit.elements.child.limit.child_count\": 90,\n",
    "}\n",
    "\n",
    "policy_reforms = [\n",
    "    repeal_two_child_limit,\n",
    "    raise_pa,\n",
    "    higher_rate_threshold,\n",
    "    raise_ma_rate,\n",
    "]\n",
    "policy_reform_names = [\n",
    "    \"Repeal the two-child limit\",\n",
    "    \"Raise the Personal Allowance to £20,000\",\n",
    "    \"Set the higher rate threshold to £70,000\",\n",
    "    \"Raise the Marriage Allowance rate to 25%\",\n",
    "]\n",
    "\n",
    "years = []\n",
    "debt_impacts = []\n",
    "policies = []\n",
    "\n",
    "from tqdm import tqdm\n",
    "\n",
    "for i in tqdm(range(len(policy_reforms))):\n",
    "    reform = {}\n",
    "    for j in range(i + 1):\n",
    "        reform.update(policy_reforms[j])\n",
    "\n",
    "    sim = Simulation(\n",
    "        country=\"uk\",\n",
    "        scope=\"macro\",\n",
    "        reform=reform,\n",
    "    )\n",
    "    print(reform, policy_reform_names[i])\n",
    "\n",
    "    for year in tqdm(range(2025, 2030)):\n",
    "        debt_impact = (\n",
    "            sim.reform_simulation.calculate(\"gov_balance\", year).sum() / 1e9\n",
    "            - sim.baseline_simulation.calculate(\"gov_balance\", year).sum()\n",
    "            / 1e9\n",
    "        )\n",
    "        years.append(year)\n",
    "        debt_impacts.append(debt_impact)\n",
    "        policies.append(policy_reform_names[i])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "56e44931",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "df = pd.DataFrame(\n",
    "    {\n",
    "        \"Year\": years,\n",
    "        \"Debt impact (£ billions)\": debt_impacts,\n",
    "        \"Policy\": policies,\n",
    "    }\n",
    ")\n",
    "\n",
    "df = df.pivot(\n",
    "    columns=\"Year\", index=\"Policy\", values=\"Debt impact (£ billions)\"\n",
    ")\n",
    "df = df.iloc[[2, 1, 3, 0]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "35291e14",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.values[1:] = df.values[1:] - df.values[:-1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "7f1230a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[\"2025-29\"] = df.sum(axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "0c7d8a5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Add 'total' row\n",
    "df.loc[\"Total\"] = df.sum(numeric_only=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "d2b5d2eb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "| Policy                                   |   2025 |   2026 |   2027 |   2028 |   2029 |   2025-29 |\n",
      "|:-----------------------------------------|-------:|-------:|-------:|-------:|-------:|----------:|\n",
      "| Repeal the two-child limit               |   -1.7 |   -1.8 |   -1.9 |   -2.2 |   -2.3 |      -9.9 |\n",
      "| Raise the Personal Allowance to £20,000  |  -50.7 |  -51.5 |  -52.4 |  -49.1 |  -45.5 |    -249.3 |\n",
      "| Set the higher rate threshold to £70,000 |  -22.2 |  -23.8 |  -25.5 |  -27.2 |  -29.3 |    -128   |\n",
      "| Raise the Marriage Allowance rate to 25% |   -0.7 |   -0.7 |   -0.8 |   -0.8 |   -0.9 |      -3.9 |\n",
      "| Total                                    |  -75.3 |  -77.9 |  -80.5 |  -79.3 |  -78.1 |    -391.1 |\n"
     ]
    }
   ],
   "source": [
    "print(df.round(1).to_markdown(index=True))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}



---

---
# Extending the Winter Fuel Allowance
Slug: wfa-means-test
Date: 2025-06-11 11:00:00
Authors: Nikhil Woodruff
Tags: uk, policy, featured
Description: The government has reversed its Winter Fuel Allowance means testing, expanding eligibility to 9 million pensioners through a £35,000 income threshold.

---

{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The Labour government has announced changes to its Winter Fuel Allowance policy, expanding eligibility from 1.5 million to 9 million pensioners in England and Wales. The new £35,000 income threshold replaces the previous restriction to Pension Credit recipients only.\n",
    "\n",
    "\n",
    "## Original policy\n",
    "\n",
    "The Winter Fuel Payment provides £200 for households with someone of State Pension age and £300 for households with someone aged 80 or over.\n",
    "\n",
    "In July 2024, the government [restricted Winter Fuel Payments](https://commonslibrary.parliament.uk/research-briefings/cbp-10094/) to pensioners receiving Pension Credit or other means-tested benefits. The Department of Work and Pensions [reports](https://www.gov.uk/government/news/nine-million-pensioners-to-receive-winter-fuel-payments-this-winter) that this reduced the number of recipients from 11.4 million to 1.5 million pensioners - a reduction of 9.9 million people.\n",
    "\n",
    "\n",
    "## New policy\n",
    "\n",
    "From winter 2025/26, all people above State Pension age in England and Wales with taxable income of £35,000 or less will receive Winter Fuel Payments; the amounts do not change. Those with income above £35,000 will receive the payment, but have it recovered through HMRC via PAYE or Self-Assessment.\n",
    "\n",
    "The £35,000 threshold applies to individual income, not household income. If any person is eligible under this taxable income means test, the DWP will pay the benefit amount to the household.\n",
    "\n",
    "\n",
    "## Household impacts\n",
    "\n",
    "For a single 70-year old, the new policy increases their net income by £200 between around £11,000 (where Pension Credit entitlement ends) and £35,000 in taxable income.\n",
    "\n",
    "```plotly\n",
    "{\"data\":[{\"hovertemplate\":\"variable=Reform\\u003cbr\\u003eIncome=%{x}\\u003cbr\\u003evalue=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Reform\",\"line\":{\"color\":\"#2C6496\",\"dash\":\"solid\"},\"marker\":{\"symbol\":\"circle\"},\"mode\":\"lines\",\"name\":\"Reform\",\"orientation\":\"v\",\"showlegend\":true,\"x\":[0.0,1189.689453125,2379.37890625,3569.068115234375,4758.7578125,5948.44677734375,7138.13623046875,8327.826171875,9517.515625,10707.2041015625,11896.8935546875,13086.5830078125,14276.2724609375,15465.9619140625,16655.65234375,17845.341796875,19035.03125,20224.720703125,21414.408203125,22604.09765625,23793.787109375,24983.4765625,26173.166015625,27362.85546875,28552.544921875,29742.234375,30931.923828125,32121.61328125,33311.3046875,34500.9921875,35690.68359375,36880.37109375,38070.0625,39259.75,40449.44140625,41639.12890625,42828.81640625,44018.5078125,45208.1953125,46397.88671875,47587.57421875,48777.265625,49966.953125,51156.64453125,52346.33203125,53536.0234375,54725.7109375,55915.40234375,57105.08984375,58294.78125,59484.46875,60674.16015625,61863.84765625,63053.5390625,64243.2265625,65432.91796875,66622.609375,67812.296875,69001.984375,70191.671875,71381.3671875,72571.0546875,73760.7421875,74950.4296875,76140.125,77329.8125,78519.5,79709.1875,80898.8828125,82088.5703125,83278.2578125,84467.9453125,85657.6328125,86847.328125,88037.015625,89226.703125,90416.390625,91606.0859375,92795.7734375,93985.4609375,95175.1484375,96364.84375,97554.53125,98744.21875,99933.90625,101123.6015625,102313.2890625,103502.9765625,104692.6640625,105882.359375,107072.046875,108261.734375,109451.421875,110641.1171875,111830.8046875,113020.4921875,114210.1796875,115399.875,116589.5625,117779.25,118968.9375],\"xaxis\":\"x\",\"y\":[200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"yaxis\":\"y\",\"type\":\"scatter\"},{\"hovertemplate\":\"variable=Baseline\\u003cbr\\u003eIncome=%{x}\\u003cbr\\u003evalue=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Baseline\",\"line\":{\"color\":\"#808080\",\"dash\":\"solid\"},\"marker\":{\"symbol\":\"circle\"},\"mode\":\"lines\",\"name\":\"Baseline\",\"orientation\":\"v\",\"showlegend\":true,\"x\":[0.0,1189.689453125,2379.37890625,3569.068115234375,4758.7578125,5948.44677734375,7138.13623046875,8327.826171875,9517.515625,10707.2041015625,11896.8935546875,13086.5830078125,14276.2724609375,15465.9619140625,16655.65234375,17845.341796875,19035.03125,20224.720703125,21414.408203125,22604.09765625,23793.787109375,24983.4765625,26173.166015625,27362.85546875,28552.544921875,29742.234375,30931.923828125,32121.61328125,33311.3046875,34500.9921875,35690.68359375,36880.37109375,38070.0625,39259.75,40449.44140625,41639.12890625,42828.81640625,44018.5078125,45208.1953125,46397.88671875,47587.57421875,48777.265625,49966.953125,51156.64453125,52346.33203125,53536.0234375,54725.7109375,55915.40234375,57105.08984375,58294.78125,59484.46875,60674.16015625,61863.84765625,63053.5390625,64243.2265625,65432.91796875,66622.609375,67812.296875,69001.984375,70191.671875,71381.3671875,72571.0546875,73760.7421875,74950.4296875,76140.125,77329.8125,78519.5,79709.1875,80898.8828125,82088.5703125,83278.2578125,84467.9453125,85657.6328125,86847.328125,88037.015625,89226.703125,90416.390625,91606.0859375,92795.7734375,93985.4609375,95175.1484375,96364.84375,97554.53125,98744.21875,99933.90625,101123.6015625,102313.2890625,103502.9765625,104692.6640625,105882.359375,107072.046875,108261.734375,109451.421875,110641.1171875,111830.8046875,113020.4921875,114210.1796875,115399.875,116589.5625,117779.25,118968.9375],\"xaxis\":\"x\",\"y\":[200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Taxable income\"},\"tickprefix\":\"\\u00a3\",\"tickformat\":\",.0f\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Winter Fuel Allowance\"},\"tickprefix\":\"\\u00a3\",\"tickformat\":\",.0f\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"legend\":{\"title\":{\"text\":\"\"},\"tracegroupgap\":0},\"margin\":{\"t\":120,\"b\":120,\"l\":120,\"r\":120},\"title\":{\"text\":\"Winter Fuel Allowance by taxable income for a 70-year-old\"},\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"height\":600,\"width\":800,\"plot_bgcolor\":\"#F4F4F4\",\"paper_bgcolor\":\"#F4F4F4\",\"images\":[{\"sizex\":0.15,\"sizey\":0.15,\"source\":\"https:\\u002f\\u002fraw.githubusercontent.com\\u002fPolicyEngine\\u002fpolicyengine-app\\u002fmaster\\u002fsrc\\u002fimages\\u002flogos\\u002fpolicyengine\\u002fteal.png\",\"x\":1.1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"annotations\":[{\"showarrow\":false,\"text\":\"Source: PolicyEngine UK tax-benefit microsimulation model (version 2.32.0)\",\"x\":0,\"xanchor\":\"left\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"modebar\":{\"bgcolor\":\"#F4F4F4\",\"color\":\"#F4F4F4\",\"activecolor\":\"#F4F4F4\"},\"uniformtext\":{\"mode\":\"hide\",\"minsize\":12}}}\n",
    "```\n",
    "\n",
    "## Economic impacts\n",
    "\n",
    "We [estimate](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=85980&region=uk&timePeriod=2025&baseline=1) this reform will increase the deficit by £1.33 billion per year (the government estimates £1.26 billion in 2025/26), totaling £6.6 billion over the next five years.\n",
    "\n",
    "| Net revenue impact (billions) | 2025-26 | 2026-27 | 2027-28 | 2028-29 | 2029-30 | 2025-30 |\n",
    "|-------------------------------|---------|---------|---------|---------|---------|---------|\n",
    "| Tax                          | 0.0     | 0.0     | 0.0     | 0.0     | 0.0     | 0.0     |\n",
    "| Benefits                     | 1.3     | 1.3     | 1.3     | 1.3     | 1.3     | 6.6     |\n",
    "| **Total**                    | **-1.3** | **-1.3** | **-1.3** | **-1.3** | **-1.3** | **-6.6** |\n",
    "\n",
    "\n",
    "We estimate that the reform will also benefit the second income decile the most in 2025, with the top three deciles benefitting by less than 0.1%.\n",
    "\n",
    "```plotly\n",
    "{\"data\":[{\"alignmentgroup\":\"True\",\"hovertemplate\":\"Income decile=%{x}\\u003cbr\\u003eRelative net income change=%{y}\\u003cbr\\u003etext=%{text}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"\",\"marker\":{\"color\":\"#2C6496\",\"pattern\":{\"shape\":\"\"}},\"name\":\"\",\"offsetgroup\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"text\":[\"0.16%\",\"0.26%\",\"0.24%\",\"0.19%\",\"0.19%\",\"0.13%\",\"0.11%\",\"0.02%\",\"0.02%\",\"0.01%\"],\"textposition\":\"auto\",\"x\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],\"xaxis\":\"x\",\"y\":[0.0016286845773460803,0.0025985178524429438,0.0023843406664892223,0.0018586896728699704,0.0018596998204870117,0.0013138312658149721,0.0011071005875686042,0.00024795528943022133,0.0002456897607750285,5.1435862897925305e-05],\"yaxis\":\"y\",\"type\":\"bar\"}],\"layout\":{\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Income decile\"},\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Relative net income change\"},\"tickformat\":\".1%\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"legend\":{\"tracegroupgap\":0},\"margin\":{\"t\":120,\"b\":120,\"l\":120,\"r\":120},\"barmode\":\"relative\",\"uniformtext\":{\"minsize\":12,\"mode\":\"hide\"},\"title\":{\"text\":\"Relative net income change by income decile of expanding WFA eligibility\"},\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"height\":600,\"width\":800,\"plot_bgcolor\":\"#F4F4F4\",\"paper_bgcolor\":\"#F4F4F4\",\"images\":[{\"sizex\":0.15,\"sizey\":0.15,\"source\":\"https:\\u002f\\u002fraw.githubusercontent.com\\u002fPolicyEngine\\u002fpolicyengine-app\\u002fmaster\\u002fsrc\\u002fimages\\u002flogos\\u002fpolicyengine\\u002fteal.png\",\"x\":1.1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"annotations\":[{\"showarrow\":false,\"text\":\"Source: PolicyEngine UK tax-benefit microsimulation model (version 2.28.2)\",\"x\":0,\"xanchor\":\"left\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"modebar\":{\"bgcolor\":\"#F4F4F4\",\"color\":\"#F4F4F4\",\"activecolor\":\"#F4F4F4\"}}}\n",
    "\n",
    "```\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/nikhilwoodruff/policyengine/policyengine-app/.venv/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n",
      "  from .autonotebook import tqdm as notebook_tqdm\n",
      "No data provided, using default dataset: gs://policyengine-uk-data-private/enhanced_frs_2022_23.h5\n",
      "Downloading enhanced_frs_2022_23.h5 from bucket policyengine-uk-data-private\n",
      "INFO:root:Using Google Cloud Storage for download.\n",
      "INFO:root:Metadata for blob policyengine-uk-data-private, enhanced_frs_2022_23.h5 has version: 1.13.1\n",
      "WARNING:root:No version specified for policyengine-uk-data-private, enhanced_frs_2022_23.h5. Using latest version: 1.13.1\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Syncing policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.13.1 to cache\n",
      "INFO:root:Blob policyengine-uk-data-private, /b/policyengine-uk-data-private/o/enhanced_frs_2022_23.h5 has version 1.13.1\n",
      "INFO:policyengine.utils.data.simplified_google_storage_client:Crc for policyengine-uk-data-private, enhanced_frs_2022_23.h5 is xBsZfQ==\n",
      "INFO:root:Blob policyengine-uk-data-private, /b/policyengine-uk-data-private/o/enhanced_frs_2022_23.h5 has version 1.13.1\n",
      "INFO:policyengine.utils.data.simplified_google_storage_client:Downloaded policyengine-uk-data-private, enhanced_frs_2022_23.h5, version:1.13.1\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Downloaded new version of policyengine-uk-data-private, enhanced_frs_2022_23.h5, 1.13.1 with crc xBsZfQ==\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Cache updated for {id_string}\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Copying downloaded data for policyengine-uk-data-private, enhanced_frs_2022_23.h5 to enhanced_frs_2022_23.h5\n",
      "INFO:policyengine.utils.data.caching_google_storage_client:Data successfully copied to enhanced_frs_2022_23.h5 with version 1.13.1\n",
      "INFO:root:Data loaded\n",
      "INFO:root:Simulations initialised\n",
      "INFO:root:Output functions loaded\n"
     ]
    },
    {
     "data": {
      "text/markdown": [
       "[See the forecast change in PolicyEngine](https://legacy.policyengine.org/uk/policy?reform=85983&baseline=85984&region=uk&timePeriod=2029)"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from policyengine import Simulation\n",
    "\n",
    "\n",
    "ORIGINAL_MEANS_TESTED = {\n",
    "    \"gov.dwp.winter_fuel_payment.eligibility.taxable_income_test.maximum_taxable_income\": {\n",
    "        \"2025\": 0,\n",
    "        \"2026\": 0,\n",
    "        \"2027\": 0,\n",
    "        \"2028\": 0,\n",
    "        \"2029\": 0,\n",
    "    },\n",
    "    \"gov.dwp.winter_fuel_payment.eligibility.taxable_income_test.use_maximum_taxable_income\": {\n",
    "        \"2025\": False,\n",
    "        \"2026\": False,\n",
    "        \"2027\": False,\n",
    "        \"2028\": False,\n",
    "        \"2029\": False,\n",
    "    },\n",
    "}\n",
    "\n",
    "NEW_MEANS_TESTED = {\n",
    "    \"gov.dwp.winter_fuel_payment.eligibility.taxable_income_test.maximum_taxable_income\": {\n",
    "        \"2025\": 35_000,\n",
    "        \"2026\": 35_000,\n",
    "        \"2027\": 35_000,\n",
    "        \"2028\": 35_000,\n",
    "        \"2029\": 35_000,\n",
    "    },\n",
    "    \"gov.dwp.winter_fuel_payment.eligibility.taxable_income_test.use_maximum_taxable_income\": {\n",
    "        \"2025\": True,\n",
    "        \"2026\": True,\n",
    "        \"2027\": True,\n",
    "        \"2028\": True,\n",
    "        \"2029\": True,\n",
    "    },\n",
    "}\n",
    "\n",
    "sim = Simulation(\n",
    "    country=\"uk\",\n",
    "    scope=\"macro\",\n",
    "    baseline=ORIGINAL_MEANS_TESTED,\n",
    "    reform=NEW_MEANS_TESTED,\n",
    ")\n",
    "\n",
    "from policyengine_core.reforms import Reform\n",
    "from IPython.display import Markdown\n",
    "import pandas as pd\n",
    "\n",
    "baseline = Reform.from_dict(ORIGINAL_MEANS_TESTED, country_id=\"uk\")\n",
    "reform = Reform.from_dict(NEW_MEANS_TESTED, country_id=\"uk\")\n",
    "\n",
    "link = f\"https://legacy.policyengine.org/uk/policy?reform={reform.api_id}&baseline={baseline.api_id}&region=uk&timePeriod=2029\"\n",
    "\n",
    "Markdown(f\"[See the forecast change in PolicyEngine]({link})\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Simulations initialised\n",
      "INFO:root:Output functions loaded\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{\"data\":[{\"hovertemplate\":\"variable=Reform\\u003cbr\\u003eIncome=%{x}\\u003cbr\\u003evalue=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Reform\",\"line\":{\"color\":\"#2C6496\",\"dash\":\"solid\"},\"marker\":{\"symbol\":\"circle\"},\"mode\":\"lines\",\"name\":\"Reform\",\"orientation\":\"v\",\"showlegend\":true,\"x\":[0.0,1189.689453125,2379.37890625,3569.068115234375,4758.7578125,5948.44677734375,7138.13623046875,8327.826171875,9517.515625,10707.2041015625,11896.8935546875,13086.5830078125,14276.2724609375,15465.9619140625,16655.65234375,17845.341796875,19035.03125,20224.720703125,21414.408203125,22604.09765625,23793.787109375,24983.4765625,26173.166015625,27362.85546875,28552.544921875,29742.234375,30931.923828125,32121.61328125,33311.3046875,34500.9921875,35690.68359375,36880.37109375,38070.0625,39259.75,40449.44140625,41639.12890625,42828.81640625,44018.5078125,45208.1953125,46397.88671875,47587.57421875,48777.265625,49966.953125,51156.64453125,52346.33203125,53536.0234375,54725.7109375,55915.40234375,57105.08984375,58294.78125,59484.46875,60674.16015625,61863.84765625,63053.5390625,64243.2265625,65432.91796875,66622.609375,67812.296875,69001.984375,70191.671875,71381.3671875,72571.0546875,73760.7421875,74950.4296875,76140.125,77329.8125,78519.5,79709.1875,80898.8828125,82088.5703125,83278.2578125,84467.9453125,85657.6328125,86847.328125,88037.015625,89226.703125,90416.390625,91606.0859375,92795.7734375,93985.4609375,95175.1484375,96364.84375,97554.53125,98744.21875,99933.90625,101123.6015625,102313.2890625,103502.9765625,104692.6640625,105882.359375,107072.046875,108261.734375,109451.421875,110641.1171875,111830.8046875,113020.4921875,114210.1796875,115399.875,116589.5625,117779.25,118968.9375],\"xaxis\":\"x\",\"y\":[200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"yaxis\":\"y\",\"type\":\"scatter\"},{\"hovertemplate\":\"variable=Baseline\\u003cbr\\u003eIncome=%{x}\\u003cbr\\u003evalue=%{y}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"legendgroup\":\"Baseline\",\"line\":{\"color\":\"#808080\",\"dash\":\"solid\"},\"marker\":{\"symbol\":\"circle\"},\"mode\":\"lines\",\"name\":\"Baseline\",\"orientation\":\"v\",\"showlegend\":true,\"x\":[0.0,1189.689453125,2379.37890625,3569.068115234375,4758.7578125,5948.44677734375,7138.13623046875,8327.826171875,9517.515625,10707.2041015625,11896.8935546875,13086.5830078125,14276.2724609375,15465.9619140625,16655.65234375,17845.341796875,19035.03125,20224.720703125,21414.408203125,22604.09765625,23793.787109375,24983.4765625,26173.166015625,27362.85546875,28552.544921875,29742.234375,30931.923828125,32121.61328125,33311.3046875,34500.9921875,35690.68359375,36880.37109375,38070.0625,39259.75,40449.44140625,41639.12890625,42828.81640625,44018.5078125,45208.1953125,46397.88671875,47587.57421875,48777.265625,49966.953125,51156.64453125,52346.33203125,53536.0234375,54725.7109375,55915.40234375,57105.08984375,58294.78125,59484.46875,60674.16015625,61863.84765625,63053.5390625,64243.2265625,65432.91796875,66622.609375,67812.296875,69001.984375,70191.671875,71381.3671875,72571.0546875,73760.7421875,74950.4296875,76140.125,77329.8125,78519.5,79709.1875,80898.8828125,82088.5703125,83278.2578125,84467.9453125,85657.6328125,86847.328125,88037.015625,89226.703125,90416.390625,91606.0859375,92795.7734375,93985.4609375,95175.1484375,96364.84375,97554.53125,98744.21875,99933.90625,101123.6015625,102313.2890625,103502.9765625,104692.6640625,105882.359375,107072.046875,108261.734375,109451.421875,110641.1171875,111830.8046875,113020.4921875,114210.1796875,115399.875,116589.5625,117779.25,118968.9375],\"xaxis\":\"x\",\"y\":[200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,200.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmapgl\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmapgl\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"geo\":{\"bgcolor\":\"white\",\"lakecolor\":\"white\",\"landcolor\":\"white\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\"},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"white\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#EBF0F8\",\"zerolinewidth\":2}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Taxable income\"},\"tickprefix\":\"\\u00a3\",\"tickformat\":\",.0f\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Winter Fuel Allowance\"},\"tickprefix\":\"\\u00a3\",\"tickformat\":\",.0f\",\"gridcolor\":\"#F4F4F4\",\"zerolinecolor\":\"#F4F4F4\",\"ticksuffix\":\"\"},\"legend\":{\"title\":{\"text\":\"\"},\"tracegroupgap\":0},\"margin\":{\"t\":120,\"b\":120,\"l\":120,\"r\":120},\"title\":{\"text\":\"Winter Fuel Allowance by taxable income for a 70-year-old\"},\"font\":{\"family\":\"Roboto Serif\",\"color\":\"black\"},\"height\":600,\"width\":800,\"plot_bgcolor\":\"#F4F4F4\",\"paper_bgcolor\":\"#F4F4F4\",\"images\":[{\"sizex\":0.15,\"sizey\":0.15,\"source\":\"https:\\u002f\\u002fraw.githubusercontent.com\\u002fPolicyEngine\\u002fpolicyengine-app\\u002fmaster\\u002fsrc\\u002fimages\\u002flogos\\u002fpolicyengine\\u002fteal.png\",\"x\":1.1,\"xanchor\":\"right\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"annotations\":[{\"showarrow\":false,\"text\":\"Source: PolicyEngine UK tax-benefit microsimulation model (version 2.32.0)\",\"x\":0,\"xanchor\":\"left\",\"xref\":\"paper\",\"y\":-0.2,\"yanchor\":\"bottom\",\"yref\":\"paper\"}],\"modebar\":{\"bgcolor\":\"#F4F4F4\",\"color\":\"#F4F4F4\",\"activecolor\":\"#F4F4F4\"},\"uniformtext\":{\"mode\":\"hide\",\"minsize\":12}}}\n"
     ]
    }
   ],
   "source": [
    "household = Simulation(\n",
    "    country=\"uk\",\n",
    "    scope=\"household\",\n",
    "    baseline=ORIGINAL_MEANS_TESTED,\n",
    "    reform=NEW_MEANS_TESTED,\n",
    "    data={\n",
    "        \"people\": {\n",
    "            \"person\": {\n",
    "                \"age\": 70,\n",
    "            }\n",
    "        },\n",
    "        \"axes\": [\n",
    "            [\n",
    "                {\n",
    "                    \"name\": \"private_pension_income\",\n",
    "                    \"min\": 0,\n",
    "                    \"max\": 100_000,\n",
    "                    \"count\": 101,\n",
    "                }\n",
    "            ]\n",
    "        ],\n",
    "    },\n",
    ")\n",
    "\n",
    "import plotly.express as px\n",
    "\n",
    "df = pd.DataFrame()\n",
    "df[\"Reform\"] = household.reform_simulation.calculate(\n",
    "    \"winter_fuel_allowance\", 2025\n",
    ")\n",
    "df[\"Baseline\"] = household.baseline_simulation.calculate(\n",
    "    \"winter_fuel_allowance\", 2025\n",
    ")\n",
    "df[\"Income\"] = household.baseline_simulation.calculate(\n",
    "    \"private_pension_income\", 2025\n",
    ")\n",
    "\n",
    "from policyengine.utils.charts import *\n",
    "\n",
    "\n",
    "fig = px.line(\n",
    "    df,\n",
    "    x=\"Income\",\n",
    "    y=[\"Reform\", \"Baseline\"],\n",
    "    color_discrete_sequence=[BLUE, GRAY],\n",
    ").update_layout(\n",
    "    title=\"Winter Fuel Allowance by taxable income for a 70-year-old\",\n",
    "    yaxis_title=\"Winter Fuel Allowance\",\n",
    "    xaxis_title=\"Taxable income\",\n",
    "    yaxis_tickprefix=\"£\",\n",
    "    xaxis_tickprefix=\"£\",\n",
    "    yaxis_tickformat=\",.0f\",\n",
    "    xaxis_tickformat=\",.0f\",\n",
    "    legend_title_text=\"\",\n",
    ")\n",
    "\n",
    "\n",
    "print(format_fig(fig).to_json())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Poverty rates\n",
    "\n",
    "The government reports annually on four poverty metrics:\n",
    "\n",
    "* **Absolute poverty before housing costs**: households with income below 60% of the 2010/11 median income, adjusted for inflation.\n",
    "* **Absolute poverty after housing costs**: households with income below 60% of the 2010/11 median income after housing costs, adjusted for inflation.\n",
    "* **Relative poverty before housing costs**: households with income below 60% of the median income in the current year.\n",
    "* **Relative poverty after housing costs**: households with income below 60% of the median incomeafter housing costs in the current year .\n",
    "\n",
    "For each of these metrics, we simulate the change in the poverty rate and headcount as a result of the policy change. All reported years are fiscal years."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_poverty(simulation, year, absolute, bhc, rate):\n",
    "    population = simulation.calculate(\"person_id\", year).count()\n",
    "    if absolute:\n",
    "        if bhc:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_poverty\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "        else:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_poverty_ahc\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "    else:\n",
    "        if bhc:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_relative_poverty_bhc\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "        else:\n",
    "            in_poverty = simulation.calculate(\n",
    "                \"in_relative_poverty_ahc\", year, map_to=\"person\"\n",
    "            ).sum()\n",
    "\n",
    "    if rate:\n",
    "        return round(in_poverty / population * 100, 1)\n",
    "\n",
    "    else:\n",
    "        return round(in_poverty / 1e3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 2: Absolute poverty before housing costs\n",
       "\n",
       "|   Year |   Baseline rate (%) | Baseline headcount (thousands)   |   Reform rate (%) | Reform headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|--------------------:|:---------------------------------|------------------:|:-------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                11.2 | 7,889                            |              11.2 | 7,857                          |                     0 |                               -32 |\n",
       "|   2026 |                11.2 | 7,928                            |              11.2 | 7,898                          |                     0 |                               -30 |\n",
       "|   2027 |                11.3 | 8,065                            |              11.3 | 8,038                          |                     0 |                               -27 |\n",
       "|   2028 |                11.3 | 8,102                            |              11.3 | 8,074                          |                     0 |                               -28 |\n",
       "|   2029 |                11.4 | 8,196                            |              11.4 | 8,173                          |                     0 |                               -23 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def add_thousands_separator(x):\n",
    "    return \"{:,}\".format(x)\n",
    "\n",
    "\n",
    "def get_rate_table(absolute, bhc, i):\n",
    "    years = []\n",
    "    poverty_rates_autumn = []\n",
    "    headcounts_autumn = []\n",
    "    poverty_rates_spring = []\n",
    "    headcounts_spring = []\n",
    "    change_rates = []\n",
    "    change_headcounts = []\n",
    "    for year in range(2025, 2030):\n",
    "        years.append(year)\n",
    "        poverty_rates_autumn.append(\n",
    "            get_poverty(\n",
    "                sim.baseline_simulation, year, absolute, bhc, rate=True\n",
    "            )\n",
    "        )\n",
    "        poverty_rates_spring.append(\n",
    "            get_poverty(sim.reform_simulation, year, absolute, bhc, rate=True)\n",
    "        )\n",
    "        headcounts_autumn.append(\n",
    "            get_poverty(\n",
    "                sim.baseline_simulation, year, absolute, bhc, rate=False\n",
    "            )\n",
    "        )\n",
    "        headcounts_spring.append(\n",
    "            get_poverty(sim.reform_simulation, year, absolute, bhc, rate=False)\n",
    "        )\n",
    "        change_rates.append(\n",
    "            round(poverty_rates_spring[-1] - poverty_rates_autumn[-1], 1)\n",
    "        )\n",
    "        change_headcounts.append(\n",
    "            round(headcounts_spring[-1] - headcounts_autumn[-1], 0)\n",
    "        )\n",
    "\n",
    "    df = pd.DataFrame(\n",
    "        {\n",
    "            \"Year\": years,\n",
    "            \"Baseline rate (%)\": poverty_rates_autumn,\n",
    "            \"Baseline headcount (thousands)\": headcounts_autumn,\n",
    "            \"Reform rate (%)\": poverty_rates_spring,\n",
    "            \"Reform headcount (thousands)\": headcounts_spring,\n",
    "            \"Change in rate (pp)\": change_rates,\n",
    "            \"Change in headcount (thousands)\": change_headcounts,\n",
    "        }\n",
    "    )\n",
    "\n",
    "    for col in df.columns:\n",
    "        if \"thousands\" in col:\n",
    "            df[col] = df[col].apply(add_thousands_separator)\n",
    "\n",
    "    title = \"Absolute poverty\" if absolute else \"Relative poverty\"\n",
    "    title += \" before housing costs\" if bhc else \" after housing costs\"\n",
    "\n",
    "    return Markdown(\n",
    "        f\"Table {i}: {title}\\n\\n\" + df.set_index(\"Year\").to_markdown()\n",
    "    )\n",
    "\n",
    "\n",
    "get_rate_table(absolute=True, bhc=True, i=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 3: Absolute poverty after housing costs\n",
       "\n",
       "|   Year |   Baseline rate (%) | Baseline headcount (thousands)   |   Reform rate (%) | Reform headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|--------------------:|:---------------------------------|------------------:|:-------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                16.7 | 11,708                           |              16.7 | 11,694                         |                   0   |                               -14 |\n",
       "|   2026 |                16.9 | 11,928                           |              16.9 | 11,910                         |                   0   |                               -18 |\n",
       "|   2027 |                17.3 | 12,294                           |              17.3 | 12,278                         |                   0   |                               -16 |\n",
       "|   2028 |                17.4 | 12,408                           |              17.3 | 12,388                         |                  -0.1 |                               -20 |\n",
       "|   2029 |                17.4 | 12,516                           |              17.4 | 12,496                         |                   0   |                               -20 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rate_table(absolute=True, bhc=False, i=3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 4: Relative poverty before housing costs\n",
       "\n",
       "|   Year |   Baseline rate (%) | Baseline headcount (thousands)   |   Reform rate (%) | Reform headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|--------------------:|:---------------------------------|------------------:|:-------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                17.8 | 12,511                           |              17.8 | 12,491                         |                   0   |                               -20 |\n",
       "|   2026 |                17.9 | 12,661                           |              17.9 | 12,618                         |                   0   |                               -43 |\n",
       "|   2027 |                18.2 | 12,946                           |              18.2 | 12,921                         |                   0   |                               -25 |\n",
       "|   2028 |                18.2 | 13,026                           |              18.2 | 12,987                         |                   0   |                               -39 |\n",
       "|   2029 |                18.4 | 13,184                           |              18.3 | 13,126                         |                  -0.1 |                               -58 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rate_table(absolute=False, bhc=True, i=4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 5: Relative poverty after housing costs\n",
       "\n",
       "|   Year |   Baseline rate (%) | Baseline headcount (thousands)   |   Reform rate (%) | Reform headcount (thousands)   |   Change in rate (pp) |   Change in headcount (thousands) |\n",
       "|-------:|--------------------:|:---------------------------------|------------------:|:-------------------------------|----------------------:|----------------------------------:|\n",
       "|   2025 |                24.3 | 17,067                           |              24.3 | 17,049                         |                   0   |                               -18 |\n",
       "|   2026 |                24.2 | 17,082                           |              24.2 | 17,073                         |                   0   |                                -9 |\n",
       "|   2027 |                24.3 | 17,302                           |              24.3 | 17,277                         |                   0   |                               -25 |\n",
       "|   2028 |                24.5 | 17,471                           |              24.4 | 17,454                         |                  -0.1 |                               -17 |\n",
       "|   2029 |                24.6 | 17,673                           |              24.8 | 17,763                         |                   0.2 |                                90 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_rate_table(absolute=False, bhc=False, i=5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Inequality\n",
    "\n",
    "We also project income inequality metrics in PolicyEngine's open source model, including the Gini coefficient, the share of income held by the top 10 percent, and the share of income held by the top 1 percent."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 6: Gini coefficient\n",
       "\n",
       "|   Year |   Baseline |   Reform |   Change (pp) |   Change (%) |\n",
       "|-------:|-----------:|---------:|--------------:|-------------:|\n",
       "|   2025 |       37.3 |     37.2 |          -0.1 |         -0.2 |\n",
       "|   2026 |       37.5 |     37.4 |          -0.1 |         -0.2 |\n",
       "|   2027 |       37.5 |     37.5 |          -0.1 |         -0.1 |\n",
       "|   2028 |       37.6 |     37.6 |          -0.1 |         -0.1 |\n",
       "|   2029 |       37.7 |     37.6 |          -0.1 |         -0.1 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def get_inequality_table(metric, i):\n",
    "    years = []\n",
    "    autumn_values = []\n",
    "    spring_values = []\n",
    "    change_values = []\n",
    "    change_values_pct = []\n",
    "\n",
    "    for year in range(2025, 2030):\n",
    "        if metric == \"Gini coefficient\":\n",
    "            autumn_values.append(\n",
    "                sim.baseline_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).gini()\n",
    "                * 100\n",
    "            )\n",
    "            spring_values.append(\n",
    "                sim.reform_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).gini()\n",
    "                * 100\n",
    "            )\n",
    "        elif metric == \"Top 10% share\":\n",
    "            autumn_values.append(\n",
    "                sim.baseline_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_10_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "            spring_values.append(\n",
    "                sim.reform_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_10_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "        elif metric == \"Top 1% share\":\n",
    "            autumn_values.append(\n",
    "                sim.baseline_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_1_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "            spring_values.append(\n",
    "                sim.reform_simulation.calculate(\n",
    "                    \"equiv_household_net_income\", year\n",
    "                ).top_1_pct_share()\n",
    "                * 100\n",
    "            )\n",
    "        years.append(year)\n",
    "        change_values.append(round(spring_values[-1] - autumn_values[-1], 1))\n",
    "        change_values_pct.append(\n",
    "            round(\n",
    "                (spring_values[-1] - autumn_values[-1])\n",
    "                / autumn_values[-1]\n",
    "                * 100,\n",
    "                1,\n",
    "            )\n",
    "        )\n",
    "\n",
    "    df = pd.DataFrame(\n",
    "        {\n",
    "            \"Year\": years,\n",
    "            \"Baseline\": autumn_values,\n",
    "            \"Reform\": spring_values,\n",
    "            \"Change (pp)\": change_values,\n",
    "            \"Change (%)\": change_values_pct,\n",
    "        }\n",
    "    )\n",
    "\n",
    "    df[\"Baseline\"] = df[\"Baseline\"].round(1)\n",
    "    df[\"Reform\"] = df[\"Reform\"].round(1)\n",
    "\n",
    "    return Markdown(\n",
    "        f\"Table {i}: {metric}\\n\\n\" + df.set_index(\"Year\").to_markdown()\n",
    "    )\n",
    "\n",
    "\n",
    "get_inequality_table(\"Gini coefficient\", i=6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 7: Top 10% share\n",
       "\n",
       "|   Year |   Baseline |   Reform |   Change (pp) |   Change (%) |\n",
       "|-------:|-----------:|---------:|--------------:|-------------:|\n",
       "|   2025 |       29   |     29   |            -0 |         -0.1 |\n",
       "|   2026 |       29.2 |     29.1 |            -0 |         -0.1 |\n",
       "|   2027 |       29.2 |     29.2 |            -0 |         -0.1 |\n",
       "|   2028 |       29.3 |     29.3 |            -0 |         -0.1 |\n",
       "|   2029 |       29.3 |     29.3 |            -0 |         -0   |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_inequality_table(\"Top 10% share\", i=7)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "Table 8: Top 1% share\n",
       "\n",
       "|   Year |   Baseline |   Reform |   Change (pp) |   Change (%) |\n",
       "|-------:|-----------:|---------:|--------------:|-------------:|\n",
       "|   2025 |        9.7 |      9.7 |            -0 |         -0.1 |\n",
       "|   2026 |        9.8 |      9.8 |            -0 |         -0.1 |\n",
       "|   2027 |        9.9 |      9.9 |            -0 |         -0.1 |\n",
       "|   2028 |       10   |     10   |            -0 |         -0.1 |\n",
       "|   2029 |       10.1 |     10   |            -0 |         -0.1 |"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_inequality_table(\"Top 1% share\", i=8)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "View the full PolicyEngine analysis [here](https://legacy.policyengine.org/uk/policy?focus=policyOutput.policyBreakdown&reform=85980&region=uk&timePeriod=2025&baseline=1) and use our household [calculator](https://legacy.policyengine.org/uk/household?focus=intro&reform=85980&region=uk&timePeriod=2025&baseline=1) to see how these changes affect individual households."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}



---

---
# How changing the VAT threshold affects UK revenues
Slug: uk-vat-thresholds
Date: 2025-09-10 11:00:00
Authors: Vahid Ahmadi
Tags: uk, policy, featured
Description: PolicyEngine's new firm microsimulation model estimates revenue and business impacts of VAT thresholds from £70,000 to £120,000.

---

The UK requires businesses to register for VAT and charge customers 20% on their sales once annual turnover reaches [£90,000](https://www.gov.uk/vat-registration-thresholds), up from [£85,000](https://www.gov.uk/government/publications/vat-increasing-the-registration-and-deregistration-thresholds/increasing-the-vat-registration-threshold) in 2024-25. The Telegraph [reported](https://www.telegraph.co.uk/business/2025/08/30/reeves-talks-to-raise-vat-threshold-battle-to-grow-economy/) that Chancellor Rachel Reeves is considering further increases to the VAT threshold.

We analyse how VAT threshold changes between £70,000 and £120,000 would affect revenues and the number of VAT-paying firms for the 2026-27 fiscal year. We constructed synthetic firm microdata to generate these projections and compare them with HMRC's official estimates.

## Methodology

We calibrated synthetic firm microdata to official UK business statistics from two sources: [ONS UK Business statistics](https://www.ons.gov.uk/businessindustryandtrade/business/activitysizeandlocation) for overall firm distributions and [HMRC VAT statistics](https://www.gov.uk/government/statistics/value-added-tax-vat-annual-statistics) for VAT-registered businesses.

Figure 1 shows the distribution of UK firms by turnover band in 2024 according to ONS business statistics.

[Chart: type: bar]

ONS data shows 32.1% of UK firms have turnover between £100,000 and £249,000, with 14.3% below £50,000 and 19.7% in the £50,000-£99,000 range. Most UK businesses operate with turnover below £250,000.

Figure 2 presents the distribution of VAT-registered firms by turnover band in 2024-25 from HMRC statistics.

[Chart: type: bar]

HMRC data shows 31.1% of VAT-registered firms have turnover between £1 and £90,000, just below the registration threshold, with 14.0% in the £90,000-£150,000 band.

We constructed synthetic firm microdata through multi-objective optimisation that matches both ONS firm structures and HMRC targets. The data captures firms by industry classification, turnover bands, employee counts, and VAT tax liability.

Figure 3 shows the resulting distribution of UK firms by annual turnover in 2024.

[Chart: type: bar]

The distribution shows drops in firm density above both the £90,000 VAT threshold and the £150,000 [VAT Flat Rate Scheme](https://www.gov.uk/vat-flat-rate-scheme) limit, which offers simplified VAT accounting for smaller businesses.

We construct the initial synthetic firm set for 2024-25, then age turnover and VAT liability values to 2026-27 using growth factors from the [OBR's Retail Price Index forecasts](https://obr.uk/efo/economic-and-fiscal-outlook-march-2024/#annex-a), maintaining the same number of firms. Projections assume no behavioral responses to threshold changes.

## Comparison with HMRC projections

HMRC published revenue projections for raising the VAT threshold from [£85,000 to £90,000](https://www.gov.uk/government/publications/vat-increasing-the-registration-and-deregistration-thresholds/increasing-the-vat-registration-threshold#summary-of-impacts) across the 2024-29 period. My colleague Max Ghenis [confirmed](https://maxghenis.substack.com/p/vat-thresholds-revenues-and-the-role) that HMRC assumed baseline thresholds of £85,000 in 2024-25, £87,000 in 2025-26, £89,000 in 2026-27, and £92,000 in 2028-29. Figure 4 compares PolicyEngine's estimates with HMRC's projections.

[Chart: type: bar]

Both models project revenue losses in the first four years, followed by gains in 2028-29. HMRC estimates a [£185 million](https://www.gov.uk/government/publications/vat-increasing-the-registration-and-deregistration-thresholds/increasing-the-vat-registration-threshold#summary-of-impacts) loss in 2025-26; PolicyEngine projects £184 million. The 2028-29 revenue increase occurs because HMRC's baseline assumes the threshold would grow with inflation to £92,000 by that point, so fixing it at £90,000 captures more firms. PolicyEngine's estimates deviate an average 12.3% from HMRC's projections across all five years.

## Revenue impacts

Figure 7 shows revenue impacts for different thresholds in 2026-27.

[Chart: type: scatter]

In 2026-27, a £70,000 threshold would generate approximately £642 million additional revenue while a £120,000 threshold would reduce revenue by approximately £1.1 billion.

## Impact on VAT-paying firms

Figure 5 shows how different threshold levels change the number of VAT-paying firms in 2026-27.

[Chart: type: scatter]

A £70,000 threshold would add approximately 109,000 firms to VAT registration in 2026-27, while a £120,000 threshold would remove approximately 116,000 firms.

## Conclusion

Our synthetic firm microsimulation model shows that VAT threshold changes affect government revenues and the number of VAT-registered businesses. Raising the threshold to £100,000 would remove approximately 48,000 firms from VAT registration in 2026-27, reducing revenue by approximately £371 million.

This analysis represents PolicyEngine's first application of firm-level microsimulation to UK tax policy. In the coming weeks, we'll apply this VAT model to evaluate other policy alternatives, including sector-specific thresholds, phase-ins, and mechanisms to address cliff effects.



---

---
# Testing multi-agent AI workflows for policy research
Slug: multi-agent-workflows-policy-research
Date: 2025-10-28
Authors: Vahid Ahmadi
Tags: uk, us, featured, technology, ai
Description: A multi-agent Claude Code system fared better on distributional analysis than benefit interactions; insights inform our forthcoming plugin.

---

When we finished our [UK carbon dividend analysis](https://policyengine.org/uk/research/uk-carbon-tax-dividend) this autumn, we wondered whether [Claude Code's](https://claude.com/claude-code) multi-agent system could have automated parts of the research workflow. We tested it on a similar policy analysis to find out.

## Building a multi-agent research workflow

Using Claude Code, we configured three [specialised agents](https://docs.claude.com/en/docs/claude-code/agents) to handle different parts of a policy analysis pipeline. The first agent fetches PolicyEngine microsimulation data from our GitHub repositories and documentation. The second writes analysis scripts using our [Python package](https://github.com/PolicyEngine/policyengine-uk). The third generates formatted research output from the results.

We stored each agent as a markdown file in [`.claude/agents/`](https://docs.claude.com/en/docs/claude-code/agents#creating-custom-agents), defining their specific roles and tools. The data fetching agent got access to GitHub APIs and PolicyEngine documentation. The script writer could execute Python and access our policyengine-uk package. The report generator worked with markdown formatting and [Plotly](https://plotly.com/) visualisations.

![](/images/posts/multi-agent-workflows-policy-research/claude-code-interface.png)

Claude Code automatically routes tasks to the appropriate agent based on the request. When we asked it to analyse a carbon tax scenario, it handled the coordination without explicit instructions about which agent should do what.

![](/images/posts/multi-agent-workflows-policy-research/create-agent-dialog.png)

## What worked

For standard distributional analyses—calculating poverty rates, Gini coefficients, and decile-level impacts—the workflow produced output matching our manual approach. The agents correctly structured PolicyEngine API calls and generated properly formatted charts.

The system saved the most time on repetitive tasks. Once we configured the agents for UK distributional analysis, we needed minimal adjustments to run similar analyses on other policies. This matters for our work where we often model multiple versions of the same reform.

The report generator consistently matched PolicyEngine's house style at least as well as our human writers typically do on first attempt. It maintained active voice, avoided subjective adjectives, and led with quantitative findings.

![](/images/posts/multi-agent-workflows-policy-research/policyengine-agents-list.png)

## What didn't work

Complex policy modelling exposed the limits. When calculations required understanding interactions between multiple benefit programmes—like how Universal Credit's taper interacts with Housing Benefit phase-outs—the agents struggled. They would implement each programme correctly in isolation but miss the coordination logic.

We found prompt precision mattered more than expected. An instruction to "analyse carbon tax impacts" produced generic output. We needed specifics: "Calculate relative change in net income by decile, poverty rates by demographic group, and constituency-level winners and losers." The agents don't infer methodological standards the way human researchers do.

We hit an unexpected problem with code review. Our first approach used the script-writing agent to review its own code. This caught syntax errors but missed logical problems. We had to create a separate reviewer agent with different prompting to get meaningful code critique.

![](/images/posts/multi-agent-workflows-policy-research/agents-in-progress.png)

## What we learned

Multi-agent workflows work best when the task has clear boundaries and established patterns. Our monthly policy briefs analysing government reforms fit this pattern. Research exploring new methodologies doesn't.

The technology changes how we think about research automation. Instead of one AI that does everything, specialised agents with defined responsibilities produce more reliable output. This mirrors how a streamlined policy analysis shop might operate—one person pulls data, another writes Python, a third formats the report.

These limitations reveal where human judgement remains essential. When policy interactions get complex, when methodological choices require expertise, or when political context matters for framing, the agents defer to human researchers. That's the right division of labour.

## Addressing the shortcomings

We're working to address these limitations through improved agent configurations and leveraging Anthropic's recently launched [Skills](https://www.anthropic.com/news/skills) and [plugin ecosystem](https://www.anthropic.com/news/claude-code-plugins). Skills allow us to package specific PolicyEngine expertise—like properly structuring benefit programme interactions or applying our methodological standards—into reusable components that Claude Code loads when needed.

We're packaging these insights into the [policyengine-claude plugin](https://github.com/PolicyEngine/policyengine-mcp), which enables other researchers to use Claude Code with PolicyEngine more effectively. The plugin includes specialised agents, pre-configured skills for common policy analyses, and direct database access through the Model Context Protocol.

We'll demonstrate this workflow at our [PolicyEngine 2.0 event](https://www.eventbrite.co.uk/e/policyengine-20-and-the-future-of-public-policy-analysis-tickets-1673065246189?aff=oddtdtcreator) on 3 November in London, where we'll show how these tools work together for real policy analysis. If you're interested in seeing multi-agent workflows in action for policy research, we'd encourage you to attend.

We're deploying this workflow for routine policy updates where the analysis structure stays constant. It won't replace human researchers, but it will free them to focus on questions that require genuine policy expertise rather than technical execution.

