<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 10px;
            background: white;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }
        .controls label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
        }
        .controls select {
            padding: 8px 12px;
            border: 2px solid #319795;
            background: white;
            color: #374151;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            font-size: 14px;
            font-weight: 500;
            min-width: 200px;
        }
        .controls select:focus {
            outline: none;
            border-color: #2C7A7B;
        }
        #chart {
            width: 100%;
            height: 400px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <label for="metric-select">Select metric:</label>
        <select id="metric-select" onchange="showChart(this.value)">
            <optgroup label="Inflation">
                <option value="cpi" selected>CPI inflation</option>
                <option value="rpi">RPI inflation</option>
                <option value="cpih">CPIH inflation</option>
            </optgroup>
            <optgroup label="Labour market">
                <option value="earnings">Average earnings</option>
            </optgroup>
            <optgroup label="Housing">
                <option value="house_prices">House prices</option>
                <option value="rent">Rent (private & social)</option>
                <option value="social_rent">Social rent</option>
                <option value="mortgage_interest">Mortgage interest</option>
            </optgroup>
            <optgroup label="Income">
                <option value="non_labour_income">Non-labour income</option>
                <option value="per_capita_gdp">Per capita GDP</option>
                <option value="per_capita_mixed">Per capita mixed income</option>
                <option value="per_capita_nli">Per capita non-labour income</option>
            </optgroup>
            <optgroup label="Local taxes">
                <option value="council_tax_england">Council tax (England)</option>
                <option value="council_tax_scotland">Council tax (Scotland)</option>
                <option value="council_tax_wales">Council tax (Wales)</option>
            </optgroup>
        </select>
    </div>
    <div id="chart"></div>

    <script>
        const years = [2024, 2025, 2026, 2027, 2028, 2029, 2030];

        // March 2025 values from git history (commit c19189ff)
        // November 2025 values from current repo
        const data = {
            cpi: {
                march: [2.33, 3.18, 1.93, 2.00, 2.00, 2.00, 2.00],
                november: [2.53, 3.45, 2.48, 2.02, 2.04, 2.04, 2.00],
                title: 'CPI inflation (%)'
            },
            rpi: {
                march: [3.31, 4.16, 3.08, 3.00, 2.83, 2.83, 2.38],
                november: [3.59, 4.33, 3.71, 3.13, 2.87, 2.91, 2.31],
                title: 'RPI inflation (%)'
            },
            cpih: {
                march: [3.20, 3.74, 2.27, 2.10, 2.05, 2.09, 2.24],
                november: [3.27, 3.93, 2.67, 2.15, 2.08, 2.11, 2.13],
                title: 'CPIH inflation (%)'
            },
            earnings: {
                march: [4.67, 3.71, 2.16, 2.07, 2.25, 2.53, 2.92],
                november: [4.93, 5.17, 3.33, 2.25, 2.10, 2.21, 2.32],
                title: 'Average earnings growth (%)'
            },
            house_prices: {
                march: [2.7, 2.4, 2.5, 2.6, 2.3, 2.4, null],
                november: [0.83, 2.94, 2.22, 2.79, 2.72, 2.57, 2.42],
                title: 'House price growth (%)'
            },
            rent: {
                march: [7.4, 5.7, 3.6, 2.7, 2.3, 2.4, null],
                november: [7.16, 5.46, 3.34, 3.11, 2.43, 2.34, 2.54],
                title: 'Rent growth (%)'
            },
            social_rent: {
                march: [6.7, 3.3, 4.2, 2.9, 3.0, 3.0, null],
                november: [8.3, 3.5, 4.5, 3.5, 3.0, 3.0, 3.0],
                title: 'Social rent growth (%)'
            },
            mortgage_interest: {
                march: [22.1, 13.6, 12.6, 8.2, 4.2, 4.7, null],
                november: [27.3, 10.98, 14.35, 10.32, 4.70, 4.66, 5.53],
                title: 'Mortgage interest growth (%)'
            },
            non_labour_income: {
                march: [8.0, 6.8, 5.6, 4.5, 3.4, 3.5, null],
                november: [4.92, 5.19, 5.65, 4.74, 3.64, 3.02, 2.92],
                title: 'Non-labour income growth (%)'
            },
            per_capita_gdp: {
                march: [3.8, 2.8, 2.8, 3.1, 3.3, 3.3, null],
                november: [3.72, 4.18, 3.27, 3.26, 3.02, 2.94, 3.06],
                title: 'Per capita GDP growth (%)'
            },
            per_capita_mixed: {
                march: [4.8, 4.7, 3.1, 3.1, 3.6, 3.8, null],
                november: [2.73, 0.24, 3.62, 3.74, 3.51, 3.58, 3.64],
                title: 'Per capita mixed income growth (%)'
            },
            per_capita_nli: {
                march: [6.9, 5.7, 4.9, 3.8, 2.9, 3.0, null],
                november: [3.85, 4.47, 5.27, 4.37, 3.24, 2.58, 2.47],
                title: 'Per capita non-labour income growth (%)'
            },
            council_tax_england: {
                march: [5.1, 5.0, 4.3, 4.3, 4.3, 4.3, null],
                november: [5.1, 7.81, 5.30, 5.79, 5.65, 5.47, 5.42],
                title: 'Council tax growth - England (%)'
            },
            council_tax_scotland: {
                march: [0.1, 8.8, 2.7, 2.7, 2.7, 2.7, null],
                november: [0.1, 3.84, 3.84, 3.84, 3.84, 3.84, 3.84],
                title: 'Council tax growth - Scotland (%)'
            },
            council_tax_wales: {
                march: [7.7, 7.2, 4.1, 4.1, 4.1, 4.1, null],
                november: [7.7, 5.81, 5.81, 5.81, 5.81, 5.81, 5.81],
                title: 'Council tax growth - Wales (%)'
            }
        };

        function showChart(metric) {
            const d = data[metric];

            // Filter out null values for March (which only goes to 2029)
            const marchYears = [];
            const marchValues = [];
            for (let i = 0; i < years.length; i++) {
                if (d.march[i] !== null) {
                    marchYears.push(years[i]);
                    marchValues.push(d.march[i]);
                }
            }

            const trace1 = {
                x: marchYears,
                y: marchValues,
                name: 'March 2025',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#9CA3AF', width: 2, dash: 'dash' },
                marker: { size: 8 }
            };

            const trace2 = {
                x: years,
                y: d.november,
                name: 'November 2025',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#319795', width: 3 },
                marker: { size: 10 }
            };

            const layout = {
                title: {
                    text: d.title,
                    font: {
                        size: 18,
                        color: '#374151',
                        family: 'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
                    }
                },
                xaxis: {
                    tickmode: 'array',
                    tickvals: years,
                    ticktext: years.map(String),
                    gridcolor: '#E5E7EB',
                    tickfont: {
                        family: 'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        color: '#6B7280'
                    }
                },
                yaxis: {
                    gridcolor: '#E5E7EB',
                    zeroline: true,
                    zerolinecolor: '#9CA3AF',
                    tickfont: {
                        family: 'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        color: '#6B7280'
                    },
                    ticksuffix: '%'
                },
                legend: {
                    orientation: 'h',
                    y: -0.15,
                    x: 0.5,
                    xanchor: 'center',
                    font: {
                        family: 'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        color: '#374151'
                    }
                },
                margin: { t: 50, b: 80, l: 50, r: 30 },
                plot_bgcolor: 'white',
                paper_bgcolor: 'white',
                hovermode: 'x unified',
                hoverlabel: {
                    font: {
                        family: 'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
                    }
                }
            };

            const config = {
                responsive: true,
                displayModeBar: false
            };

            Plotly.newPlot('chart', [trace1, trace2], layout, config);
        }

        // Initial chart
        showChart('cpi');
    </script>
</body>
</html>
